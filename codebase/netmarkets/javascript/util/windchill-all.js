Ext.namespace("PTC.JSBridge");PTC.JSBridge.log=log4javascript.getLogger("PTC.JSBridge");Ext.namespace("PTC.JSBridge.Util");Ext.namespace("PTC.JSBridge.Util.JSON");if(typeof JSON==="undefined")JSON={};if(JSON.stringify===undefined)JSON.stringify=Ext.util.JSON.encode;if(JSON.parse===undefined)JSON.parse=Ext.util.JSON.decode;
PTC.JSBridge.Util.JSON.stringify=function(o){var saveArrToJsonMethod=Array.prototype.toJSON;delete Array.prototype.toJSON;if(o===undefined)o=null;var jsonStr=JSON.stringify(o);if(saveArrToJsonMethod!==undefined)Array.prototype.toJSON=saveArrToJsonMethod;return jsonStr};PTC.JSBridge.Util.EnumIntToTextValue=function(intValue,enumDefObject){for(var element in enumDefObject)if(enumDefObject[element]==intValue)return element;return intValue};PTC.JSBridge.Executor=function(){this._reqManager=null};
PTC.JSBridge.Executor.prototype={constructor:PTC.JSBridge.Executor,Invoke:function(cmd,params,id,async){},ReadyStateChange:function(id,state,statusCode,statusText,response){if(this._reqManager)this._reqManager.ReadyStateChange(id,state,statusCode,statusText,response)},setRequestManager:function(requestManager){if(!(requestManager instanceof PTC.JSBridge.RequestManager))throw"requestManager parameter MUST be an instance of PTC.JSBridge.RequestManager";if(this._reqManager&&this._reqManager!=requestManager)throw"an instance of PTC.JSBridge.Executor can only be associated with one RequestManager and cannot be reassigned and reused! Please create a new instance of Executor and set to the RequestManager";
this._reqManager=requestManager},getRequestManager:function(){return this._reqManager}};PTC.JSBridge.CreoExecutor=function(){PTC.JSBridge.CreoExecutor.superclass.constructor.apply(this,arguments)};
PTC.JSBridge.CreoExecutor.externalReadyStateChange=function PTC$JSBridge$CreoExecutor$externalReadyStateChange(id,state,statusCode,statusText,response){var frames=[window.top];var frameWithReq=null;while(frames.length>0){var frame=frames.shift();var request=undefined;try{request=frame.PTC.JSBridge.RequestManager.getInstance().getRequest(id)}catch(ex){}if(request!==undefined){frameWithReq=frame;break}var subFrames=frame.frames;if(subFrames){var subFramesLen=subFrames.length;for(var j=0;j<subFramesLen;j++)frames.push(subFrames[j])}}if(frameWithReq)frameWithReq.PTC.JSBridge.RequestManager.getInstance().getExecutor().ReadyStateChange(id,
state,statusCode,statusText,response);else{var errMsg="PTC.JSBridge.CreoExecutor.externalReadyStateChange() could not find the request with id: '"+id+"' in any of the frames";if(PTC.JSBridge.log)PTC.JSBridge.log.error(errMsg);else if(PTC.log)PTC.log.error(errMsg)}};if(!window.top.PTC)window.top.PTC={};if(!window.top.PTC.JSBridge)window.top.PTC.JSBridge={};if(!window.top.PTC.JSBridge.CreoExecutor)window.top.PTC.JSBridge.CreoExecutor=function(){};
if(!window.top.PTC.JSBridge.CreoExecutor.externalReadyStateChange)window.top.eval("PTC.JSBridge.CreoExecutor.externalReadyStateChange = "+PTC.JSBridge.CreoExecutor.externalReadyStateChange.toString());
PTC.JSBridge._overrides={Invoke:function(cmd,params,id,async){var isAsync=!!async;PTC.JSBridge.log.debug("PTC.JSBridge.CreoExecutor.Invoke() cmd:"+cmd+", params: "+params+", id: "+id+", async: "+isAsync);var paramsJson=PTC.JSBridge.Util.JSON.stringify(params);PTC.JSBridge.log.debug("PTC.JSBridge.CreoExecutor.Invoke() params JSON serialized: "+paramsJson);window.top.external.ptc(isAsync,id,cmd,paramsJson);PTC.JSBridge.log.debug("PTC.JSBridge.CreoExecutor.Invoke() returning")}};
Ext.extend(PTC.JSBridge.CreoExecutor,PTC.JSBridge.Executor,PTC.JSBridge._overrides);
(function(){var BEFORE_REQUEST="beforeRequest";var REQUEST_SUCCEEDED="requestSucceeded";var REQUEST_FAILED="requestFailed";var REQUEST_PROCESSED="requestProcessed";PTC.JSBridge.RequestManager=function(){this._requests={};this._requestsCount=0;this.setExecutor(new PTC.JSBridge.CreoExecutor);this._nextReqId=1;this.addEvents(BEFORE_REQUEST,REQUEST_SUCCEEDED,REQUEST_FAILED,REQUEST_PROCESSED);PTC.JSBridge.RequestManager.superclass.constructor.apply(this,arguments)};PTC.JSBridge.RequestManager.Events={BeforeRequest:BEFORE_REQUEST,
RequestSucceeded:REQUEST_SUCCEEDED,RequestFailed:REQUEST_FAILED,RequestProcessed:REQUEST_PROCESSED}})();PTC.JSBridge.RequestManager.StatusCodes={Success:200,BadRequest:400,NotFound:404,GenericError:500,NoResponseReceivedForReturnedSyncCall:510};
PTC.JSBridge._overrides={getExecutor:function(){return this._executor},setExecutor:function(executor){PTC.JSBridge.log.debug("PTC.JSBridge.RequestManager.setExecutor(): setExecutor is called with new executor");if(!(executor instanceof PTC.JSBridge.Executor))throw"executor MUST be an instance of PtC.JSBridge.Executor";this._executor=executor;executor.setRequestManager(this)},getRequest:function(id){return this._requests[id]},setRequest:function(id,request){PTC.JSBridge.log.debug("PTC.JSBridge.RequestManager.setRequest(): new request is stored in the manager, req ID:"+
id);this._requests[id]=request;this._requestsCount++},getRequestsCount:function(){return this._requestsCount},removeRequest:function(id){PTC.JSBridge.log.debug("PTC.JSBridge.RequestManager.setRequest(): Request is being removed from the manager, req ID:"+id);if(this._requests.hasOwnProperty(id)){delete this._requests[id];this._requestsCount--}},InvokeRequest:function(request){var id=this._GenerateReqId();var async=request.isAsynchronous();PTC.JSBridge.log.debug("PTC.JSBridge.RequestManager.InvokeRequest(): "+
(async?"Async":"Sync")+" request is being invoked in the manager, req ID:"+id);this.setRequest(id,request);this._FireEventSafe(PTC.JSBridge.RequestManager.Events.BeforeRequest,id,request);try{this.getExecutor().Invoke(request.getCommand(),request.getParams(),id,async)}catch(e){PTC.JSBridge.log.error("PTC.JSBridge.RequestManager.InvokeRequest() executor.Invoke threw exection : ",e);this.ReadyStateChange(id,PTC.JSBridge.Request.ReadyState.DONE,PTC.JSBridge.RequestManager.StatusCodes.GenericError,"Exception during Invoke: "+
e.toString())}if(!async&&!request.getCompleted()){var statusText="No success or failure response is received for synchronous request id: "+id+" with command:"+request.getCommand();PTC.JSBridge.log.error("PTC.JSBridge.RequestManager.InvokeRequest() "+statusText);this.ReadyStateChange(id,PTC.JSBridge.Request.ReadyState.DONE,PTC.JSBridge.RequestManager.StatusCodes.NoResponseReceivedForReturnedSyncCall,statusText)}},_FireEventSafe:function(){try{this.fireEvent.apply(this,arguments)}catch(ex){PTC.JSBridge.log.warn(ex)}},
_GenerateReqId:function(){var reqId=this._nextReqId;var nextReqId=this._nextReqId+1;this._nextReqId=nextReqId==this._nextReqId?0:nextReqId;var frameElem=window.frameElement;return reqId+"-"+(frameElem?frameElem.id:"top")+"-"+(new Date).getTime()},ReadyStateChange:function(id,state,statusCode,statusText,response){var useTimeout=false;var request=this.getRequest(id);if(request instanceof PTC.JSBridge.Request)useTimeout=request.isAsynchronous();if(useTimeout){var me=this;setTimeout(function(){me.ReadyStateChangeInner(id,
state,statusCode,statusText,response)},0)}else this.ReadyStateChangeInner(id,state,statusCode,statusText,response)},ReadyStateChangeInner:function(id,state,statusCode,statusText,response){PTC.JSBridge.log.debug("PTC.JSBridge.RequestManager.ReadyStateChange(): Req ID:"+id+' State:"'+PTC.JSBridge.Util.EnumIntToTextValue(state,PTC.JSBridge.Request.ReadyState)+"("+state+')", StatusCode:"'+statusCode+'", Status Text:"'+statusText+'"');var request=this.getRequest(id);if(!(request instanceof PTC.JSBridge.Request)){PTC.JSBridge.log.error("PTC.JSBridge.RequestManager.ReadyStateChange(): Request with ID '"+
id+"' is not of type PTC.JSBridge.Request, ignoring it");this.removeRequest(id);return}if(state==PTC.JSBridge.Request.ReadyState.DONE){this.removeRequest(id);request.setCompleted(true)}request.setStatusCode(statusCode);request.setStatusText(statusText);request.setResponse(response);request.setReadyState(state);var reqReadyStateChange=request.getOnReadyStateChange();if(typeof reqReadyStateChange=="function")reqReadyStateChange(state,request);var succeeded=false;if(state==PTC.JSBridge.Request.ReadyState.DONE){if(statusCode>=
PTC.JSBridge.RequestManager.StatusCodes.Success&&statusCode<PTC.JSBridge.RequestManager.StatusCodes.BadRequest){succeeded=true;PTC.JSBridge.log.debug("PTC.JSBridge.RequestManager.ReadyStateChange(): Success returned: status code: "+statusCode);this._FireEventSafe(PTC.JSBridge.RequestManager.Events.RequestSucceeded,id,request);var onSuccessHandler=request.getOnSuccess();if(typeof onSuccessHandler==="function"){var logger=PTC.JSBridge.log;if(logger.isDebugEnabled())logger.debug("PTC.JSBridge.RequestManager.ReadyStateChange(): onSuccess is being raised with response:"+
PTC.JSBridge.Util.JSON.stringify(response));onSuccessHandler(response,request.getContext())}}else{PTC.JSBridge.log.error("PTC.JSBridge.Request.Manager.setReadyState(): Failure is returned: status code: "+statusCode+", status text:"+statusText);this._FireEventSafe(PTC.JSBridge.RequestManager.Events.RequestFailed,id,request);var onFailureHandler=request.getOnFailure();if(typeof onFailureHandler==="function")onFailureHandler(statusCode,statusText,request.getContext())}this._FireEventSafe(PTC.JSBridge.RequestManager.Events.RequestProcessed,
succeeded,id,request)}}};Ext.extend(PTC.JSBridge.RequestManager,Ext.util.Observable,PTC.JSBridge._overrides);PTC.JSBridge.RequestManager.setInstance=function(instance){if(!(instance instanceof PTC.JSBridge.RequestManager))throw"Must be an instance of type PTC.JSBridge.RequestManager";PTC.JSBridge.RequestManager._instance=instance};PTC.JSBridge.RequestManager.getInstance=function(){return PTC.JSBridge.RequestManager._instance};PTC.JSBridge.RequestManager.setInstance(new PTC.JSBridge.RequestManager);
PTC.JSBridge.Request=function(command,params,configOptions){this._readyState=PTC.JSBridge.Request.ReadyState.UNINITIALIZED;this._command=command;this._params=params;this._response=null;this._completed=false;this.setManager(PTC.JSBridge.RequestManager.getInstance());this.setAsynchronous(true);if(configOptions!==undefined&&configOptions!==null){this._onSuccess=configOptions.onSuccess;this._onFailure=configOptions.onFailure;this._context=configOptions.context;this._onReadyStateChange=configOptions.onReadyStateChange;
if(configOptions.manager!==undefined)this.setManager(configOptions.manager);var async=configOptions.asynchronous;if(async!==undefined)this.setAsynchronous(async)}this.Invoke()};PTC.JSBridge.Request.ReadyState={UNINITIALIZED:0,OPENED:1,HEADERS_RECEIVED:2,INTERACTIVE_LOADING:3,DONE:4};
PTC.JSBridge.Request.prototype={constructor:PTC.JSBridge.Request,getManager:function(){return this._reqManager},setManager:function(manager){if(!(manager instanceof PTC.JSBridge.RequestManager))throw"manager MUST be an instance of PTC.JSBridge.RequestManager";this._reqManager=manager},setReadyState:function(readyState){PTC.JSBridge.log.debug('PTC.JSBridge.Request.setReadyState(): Ready State:"'+PTC.JSBridge.Util.EnumIntToTextValue(readyState,PTC.JSBridge.Request.ReadyState)+"("+readyState+')"');this._readyState=
readyState},getReadyState:function(){return this._readyState},Invoke:function(){this.setResponse(null);this.setCompleted(false);this.getManager().InvokeRequest(this)},getCommand:function(){return this._command},getParams:function(){return this._params},isAsynchronous:function(){return this._asynchronous},setAsynchronous:function(value){this._asynchronous=!!value},getOnSuccess:function(){return this._onSuccess},getOnFailure:function(){return this._onFailure},getContext:function(){return this._context},
getOnReadyStateChange:function(){return this._onReadyStateChange},getStatusCode:function(){return this._statusCode},setStatusCode:function(statusCode){this._statusCode=statusCode},getStatusText:function(){return this._statusText},setStatusText:function(statusText){this._statusText=statusText},getResponse:function(){return this._response},setResponse:function(response){this._response=response},getCompleted:function(){return this._completed},setCompleted:function(completed){this._completed=completed}};
PTC.JSBridge.Request.Run=function(command,params,configOptions){return new PTC.JSBridge.Request(command,params,configOptions)};Ext.namespace("PTC");Ext.BLANK_IMAGE_URL=getBaseHref()+"netmarkets/images/sp.gif";if(Ext.isIE8||Ext.isIE7)Ext.SSL_SECURE_URL=Ext.BLANK_IMAGE_URL;Ext.useShims=true;Ext.Tip.prototype.maxWidth=420;PTC=PTC;PTC.action={};PTC.jca={};PTC.jca.table={};PTC.jca.table.scroll={};PTC.wizard={};PTC.util={};PTC.jca.state={};PTC.validation={};PTC.pineapple={};PTC.driverAttributes={};
isIE=Prototype.Browser.IE;Ext.apply(PTC,new Ext.util.Observable);PTC.addEvents("ready");PTC.onReady=function(fn,scope,options){if(PTC.isReady()){fn();fn=null}else PTC.on("ready",fn,scope,options)};PTC.isOldGecko=function(){return Ext.isGecko&&Ext.isGecko2&&!Ext.isGecko3};PTC.onAvailable=function(id,fn,scope){return Ext.ComponentMgr.onAvailable(id,fn,scope)};PTC.registerType=function(xtype,cls){return Ext.ComponentMgr.registerType(xtype,cls)};
PTC.create=function(config,defaultType){return Ext.ComponentMgr.create(config,defaultType)};Ext.copyTo(PTC,Ext,"decode,Panel,extend,getCmp,apply,applyIf");PTC.isReady=function(){return PTC.extReady===true&&PTC.wizard.isReady===true};PTC.checkAndFireReady=function(){if(PTC.isReady())PTC.fireEvent("ready")};Ext.onReady(function(){PTC.extReady=true;PTC.checkAndFireReady()});PTC.isWindowLoaded=function(){if(PTC.windowLoaded)return true;return false};
PTC.onWindowLoad=function(fn){if(PTC.windowLoaded)fn();else Ext.EventManager.on(window,"load",fn)};Ext.EventManager.on(window,"load",function(){PTC.windowLoaded=true});FALSE_FUNC=function(){return false};TRUE_FUNC=function(){return true};Ext._EMPTY_RECORD={get:function(){return""},IS_EMPTY:true};Ext._EMPTY_RECORD.data=Ext._EMPTY_RECORD;PTC.log={};PTC.log=log4javascript.getLogger("PTC");PTC.log.setLevel(log4javascript.Level.ERROR);log4javascript.logLog.setQuietMode(true);
var ajaxAppender=new log4javascript.AjaxAppender(getBaseHref()+"ptc1/log4javascript");ajaxAppender.setBatchSize(5);ajaxAppender.setTimerInterval(8E3);ajaxAppender.setTimed(true);ajaxAppender.setLayout(new log4javascript.JsonLayout);PTC.log.addAppender(ajaxAppender);PTC.log.ajaxAppender=ajaxAppender;var appender=new log4javascript.BrowserConsoleAppender;appender.setThreshold(log4javascript.Level.ALL);PTC.log.addAppender(appender);
PTC.log.enablePopupAppender=function(){if(typeof isWfTrlReplay==="function"&&isWfTrlReplay())return;if(Ext.isIE&&PTC.getMainWindow().PTC&&PTC.getMainWindow().PTC.debug&&PTC.getMainWindow().PTC.debug.isJsDebug())PTC.log.addAppender(new log4javascript.PopUpAppender)};log4javascript.Level.prototype.ALL_LEVELS=[log4javascript.Level.ALL,log4javascript.Level.TRACE,log4javascript.Level.DEBUG,log4javascript.Level.INFO,log4javascript.Level.WARN,log4javascript.Level.ERROR,log4javascript.Level.FATAL,log4javascript.Level.OFF];
log4javascript.Level.getLevel=function(name){var logLevel=log4javascript.Level.TRACE;log4javascript.Level.prototype.ALL_LEVELS.each(function(item){if(item.name===name)logLevel=item});return logLevel};PTC.log._getLoggerFromInputStr=function(str){if(str.indexOf("=")>=0)str=str.substring(0,str.indexOf("="));var logger=log4javascript.getLogger(str);return logger};
PTC.log._getLevelFromInputStr=function(str){var level=log4javascript.Level.TRACE;if(str.indexOf("=")>=0)level=log4javascript.Level.getLevel(str.substring(str.indexOf("=")+1));return level};PTC.log.startLogger=function(inputStr){if(inputStr===null||inputStr==="")inputStr="PTC";var logger=PTC.log._getLoggerFromInputStr(inputStr);var level=PTC.log._getLevelFromInputStr(inputStr);logger.setLevel(level)};
PTC.log.sendAllMessages=function(){if(PTC.log!==undefined&&typeof PTC.log.ajaxAppender.sendAllRemaining!=="undefined")PTC.log.ajaxAppender.sendAllRemaining()};
PTC.log.enableLogging=function(url){var jsLogParam=extractParamValue(url,"jsLog");if(jsLogParam==="")return true;else{jsLogParam=decodeURIComponent(jsLogParam);if(jsLogParam.indexOf("PTC")>=0)jsLogParam.split(/,/).each(function(loggerName){if(loggerName.indexOf("PTC")!==0){var origLevel=PTC.log.getLevel();PTC.log.setLevel(log4javascript.Level.WARN);PTC.log.warn("logger name ",loggerName," does not begin with root namespace 'PTC'? logging not enabled for it.");PTC.log.setLevel(origLevel)}var logger=
log4javascript.getLogger(loggerName);logger.setLevel(log4javascript.Level.TRACE);logger.info("turned on logger ",loggerName)});else{var logger=log4javascript.getLogger("PTC");logger.setLevel(log4javascript.Level.TRACE);PTC.log.info("logger name(s) does not start with root namespace PTC?");PTC.log.info("turned on the PTC logger in that case")}}return true};
PTC.log._enableLogging=function(){PTC.log.enableLogging(getWindow().location.href);if("navigation"in PTC)PTC.navigation.on("historyChange",PTC.log.enableLogging);else PTC.onReady(function(){PTC.navigation.on("historyChange",PTC.log.enableLogging)})};if("log4javascript"in window)PTC.log._enableLogging();else PTC.onReady(PTC.log._enableLogging);PTC.jslint={};PTC.jslint.SCRIPT_URL_STRING="javascript:";PTC.jslint.allowNamespaceRegEx=/^(?:([\[\{])(?:@)?([\w-]+(?:\:[\w-]+))\s?(?:(=|.=)\s?['"]?(.*?)["']?)?[\]\}])/;
PTC.jslint.betterWrittenInDotNotation=function(obj,key){return obj[key]};PTC.jslint.doNotUseStringFunctionAsConstructor=function(str){return new String(str)};PTC.jslint.foundEvalReservedWord=function(str,context){if(context)return context.eval(str);else return eval(str)};MAINFORM_STARTING_DOM_ELEMENT=undefined;PTC.util.log=log4javascript.getLogger("PTC.util");PTC.mainform=log4javascript.getLogger("PTC.mainform");Ext.apply(PTC.util,new Ext.util.Observable);PTC.util.addEvents("checkplugins");
PAGE_LOADED=false;Event.observe(window,"load",function(){PAGE_LOADED=true});function executeFunctionOnload(func){if(PAGE_LOADED)func.call();else Event.observe(window,"load",func)}URL_utils={};URL_utils.removeAnchor=function(url){if(url){url=url.replace(/#[^#&?]*/g,"");url=url.replace(/\?/,"KEEP_ONLY_THE_FIRST_QUESTION_MARK");url=url.replace(/\?/g,"&");url=url.replace(/KEEP_ONLY_THE_FIRST_QUESTION_MARK/,"?")}return url};
URL_utils.getParams=function(url){if(!url||url.indexOf("?")<0)return"";url=URL_utils.removeAnchor(url);url=url.substring(url.indexOf("?")+1);return"&"+url};function isDefined(toCheck){return toCheck!==undefined}function P(){this.n="";this.v=""}
function buildStringParam(params){var windowUrl="";if(params)if(params.length>0){var alength=params.length;for(var i=0;i<alength;i++){var param=params[i];if(param&&param.n&&param.v){windowUrl+=param.v;if(i<alength-1)windowUrl=windowUrl+"___"}}}return windowUrl}combineURL=Ext.urlAppend;function hasParentById(divNode,id){if(!divNode)return false;while(divNode.parentNode&&divNode.parentNode!=document){if(divNode.parentNode.id==id)return true;divNode=divNode.parentNode}return false}
function getParentNodeByTag(anode,tag){var count=0;while(anode&&anode.tagName!==tag&&anode.parentNode&&anode.tagName!=="FORM"){anode=anode.parentNode;count++;if(count>100)return anode}return anode}
function _traveseParams(params,param,paramString){var result="";if(params[param]){var value=params[param];if(value&&typeof value==="string")result=value;else if(value&&typeof value==="object"&&typeof value.length!="undefined")result=value[0];else if(paramString.indexOf("&"+param+"&")>=0)return"1"}result=result.replace(/\+/g," ");result=encodeURIComponent(result);return result}
function extractParamValue(aUrl,param){var url=aUrl;var paramString;if(!url||typeof url!=="string"||url.indexOf("?")<0&&url.indexOf("&")<0)return"";paramString=url;if(paramString.indexOf("?")>=0)paramString="&"+paramString.substring(paramString.indexOf("?")+1)+"&";var params=paramString.toQueryParams();var result=_traveseParams(params,param,paramString);if(result===""){var after=url.split("#")[1];if(after){var paramString2="&"+after.substring(after.indexOf("?")+1)+"&";var params2=paramString2.toQueryParams();
result=_traveseParams(params2,param,paramString)}}return result}function transferParam(url1,url2,param){var value=extractParamValue(url1,param);if(value&&typeof value==="string"){var tmpValue=value;value=[];value.push(tmpValue)}if(value&&typeof value==="object"&&typeof value.length!=="undefined")for(var k=0,l=value.length;k<l;k++){var tmpParam=param;if(url2.indexOf("?")>0)tmpParam="&"+tmpParam;else tmpParam="?"+tmpParam;url2=url2+tmpParam+"="+value[k]}return url2}
function getBaseHref(){var href="";if($("basehref"))href=$("basehref").href;else{var baseTags=document.getElementsByTagName("BASE");if(baseTags&&baseTags.length>0)href=baseTags[0].href}window.getBaseHref=function(){return href};return href}function replaceAll(s,findString,replaceString){var st=s;if(findString.length===0)return st;var idx=st.indexOf(findString);while(idx>=0){st=st.substring(0,idx)+replaceString+st.substr(idx+findString.length);idx=st.indexOf(findString)}return st}
function refreshTreeForAssociation(oldPartOid,newPartOid){var cform=window.document.forms.RefreshForAssociation;if(cform){cform.oldOid.value=oldPartOid;cform.newOid.value=newPartOid;cform.tableSelectionAction.value="RefreshForAssociation";cform.submit()}else document.location=document.location}
function newHiddenInputElement(name,value,form){var parentDoc=document;if(form&&form.ownerDocument)parentDoc=form.ownerDocument;var hiddenInput=parentDoc.createElement("INPUT");hiddenInput.id=name;hiddenInput.name=name;hiddenInput.type="hidden";hiddenInput.value=value;return hiddenInput}var JCAnewHiddenInputElement=newHiddenInputElement;
function appendFormHiddenInput(form,name,value){function getNonNullValue(value){return value!==null&&value!=="null"&&value!==undefined&&value!=="undefined"?value:""}if(form){if(name===null||name==="null")return;var targetel=form[name];if(targetel&&(targetel.tagName||targetel.tagName==="")&&targetel.tagName==="INPUT"){targetel.setAttribute("name",name);targetel.setAttribute("value",getNonNullValue(value));return targetel}else{var hiddenInput=JCAnewHiddenInputElement(name,getNonNullValue(value),form);
form.appendChild(hiddenInput);return hiddenInput}}else throw new Error("Implementation ERROR: invalid form");}var JCAappendFormHiddenInput=appendFormHiddenInput;function extractString(fromString,start_mark,end_mark){var result="";var index1=fromString.indexOf(start_mark);var index2=fromString.indexOf(end_mark);if(index1>=0&&index2>0)result=fromString.substring(index1+start_mark.length,index2);return result}
function getElementByName(name){var elem=null;var elements=document.getElementsByName(name);if(elements&&elements.length>0)elem=elements[0];return elem}function setSelected(element,selectedVal){var element_options_length=element.options.length;for(var i=0;i<element_options_length;i++)if(element.options[i].value==selectedVal){element.options[i].selected=true;PTC.event.fireEvent(element,"change")}else element.options[i].selected=false}
function setSelectedRadio(name,selectedVal){var radioButtons=document.getElementsByName(name);var radioButtons_length=radioButtons.length;for(var i=0;i<radioButtons_length;i++)if(radioButtons[i].value==selectedVal){radioButtons[i].checked=true;PTC.event.fireEvent(radioButtons[i],"click")}else radioButtons[i].checked=false}
function setDefaultValue(name,val){if(name||name==="")if(name.indexOf("___radio")!=-1)setSelectedRadio(name,val);else{var component=getElementByName(name);if(component||component==="")if(name.indexOf("___combobox")!=-1)setSelected(component,val);else{component.value=val;PTC.event.fireEvent(component,"change")}}}
function getWindow(){try{if(PTC.lightbox&&PTC.lightbox.isLightbox(window)){getWindow=function(){return window};return window}var href=window.top.location.href;if(typeof window.top.PTC!=="undefined"&&typeof window.top.PTC.navigation!=="undefined")return window.top;else return window}catch(e){getWindow=function(){return this.window};return this.window}}
function jcaSetPosition(winFeatures){var isLeftSpecified=winFeatures.indexOf("left");var isTopSpecified=winFeatures.indexOf("top");var heightIndex=winFeatures.indexOf("height");var widthIndex=winFeatures.indexOf("width");var width=0,height=0,xpos,ypos,hindex,pos,topPos;var popW=0,popH=0,offset=10;if(heightIndex!=-1){pos=winFeatures.indexOf(",",heightIndex);if(pos===-1)pos=winFeatures.length;popH=winFeatures.substring(heightIndex+7,pos)}if(widthIndex!=-1){pos=winFeatures.indexOf(",",widthIndex);if(pos===
-1)pos=winFeatures.length;popW=winFeatures.substring(widthIndex+6,pos)}if(isLeftSpecified==-1){if(is_ie){width=getWindow().screen.width;if(getWindow().document.body&&getWindow().document.body.clientWidth<width)width=getWindow().document.body.clientWidth;xpos=getWindow().screenLeft}else{width=getWindow().outerWidth;xpos=getWindow().screenX}var leftPos=(width-popW)/2+xpos;if(leftPos<0||leftPos>width)leftPos=0;winFeatures=winFeatures+",left="+leftPos}if(isTopSpecified==-1){if(is_ie){height=getWindow().screen.height;
if(getWindow().document.body&&getWindow().document.body.clientHeight<height)height=getWindow().document.body.clientHeight;ypos=getWindow().screenTop}else{height=getWindow().outerHeight;ypos=getWindow().screenY}if(popH<height/2)topPos=height/2-offset-popH+ypos;else topPos=offset+ypos;if(topPos<0||topPos>height)topPos=0;winFeatures=winFeatures+",top="+topPos}return winFeatures}
function JCAConfirm(evt,rbinfokey,inserts){if(!rbinfokey){rbinfokey=evt;if(window.event)evt=window.event}var alertmess=getBundleStringAndInserts(rbinfokey,inserts);var retVal=wfconfirm_gen(alertmess);if(!retVal&&evt){evt=evt?evt:window.event;evt.returnValue=false;if(evt.preventDefault)evt.preventDefault()}return retVal}
function JCAAlert(rbinfokey,message,inserts){if(message)message=" "+message;else message="";var alertmess="";if(rbinfokey!==undefined&&rbinfokey.indexOf(".")>0&&rbinfokey.lastIndexOf(".")!=rbinfokey.length-1)alertmess=getBundleStringAndInserts(rbinfokey,inserts);else alertmess=rbinfokey;return wfalert_gen(alertmess+message)}function getBundleString(key){return bundleHandler.get(key)}
bundleHandler=function(){var cache={};function lookup(key,intParams,paramString){var url=getBaseHref()+"netmarkets/jsp/util/getBundleKey.jsp?key="+encodeURIComponent(key);if(intParams!==undefined)url=url+"&intParams="+encodeURIComponent(intParams);if(paramString!==undefined)url=url+"&params="+encodeURIComponent(paramString);var options={method:"get",asynchronous:false,parameters:paramString};var transport=requestHandler.doRequest(url,options);if(transport&&transport.readyState==4)return transport.responseText;
else{var errorMsg=PTC.jslint.betterWrittenInDotNotation(cache,"com.ptc.core.ui.navigationRB.UNABLE_TO_CONNECT");if(errorMsg===undefined)errorMsg="Unable to connect to server.";return errorMsg}}return{get:function(key,intParams,disableCache,paramString){this._initializeCache();var result;try{if(!disableCache)result=cache[key];else if(cache[key])cache[key]=null;if(!result){result=lookup(key,intParams,paramString);var hasFormBasedAuth=PTC.navigation.responseHasFormBasedAuth(result);if(hasFormBasedAuth){result=
PTC.jslint.betterWrittenInDotNotation(cache,"com.ptc.core.ui.navigationRB.UNABLE_TO_CONNECT");if(result===undefined)result="Unable to connect to server."}if(!disableCache&&!hasFormBasedAuth)cache[key]=result}}catch(e){}return result},set:function(key,value){cache[key]=value},_initializeCache:function(){PTC.attributeHelper._initializeCache();bundleHandler._initializeCache=Ext.emptyFn},_getCache:function(){return cache},_setCache:function(newCache){cache=newCache}}}();
bundleHandler.getBundleStringAndInserts=function(key,inserts){var alertmess=bundleHandler.get(key);if(inserts&&inserts.length>0){var inserts_length=inserts.length;for(var i=0;i<inserts_length;i++)alertmess=alertmess.replace("{"+i+"}",inserts[i])}alertmess=alertmess.gsub("&quot;",'"');return alertmess};getBundleStringAndInserts=bundleHandler.getBundleStringAndInserts;
bundleHandler.getUniqueName=function(key,namesArray){var result=null;if(namesArray){var index=0;var tempName;var arrayString=namesArray.toString().toLowerCase();while(index<999&&result===null){index++;tempName=getBundleStringAndInserts(key,[""+index]);if(arrayString.indexOf(tempName.toLowerCase())<0)result=tempName}}return result};
function getMainForm(domElement){PTC.mainform.debug("begin getMainForm() MAINFORM_STARTING_DOM_ELEMENT ID: ",MAINFORM_STARTING_DOM_ELEMENT?MAINFORM_STARTING_DOM_ELEMENT.id:null," domElement id: ",domElement?domElement.id:null);if(!document.body){PTC.mainform.error("getMainForm() called before DOM was loaded, code should be wrapped in PTC.onReady() ");return undefined}var startingElement=domElement?domElement:MAINFORM_STARTING_DOM_ELEMENT;var mform;if(startingElement)mform=PTC.util.getForm(startingElement);
if(mform===undefined)mform=getWindow().document.forms.mainform;if(mform===undefined)mform=window.document.forms.mainform;if(mform&&mform[0]!==undefined&&mform[0].action!==undefined)mform=mform[0];if(!PTC.nonce&&"csrf_nonce"in window)PTC.nonce=csrf_nonce;if(mform===undefined){mform=$("mainformDummy");if(!mform){mform=window.document.createElement("FORM");mform.setAttribute("name","mainformDummy");mform.setAttribute("id","mainformDummy");mform.setAttribute("method","POST");var parent=$(PTC.navigation.activeContentID)?
$(PTC.navigation.activeContentID):document.body;parent.appendChild(mform);JCAappendFormHiddenInput(mform,"CSRF_NONCE",PTC.nonce)}}var formAction=PTC.util.getFormAction(mform);if(!formAction)PTC.util.setFormAction(mform,getWindow().location.href);if(!mform.CSRF_NONCE||!mform.CSRF_NONCE.value)if(!mform.CSRF_NONCE||!(mform.CSRF_NONCE[0]&&mform.CSRF_NONCE[0].value))JCAappendFormHiddenInput(mform,"CSRF_NONCE",PTC.nonce);PTC.mainform.debug("end getMainForm() returning form: ",mform?mform.name:null);return mform}
function setNewFolder(url){var mform=getMainForm();if(mform===undefined)setNewFolder.defer(20,null,[url]);else if(url.indexOf(getBaseHref())>-1)PTC.util.setFormAction(mform,url+"&twoPane=true")}function containsClass(node,cssclass){if(!node||!node.className)return false;return node.className.match(new RegExp("(^|\\s)"+cssclass+"(\\s|$)"))!==null}
function showFullText(displayText,encoded){if(encoded)displayText=unescape(displayText);displayText=displayText.replace(/href\s*=\s*\"(.*?)\"/g,"target='_parent' onclick='opener.location=\""+getBaseHref()+"$1\";window.close();' href='#'");var htmlString=""+"<html>"+"<head>"+"<title>"+"&nbsp"+"</title>"+"</head>"+"<body>"+'<div align="left">'+'<table width="90%">'+"<tr>"+"<td id='moreLinkDisplayText'>"+displayText+"</td>"+"</tr>"+"</table>"+"</div>"+"</body>"+"</html>";var newWindow=window.open("",
"popupwindow","width=400,height=200,scrollbars=yes");var moreLinkDisplayTextTableCell=newWindow.document.getElementById("moreLinkDisplayText");if(moreLinkDisplayTextTableCell)moreLinkDisplayTextTableCell.innerHTML=displayText;else newWindow.document.write(htmlString)}
function arrayHasClassName(children,className){var elements=[];var regEx=new RegExp("(^|\\s)"+className+"(\\s|$)");for(var i=0,l=children.length;i<l;i++){var child=children[i];if(child.className.match(regEx))elements.push(child)}return elements}function getElementsByClassNameAndTag(className,parentElement,tagname){if(!parentElement||typeof parentElement.getElementsByTagName==="undefined")parentElement=document.body;return arrayHasClassName(parentElement.getElementsByTagName(tagname),className)}
PTC.util.getForm=function(element){var el=Ext.get(element);if(!PTC.isDefined(el))return undefined;else el=el.dom;if(PTC.isDefined(el.tagName)&&el.tagName.toUpperCase()==="FORM")return el;if(PTC.isDefined(el.form))return el.form;var found=false;var a_form;while(PTC.isDefined(el)&&PTC.isDefined(el.parentNode)&&!found){if(PTC.isDefined(el.parentNode.tagName)&&el.parentNode.tagName.toUpperCase()==="FORM"){a_form=el.parentNode;el.form=a_form;found=true}el=el.parentNode}return a_form};
PTC.util._setMainFormStartingElementFromParent=function(parentId){PTC.mainform.debug("setMainFormStartingElementFromParent parentId: ",parentId);var mainform=Ext.DomQuery.selectNode("#"+parentId+" #mainform");if(mainform)PTC.util._setMainFormStartingElement(mainform);return mainform};PTC.util._setMainFormStartingElement=function(childId){PTC.mainform.debug("setMainFormStartingElement childId: ",childId?childId.id:null);MAINFORM_STARTING_DOM_ELEMENT=childId};
function getSerializedMainForm(){var form=getMainForm();return Ext.lib.Ajax.serializeForm(form)}function getPreviousSibling(node){var preS=node.previousSibling;if(preS)while(preS.previousSibling&&preS.nodeType!=1)preS=preS.previousSibling;return preS}function getNextSibling(node){var nextS=node.nextSibling;if(nextS&&nextS!=="null")while(nextS.nodeType!=1&&nextS.nextSibling)nextS=nextS.nextSibling;return nextS}
PTC.util.cleanAndEval=function(str){if(PTC.util.isJSUrl(str))str=str.substring(str.indexOf(PTC.jslint.SCRIPT_URL_STRING));if(str.indexOf("%20")>=0)str=replaceAll(str,"%20","");eval(str)};var cleanAndEval=PTC.util.cleanAndEval;
PTC.util._evalHTML=function(html){try{var div=document.createElement("div");div.innerHTML="_"+html;var children=div.children;for(var i=0,l=children.length;i<l;i++){var child=children[i];if(child&&child.tagName==="SCRIPT")eval(child.innerHTML)}}catch(e){PTC.util.log.error("Error in _evalHTML ",e)}};PTC.util.isJSUrl=function(url){if(!url||!Ext.isString(url))return false;return url.toLowerCase().indexOf(PTC.jslint.SCRIPT_URL_STRING)>=0};
function pausecomp(millis){var date=new Date;date=parseInt(date.getTime(),10);var curDate=null;do{curDate=new Date;curDate=parseInt(curDate.getTime(),10)}while(parseInt(curDate-date,10)<parseInt(millis,10))}function forceWindowLocation(){var forceWindowHref=window.location.href;window.location.href=forceWindowHref}function isArray(obj){return Ext.isArray(obj)}
function JCAClone(obj){if(obj===null||typeof obj!=="object")return obj;var temp;if(typeof obj.constructor==="function")temp=new obj.constructor;else if(isArray(obj))temp=[];else temp={};for(var property in obj)if(obj.hasOwnProperty(property))temp[property]=JCAClone(obj[property]);return temp}PTC.util.addFuncWrapper=function(obj,func){for(var key in obj)if(typeof obj[key]==="function")func(obj,key)};
PTC.util.addTimeWrapper=function(obj,key){obj[key]=obj[key].wrap(function(proceed){var start=(new Date).getTime();try{return proceed.apply(this,$A(arguments).slice(1))}finally{var end=(new Date).getTime();jsca.log(key,"took",end-start,"ms")}})};PTC.util.addLoggingWrapper=function(obj,key){obj[key]=obj[key].wrap(function(proceed){jsca.log("starting function ",key);try{return proceed.apply(this,$A(arguments).slice(1))}finally{jsca.log("end funciton ",key)}})};
PTC.util.addFormParam=function(name,params){var mform=getMainForm();if(mform===undefined||params===undefined)return;var names=mform[name];if(names===undefined||params[name]!==undefined)return;if(names.length>0)names=names[0];if(names.value!==undefined&&names.value!=="")params[name]=names.value};
PTC.util.delayAllCalls=function(func,delay){if(delay===undefined)delay=100;func=func.wrap(function(proceed,a,b,c,d,e,f,g){if(func.task===undefined)func.task=new Ext.util.DelayedTask(proceed);if(arguments.length>7)func.task.delay(delay,proceed,this,$A(arguments).slice(1));else func.task.delay(delay,proceed,this,[a,b,c,d,e,f,g])});return func};
PTC.util.replaceURLNoReload=function(newUrl){if(Ext.History.getToken()!==PTC.navigation.getTokenFromUrl(newUrl)){PTC.navigation.on("historyChange",FALSE_FUNC,PTC.navigation,{single:true});window.location.replace(newUrl);return true}return false};PTC.util.replaceURL=function(newUrl,suppressHistoryChange){if(typeof suppressHistoryChange==="undefined"||suppressHistoryChange===true)PTC.util.replaceURLNoReload(newUrl);else window.location.replace(newUrl)};
PTC.util.removeURLParamsFromThisWindow=function(params){var newUrl=PTC.util.removeURLParams(window.location.href,params);PTC.util.replaceURL(newUrl);return newUrl};PTC.util.removeURLParams=function(url,params){for(var i=0;i<params.length;i++){var regex=new RegExp("([&?])"+params[i]+"=[^&#?]*(&?)");var groups=url.match(regex);if(groups!==null)if(groups[1]==="?"&&groups[2]!=="")url=url.replace(groups[0].substr(1),"");else url=url.replace(regex,groups[2])}return url};
PTC.util.replaceURLParam=function(url,paramToReplace,newVal){var regex=new RegExp("([&?]"+paramToReplace+"=)[^&#?]*");var groups=url.match(regex);if(groups!==null){var newParam=groups[1]+newVal;url=url.replace(regex,newParam)}return url};PTC.util.replaceURLParamInThisWindow=function(paramToReplace,newVal,suppressHistoryChange){var newUrl=PTC.util.replaceURLParam(window.location.href,paramToReplace,newVal);PTC.util.replaceURL(newUrl,suppressHistoryChange);return newUrl};
PTC.util.extractAllParams=function(url){if(!url||url.indexOf("?")<0&&url.indexOf("&")<0)return{};var params=url.substr(url.indexOf("?")+1);return Ext.urlDecode(params)};PTC.util.getUniqueId=function(){var d=new Date;var uniqueNumber=Date.UTC(d.getYear(),d.getMonth(),d.getDay(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds())*-1;return uniqueNumber+"_"+PTC.util.getUniqueId.counter++};PTC.util.getUniqueId.counter=0;
PTC.util.unescapeHTML=function(html){var htmlNode=document.createElement("DIV");if(html.indexOf("<")!==0)html="<span>"+html+"</span>";htmlNode.innerHTML=html;return PTC.util.getTextContent(htmlNode)};
PTC.util.getTextContent=function(element){if(!element||!("nodeType"in element))return"";var text="";if(element.nodeType==3){text=element.data;text=text.replace(/\n|\r|\t|\xA0/g," ");return text}if(element.nodeType===1&&element.nodeName!=="SCRIPT")if(element.type==="text"||element.type==="textarea")text=element.value;else if(element.type==="select-one")text=PTC.util.getTextContent(element.options[element.selectedIndex]);else if(element.type==="select-multiple")for(var j=0;j<element.options.length;j++){var option=
element.options[j];if(option.selected)text+=PTC.util.getTextContent(option)}else if(element.tagName==="BR")text="\n";else for(var i=0;i<element.childNodes.length;i++){var child=element.childNodes[i];text+=PTC.util.getTextContent(child)}return text};
PTC.util.convertStringToFunc=function(funcString){var originalFuncString=funcString;if(typeof funcString==="function")return funcString;var scope=window;while(funcString.indexOf(".")>0){var index=funcString.indexOf(".");var scopeString=funcString.substring(0,index);funcString=funcString.substring(index+1);scope=scope[scopeString]}if(typeof scope[funcString]==="function")scope[funcString]._originalFuncString_=originalFuncString;return scope[funcString]};
PTC.util.isCharInputKey=function(e){if(!e||!e.keyCode)return true;if(13===e.keyCode){var target=e.target?e.target:e.srcElement;if(target&&target.type&&"textarea"==target.type)return true;else return false}if(8===e.keyCode||9===e.keyCode||16===e.keyCode||17===e.keyCode||18===e.keyCode||35===e.keyCode||36===e.keyCode||37===e.keyCode||38===e.keyCode||39===e.keyCode||40===e.keyCode||46===e.keyCode)return false;return true};
PTC.util.eventTargetHasSelection=function(e){var target=e.target?e.target:e.srcElement;if(target)if(typeof target.selectionStart=="number"){var selection=target.selectionEnd-target.selectionStart;if(selection>0)return true}else if(document.selection){var textRange=document.selection.createRange();var rangeParent=textRange.parentElement();if(rangeParent===target&&textRange.text.length>0)return true}return false};PTC.util.isLeftClick=function(evt){if(!evt)return false;return evt.button===0};
PTC.util.isRightClick=function(evt){if(!evt)return false;return evt.button===2||PTC.navigation.mouseUpButtonClick===2};PTC.util.downloadUrl=function(url){if(url!==null&&url.indexOf("/")===0&&url.length>1)url=getBaseHref()+url.substring(1,url.length);Ext.onReady(PTC.util._createDownloadIframe,{url:url},{single:true});return url};PTC.util._createDownloadIframe=function(){var iframe=document.createElement("iframe");iframe.src=this.url;iframe.style.display="none";document.body.appendChild(iframe)};
PTC.util.getDom=function(obj){if(obj&&typeof obj.getEl==="function")obj=obj.getEl().dom;if(obj&&obj.dom)obj=obj.dom;return obj};PTC.jca.deleteAllCmpsWithCls=function(dom,selector){if(!dom||!selector)return;var divs=Ext.DomQuery.select(selector,dom);for(var i=divs.length;--i>=0;){var panel=Ext.getCmp(divs[i].id);if(panel){panel.removeAll(true);panel.destroy()}}};
PTC.util.getByteLength=function(str){var totalLength=0;if(str!==null&&str!==undefined){str=str.toString();str=str.replace(/\n/g,"\n\r");for(var i=str.length;i--;){var c=str.charCodeAt(i);if(c>=1&&c<=127)totalLength++;else if(c>2047)totalLength+=3;else totalLength+=2}}return totalLength};
PTC.util.getGlobalQuickTipText=function(){if(Ext.QuickTips.isEnabled()){var pNode=document.getElementById(Ext.QuickTips.getQuickTip().id);var divs=pNode.getElementsByTagName("div");for(var x=0;x<divs.length;x++)if(divs[x].className==="x-tip-body")return divs[x].innerHTML}return""};PTC.util.getWeeklyCacheBuster=function(date){if(PTC.debug.isJsDebug())return new Date;if(date.getPreviousSunday)return date.getPreviousSunday();return date};
PTC.util.purge=function(d,onlyChildren){if(Ext.isIE8){var a=d.attributes,i,l,n;if(a&&onlyChildren!==true){l=a.length;for(i=0;i<l;i+=1)if(a[i]){n=a[i].name;if(typeof d[n]==="function"){if(n.toLowerCase()==="onunload"){PTC.util.log.debug("PTC.util.purge - Not purging onunload handler so that its executed as expected");continue}d[n]=null}}}a=d.childNodes;if(a){l=a.length;for(i=0;i<l;i+=1)PTC.util.purge(d.childNodes[i])}}};
PTC.util.openWindow=function(url,windowName,params){var win;if(Ext.isIE8&&!isWf()&&!Ext.isIE64BIT){var emptyForm=document.getElementById("emptyForm");if(!emptyForm){emptyForm=window.document.createElement("FORM");emptyForm.setAttribute("id","emptyForm");emptyForm.setAttribute("method","POST");document.body.appendChild(emptyForm)}emptyForm.setAttribute("action",url);emptyForm.setAttribute("target",windowName);win=window.open("",windowName,params);emptyForm.submit()}else win=window.open(url,windowName,
params);return win};PTC.util.isEmptyObject=function(obj){if(obj!==undefined)for(var i in obj)if(obj.hasOwnProperty(i))return false;return true};PTC.util.removeChildScriptNodes=function(node){if(!node)return;var formNodes=node.childNodes;var i=formNodes.length;while(i--){var child=formNodes[i];if(child&&child.tagName&&child.tagName.toLowerCase()==="script")node.removeChild(child)}};
PTC.util.propertyIterator=function(obj,contextObj,func,params){if(!obj)return;if(!func||typeof func!=="function")throw new Error("iterator function was not provided");for(var key in obj)if(key&&typeof obj[key]!=="function")func.apply(contextObj||obj,[key,obj[key]].concat(params))};
PTC.util.getAllPTCWindows=function(){var i,contextWindow,allWindows=[];try{contextWindow=getWindow();do if(!(contextWindow.PTC===undefined||contextWindow.PTC===null)){allWindows.push(contextWindow);if(contextWindow.PTC.action.actionWindows)allWindows=allWindows.concat(contextWindow.PTC.action.actionWindows);if(PTC.lightbox.isLightbox(contextWindow))contextWindow=contextWindow.parent;else contextWindow=contextWindow.opener}else contextWindow=null;while(!(contextWindow===undefined||contextWindow===
null))}catch(e){}i=allWindows.length;var names=[];while(i--){var win=allWindows[i];if(win){var name=win.name;if(!win.PTC||names.indexOf(name)>=0)allWindows.splice(i,1);names.push(name)}}return allWindows};PTC.util.getAllPTCIframes=function(){var allIframes=[];var iframes=document.getElementsByTagName("iframe");var i=iframes.length;while(i--){var iframeEl=iframes[i];var iframeWin=iframeEl.contentWindow;if(iframeWin&&iframeWin.PTC)allIframes.push(iframeWin)}return allIframes};
PTC.util.extractAllValues=function(value){var oids=[];if(typeof value==="object"&&value[0]){var i=0;while(value[i])oids=oids.concat(value[i++])}else oids=oids.concat(value);return oids};PTC.util.oidStringMatches=function(oidHolderString,regexp){var match=false;if(Ext.isString(oidHolderString)){var oid=oidUtils.normalize(oidHolderString);if(oid&&oid.indexOf("?")>0)oid=getOidFromURL(oid);if(oid)match=!!oid.match(regexp)}return match};
PTC.util.isAContainer=function(oidString){var containerRegexp=/pdmlink\.PDMLinkProduct|admin\.Project|library\.WTLibrary|container\.OrgContainer|container\.ExchangeContainer/;return PTC.util.oidStringMatches(oidString,containerRegexp)};PTC.util.isAFolder=function(oidString){var folderRegexp=/folder\.SubFolder|folder\.Cabinet/;return PTC.util.oidStringMatches(oidString,folderRegexp)};
PTC.util.getPlugins=function(domElement,iframeLookupDomElement){var plugins=[];var domEl=iframeLookupDomElement||domElement;if(domEl){var iframes=Ext.DomQuery.select("IFRAME, FRAME",domEl);for(var i=0;i<iframes.length;i++)if(!iframes[i].style||!iframes[i].style.visibility||iframes[i].style.visibility!="hidden")plugins=plugins.concat(PTC.util.getPlugins(iframes[i].contentDocument.body));plugins=plugins.concat(Ext.DomQuery.select("APPLET, EMBED, OBJECT",domElement))}return plugins};
PTC.util._showOrHidePlugin=function(el,visible,canBeVisible,offsets,size,reEnable){var left=offsets[0];var top=offsets[1];if(!visible&&canBeVisible&&(size.width<30||reEnable))el.show();else if(visible&&!reEnable){var elOffsets=el.getOffsetsTo(document.body);var elLeft=elOffsets[0];var elTop=elOffsets[1];if(!(left===0&&top===0&&size.height===0&&size.width===0&&elLeft===left&&elTop===top))if(PTC.util.intersect({x:elLeft,y:elTop,size:el.getSize()},{x:left,y:top,size:size}))el.hide()}};
PTC.util.handlePlugins=function(comp,reEnable){var contentArea=Ext.DomQuery.select("div[id='"+PTC.navigation.contentTabID+"_contentArea']");var els=PTC.util.getPlugins(contentArea[0],document.body);var size=0;var offsets=0;if(!reEnable){size=comp.getSize();offsets=comp.getEl().getOffsetsTo(document.body)}var i=els.length;while(i--){var parentNodeName=els[i].parentNode.nodeName;var el=parentNodeName==="BODY"?Ext.get(els[i]):Ext.get(els[i].parentNode);var visible=el.isVisible(true);var canBeVisible=
parentNodeName==="BODY"?true:Ext.get(el.dom.parentNode).isVisible(true);PTC.util._showOrHidePlugin(el,visible,canBeVisible,offsets,size,reEnable)}};PTC.util.firePluginChecks=function(){PTC.util.handlePlugins(null,true);PTC.util.fireEvent("checkplugins")};PTC.util.linearOverLap=function(x1,x2,width1,width2){if(x1<=x2&&x1+width1>=x2||x1>=x2&&x1<=x2+width2)return true;return false};
PTC.util.intersect=function(box1,box2){var xoverlap=PTC.util.linearOverLap(box1.x,box2.x,box1.size.width,box2.size.width);var yoverlap=PTC.util.linearOverLap(box1.y,box2.y,box1.size.height,box2.size.height);return xoverlap&&yoverlap};PTC.util.deleteComponentWithBackgroundSrc=function(comp){if(comp){if(Ext.isIE8&&comp.el.dom)comp.el.dom.outerHTML="";Ext.destroy(comp)}};
PTC.util.getPreference=function(keyValue){var responseresult=requestHandler.doRequest(getBaseHref()+"ptc1/stateManager/",{method:"get",asynchronous:false,parameters:{key:keyValue}});var pref=responseresult.responseText;return pref};PTC.util.getCmpInAllPTCnameSpaces=function(componentid){var comp=Ext.getCmp(componentid);if(!comp)for(var i=0,l=frames.length;i<l;i++)if("Ext"in frames[i]&&"PTC"in frames[i]){comp=frames[i].Ext.getCmp(componentid);if(comp)break}return comp};
PTC.util.getFormAction=function(mform){var actionValue=null;if(mform){actionValue=mform.action?mform.action:null;if(mform.attributes)if(mform.attributes["action"]&&mform.attributes["action"].value){actionValue=mform.attributes["action"].value;if(!PTC.util.isFullyQualified(actionValue))actionValue=getBaseHref()+actionValue}}PTC.mainform.debug("getFormAction() returning action: ",actionValue);return actionValue};
PTC.util.setFormAction=function(mform,value){PTC.mainform.debug("setFormAction() setting action to: ",value);if(mform&&value&&(typeof value==="string"||value instanceof String)){var actionValue=value+"";if(!PTC.util.isFullyQualified(value))actionValue=getBaseHref()+value;if(mform.attributes&&mform.attributes["action"])mform.attributes["action"].value=actionValue;else mform.action=actionValue}};PTC.util.isFullyQualified=function(url){var r=new RegExp("^(?:[a-z]+:)?//","i");return r.test(url)};
var jsca=function(){var direction;return{compare:function(cellA,cellB){if(cellA===undefined&&cellB===undefined)return true;var comparableA=jsca.getComparable(cellA);var comparableB=jsca.getComparable(cellB);return jsca.cmp(comparableA,comparableB)},optimizedCompare:function(cellA,cellB){var result=jsca._folderCompare(cellA.isFolder,cellB.isFolder,cellA.cmp,cellB.cmp);if(direction==="DESC")result=-1*result;if(result===0)result=cellA.index<cellB.index?-1:1;return result},setDirection:function(dir){direction=
dir},versionCompare:function(cellA,cellB,rowA,rowB){var result;var isFolderA=rowA._isFolder;if(isFolderA===undefined)isFolderA=jsca.isFolderRow(rowA);var isFolderB=rowB._isFolder;if(isFolderB===undefined)isFolderB=jsca.isFolderRow(rowA);if(isFolderA===isFolderB){result=rowA.vindex-rowB.vindex;if(this.direction==="DESC")result=-1*result}else{if(isFolderA)result=-1;else result=1;if(this.direction==="DESC")result=-1*result}return result},folderCompare:function(cellA,cellB,rowA,rowB){return jsca._folderCompare(jsca.isFolderRow(rowA),
jsca.isFolderRow(rowB),jsca.getComparable(cellA),jsca.getComparable(cellB))},_folderCompare:function(isFolderA,isFolderB,comparableValueA,comparableValueB){if(isFolderA===isFolderB){var a_is_null=comparableValueA===undefined||comparableValueA===null||comparableValueA==="";var b_is_null=comparableValueB===undefined||comparableValueB===null||comparableValueB==="";if(b_is_null){if(a_is_null)return 0;return-1}if(a_is_null)return 1;if((typeof comparableValueA==="string"||comparableValueA instanceof String)&&
(typeof comparableValueB==="string"||comparableValueB instanceof String))return comparableValueA.localeCompare(comparableValueB);if(comparableValueA>comparableValueB)return 1;else if(comparableValueA<comparableValueB)return-1;return 0}var result;if(isFolderA)result=-1;else result=1;if(direction==="DESC")result=-1*result;return result},getComparable:function(data){if(data===undefined||data===null)return" ";else if(typeof data==="string"||typeof data==="number")return data;if(typeof data.getComparable===
"function")return data.getComparable();if(data.comparable!==undefined)return data.comparable;else if(data.gui&&data.gui.comparable!==undefined){data.getComparable=function(){return this.gui.comparable};return data.gui.comparable}else if(data.gui&&typeof data.gui.getComparable==="string"){var compareFunc=PTC.attributeHelper.get("Compare_"+data.gui.getComparable);if(typeof compareFunc!=="function"){compareFunc=PTC.util.convertStringToFunc(data.gui.getComparable);PTC.attributeHelper.set("Compare_"+data.gui.getComparable,
compareFunc)}return compareFunc(data)}else if(data[0]&&data[0].gui&&typeof data[0].gui.comparable!=="undefined"){data.getComparable=jsca.guiComparable;return data[0].gui.comparable}else if(data.cellValue!==undefined)return jsca.getComparable(data.cellValue);else return data.text||data},cmp:function(a,b){var a_is_null=a===null||a==="";if(b===null||b===""){if(a_is_null)return 0;return-1}if(a_is_null)return 1;if(typeof a==="string"||a instanceof String)return a.localeCompare(b);if(a>b)return 1;else if(a<
b)return-1;return 0},isFolderRow:function(row){if(row===undefined)return true;if(row._isFolder!==undefined)return row._isFolder;var oid=row.get("oid");if(jsca.isFolderOid(oid))row._isFolder=true;else row._isFolder=false;return row._isFolder},isFolderOid:function(oid){if(typeof oid==="string"&&(oid.indexOf("Folder:")>=0||oid.indexOf("Cabinet:")>=0))return true;return false},isCabinetOid:function(oid){if(typeof oid==="string"&&oid.indexOf("Cabinet")!==-1)return true;return false},guiComparable:function(){return this[0].gui.comparable},
postRenderer:function(tabledesc,column,row,cell){return cell}}}();jsca.compare.funcname="jsca.compare";jsca.postRenderer.funcname="jsca.postRenderer";jsca.i18n={ACTIONS:"Actions",VIEW_INFORMATION:"View Information"};jsca.log=function(){PTC.log.info.apply(PTC.log,arguments)};jsca.debug=function(){PTC.log.debug.apply(PTC.log,arguments)};jsca.trace=function(){PTC.log.trace.apply(PTC.log,arguments)};jsca.info=function(){PTC.log.info.apply(PTC.log,arguments)};
jsca.warn=function(){PTC.log.warn.apply(PTC.log,arguments)};jsca.error=function(){PTC.log.error.apply(PTC.log,arguments)};jsca.JCA_CHECKBOX_NAME="pjl_selPJLsa1__1";
jsca.unSelectHiddenCheckboxes=function(tableId){var selectedRowsDiv=getWindow().document.getElementById("checkboxesFor_"+tableId);if(selectedRowsDiv)Element.remove(selectedRowsDiv);var table=tableUtils.getTable(tableId);if(table&&tableUtils.isExt()&&typeof table.getSelectionModel().clearSelections==="function"){var clearAllButton=Ext.getCmp(tableId+"_clearacrosspg");if(clearAllButton&&!clearAllButton.disabled)clearAllButton.fireEvent("click",clearAllButton);else table.getSelectionModel().clearSelections()}};
jsca._unSelectAll=function(inputs,tableID){var tableId;if(tableID!==null&&tableID!==undefined)jsca.unSelectHiddenCheckboxes(tableID);else{var xTables=tableUtils.getExtTables();xTables.each(function(table){jsca.unSelectHiddenCheckboxes(table.id)})}};jsca.unSelectAll=jsca._unSelectAll;JCA_UNSELECT_ALL=unSelectAll;unSelectAll=jsca.unSelectAll;if(typeof js_renderers==="undefined"){js_renderers={td:{cell:{}}};renderTD11PixelImage="";js_renderers.ro={}}
jsca.columns=function(){var OLDSTR="___old";return{OLDSTR:OLDSTR,sizeStr:function(size){return'size="'+size+'" '},idStr:function(id){return id?'id="'+id+'" ':""},nameStr:function(name){if(!name)name="";return'name="'+name+'" '},getTrailId:function(column,row,data){var trailId="";if(data.trailId)trailId=data.trailId+"__"+column.id;var defaultHtml=data.html;if(defaultHtml&&typeof defaultHtml==="string")if(data.id)trailId=data.id+"__"+column.id;else{trailId=jsca.columns.getHtmlId(defaultHtml);if(!trailId&&
PTC.trail.isTrailEnabled()){trailId=getUnescapedText(defaultHtml);trailId=tableUtils.fixStrForTrail(trailId)}}return trailId},getHtmlId:function(html){var matchId=/id=\"(.*?)\"/;var match=html.match(matchId);if(match)return match[1]},tooltipStr:function(tooltip){if(!tooltip)tooltip="";return'ext:qtip="'+tooltip+'" '},readOnlyStr:function(readOnly){if(!readOnly)return"";else readOnly="readonly";return'readonly="'+readOnly+'" '},valueStr:function(value){if(!value)value="";return'value="'+value+'" '},
typeStr:function(type){return'type="'+type+'" '},maxlengthStr:function(maxlength){return'maxlength="'+maxlength+'" '},jsActionsStr:function(jsActions){return jsActions?jsActions:""},disabledStr:function(disabled){return disabled?"disabled ":""},getCellValue:function(column,row){var data=null;if(typeof row.get==="function")data=row.get(column.id);else data=getRowItem(row)[column.id];if(data&&data.gui)data=data.gui;return data},setCellValue:function(column,row,newData){var data=getRowItem(row)[column.id];
if(data&&data.gui){data=JCAClone(data);if(data[0]&&data[0].gui&&data[0].gui===data.gui)data[0].gui=newData;data.gui=newData;getRowItem(row)[column.id]=data}else getRowItem(row)[column.id]=newData},defaultRenderer:function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);if(typeof data==="string")data=PTC.jslint.doNotUseStringFunctionAsConstructor(data);if(data instanceof String)data.html=data.valueOf();if(data&&typeof data.html!=="undefined"){result=data.html;if(typeof result===
"string"&&result.indexOf("<script")>=0)PTC.jca.table.Utils.evalCellContent(table,result)}else result=renderTDString(table,column,row);return result},noOp:function(){}}}();function clearStickyAction(){}PTC.navigation={};PTC.navigation.log=log4javascript.getLogger("PTC.navigation");PTC.navigation.NAVIGATION_DEFAULT_HOME_PAGE="ptc1/homepage";PTC.navigation.shellLoaded=false;PTC.navigation.APP_TOKEN_REGEX=new RegExp("app/[^#]*#?/?");PTC.navigation.contentID="contentDiv";
PTC.navigation.activeContentID=PTC.navigation.contentID;PTC.navigation.setActiveContentArea=function(id){PTC.navigation.activeContentID=id};PTC.navigation.NAVIGATION_WELCOME_PAGE="ptc1/netmarkets/welcomepage";PTC.navigation.CLOSE_WELCOME_PAGE="CloseWelcomePage";PTC.navigation.goHome=function(){PTC.navigation.loadContent(PTC.navigation.NAVIGATION_DEFAULT_HOME_PAGE)};PTC.navigation.pageCount=0;PTC.navigation.MAX_IE_PAGE_COUNT=30;PTC.navigation.openRequests=[];PTC.navigation.default_isPageLoaded=function(){return isWizardWindow()};
PTC.navigation.getActiveCard=function(){var cp=Ext.getCmp(PTC.navigation.cardManager);if(cp)return cp.layout.activeItem;else return null};
PTC.navigation._isPageLoaded=function(){var found=false;PTC.navigation.log.debug("PTC.navigation._isPageLoaded checking to see if there are any pending 'loadContent' requests",PTC.navigation.openRequests);if(PTC.navigation.openRequests.length>0){var i=PTC.navigation.openRequests.length;while(i--){var item=PTC.navigation.openRequests[i];var state=null;try{state=item.readyState}catch(e){PTC.navigation.log.debug("PTC.navigation._isPageLoaded readyState may not be a property on item",item,e)}if(state!=
4){found=true;try{if(state!=1)PTC.navigation.log.debug("PTC.navigation._isPageLoaded found pending request. status: ",item.status," readyState: ",item.readyState)}catch(e2){}}else{PTC.navigation.openRequests.splice(i,1);PTC.navigation.log.debug("PTC.navigation._isPageLoaded removed request. status: ",item.status," readyState: ",item.readyState)}}}PTC.navigation.log.debug("PTC.navigation._isPageLoaded returning ",!found);return!found};PTC.navigation.isPageLoaded=PTC.navigation.default_isPageLoaded;
PTC.navigation.stopInProgressPages=function(){if(!PTC.navigation.isPageLoaded())PTC.navigation.openRequests.each(function(item){item.abort()});PTC.navigation.openRequests=[]};PTC.navigation.addOpenRequest=function(req){if(!req.jcaid)req.jcaid=PTC.navigation.addOpenRequest.counter++;PTC.navigation.openRequests.push(req)};PTC.navigation.addOpenRequest.counter=0;
PTC.navigation.onSuccessRequest=function(req,contentDivId){var id=req.transport.jcaid;var i=PTC.navigation.openRequests.length;while(i--)if(PTC.navigation.openRequests[i].jcaid===id)PTC.navigation.openRequests.splice(i,1);PTC.navigation.log.timeEnd("loadContent");PTC.log.sendAllMessages();var contentId=contentDivId?contentDivId:PTC.navigation.contentID;setTimeout(function(){PTC.util._setMainFormStartingElementFromParent(contentId)},10)};
PTC.navigation.onFail=function(req,contentId){var domElementId;if(contentId)domElementId=contentId;else domElementId=PTC.navigation.activeContentID;PTC.navigation.overwrite(Ext.getDom(domElementId),req.responseText)};navigation=PTC.navigation;PTC.navigation.mouseUpButtonClick=null;PTC.navigation.saveMouseUpButtonClickInfo=function(evt){PTC.navigation.mouseUpButtonClick=evt.button};
PTC.navigation.remapNavigationLinks=function(evt){var mouseUpEvtButton=PTC.navigation.mouseUpButtonClick;PTC.navigation.mouseUpButtonClick=null;if(mouseUpEvtButton)return true;var link=evt.getTarget("A");if(link&&PTC.navigation.isEmbeddedUrl(getParentNodeByTag(link,"A"))){evt.stopEvent();var href=getParentNodeByTag(link,"A").href;if(!(!href||href==="#"||href===getBaseHref()+"#")){getWindow().PTC.navigation.loadContent(href);if(PTC.navigator&&PTC.navigator.isExpanded())PTC.navigator.collapseNavigator()}return false}return true};
PTC.navigation.getTokenFromUrl=function(url){if(!url)return url;var baseHref=getBaseHref();var token=url.replace(baseHref,"");if(token===url&&url.toLowerCase().indexOf(baseHref.toLowerCase())===0){PTC.navigation.log.debug("URL property has a case mismatch compared to the urls actually used!",url,baseHref);var index=url.toLowerCase().indexOf(baseHref.toLowerCase());token=url.substring(index+baseHref.length)}token=token.strip().replace(PTC.navigation.APP_TOKEN_REGEX,"");token=token.split("#")[0];return token};
PTC.navigation.getTimeStampedUrl=function(url){var token=PTC.navigation.getTokenFromUrl(url);var newPage=getBaseHref()+"app/?iemem="+(new Date).getTime()+"#"+token;return newPage};PTC.navigation.addHistoryToken=function(url){var token=PTC.navigation.getTokenFromUrl(url);Ext.History.add(token)};PTC.navigation.isCADURL=function(url){return PTC.navigation.isArbortextURL(url)||url.indexOf("wtpub:")>=0||url.indexOf("wtws:")>=0};
PTC.navigation.isArbortextURL=function(url){return url.indexOf("arbortext-editor:")>=0};PTC.navigation.isDownloadURL=function(url){return url.indexOf("redirectRecipient")>=0||url.indexOf("doDirectDownload")>=0||url.indexOf("wt.content.ContentHttp/viewContent")>=0};function getWindowForArbortextProtocol(){return window}
PTC.navigation.loadContent=function(url,forceDuplicates){if(forceDuplicates===undefined)forceDuplicates=true;if(PTC.navigation.fireEvent("beforeLoadContent",url)!==false){var isDownload=PTC.navigation.isDownloadURL(url);if(!PTC.navigation.isShell()||isDownload||PTC.navigation.isCADURL(url)){if(Ext.isGCF&&isDownload)PTC.util.downloadUrl(url);else if(PTC.navigation.isArbortextURL(url))getWindowForArbortextProtocol().location.href=url;else getWindow().location.href=url;return}if(Ext.isIE&&PTC.navigation.pageCount>=
PTC.navigation.MAX_IE_PAGE_COUNT){var newPage=PTC.navigation.getTimeStampedUrl(url);getWindow().location.href=newPage;return}if(PTC.navigation.HISTORY_STARTED===true&&Ext.getDom(PTC.navigation.activeContentID)!==undefined&&(forceDuplicates!==true||Ext.History.getToken()!==PTC.navigation.getTokenFromUrl(url)))PTC.navigation.addHistoryToken(url);else PTC.navigation._loadContent(url)}};
PTC.navigation.isEmbeddedUrl=function(link){if(!link)return false;var url=link.href;var target=link.target;if(target&&target!==""&&target!=="_parent"&&target!=="_top")return false;if(!url)return false;if(PTC.util.isJSUrl(url))return false;if(url.indexOf(getBaseHref())>=0&&url.length>=getBaseHref().length+1)return true;return false};
PTC.navigation.isShell=function(){var shellWindow=getWindow();if(!("Ext"in shellWindow))return false;var cp=shellWindow.Ext.getCmp(PTC.navigation.cardManager);if(cp)return true;var appPatt=new RegExp("/app/");var shellPatt=new RegExp("shell.jsp");try{return shellWindow.location.pathname.search(appPatt)>0||shellWindow.location.pathname.search(shellPatt)>0}catch(e){return window.location.pathname.search(appPatt)>0||window.location.pathname.search(shellPatt)>0}};
PTC.navigation._reloadShellContentArea=function(form){if(!form)form=getMainForm();var params=Form.serialize(form);var contentId=PTC.navigation.activeContentID;if(form.parentNode&&form.parentNode.id!==undefined&&form.name!=="htmlcompMF")contentId=form.parentNode.id;PTC.navigation.initiateRequest(form.action,contentId,params,function(req){PTC.navigation.onSuccessRequest(req,contentId)},function(req){PTC.navigation.onFail(req,contentId)})};PTC.navigation.contentTabID="contentPanel";
PTC.navigation.cardManager="contentPanel_parent";PTC.isPreFireFox13=function(){var regex=/rv:\d+/;var version=regex.exec(navigator.userAgent.toLowerCase());return version&&version[0].split(":")[1]<13};
PTC.navigation._loadContent=function(page){PTC.navigation.log.time("loadContent");if(PTC.navigation.fireEvent("historyChange",page)!==false){if(!PTC.navigation.isShell()){getWindow().location.href=page;return}if(!page||page==="#"){page=PTC.navigation.NAVIGATION_DEFAULT_HOME_PAGE;var value=PTC.jca.state.ServerStateProvider.get(PTC.navigation.CLOSE_WELCOME_PAGE);if(!value)page=PTC.navigation.NAVIGATION_WELCOME_PAGE}PTC.navigation.pageCount++;PTC.navigation._setActiveLayout(page);if(!extractParamValue(page,
"portlet"))page=requestHandler.addURIParam(page,"portlet","component",page);PTC.navigation.initiateRequest(page);PTC.navigation.fireEvent("afterLoadContent",page)}else PTC.navigation.log.debug("PTC.navigation._loadContent: content not loaded for ",page," as historyChange event returned false")};
PTC.navigation.initiateRequest=function(page,id,params,onSuccess,onFail){id=id||PTC.navigation.activeContentID;PTC.navigation.stopInProgressPages();if(!$(id)){PTC.navigation.log.error("Cannot load new content into id "+id+" because no dom element with that id exists in this window "+window.location.href+". Attempting to reload the window...");getWindow().location.reload();return}params=params||"";onSuccess=onSuccess||PTC.navigation.onSuccessRequest;onFail=onFail||PTC.navigation.onFail;var cp=Ext.getCmp(PTC.navigation.cardManager);
var cd=Ext.get(id);if(cd)PTC.navigation.setInProgress(cd.dom,cp.getInnerHeight()*0.85);PTC.pageTitleSet=false;PTC.navigation.addOpenRequest(getElementHtml(params,id,true,PTC.navigation.getTokenFromUrl(page),false,onSuccess,onFail))};PTC.pageTitleSet=false;PTC.navigation.setPageTitle=function(title){if(!PTC.pageTitleSet&&title!==""){document.title=title;PTC.pageTitleSet=true}};PTC.navigation.reloadWholeWindow=function(){getWindow().location.reload()};
PTC.navigation.reload=function(){if(PTC.navigation.isShell())PTC.navigation._reloadShellContentArea();else{var mainPageHref=getWindow().location.href;getWindow().location.href=mainPageHref}};PTC.navigation.submitForm=function(form){if(PTC.navigation.isShell()){PTC.navigation._reloadShellContentArea(form);unSelectAll(document.getElementsByTagName("input"))}else{if(!form)form=getMainForm();form.submit()}};
if(PTC.navigation.isShell()){Ext.EventManager.on(window.document,"mouseup",PTC.navigation.saveMouseUpButtonClickInfo);Ext.EventManager.on(window.document,"click",PTC.navigation.remapNavigationLinks)}
PTC.navigation.loadTwoPanes=function(leftPaneUrl,rightPaneUrl,clickHandler,orientation,paneSizes,headerPaneUrl){var cp=Ext.getCmp(PTC.navigation.cardManager);if(!cp){var recallFunc=function(){PTC.navigation.loadTwoPanes(leftPaneUrl,rightPaneUrl,clickHandler,orientation,paneSizes,headerPaneUrl)};Ext.onReady(function(){recallFunc.defer(1)});return}PTC.navigation.clearCurrentCard();var activeItemId=PTC.navigation.contentTabID+"_twoPanes_"+orientation;cp.layout.setActiveItem(activeItemId);PTC.navigation.setActiveContentArea(cp.layout.activeItem.CONTENT_DIV);
cp.layout.activeItemId=activeItemId;cp.layout.leftPaneBaseUrl=encodeURIComponent(leftPaneUrl.split("?")[0]);cp.layout.paneSizes=paneSizes;cp.layout.orientation=orientation;var hasPanesResized=PTC.navigation.resizePanes(Ext.getCmp(activeItemId),paneSizes,orientation);if(headerPaneUrl&&headerPaneUrl!=="null")PTC.navigation.loadHeaderPane(headerPaneUrl);else if(orientation==="horizontal"&&typeof cp.getHeaderPane==="function"){var headerPane=cp.getHeaderPane();headerPane.hide()}if(PTC.isDefined(leftPaneUrl)&&
leftPaneUrl!=="#"&&paneSizes.left>0)PTC.navigation.loadLeftPane(leftPaneUrl);else{if(typeof cp.getNavPane!=="function")cp.getNavPane=function(){return this.findById(PTC.navigation.contentTabID+"_twoPanes_left")};cp.getNavPane().hide()}if(PTC.isDefined(rightPaneUrl)&&rightPaneUrl!=="#"&&paneSizes.right>0)PTC.navigation.loadRightPane(rightPaneUrl,false);else{if(typeof cp.getDetailPane!=="function")cp.getDetailPane=function(){return this.findById(PTC.navigation.contentTabID+"_twoPanes_center")};cp.getDetailPane().hide()}if(hasPanesResized)cp.doLayout(false,
true);if(clickHandler){Event.stopObserving(cp.layout.activeItem.getEl().dom,"click");Event.observe(cp.layout.activeItem.getEl().dom,"click",clickHandler)}};
PTC.navigation.loadHeaderPane=function(url){var cp=Ext.getCmp(PTC.navigation.cardManager);cp.layout.activeItem.headerPaneUrl=url;var options={};options.parameters="";options.asynchronous=true;options.on501=function(response){var headerPaneDiv=Ext.getDom("headerPane");if(headerPaneDiv&&response.responseText.indexOf("ATTENTION:  Secured Action")>0){headerPaneDiv.style.height="200px";headerPaneDiv.childNodes[0].childNodes[0].style.height="200px";headerPaneDiv.childNodes[0].childNodes[0].childNodes[0].innerHTML=
response.responseText;leftPaneDiv=Ext.getDom("contentPanel_twoPanes_left");leftPaneDiv.style.cssText="width: 0px; height: 0px; left: 0px; top: 0px;";leftPaneDiv.childNodes[0].style.cssText="width: 0px; height: 0px; left: 0px; top: 0px;";rightPaneDiv=Ext.getDom("contentPanel_twoPanes_center");rightPaneDiv.style.cssText="width: 0px; height: 0px; left: 0px; top: 0px;";rightPaneDiv.childNodes[0].style.cssText="width: 0px; height: 0px; left: 0px; top: 0px;"}};getElementHtml("",cp.layout.activeItem.header_id,
true,cp.layout.activeItem.headerPaneUrl,false,"","",options)};PTC.navigation.loadLeftPane=function(url){var cp=Ext.getCmp(PTC.navigation.cardManager);url=url+"&portlet=poppedup&leftPaneOnly=true";cp.layout.activeItem.leftPaneUrl=url;getElementHtml("",cp.layout.activeItem.left_id,true,cp.layout.activeItem.leftPaneUrl,false)};
PTC.navigation.loadRightPane=function(url,addHistoryEntry){var cp=Ext.getCmp(PTC.navigation.cardManager);url+=url.indexOf("?")>0?"&":"?";url=url+"portlet=poppedup&rightPaneOnly=true";url=url+"&setActiveLayout="+cp.layout.activeItemId;url=url+"&leftPane="+cp.layout.leftPaneBaseUrl;cp.layout.activeItem.rightPaneUrl=url;if(addHistoryEntry)PTC.navigation.loadContent(cp.layout.activeItem.rightPaneUrl);else PTC.navigation._loadContent(cp.layout.activeItem.rightPaneUrl)};
PTC.navigation.getRightPaneUrl=function(){var cp=Ext.getCmp(PTC.navigation.cardManager);return cp.layout.activeItem.rightPaneUrl};PTC.navigation.getHeaderPaneUrl=function(){var cp=Ext.getCmp(PTC.navigation.cardManager);return cp.layout.activeItem.headerPaneUrl};
PTC.navigation.resizePanes=function(paneHolder,paneSizes,orientation){var hasResizedPanes=false;if(!paneHolder||paneHolder.ctype!=="Ext.Component")return hasResizedPanes;if(paneSizes){var pane1Size=Math.abs(paneSizes.left);var pane2Size=Math.abs(paneSizes.right);if(!isNaN(pane1Size)&&!isNaN(pane2Size)){var parentSize=orientation==="horizontal"?paneHolder.getWidth():paneHolder.getHeight();if(pane1Size+pane2Size===100){pane1Size=pane1Size/100*parentSize;pane2Size=pane2Size/100*parentSize;pane1Size=
Math.floor(pane1Size);pane2Size=Math.round(pane2Size)}}var paneToResize=paneHolder.getNavPane();if(PTC.navigation.resizePane(paneToResize,pane1Size,orientation))hasResizedPanes=true;paneToResize=paneHolder.getDetailPane();if(PTC.navigation.resizePane(paneToResize,pane2Size,orientation))hasResizedPanes=true;if(orientation==="horizontal")if(paneSizes.header){var headerPaneSize=Math.abs(paneSizes.header);var headerPane=paneHolder.findById("headerPane");if(headerPane&&!isNaN(headerPaneSize)){headerPane.setHeight(headerPaneSize);
hasResizedPanes=true}}}return hasResizedPanes};PTC.navigation.resizePane=function(pane,paneSize,orientation){var hasResizedPane=false;if(pane&&!isNaN(paneSize)){if(orientation==="vertical")pane.setHeight(paneSize);else pane.setWidth(paneSize);hasResizedPane=true}return hasResizedPane};PTC.navigation._resizeTwoPanesAfterLayout=function(){var tables=PTC.jca.table.Utils.getExtTables(this.el.dom);var len=tables.length;for(var i=0;i<len;i++)tables[i].setHeight(tables[i].oldHeight+6)};
PTC.navigation.resetTwoPanes=function(){var cp=Ext.getCmp(PTC.navigation.cardManager);if(cp&&cp.layout.activeItemId&&cp.layout.activeItem.id.indexOf("_twoPanes_")>0){var tables=PTC.jca.table.Utils.getExtTables(cp.el.dom);for(var i=0;i<tables.length;i++)tables[i].oldHeight=tables[i].height;if(PTC.navigation.resizePanes(Ext.getCmp(cp.layout.activeItemId),cp.layout.paneSizes,cp.layout.orientation)){cp.doLayout(false,true);cp.on("afterLayout",PTC.navigation._resizeTwoPanesAfterLayout,null,{single:true})}}};
PTC.navigation.clearCurrentCard=function(){var cp=Ext.getCmp(PTC.navigation.cardManager);if(!cp||!cp.layout||!cp.getEl().dom)return false;var activeItem=cp.layout.activeItem;if(activeItem)return activeItem.clearCardContents()};
PTC.navigation.setInProgress=function(obj,height){if(!obj)return;if(!height){height=200;if(obj)height=obj.offsetHeight*0.9;else height=window.document.height*0.4;if(height<200)height=200}var contentLoadingMaskId="contentLoadingMask";if(obj.id)contentLoadingMaskId+="_"+obj.id;PTC.navigation.overwrite(obj,'<div id="'+contentLoadingMaskId+'" style="height:'+height+'px">&nbsp;</div>');PTC.navigation.startProgressTask(contentLoadingMaskId);Ext.garbageCollect()};
PTC.navigation.startProgressTask=function(id){var progressTaskFunc=function(){var mask=Ext.getDom(id);if(mask)Ext.fly(mask).addClass("contentloading");progressTaskFunc=null};var taskid=setTimeout(progressTaskFunc,400);return taskid};PTC.navigation_this=this;PTC.navigation.evalPageScripts=function(text){var sts=text.extractScripts();if(!sts||sts.length<=0)return false;var item=sts.join(";\n ");PTC.navigation._evalScripts(item)};
PTC.navigation._evalScripts=function(text){if(PTC.navigation_this.execScript)PTC.navigation_this.execScript(text,"javascript");else PTC.jslint.foundEvalReservedWord(text,PTC.navigation_this)};PTC.navigation.loadedscripts=[];
PTC.navigation.loadScript=function(src,reload){var srcNotLoadedYet=src.indexOf(".js")>0&&PTC.navigation.loadedscripts.indexOf(src)<0;if(srcNotLoadedYet||reload){var base=getBaseHref();var fullyQualifiedSrc=src.indexOf(base)===0?src:base+src;var options={method:"get",asynchronous:false,evalJS:false,onSuccess:function(transport){var forDebugger="\n//# sourceURL="+fullyQualifiedSrc;PTC.navigation._evalScripts(transport.responseText+forDebugger);if(PTC.navigation.loadedscripts.indexOf(src)<0)PTC.navigation.loadedscripts.push(src)}};
var cacheBuster=reload?new Date:PTC.util.getWeeklyCacheBuster(new Date);var url=fullyQualifiedSrc+(fullyQualifiedSrc.indexOf("?")<0?"?cb=":"&cb=")+cacheBuster.getTime();return new Ajax.Request(url,options)}};PTC.navigation.increaseNodesClickableArea=function(treeLoader,treeNode){treeNode.on("click",PTC.navigation.navigateToNodeHref);treeNode.childNodes.each(function(childNode){childNode.on("click",PTC.navigation.navigateToNodeHref)})};
PTC.navigation.navigateToNodeHref=function(treeNode,event){var link=null;var eventTarget=null;if(event){link=event.getTarget("A");eventTarget=event.target}if(!link){var anchorFromDom=treeNode.ui.anchor;if(Ext.isIE)anchorFromDom.click();else if(document.createEvent&&eventTarget!==anchorFromDom){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",true,true,window,0,0,0,0,0,false,false,false,false,0,null);anchorFromDom.dispatchEvent(e)}}};
PTC.navigation.getAccordionItems=function(mainNavItems){var accordionItems=[];var accordionStyles="";var getStateFunc=function(){var state={};var expanded=[];for(var id in this.nodeHash)if(this.nodeHash.hasOwnProperty(id)){var node=this.nodeHash[id];if(node.expanded){expanded.push(node.getPath());if(!node.isRoot)expanded.remove(node.parentNode.getPath())}}state={expanded:expanded};return state};var applyStateFunc=function(state){if(state.expanded&&state.expanded.length>0)this.addListener("load",function(node){if(!this.rendered)return;
var treeState=Ext.state.Manager.get(node.getOwnerTree().getId());var expandedLen=treeState.expanded.length;for(var i=0;i<expandedLen;i++){var path=treeState.expanded[i];this.expandPath(path)}})};var onNodeClickFunc=function(e,node){onNodeClick_orig(e,node);node.ui.removeClass("x-tree-selected")};for(var i=0,l=mainNavItems.length;i<l;i++){var action=mainNavItems[i];if(action.icon){PTC.action.fixIconForSSL(action);accordionStyles+="."+action.id+"-icon { background: url("+action.icon+") no-repeat !important; width:25px;height: 25px;} \n";
action.iconCls=action.id+"-icon";action.tabTip=action.title;action.title=null}var navigatorPanelEnabled=PTC.navigator.isNavigatorEnabled();var treePanel;if(action.actionModelName===null||action.actionModelName===undefined){action.useArrows=true;action.animate=true;action.autoScroll=true;action.loader=new Ext.tree.TreeLoader(action.treeLoader);action.loader.on("load",PTC.navigation.increaseNodesClickableArea);action.containerScroll=true;action.rootVisible=false;if(navigatorPanelEnabled){action.tools=
[];if(action.listActionUrl){action.tools.push({title:action.listActionTitle,id:"viewAll",qtip:action.listActionTip,href:action.listActionUrl,handler:PTC.navigator.viewAllHandler});action.toolTemplate=new Ext.XTemplate('<div class="x-tool navigator-treePanel-tool-{id}"><a href="{href}">{title}</a></div>')}action.bodyCssClass="navigator-treePanel-body";action.headerCfg={tag:"div",cls:"x-panel-header navigator-treePanel-header",html:action.tabTip};action.headerAsText=false;action.stateful=true;action.stateEvents=
["expandnode","collapsenode"];action.getState=getStateFunc;action.applyState=applyStateFunc;Ext.state.Manager.setProvider(new PTC.jca.state.ClientStateProvider);treePanel=new Ext.tree.TreePanel(action)}else treePanel=new Ext.ux.TreePanelStateful(action);var onNodeClick_orig=treePanel.eventModel.onNodeClick;treePanel.eventModel.onNodeClick=onNodeClickFunc;treePanel.autoWidth=true;treePanel.tabCls="navigator-tab";var treePanelRoot=new Ext.tree.AsyncTreeNode(action.root);treePanelRoot.on("load",PTC.trail.navigation.listener);
treePanel.setRootNode(treePanelRoot);if(!navigatorPanelEnabled)treePanelRoot.expand(false,false)}else{var debugurl=action.url;if(debugurl!==null&&debugurl!==undefined)if(action.actionModelName!==null&&action.actionModelName!==undefined)if(debugurl.indexOf("?")>-1)debugurl=debugurl+"&actionModelName="+action.actionModelName+"&modelType="+action.modelType;else debugurl=debugurl+"?actionModelName="+action.actionModelName+"&modelType="+action.modelType;var panelConfig={id:action.id,icon:action.icon,iconCls:action.id+
"-icon",tabTip:action.title,title:null,autoScroll:true,html:'<div id="'+action.id+"-contentDiv"+'"></div>',url:debugurl,tabCls:"navigator-tab navigator-tab-text",autoWidth:true,listeners:{activate:PTC.navigator.activatePanelListener}};treePanel=new Ext.Panel(panelConfig)}accordionItems.push(treePanel)}Ext.util.CSS.createStyleSheet(accordionStyles);return accordionItems};
PTC.navigation.getAccordionPanel=function(){var accordionItems=PTC.navigation.getAccordionItems(mainNavActions);var width=PTC.navigation.stateProvider.get("AccordionPanelWidth");if(!width)width=200;var accordionPanel=new Ext.Panel({id:"accordion",title:PTC.navigation.NAVIGATION_TITLE,region:"west",width:width,split:true,minSize:100,maxSize:400,margins:"-2 0 0 0",cmargins:{left:0,top:-3,bottom:-3},collapsible:true,collapsed:false,layout:"accordion",defaults:{collapsed:true},items:accordionItems});
accordionPanel.on("afterlayout",function(c){this.syncSize()},accordionPanel,{single:true,delay:500});return accordionPanel};
PTC.navigation.getCommonPanels=function(){var contentCenterTab=new PTC.jca.table.TableContainer({id:PTC.navigation.contentTabID,bodyCssClass:"contentBody",split:true,autoScroll:true,bufferResize:false,autoWidth:true,margins:"5 5 1 0",CONTENT_DIV:PTC.navigation.contentID,html:'<div id="'+PTC.navigation.contentID+'"></div>'});var headerPane=new Ext.Panel({id:"headerPane",region:"north",height:64,bufferResize:false,width:"100%",autoWidth:false,html:'<div id="twoPanes_HEADERPANE"></div>',clearCardContents:function(){this.removeAll(true);
var itemDisplayID=this.itemIdLinePanelID?this.itemIdLinePanelID:"itemDisplayID";var oldItemIdPanel=Ext.getCmp(itemDisplayID);if(oldItemIdPanel)oldItemIdPanel.destroy();Ext.getDom("twoPanes_HEADERPANE").innerHTML=""},border:false});var twoPanesCenter=new PTC.jca.table.TableContainer({id:PTC.navigation.contentTabID+"_twoPanes_center",cls:"",split:true,region:"center",bufferResize:10,autoScroll:true,clearCardContents:function(){Ext.getDom("twoPanes_RIGHTPANE2").innerHTML=""},html:'<div id="twoPanes_RIGHTPANE2"></div>'});
var contentLeftTab=new PTC.jca.table.TableContainer({id:PTC.navigation.contentTabID+"_twoPanes_left",cls:"",region:"west",collapsible:true,header:false,autoScroll:true,bufferResize:false,html:'<div id="twoPanes_LEFTPANE"></div>',split:true,clearCardContents:function(){Ext.getDom("twoPanes_LEFTPANE").innerHTML=""}});var twoPanesHorizontal=new Ext.Panel({id:PTC.navigation.contentTabID+"_twoPanes_horizontal",bodyCssClass:"contentBody",layout:"border",split:true,bufferResize:false,right_id:"twoPanes_RIGHTPANE",
left_id:"twoPanes_LEFTPANE",header_id:"twoPanes_HEADERPANE",CONTENT_DIV:"twoPanes_RIGHTPANE2",items:[contentLeftTab,twoPanesCenter,headerPane],getHeaderPane:function(){return this.get("headerPane")},getNavPane:function(){return this.get(PTC.navigation.contentTabID+"_twoPanes_left")},getDetailPane:function(){return this.get(PTC.navigation.contentTabID+"_twoPanes_center")}});var twoPanesbottom=new PTC.jca.table.TableContainer({id:PTC.navigation.contentTabID+"_twoPanes_bottom",cls:"",split:true,bufferResize:false,
region:"center",autoScroll:true,clearCardContents:function(){Ext.getDom("twoPanes_BOTTOMPANE").innerHTML=""},html:'<div id="twoPanes_BOTTOMPANE"></div>'});var twoPanesTop=new PTC.jca.table.TableContainer({id:PTC.navigation.contentTabID+"_twoPanes_top",cls:"",region:"north",collapsible:true,header:false,height:200,bufferResize:false,autoScroll:true,clearCardContents:function(){Ext.getDom("twoPanes_TOPPANE").innerHTML=""},html:'<div id="twoPanes_TOPPANE"></div>',split:true});var twoPanesVertical=new Ext.Panel({id:PTC.navigation.contentTabID+
"_twoPanes_vertical",bodyCssClass:"contentBody",layout:"border",split:true,bufferResize:false,CONTENT_DIV:"twoPanes_BOTTOMPANE",right_id:"twoPanes_BOTTOMPANE",left_id:"twoPanes_TOPPANE",items:[twoPanesTop,twoPanesbottom],getNavPane:function(){return this.get(PTC.navigation.contentTabID+"_twoPanes_top")},getDetailPane:function(){return this.get(PTC.navigation.contentTabID+"_twoPanes_bottom")}});var contentCardManager=new Ext.Panel({id:PTC.navigation.cardManager,cls:"contentTab",baseCls:"x-box",frame:true,
layout:"card",region:"center",margins:"0 6 0 6",activeItem:0,bufferResize:false,width:"100%",border:false,split:true,flex:1,items:[contentCenterTab,twoPanesHorizontal,twoPanesVertical]});var contentArea=new Ext.Panel({id:PTC.navigation.contentTabID+"_contentArea",layout:{type:"vbox",align:"stretch"},margins:"-2 0 0 -2",border:false,bufferResize:false,region:"center",items:[contentCardManager]});return[contentArea]};
Ext.Panel.prototype.clearCardContents=function(){PTC.util._setMainFormStartingElement(null);if(this.getEl())PTC.jca.table.Utils.cleanUp(this.getEl().dom);if(this.items)this.items.each(function(item){if(typeof item.clearCardContents==="function")item.clearCardContents()});if(Ext.getDom(this.CONTENT_DIV))return PTC.navigation.setInProgress(Ext.getDom(this.CONTENT_DIV))};
PTC.navigation.loadViewPort=function(pageItems){(function(){var viewport=new Ext.Viewport({layout:"border",layoutConfig:{getNavigator:function(){return this.west}},id:"jca_viewport",items:pageItems,bufferResize:50,autoWidth:true,listeners:{afterrender:function(v){var navigator=v.layout.getNavigator();if(navigator&&navigator.id==="navigatorPanel")PTC.navigator.initialize(navigator)},resize:PTC.navigator.onViewportResize,afterlayout:function(container,layout){if(layout.getNavigator()!==undefined&&layout.getNavigator().isSlid){PTC.navigator.moveNavigatorRight();
if(PTC.navigator.isPinned())PTC.navigator.adjustWidthWhenPinned("unpin")}}}})})()};PTC.navigation.navigatorIframeBodyClickHandler=function(){if(PTC.navigator.isExpanded())PTC.navigator.collapseNavigator();else PTC.navigator.expandNavigator()};
PTC.navigation.navigatorIframeClickHandler=function(){var navigatorBarFrame=document.getElementById("navigatorBarIframe");if(navigatorBarFrame&&navigatorBarFrame.contentWindow&&navigatorBarFrame.contentWindow.document&&navigatorBarFrame.contentWindow.document.body){navigatorBarFrameBody=navigatorBarFrame.contentWindow.document.body;navigatorBarFrameBody.style.cursor="hand";Ext.get(navigatorBarFrameBody).on("click",PTC.navigation.navigatorIframeBodyClickHandler)}else PTC.navigation.navigatorIframeClickHandler.defer(100)};
PTC.navigation.loadPopupShell=function(){Ext.EventManager.on(window,"unload",PTC.wizard.unloadWizard);return PTC.navigation.loadViewPort(PTC.navigation.getCommonPanels())};PTC.mainWindow=null;
PTC.getMainWindow=function(){var returnVal=PTC.mainWindow;var found=false;if(!returnVal){try{if(top.window.opener&&top.window.opener.PTC){returnVal=top.window.opener.PTC.getMainWindow();found=true}}catch(e){}if(!found){returnVal=getWindow();if(returnVal&&returnVal.PTC&&returnVal.PTC.navigation&&!returnVal.PTC.navigation.isShell()&&returnVal.parent&&returnVal.parent.PTC)returnVal=returnVal.parent}}return returnVal};
PTC.navigation.unloadShell=function(){PTC.navigation.log.trace("Entered PTC.navigation.unloadShell");PTC.util._setMainFormStartingElement(null);PTC.util.purge(window.document);window.onload=null;window.onresize=null;window.onbeforeunload=null;window.onerror=null;var iframes=document.getElementsByTagName("iframe");var i=iframes.length;while(i--){var iframeEl=iframes[i];try{var iframeNameOrId=iframeEl.getAttribute("name");if(!iframeNameOrId)iframeNameOrId=iframeEl.getAttribute("id");PTC.navigation.log.debug("PTC.navigation.unloadShell: purging iframe ",
iframeNameOrId," from dom");PTC.util.purge(iframeEl.contentWindow.document)}catch(e){PTC.navigation.log.debug("PTC.navigation.unloadShell : Exception thrown while purging iframe contents.",iframeEl,e)}}PTC.purgeListeners();PTC.navigation.purgeListeners();PTC.wizard.purgeListeners();PTC.search.purgeListeners();PTC.driverAttributes.purgeListeners();PTC.attributePanel.purgeListeners();PTC.jca.dataSource.purgeListeners();PTC.menu.purgeListeners();PTC.infoPage.purgeListeners();delete PTC.navigation_this;
Ext.destroy(PTC.infoPage,PTC.navigation,PTC.wizard,PTC.menu);Ext.EventManager.un(window,"unload",PTC.navigation.unloadShell);PTC.navigation.unloadShell=null};
(function(){if(Ext.isIE){var fnCleanUp=function(){var p=Function.prototype;delete p.createSequence;delete p.defer;delete p.createDelegate;delete p.createCallback;delete p.createInterceptor;delete p.argumentNames;delete p.bind;delete p.bindAsEventListener;delete p.curry;delete p.delay;delete p.prototype_defer;delete p.wrap;delete p.methodize;window.detachEvent("onunload",fnCleanUp);fnCleanUp=null};window.attachEvent("onunload",fnCleanUp)}})();
PTC.navigation.loadMainShell=function(){PTC.mainWindow=window;if(!("onhashchange"in window)){var historyDiv=document.createElement("DIV");historyDiv=document.body.appendChild(historyDiv);historyDiv.innerHTML='<form id="history-form" class="x-hidden" style="visibility:hidden">'+'<input type="hidden" id="x-history-field" />'+'<iframe id="x-history-frame"></iframe>'+"</form>"}Ext.History.init();PTC.navigation.HISTORY_STARTED=true;var header=new Ext.Panel({id:"header",header:false,region:"north",bufferResize:false,
margins:"0 0 0 0",height:80,bwrapCfg:{style:"height:41px"},html:'<div id="pageHeaderActions"></div><div id="globalSearch"></div><div id="typeChooserTrigger"></div><div id="divider"></div><div id="logoNav" class="'+PTC.navigation.HEADER_CLASS+'"><span id="globalUser"></span></div>',listeners:{afterrender:function(headerCmp){PTC.navigation.fireEvent("afterHeaderRender",headerCmp)}}});var pageItems=PTC.navigation.getCommonPanels();pageItems.push(header);var breadcrumb=new PTC.navigation.breadcrumb.HeaderPanel;
Ext.getCmp(PTC.navigation.contentTabID+"_contentArea").insert(0,breadcrumb);var navigatorPanelEnabled=PTC.navigator.isNavigatorEnabled();var accordion=null;if(!navigatorPanelEnabled){accordion=PTC.navigation.getAccordionPanel();pageItems.push(accordion)}else{var navigatorPanel=PTC.navigator.getNavigatorPanel();pageItems.push(navigatorPanel);Ext.EventManager.on(window.document,"click",PTC.navigator.slideInIf)}PTC.navigation.loadViewPort(pageItems);if(Ext.isGecko&&PTC.isPreFireFox13())Ext.getBody().addClass("pre-firefox-13");
Ext.History.on("change",PTC.navigation._loadContent);var token=document.location.href.split("#")[1];var rightPaneOnly=extractParamValue(token,"rightPaneOnly");if("true"==rightPaneOnly){token=decodeURIComponent(token);var leftPaneUrl=extractParamValue(token,"leftPane");var tokenSplit=token.split("?");var leftToken=decodeURIComponent(leftPaneUrl+"?"+tokenSplit[1]);PTC.navigation._setActiveLayout(leftToken);PTC.navigation.loadLeftPane(leftToken)}PTC.navigation.isPageLoaded=PTC.navigation._isPageLoaded;
PTC.navigation._loadContent(token);if(!navigatorPanelEnabled)Ext.ux.TreePanelStateful.restore(accordion);var bodyProgress=Ext.fly("bodyProgress");if(bodyProgress)bodyProgress.removeClass("progress");if(Ext.isIE)Ext.EventManager.on(window,"unload",PTC.navigation.unloadShell);PTC.navigation.showIE8CompatibilityModeMessage();PTC.navigation.fireEvent("afterLoadMainShell")};
PTC.navigation._setActiveLayout=function(page){var cp=Ext.getCmp(PTC.navigation.cardManager);var layout=0;if(page.indexOf("setActiveLayout")>0)layout=extractParamValue(page,"setActiveLayout");if(!cp.layout.activeItem||layout!==cp.layout.activeItem.id){if(cp.layout.activeItem&&cp.layout.activeItem.getEl())PTC.navigation.removeIframes(cp.layout.activeItem.getEl().dom);PTC.navigation.clearCurrentCard();cp.layout.setActiveItem(layout);PTC.navigation.setActiveContentArea(cp.layout.activeItem.CONTENT_DIV)}};
PTC.navigation.removeIframes=function(dom,removeJCATables,purgeGivenDomElementPlusChildren){if(dom){PTC.navigation.fireEvent("removeIframe",dom);var iframes=dom.getElementsByTagName("iframe");var i=iframes.length;while(i--){var iframeEl=iframes[i];var iframeNameOrId=iframeEl.getAttribute("name");if(!iframeNameOrId)iframeNameOrId=iframeEl.getAttribute("id");PTC.navigation.log.debug("PTC.navigation.removeIframes: purging iframe ",iframeNameOrId," from dom");try{var iframeWin=iframeEl.contentWindow;
if(iframeWin&&iframeWin.PTC)iframeWin.PTC.navigation.removeIframes.call(iframeWin,iframeWin.document,removeJCATables,true);if(iframeWin&&iframeWin.document){PTC.util.purge(iframeWin.document);iframeWin.close()}else PTC.navigation.log.debug("PTC.navigation.removeIframes: content document not found for iframe ",iframeNameOrId,"? Document not purged.");iframeWin.location.replace("about:blank")}catch(e){PTC.navigation.log.debug("PTC.navigation.removeIframes: access error trying to access the document or content window for iframe ",
iframeNameOrId)}try{Ext.removeNode(iframeEl)}catch(erm){PTC.navigation.log.debug("PTC.navigation.removeIframes: access error trying to delete iframeEl")}}PTC.util.purge(dom,purgeGivenDomElementPlusChildren!==true);if(removeJCATables===true)tableUtils.cleanUp(dom);if("CollectGarbage"in window)CollectGarbage()}};PTC.navigation.POPUP_SHELL="PTC.navigation.POPUP_SHELL";Ext.onReady(Ext.QuickTips.init);
PTC.navigation.loadShell=function(shellType){if(PTC.navigation.shellLoaded)return;PTC.navigation.shellLoaded=true;PTC.onWindowLoad(function(){if(PTC.navigation.POPUP_SHELL===shellType)PTC.navigation.loadPopupShell();else PTC.navigation.loadMainShell()})};PTC.navigation.updateTreePanel=function(navAction,forcedUpdate){var nodeName=navAction+"Navigation";PTC.navigation._updateTreePanel(nodeName,forcedUpdate)};
PTC.navigation._updateTreePanel=function(treePanelId,forcedUpdate){var cp=Ext.getCmp(treePanelId);if(!cp||!cp.rendered)return;var rootNode=cp.getRootNode();var oid=decodeURIComponent(extractParamValue(window.location.href,"oid"));if(oid&&!forcedUpdate)if(treePanelId==="recentContextsNavigation"){var type=oid.split(":")[1];var firstNodeOfSameType=rootNode.findChildBy(function(child){return child.id.indexOf(type)>=0});if(firstNodeOfSameType&&firstNodeOfSameType.id.indexOf(oid)>=0)return}else if(rootNode.item(0)&&
rootNode.item(0).id.indexOf(oid)>=0)return;rootNode.reload();if(PTC.navigator.isNavigatorEnabled())PTC.navigator.restoreTreePanelState(cp,Ext.state.Manager.get(cp.getStateId()));else cp.restoreState()};
PTC.navigation.overwrite=function(obj,newhtml){if(PTC.navigation.log.isTraceEnabled()){var id=obj?obj.id:"obj is null or undefined";PTC.navigation.log.trace("Entered PTC.navigation.overwrite to overwrite dom: "+id)}PTC.navigation.removeIframes(obj);tableUtils.cleanUp(obj);Ext.DomHelper.overwrite(obj,newhtml)};Ext.apply(PTC.navigation,new Ext.util.Observable);PTC.navigation.addEvents("afterHeaderRender","beforeLoadContent","afterLoadContent","historyChange","removeIframe","afterLoadMainShell");
PTC.navigation.on("afterHeaderRender",function(){var menuButton=new PTC.menu.DynamicMenuButton({id:"quickLinksButton",renderTo:"pageHeaderActions",text:bundleHandler.get("com.ptc.core.ui.navigationRB.QUICK_LINKS"),menuAlign:"tr-br?",menu:{id:"quickLinksMenu",xtype:"dynamicMenu",loadOnce:true,requestUrl:PTC.attributeHelper.get("ActionsMenu").url,requestOptions:{parameters:{actions:"header actions"}}}});Ext.getDom("globalUser").innerHTML=PTC.navigation.GLOBAL_USER;Ext.fly("logoNav").on("click",function(){PTC.navigation.goHome()});
Ext.getBody().createChild({tag:"span",id:"preload1"});return menuButton});PTC.navigation.on("beforeLoadContent",PTC.log.sendAllMessages);PTC.navigation.openAuthLightbox=function(){PTC.lightbox.activate({contentHref:"netmarkets/jsp/components/reload.jsp",requestMethod:"get",id:"fba_relogin",width:400,height:350})};PTC.navigation.openAuthLightbox=PTC.util.delayAllCalls(PTC.navigation.openAuthLightbox);
PTC.navigation.handleResponseHasFormBasedAuth=function(response){if(PTC.navigation.responseHasFormBasedAuth(response.responseText)){PTC.navigation.openAuthLightbox();return true}return false};PTC.navigation.FORM_BASED_AUTH_FORMID="login";PTC.navigation.FORM_BASED_WINDOW_SIZE={height:350,width:400};
PTC.navigation.responseHasFormBasedAuth=function(responseText){var flag=PTC.attributeHelper.get("PTC.navigation.FORM_BASED_AUTH_RESPONSE_FLAG");if(flag&&responseText&&responseText.indexOf(flag)>0)return true;return false};PTC.navigation.formBaseAjaxRequestChecker=function(conn,response,options){var reAuthNeeded=PTC.navigation.handleResponseHasFormBasedAuth(response);if(reAuthNeeded)return false;return true};
PTC.navigation.override=function(){if(PTC.navigation.override_complete===true)return;PTC.navigation.override_complete=true;Event.observe=Event.observe.wrap(function(proceed,object,eventName,func){if(eventName==="load")func.apply(object,[]);else return proceed(object,eventName,func)});if(extractParamValue(document.location.href,"isWf"))isWf=TRUE_FUNC;if(PTC.attributeHelper.get("formBased")){Ext.Ajax.on("requestcomplete",PTC.navigation.formBaseAjaxRequestChecker);Ajax.Responders.register({onComplete:PTC.navigation.formBaseAjaxRequestChecker})}};
if("Ext"in window)Ext.DomQuery.matchers.push({re:PTC.jslint.allowNamespaceRegEx,select:'n = byAttribute(n, "{2}", "{4}", "{3}", "{1}");'});function setMainformForActionHandler(event){PTC.util._setMainFormStartingElement(event.target?event.target.id:event.srcElement.id)}PTC.jca.setPageTitle=false;
PTC.navigation.showIE8CompatibilityModeMessage=function(){if(Ext.isIE7&&document.documentMode){var title=bundleHandler.get("com.ptc.core.ui.errorMessagesRB.IE_COMPAT_MODE_ERROR_MESSAGE_HEADER");var msg=bundleHandler.get("com.ptc.core.ui.errorMessagesRB.IE_COMPAT_MODE_ERROR_MESSAGE");PTC.messaging.showMessage(title,msg)}};PTC.onError=function(e,url,lineNum){try{PTC.log.error(e,url,lineNum);return!PTC.getMainWindow().PTC.debug.isJsDebug()}catch(e2){return false}};window.onerror=PTC.onError;
PTC.navigation.on("historychange",Ext.menu.MenuMgr.hideAll,Ext.menu.MenuMgr,{delay:100});PTC.infoPage={};PTC.infoPage.log=log4javascript.getLogger("PTC.infoPage");Ext.apply(PTC.infoPage,new Ext.util.Observable);PTC.infoPage.addEvents("beforeRender","afterRender");PTC.infoPage.stdTabPanelID="infoPanelID";PTC.infoPage.stdTopTabPanelID="infoPage"+PTC.infoPage.stdTabPanelID;PTC.infoPage.mainInfoPageIDSuffix="mainInfoPagePanel";PTC.infoPage.itemDisplayID="itemDisplayID";PTC.infoPage.tabPanel=[];
PTC.infoPage.getTabPanel=function(id){if(!id){if(PTC.infoPage.tabPanel[id])return PTC.infoPage.tabPanel[id];id=PTC.infoPage.stdTopTabPanelID}return PTC.infoPage.tabPanel[id]};PTC.infoPage.renderTabs=function(tabs_config){PTC.infoPage.tabPanel[PTC.infoPage.stdTlnTabPanelID]=new Ext.TabPanel(tabs_config)};
PTC.infoPage.addThirdLevelNavTab=function(actionConfig,tabPanelId,tabId){var id=actionConfig.id;var url=actionConfig.actionURL;var title=actionConfig.text;if(!tabPanelId)tabPanelId=PTC.infoPage.stdTlnTabPanelID;var tp=PTC.infoPage.getTabPanel(tabPanelId);var tln_panel_id="tln_tab_"+id;if(Ext.getDom(tln_panel_id))tp.activate(tln_panel_id);else{var panelToAdd={html:'<div style="background: url(netmarkets/javascript/ext/resources/images/default/shared/blue-loading.gif) no-repeat center center; height:100px">&nbsp;</div>',
title:title,closable:true,id:tln_panel_id};tp.add(panelToAdd);var tabRef=tp.get(tln_panel_id);if(PTC.isDefined(tabRef))tabRef.on("beforeclose",PTC.jca.DataSourceRegistry.killInternalDataSources);tp.activate(tln_panel_id);var mform=getMainForm();if(isDefined(mform))mform=Form.serialize(mform);getElementHtml(mform,tln_panel_id,true,url,false);tp.doLayout();PTC.infoPageTableMgr.addRenderedTable(actionConfig.actionID,tln_panel_id,tabId);return tp.getItem(tln_panel_id)}};PTC.infoPage.InfoModel=function(){};
PTC.infoPage.InfoModel.prototype={getAttributeValue:function(id){if(this.attributes&&this.attributes.length)for(var i=0,l=this.attributes.length;i<l;i++){var attribute=this.attributes[i];if(attribute[0]===id)return attribute[2]}return},setAttributeValue:function(id,value){if(this.attributes&&this.attributes.length)for(var i=0,l=this.attributes.length;i<l;i++){var attribute=this.attributes[i];if(attribute[0]===id){attribute[2]=value;return true}}return false},getAttributeIDs:function(){var idList=
[];if(this.attributes&&this.attributes.length)for(var i=0,l=this.attributes.length;i<l;i++){var attribute=this.attributes[i];idList[i]=attribute[0]}return idList},getClientStorage:function(){if(!PTC.isDefined(this.clientStorageProvider))this.clientStorageProvider=new PTC.jca.state.ClientStateProvider;return this.clientStorageProvider}};
PTC.infoPage.layout=function(infoModel){PTC.onReady(function(){Ext.apply(infoModel,new PTC.infoPage.InfoModel);infoModel.id=infoModel.id||"";infoModel.headerLabels={};if(PTC.infoPage.fireEvent("beforeRender",infoModel)!==false)PTC.infoPage.doLayout(infoModel);PTC.infoPage.fireEvent("afterRender",infoModel)})};PTC.infoPage.on("afterRender",function(infoModel){if(infoModel.data.visualization)PTC.navigation.evalPageScripts(infoModel.data.visualization)});
PTC.infoPage.cleanPreviousInfoPageCmps=function(mainInfoPanelID){var cardPanel=Ext.getCmp(PTC.navigation.cardManager);var currentInfoPageContent=cardPanel.findById(mainInfoPanelID);if(currentInfoPageContent){PTC.infoPage._cleanPreviousInfoPageCmps_cachedForms[mainInfoPanelID]=getMainForm("infoPageDivID");cardPanel.remove(mainInfoPanelID,true)}};PTC.infoPage._cleanPreviousInfoPageCmps_cachedForms=[];
PTC.infoPage.handleTabChange=function(tabPanel,newTab,currentTab){if(newTab){if(newTab.id===PTC.infoPage.myTab.addNewTabActionID&&tabPanel.docking!==true){PTC.infoPage.myTab.addNewTab(tabPanel);return false}return PTC.infoPageTableMgr.handleTabChange(tabPanel,newTab,currentTab)}return true};
PTC.infoPage.handleComponentRefresh=function(tabPanel,newTab){if(newTab){var extComponent=Ext.getCmp(newTab.id);var tables=PTC.jca.table.Utils.getExtTables(extComponent.getEl().dom);for(var i=0,l=tables.length;i<l;i++)PTC.jca.table.scroll.updateTableSize(tables[i].id,false,tables[i].getWidth(),true)}};
PTC.infoPage.getItemIdPanel=function(infoModel){var infoModelId=infoModel.id?infoModel.id:"";var itemIdLinePanelID=infoModelId+PTC.infoPage.itemDisplayID;var existingIdPanel=Ext.getCmp(itemIdLinePanelID);if(existingIdPanel)existingIdPanel.destroy();var itemIdLine=new Ext.Panel({id:itemIdLinePanelID,layout:"anchor",header:false,border:false,hideBorders:true,cls:"infoPage-title",autoHeight:true,items:PTC.infoPage._getItemIDItems(infoModel),region:"north"});var headerPanel=Ext.getCmp("headerPanel");
if(headerPanel)headerPanel.itemIdLinePanelID=itemIdLinePanelID;return itemIdLine};PTC.infoPage.getTabManager=function(tabPanel){if(!PTC.isDefined(tabPanel.tabManager)){var tabManager=new PTC.jca.manager.TabManager;tabManager.init(tabPanel);tabManager.setActiveTab(tabPanel.activeTabObj);tabPanel.tabManager=tabManager}return tabPanel.tabManager};
PTC.infoPage.redirectToTabTable=function(actionType,actionName,tabPanelId){var tabPanel=PTC.infoPage.getTabPanel(tabPanelId);var tabId=tabPanel.items.items[0].id;var tabSet=tabPanel.items.items;var tabToActivate=tabPanel.activeTabObj.scrollToTabTable(tabSet,tabId,actionType,actionName);var tab=Ext.getCmp(tabToActivate);tabPanel.setActiveTab(tab)};
PTC.infoPage.getTabSet=function(infoModel,activeTab){var serverTabSet=PTC.infoPage._getTabSet(infoModel,activeTab);var tabSet=new PTC.infoPage.TabSet({tabSetKey:PTC.infoPage.TabUtils.getTabSetKey(infoModel),objectType:PTC.infoPage.TabUtils.getObjectType(infoModel),serverTabSet:serverTabSet});return tabSet};
PTC.infoPage.getTopTabPanel=function(infoModel){var activeTab=new PTC.infoPage.ActiveTab;activeTab.init(infoModel);var tabPanelID=infoModel.id+PTC.infoPage.stdTabPanelID;var tabSet=PTC.infoPage.getTabSet(infoModel,activeTab);var orderedTabSet=tabSet.getCalculatedTabOrder();var activeTabId=activeTab.getActiveTabId(orderedTabSet);var tabPanel=new Ext.ux.DockTabPanel({activeTab:activeTabId,activeTabObj:activeTab,id:tabPanelID,items:orderedTabSet,plain:true,cls:"infoPage-tabs",region:"center",myTabConfig:infoModel.myTabConfig,
infoModel:infoModel,tabSet:tabSet,enableTabScroll:true,defaults:{autoScroll:true},plugins:PTC.infoPage.getTopTabPanelPlugins(infoModel),listeners:{beforetabchange:PTC.infoPage.handleTabChange,dock:PTC.infoPage.dockListener,tabchange:PTC.infoPage.handleComponentRefresh}});PTC.infoPage.tabPanel[tabPanel.id]=tabPanel;return tabPanel};
PTC.infoPage.getTopTabPanelPlugins=function(infoModel){var plugins=[new Ext.ux.TabContextMenu];if(PTC.infoPage.shouldHideAddNewTab(infoModel)!==true)plugins.push(new Ext.ux.TabScrollerAddTabButton);return plugins};PTC.infoPage.dockListener=function(tabPanel,c,activate,position,allowRemove){tabPanel.tabSet.saveTabOrderDrag(this,c.actionID,position)};
PTC.infoPage.getMainPanel=function(infoModel,items){var mainInfoPanelID=infoModel.id+PTC.infoPage.mainInfoPageIDSuffix;var mainPanelConfig={id:mainInfoPanelID,header:false,border:false,hideBorders:true,layout:"border",cls:"infoPage",clearCardContents:PTC.infoPage.clearCardContents,addMainForm:PTC.infoPage.addMainForm,bufferResize:100,listeners:{render:PTC.infoPage.renderListener},items:items};if(infoModel.jcaDebugInfo&&PTC.debug.isJCADebug())mainPanelConfig.tbar={xtype:"panel",html:infoModel.jcaDebugInfo};
return new PTC.jca.table.TableContainer(mainPanelConfig)};PTC.infoPage.renderListener=function(){this.addMainForm();var mainContent=$(PTC.navigation.contentID);if(mainContent){PTC.util.purge(mainContent,true);mainContent.innerHTML=""}};
PTC.infoPage.addMainForm=function(){var dom=this.getEl().dom;var childNodes=dom.childNodes;var mform=PTC.util.getForm("infoPageDivID");if(!mform)mform=PTC.infoPage._cleanPreviousInfoPageCmps_cachedForms[this.id];PTC.infoPage._cleanPreviousInfoPageCmps_cachedForms[this.id]=undefined;if(PTC.isDefined(mform)){PTC.util.removeChildScriptNodes(mform);while(childNodes.length>0)mform.appendChild(childNodes[childNodes.length-1]);PTC.navigation.overwrite(dom,"");dom.appendChild(mform);PTC.util._setMainFormStartingElement(mform)}};
PTC.infoPage.clearCardContents=function(){if(this.getEl()&&this.getEl().dom)PTC.navigation.removeIframes(this.getEl().dom,true);var tabPanel=PTC.infoPage.tabPanel[PTC.infoPage.stdTopTabPanelID];if(tabPanel&&tabPanel.tabManager){tabPanel.tabManager.destroy();delete tabPanel.tabManager}this.removeAll(true);Ext.Panel.prototype.clearCardContents.call(this);if(this.getEl()&&this.getEl().dom)this.getEl().dom.innerHTML="";this.destroy();Ext.garbageCollect();return true};
PTC.infoPage.doLayout=function(infoModel){var mainInfoPanelID=infoModel.id+PTC.infoPage.mainInfoPageIDSuffix;PTC.infoPage.cleanPreviousInfoPageCmps(mainInfoPanelID);PTC.infoPageTableMgr.cleanUp();var itemIdLine=PTC.infoPage.getItemIdPanel(infoModel);var tabPanel=PTC.infoPage.getTopTabPanel(infoModel);var mainPanel=PTC.infoPage.getMainPanel(infoModel,[itemIdLine,tabPanel]);mainPanel.on("afteraction",PTC.infoPage.onAfterAction,mainPanel);var objectsAffectedHandler=PTC.infoPage.onObjectsAffected;if(infoModel.objectsAffectedHandler){PTC.infoPage.log.debug("Overriding default objectsAffected handler for infoPage: ",
mainInfoPanelID);objectsAffectedHandler=PTC.util.convertStringToFunc(infoModel.objectsAffectedHandler)}mainPanel.mon(PTC.action,"objectsaffected",objectsAffectedHandler,mainPanel);PTC.infoPage.displayInfoPage(mainPanel);try{for(var i=0,l=tabPanel.items.items.length;i<l;i++){var item=tabPanel.items.items[i];var dp=new Ext.ux.DockPanel({dockonly:true,constrainHeader:true});item.dockContainer=tabPanel.id;item.plugins=[dp];dp.init(item)}}catch(e){PTC.infoPage.log.error("An error occurred in rendering of the tabs in info page.",
e)}var rightScroller=Ext.query(".x-tab-scroller-right");if(rightScroller.size()===0&&PTC.infoPage.shouldHideAddNewTab(infoModel)!==true)PTC.infoPage.myTab.addNewTabAction(tabPanel.id)};PTC.infoPage.shouldHideAddNewTab=function(infoModel){return infoModel.hideAddNewTab===true};PTC.infoPage.displayInfoPage=function(mainInfoPagePanel){var cardPanel=Ext.getCmp(PTC.navigation.cardManager);cardPanel.add(mainInfoPagePanel);cardPanel.getLayout().setActiveItem(mainInfoPagePanel.id)};
PTC.infoPage._getActionsMenu=function(infoModel){var actionsMenu=PTC.attributeHelper.get("ActionsMenu");var menuId=infoModel.id+"detailsPageActionsMenu";var oidParam=infoModel.data.nmActions.params.oid;var menuButton={xtype:"dynamicMenuButton",cls:"infoPageActionsMenu",id:menuId,text:actionsMenu.label,menu:{xtype:"dynamicMenu",requestUrl:actionsMenu.url,loadOnce:true,id:menuId+"_menu",requestOptions:{parameters:infoModel.data.nmActions.params,onSuccess:function(response){var actionModel=Ext.decode(response.responseText);
var menu=Ext.getCmp(menuId).menu;menu.initializeMenu(actionModel);if(menu.isVisible())menu.positionMenu();PTC.menu.contextOid=oidParam}}},listeners:{click:function(button){PTC.util._setMainFormStartingElement(button.id);this.menu.positionMenu();PTC.menu.fireEvent("dynamicMenuLoad",this.menu)},afterRender:function(button){requestHandler.doRequest(button.menu.requestUrl,button.menu.requestOptions)}}};return menuButton};
PTC.infoPage._getItemIDItems=function(infoModel){var titleInfoPage=infoModel.data.displayType;if(infoModel.data.displayIdentifier!=="null")titleInfoPage+=" - "+infoModel.data.displayIdentifier;titleInfoPage=getUnescapedText(titleInfoPage);PTC.navigation.setPageTitle(titleInfoPage);var headerItems=[];if(infoModel.data.goToLatest)headerItems.push({id:infoModel.id+"_gotToLatest",xtype:"panel",border:false,cls:"goToLatest",html:infoModel.data.goToLatest});if(infoModel.data.nmActions)headerItems.push(PTC.infoPage._getActionsMenu(infoModel));
if(infoModel.toggleButtonConfigs)infoModel.toggleButtonConfigs.each(function(item){item.style="";Ext.applyIf(item,{xtype:"button",cls:"toggle"});headerItems.push(item)});headerItems.push(PTC.infoPage._getIdentityPanel(infoModel));var helpButton=PTC.help.getHelpButtonConfig(infoModel.help);if(helpButton)headerItems.push(helpButton);if(infoModel.data.infoPageTitleBarLifeCycleState)headerItems.push({id:infoModel.id+"infoPageTitleBarLifeCycleState",xtype:"panel",border:false,cls:"state",html:infoModel.data.infoPageTitleBarLifeCycleState});
var headerPanel={id:infoModel.id+"_itemIDHeaderPanel",xtype:"panel",layout:"column",border:false,items:headerItems};return headerPanel};
PTC.infoPage.getIdentityHTML=function(infoModel){var itemIdIcon=infoModel.data.type_icon?infoModel.data.type_icon:"";var htmlContent=itemIdIcon+"<span id='infoPageIdentityDisplayText'>"+"<span id='infoPageIdentityDisplayType'>"+infoModel.data.displayType+"</span>";if(infoModel.data.displayIdentifier!=="null")htmlContent+=" - <span id='infoPageIdentityObjectIdentifier'>"+infoModel.data.displayIdentifier+"</span>";if(infoModel.data.infoPageTitleFolderDomain)htmlContent+=" <span id='infoPageFolderDomain'>("+
infoModel.data.infoPageTitleFolderDomain+")</span>";htmlContent+="  "+infoModel.statusGlyphs+"</span>";return htmlContent};PTC.infoPage._getIdentityPanel=function(infoModel){return new Ext.Panel({id:infoModel.id+"infoPageIdentityDisplayPanel",border:false,cls:"infoPage-Identity",html:PTC.infoPage.getIdentityHTML(infoModel)})};PTC.infoPage._tabSetRenderers=[];PTC.infoPage.registerTabRenderer=function(id,func){PTC.infoPage._tabSetRenderers[id]=func};PTC.infoPage.stdTlnTabPanelID="thirdLevelNavPanel";
PTC.infoPage.registerTabRenderer("myTab",function(actionConfig,infoModel){return PTC.infoPage.myTab.tabRenderer(actionConfig,infoModel)});PTC.infoPage.defaultActivateTabHandler=function(actionConfig){getElementHtml(Form.serialize(getMainForm()),actionConfig.id,true,actionConfig.actionURL)};PTC.infoPage.defaultActivateTabHandlerListener=function(){PTC.infoPage.defaultActivateTabHandler(this.actionConfig)};
PTC.infoPage.registerTabRenderer("defaultTabRenderer",function(actionConfig,infoModel){var iconCls,tabTip;if(PTC.debug.isJCADebug()&&actionConfig.id.indexOf("jcaDebug_action_model_report")>-1){iconCls="tab-jcaDebug";tabTip="Information about this tab set"}var defaultPanel=new Ext.Panel({html:'<div id="'+actionConfig.id+'"> <div style="background: url(netmarkets/javascript/ext/resources/images/default/shared/blue-loading.gif) no-repeat center center; height:800px">&nbsp;</div></div>',title:actionConfig.text,
stateful:false,iconCls:iconCls,tabTip:tabTip,tabCls:PTC.infoPage.myTab.getTabCls(PTC.infoPage.myTab.getTabState({admin:infoModel.tabSet.admin,isPublic:actionConfig.isPublic,editable:actionConfig.editable})),id:PTC.infoPage.TabUtils.getTabIdPrefix(infoModel)+"_"+actionConfig.actionType+"_"+actionConfig.actionName,allowContextMenu:actionConfig.editable?actionConfig.editable:false,editable:actionConfig.editable?actionConfig.editable:false});defaultPanel.actionConfig=actionConfig;defaultPanel._reloadContents=
PTC.infoPage.defaultActivateTabHandlerListener;defaultPanel.on("activate",PTC.infoPage.defaultActivateTabHandlerListener,defaultPanel,{single:true});return defaultPanel});PTC.infoPage.onPanelActivate=function(tab){this.setActiveTab(tab)};
PTC.infoPage._getTabSet=function(infoModel,activeTab){try{var actions=infoModel.tabSet&&infoModel.tabSet.items?infoModel.tabSet.items:[];var tabSet=[];PTC.infoPage.myTab.initializeMyTabConfig(infoModel);for(var i=0,l=actions.length;i<l;i++){var actionConfig=actions[i];var panel;var func=PTC.infoPage._tabSetRenderers[actionConfig.actionID];if(!Ext.isFunction(func))if(actionConfig.items||actionConfig.oid)func=PTC.infoPage._tabSetRenderers.myTab;else func=PTC.infoPage._tabSetRenderers.defaultTabRenderer;
if(actionConfig.actionName==="myTab"&&(!infoModel.thirdLevelNavModel||PTC.infoPage.isThirdLevelNavHasNoOrOneTable(infoModel.thirdLevelNavModel)));else{if(!actionConfig.text)actionConfig.text="???"+actionConfig.actionID+"???";panel=func(actionConfig,infoModel);if(panel.id&&panel.id.startsWith("ext-comp"))panel.id=actionConfig.actionName;if(!panel.actionID)panel.actionID=actionConfig.actionID;panel.on("activate",PTC.infoPage.onPanelActivate,activeTab);tabSet[tabSet.length]=panel}}}catch(e){jsca.log(e)}return tabSet};
PTC.infoPage.isThirdLevelNavHasNoOrOneTable=function(thirdLevelModel){if(!thirdLevelModel.items)return true;if(thirdLevelModel.items.length>1)return false;if(thirdLevelModel.items.length==1&&!thirdLevelModel.items[0].items)return true;if(thirdLevelModel.items.length==1&&thirdLevelModel.items[0].items.length==1)return true;return false};PTC.infoPage.goTo=function(oid,params){var url=PTC.infoPage.getURL(oid,params);if(url)PTC.navigation.loadContent(url)};
PTC.infoPage.getURL=function(oid,params){if(!params)params={};if(oid)params.oid=oid;var infoPageData=PTC.attributeHelper.get("InfoPage");if(infoPageData){var url=infoPageData.url+"?"+Object.toQueryString(params);return url}};
PTC.infoPage.refreshTopOnSuccess=function(ajaxResponse,suppressHistoryChange,callback){function updateInfoModel(tabPanel,newInfoModel){Ext.apply(newInfoModel,new PTC.infoPage.InfoModel);Ext.applyIf(newInfoModel,tabPanel.infoModel);tabPanel.myTabConfig.thirdLevelNavModel=newInfoModel.thirdLevelNavModel;tabPanel.infoModel=newInfoModel;return newInfoModel}function updateCustomizeMenus(tabPanel,infoModel,oid){for(var i=0,tabs=tabPanel.items.items,tabL=tabs.length;i<tabL;i++)if(tabs[i].thirdLevelNavModel){tabs[i].thirdLevelNavModel=
infoModel.thirdLevelNavModel;tabs[i].initialConfig.thirdLevelNavModel=infoModel.thirdLevelNavModel;var customizeMenu=tabs[i].getCustomizeMenu();customizeMenu.initialConfig.menu=infoModel.thirdLevelNavModel;if(customizeMenu.menu.items)for(var j=0,custMenu=customizeMenu.menu.items.items,custL=custMenu.length;j<custL;j++){var subMenu=custMenu[j].items;if(subMenu)for(var k=0,subL=subMenu.length;k<subL;k++)if(subMenu[k].actionURL){var newActionUrl=PTC.util.replaceURLParam(subMenu[k].actionURL,"oid",oid);
subMenu[k].actionURL=newActionUrl;var actionCmp=tabs[i].getCustomizeMenuItem(subMenu[k].actionType,subMenu[k].actionName);actionCmp.actionURL=newActionUrl}}}}function doTopRefresh(divIdToUpdate,infoModel){var top=Ext.getCmp(divIdToUpdate);top.removeAll(true);PTC.pageTitleSet=false;var items=PTC.infoPage._getItemIDItems(infoModel);top.add(items);top.doLayout()}var tabPanel=PTC.infoPage.getTabPanel();var divIdToUpdate=tabPanel.infoModel.id+PTC.infoPage.itemDisplayID;var jsonObj=Ext.decode(ajaxResponse.responseText);
var oid=ajaxResponse.request.parameters.oid;var infoModel=updateInfoModel(tabPanel,jsonObj);updateCustomizeMenus(tabPanel,infoModel,oid);PTC.infoPage.fireEvent("beforeRender",infoModel);PTC.dynamicRefresh.doFadeOut(divIdToUpdate);doTopRefresh(divIdToUpdate,infoModel);PTC.infoPageTableMgr.setAllRenderedTablesAsDirty();PTC.dynamicRefresh.doFadeIn(divIdToUpdate);var newUrl=PTC.util.replaceURLParamInThisWindow("oid",encodeURIComponent(oid),suppressHistoryChange);PTC.util.setFormAction(getMainForm(),newUrl);
PTC.infoPage.fireEvent("afterRender",infoModel);if(callback)callback(tabPanel,infoModel)};
PTC.infoPage.refreshTop=function(oid,suppressHistoryChange,callback){this.getJsonRequestUrl=function(){var urlToken=PTC.navigation.getTokenFromUrl(PTC.attributeHelper.get("InfoPage").url);return getBaseHref()+urlToken+"/json"};function getRequestParams(oid){var params=PTC.util.extractAllParams(window.location.href);params.oid=oid;return params}PTC.infoPage.log.debug("Refreshing top of infopage to represent oid: ",oid);var changeSuppressed=suppressHistoryChange;var options={method:"get",asynchronous:false,
parameters:getRequestParams(oid),onSuccess:function(response){PTC.infoPage.refreshTopOnSuccess(response,changeSuppressed,callback)},onFailure:function(response){PTC.infoPage.log.error("Request failed to refresh infopage for oid '",oid,"'. Infopage may have incorrect, out of date data.");PTC.messaging.showMessage()}};var transport=requestHandler.doRequest(this.getJsonRequestUrl(),options)};PTC.infoPage._makeActionItemId=function(tabID,actionID){return tabID+"_"+actionID};
PTC.infoPage.onAfterAction=function(formResult){try{PTC.infoPage._handleAffectedObjects(formResult)}finally{formResult.hasInfoPageBeenProcessed=true}return!formResult.hasAnyOids()};PTC.infoPage.onObjectsAffected=function(formResult){if(!formResult.hasInfoPageBeenProcessed)PTC.infoPage._handleAffectedObjects(formResult);return true};
PTC.infoPage.refreshTabs=function(tabPanel,infoModel){var i,tab,activeTab=tabPanel.getActiveTab(),nonActiveTabs=[];if(tabPanel&&tabPanel.items){i=tabPanel.items.items.length;while(i--){tab=tabPanel.items.items[i];if(tab.actionConfig)tab.actionConfig=infoModel.tabSet.items[i];if(activeTab.id!==tab.id&&tab.id!=="new_tab_action")nonActiveTabs.push(tab)}}if(activeTab.tabContentManager)activeTab.tabContentManager.reloadContents();else if(typeof activeTab._reloadContents==="function")activeTab._reloadContents();
else{PTC.action.log.error("a tab does not know how to be reloaded",activeTab);return false}i=nonActiveTabs.length;while(i--){tab=nonActiveTabs[i];if(tab.id&&tab.id.endsWith("StructureGWT")||!tab.thirdLevelNavModel){tab.un("activate",tab._reloadContents,tab,{single:true});tab.on("activate",tab._reloadContents,tab,{single:true})}}return true};
PTC.infoPage._handleAffectedObjects=function(formResult){var currentInfoPageOid=decodeURIComponent(extractParamValue(window.location.href,"oid"));var newOid=formResult.getUpdatedOid(currentInfoPageOid);var refreshed=true;if(newOid)if((newOid!=currentInfoPageOid||formResult.actionName==="undocheckout")&&PTC.infoPage.areGWTTabsPresent())PTC.infoPage.goTo(newOid);else{PTC.infoPage.refreshTop(newOid,true,PTC.infoPage.refreshTabs);refreshed=true}var deleted=formResult.getDeletedOids();for(var i=0,l=deleted.length;i<
l;i++)if(deleted[i]===currentInfoPageOid){if(Ext.History.getToken())Ext.History.back();else PTC.navigation.goHome();refreshed=true;break}if(!refreshed)PTC.navigation.submitForm()};PTC.infoPage.areGWTTabsPresent=function(){var tabPanel=PTC.infoPage.getTabPanel();if(!tabPanel||!tabPanel.items)return false;var i=tabPanel.items.items.length;while(i--){var tab=tabPanel.items.items[i];if(tab.id&&tab.id.endsWith("StructureGWT"))return true}return false};
function submitForm(isSearchBool,isClearBool){getMainForm().fireSearch.value=isSearchBool;getMainForm().pickerClear.value=isClearBool;PTC.navigation.submitForm()}function pickerAttributesClearCriteria(){getMainForm().fireSearch.value="false";getMainForm().pickerClear.value="true";PTC.navigation.submitForm()}
function checkPickerSearchPressed(evt){if(!evt)evt=window.event;if(evt.keyCode)code=evt.keyCode;if(evt.which)code=evt.which;if(code!=Event.KEY_RETURN)return;clickSearchButton();Event.stop(evt);return false}function clickSearchButton(){if(document.getElementsByName("pickerSearch")){var pickerSearchButton=document.getElementsByName("pickerSearch")[0];pickerSearchButton.click()}}function closePickerWindow(){window.close()}
function getSelectedValue(){var isChecked=false;var selectedOidsArray=getSelectedItems();var selectedOids="";var len=selectedOidsArray.length;var paramOid="&selectedOids=";for(var i=0;i<len;i++){var selectedRow=getSelectedRow(selectedOidsArray[i].value);if(selectedRow){var oid=selectedRow.get("oid");isChecked=true;selectedOids=selectedOids+paramOid+oid}else PTC.log.error("no row found in the picker table with the context: "+selectedOidsArray[i].value)}if(!isChecked){JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.NOTHING_SELECTED");
return false}if(typeof window.callback!="function")try{if(!eval("opener.window."+window.pickerCallback));}catch(exception){var openerPrefix="window.";if(parent&&PTC.lightbox.isLightbox(window))openerPrefix="parent.";if(!eval(openerPrefix+window.pickerCallback))JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.OPENER_WINDOW_CLOSED")}var iterationValue="";if(document.getElementsByName("iterationValue")){iterationValue=document.getElementsByName("iterationValue");if(iterationValue!=
null&&iterationValue.length>0)iterationValue=document.getElementsByName("iterationValue")[0].value;else iterationValue=""}iterationValue="&iterationValue="+iterationValue;var versionValue="";if(document.getElementsByName("versionValue")){versionValue=document.getElementsByName("versionValue");if(versionValue!=null&&versionValue.length>0)versionValue=document.getElementsByName("versionValue")[0].value;else versionValue=""}versionValue="&versionValue="+versionValue;var searchTypeForTask="";if(document.getElementsByName("searchTypeForTask")){searchTypeForTask=
document.getElementsByName("searchTypeForTask");if(searchTypeForTask!=null&&searchTypeForTask.length>0)searchTypeForTask=document.getElementsByName("searchTypeForTask")[0].value;else searchTypeForTask=""}searchTypeForTask="&searchTypeForTask="+searchTypeForTask;var objectType="";if(document.getElementsByName("objectType")){objectType=document.getElementsByName("objectType");if(objectType!=null&&objectType.length>0)objectType=document.getElementsByName("objectType")[0].value;else objectType=""}var pickerObjectType=
"&objectType="+objectType;var includeTypeInstanceId="";if(document.getElementsByName("includeTypeInstanceId")){includeTypeInstanceId=document.getElementsByName("includeTypeInstanceId");if(includeTypeInstanceId!=null&&includeTypeInstanceId.length>0)includeTypeInstanceId=document.getElementsByName("includeTypeInstanceId")[0].value;else includeTypeInstanceId=""}var pickerIncludeTypeInstanceId="&includeTypeInstanceId="+includeTypeInstanceId;var showRecentlyUsed="";if(document.getElementsByName("showRecentlyUsed")){showRecentlyUsed=
document.getElementsByName("showRecentlyUsed");if(showRecentlyUsed!=null&&showRecentlyUsed.length>0)showRecentlyUsed=document.getElementsByName("showRecentlyUsed")[0].value;else showRecentlyUsed=""}showRecentlyUsed="&showRecentlyUsed="+showRecentlyUsed;if(window.pickerCallback=="contextPickerCallBackMultiSelect")if(len>multiSelectPrefVal){var insertsArr=new Array;insertsArr[0]=multiSelectPrefVal;JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.MULTISELECT_CONTEXTPICKER_LIMIT_ALERT",
"",insertsArr);return false}var showWorkingCopy="";if(document.getElementsByName("showWorkingCopy")){showWorkingCopy=document.getElementsByName("showWorkingCopy");if(showWorkingCopy!=null&&showWorkingCopy.length>0)showWorkingCopy=document.getElementsByName("showWorkingCopy")[0].value;else showWorkingCopy=""}showWorkingCopy="&showWorkingCopy="+showWorkingCopy;var url=window.pickedDataFetcher;var loader=new pAjax.ContentLoader(url,updateParent,null,"POST","attributes="+window.pickedAttributes+selectedOids+
pickerObjectType+iterationValue+versionValue+searchTypeForTask+pickerIncludeTypeInstanceId+showRecentlyUsed+showWorkingCopy);if("doNothing"!=window.pickerCallback){setTimeout(function(){PTC.wizard.close()},1E3);return false}}function getSelectedRow(selectedRowContextString){var tables=tableUtils.getTables();if(!tables||tables.length<1)throw new Error("no table found on the page");return tableUtils.getTableRowFromContext(tables[0].id,selectedRowContextString)}
function checkMemberOfContainer(){if(document.getElementById("memberOfContainer").checked==true)getMainForm().memberOfContainer.value=1}
function updateParent(){var calledFromAdvSearch="";var myJSONObject=eval("("+this.req.responseText+")");var context="";if(document.getElementsByName("pickerComponent")){var pc=document.getElementsByName("pickerComponent");if(pc!=null&&pc.length>0&&pc[0].value=="true"){var ctx=document.getElementsByName("openerCompContext");if(ctx!=null&&ctx.length>0)context=ctx[0].value}}var displayFieldId="";if(document.getElementsByName("displayFieldId")){var obj=document.getElementsByName("displayFieldId");if(obj!=
null&&obj.length>0)displayFieldId=context+obj[0].value}var hiddenId="";if(document.getElementsByName("hiddenId")){var obj=document.getElementsByName("hiddenId");if(obj!=null&&obj.length>0)context=""}var pickerId="";if(document.getElementsByName("pickerId")){var obj=document.getElementsByName("pickerId");if(obj!=null&&obj.length>0)pickerId=context+obj[0].value}if(document.getElementsByName("calledFromAdvSearch")){var obj=document.getElementsByName("calledFromAdvSearch");if(obj!=null&&obj.length>0)calledFromAdvSearch=
obj[0].value}var displayAttr="";if("true"==calledFromAdvSearch)displayAttr=window.pickedAttributes;var openerAvailable="true";try{if(!eval("opener.window."+window.pickerCallback))openerAvailable="false"}catch(exception){openerAvailable="false"}var callBackFunctionFound="false";if(typeof window.callback=="function")window.callback(myJSONObject,pickerId);else if("false"==openerAvailable)try{var openerPrefix="";if(parent&&PTC.lightbox.isLightbox(window))openerPrefix="parent.";if("true"==calledFromAdvSearch)eval(openerPrefix+
window.pickerCallback+"(myJSONObject,pickerId,displayAttr,displayFieldId)");else eval(openerPrefix+window.pickerCallback+"(myJSONObject,pickerId)")}catch(exception){JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.PICKER_CALL_BACK_ERROR",window.pickerCallback+" exception: "+exception)}else try{for(var i=0;i<=100;i++)if(eval("opener.window."+window.pickerCallback)){callBackFunctionFound="true";break}if(callBackFunctionFound=="true")if("true"==calledFromAdvSearch)eval("opener.window."+
window.pickerCallback+"(myJSONObject,pickerId,displayAttr,displayFieldId)");else eval("opener.window."+window.pickerCallback+"(myJSONObject,pickerId)");else if("true"==calledFromAdvSearch)eval(window.pickerCallback+"(myJSONObject,pickerId,displayAttr,displayFieldId)");else eval(window.pickerCallback+"(myJSONObject,pickerId)")}catch(exception){JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.PICKER_CALL_BACK_ERROR",window.pickerCallback+" exception: "+exception)}}
var pAjax=new Object;pAjax.ContentLoader=function(url,onload,onerror,method,params){this.url=url;this.req=null;this.shouldContinue=true;this.onload=onload;this.onerror=onerror?onerror:this.defaultError;this.shouldContinue=this.loadXMLDoc(url,method,params);return this.shouldContinue};
pAjax.ContentLoader.prototype={loadXMLDoc:function(url,method,params){var contentType;if(!method)method="GET";if(method=="POST")contentType="application/x-www-form-urlencoded";this.req=newHttp();if(this.req)try{var loader=this;this.req.open(method,url,false);if(contentType)this.req.setRequestHeader("Content-Type",contentType);this.req.send(params);loader.onReadyState()}catch(err){}return loader.shouldContinue},onReadyState:function(){var req=this.req;var ready=req.readyState;var httpStatus=req.status;
if(httpStatus==200||httpStatus==0)this.onload.call(this);else{this.onerror.call(this);this.shouldContinue=false}},defaultError:function(){alert("Error : "+"\n\n ready state :  "+this.req.readyState+"\n\n status : "+this.req.status+"\n\n headers : "+this.req.getAllResponseHeaders())}};function clearLastSelection(){jsca.unSelectHiddenCheckboxes(resultParams.searchResultsViewId);return true}function beforeSelectContext(combo,record,index){var selectionOptionVal=record.get("value");return true}
function addToMainFormAction(containerRef){var mainForm=getMainForm();mainForm.action=removeParamFromString("containerRef",mainForm.action);mainForm.action=removeParamFromString("oid",mainForm.action);if(containerRef.indexOf(":")>-1){var containerRefStr=containerRef;if(!containerRef.startsWith("OR:"))containerRefStr="OR:"+containerRef;mainForm.action=mainForm.action+"&containerRef="+containerRefStr;if(containerRef.indexOf(",")==-1)mainForm.action=mainForm.action+"&oid="+containerRefStr}}
function changeListener(){}
function selectRecentlyVisitedContextMultiSelect(pickerId){var group=Ext.getCmp("chkGroupContextPicker");if($(pickerId+"$label$").value!="FIND_CONTEXT"){for(var i=0;i<group.items.getCount();i++)group.items.get(i).disable();document.getElementById("memberOfContainer").disabled=false;document.getElementById("searchInUserOrg").disabled=false;$(pickerId).value=$(pickerId+"$label$").value}else if($(pickerId+"$label$").value=="FIND_CONTEXT"){var contextsChecked="";for(var i=0;i<group.items.getCount();i++){group.items.get(i).enable();
if(group.items.get(i).getValue()==true){if(contextsChecked!="")contextsChecked=contextsChecked+",";contextsChecked=contextsChecked+group.items.get(i).getName()}}disableMemberOfCheckBoxes();$(pickerId).value=contextsChecked}addToMainFormAction($(pickerId).value)}
function selectRecentlyVisitedContextMultiSelectSearchPage(pickerId){if($(pickerId+"$label$").value!="FIND_CONTEXT"){document.getElementById("memberOfContainer").disabled=false;document.getElementById("searchInUserOrg").disabled=false;$(pickerId).value=$(pickerId+"$label$").value}else if($(pickerId+"$label$").value=="FIND_CONTEXT"){var contextsChecked="";for(var i=0;i<PTC.search.recentlyUsedContexts.getCount();i++){var item=Ext.getCmp(PTC.search.recentlyUsedContexts.itemAt(i).id);if(item.getValue()==
true&&item.getName()!="all_contexts"){if(contextsChecked!="")contextsChecked=contextsChecked+",";contextsChecked=contextsChecked+item.getName()}}disableMemberOfCheckBoxes();$(pickerId).value=contextsChecked}addToMainFormAction($(pickerId).value)}
function contextPickerCallBackMultiSelect(objects,pickerId){var multiSelectPrefVal=5;if(document.getElementById("multiSelectPrefVal")!=null)multiSelectPrefVal=document.getElementById("multiSelectPrefVal").value;var arrPickedObjects=objects.pickedObject;var arrAlreadyAddedContexts=new Array;var optionDisplayVal=objects.pickedObject[0]["containerInfo.name"];var optionInternalVal=objects.pickedObject[0]["oid"];var firstPanel=Ext.getCmp("chkGroupContextPicker");var isAlreadyAdded=false;var contextSelected=
"";var counter=0;var tempArray=new Array;for(var j=0;j<firstPanel.items.getCount();j++){var tempItem=firstPanel.items.get(j);tempArray[j]=tempItem}for(var j=0;j<arrPickedObjects.length;j++){var optionDisplayVal=objects.pickedObject[j]["containerInfo.name"];var optionInternalVal=objects.pickedObject[j]["oid"];for(var i=0;i<firstPanel.items.getCount();i++)if(firstPanel.items.get(i).getName()==optionInternalVal){var tempItem=firstPanel.items.get(i);arrAlreadyAddedContexts[counter]=tempItem;counter++}}for(var aa=
0;aa<arrAlreadyAddedContexts.length;aa++){var item=arrAlreadyAddedContexts[aa];var optionInternalVal=item.getName();for(var ab=0;ab<tempArray.length;ab++){var item1=tempArray[ab];var optionInternalVal1=item1.getName();if(optionInternalVal1==optionInternalVal)tempArray.splice(ab,1)}}var itemsArray=new Array;for(var k=0;k<arrPickedObjects.length;k++){var optionDisplayVal=objects.pickedObject[k]["containerInfo.name"];var optionInternalVal=objects.pickedObject[k]["oid"];var newItem=null;var imageStr=
"";if(optionInternalVal.indexOf("Product")>-1)imageStr="prod.gif";else if(optionInternalVal.indexOf("Project")>-1)imageStr="project.gif";else if(optionInternalVal.indexOf("Library")>-1)imageStr="navigation_library.gif";if($(pickerId+"$label$").value=="FIND_CONTEXT")newItem=new PTC.search.RemovableCheckbox({boxLabel:'<img src="netmarkets/images/'+imageStr+'" /> '+optionDisplayVal,name:""+optionInternalVal,id:""+optionInternalVal,checked:true,disabled:false,listeners:{check:changeListener},onRemoveFunction:PTC.search.RemoveContextCheckbox});
else{$(pickerId+"$label$").value="FIND_CONTEXT";disableMemberOfCheckBoxes();newItem=new PTC.search.RemovableCheckbox({boxLabel:'<img src="netmarkets/images/'+imageStr+'" /> '+optionDisplayVal,name:""+optionInternalVal,id:""+optionInternalVal,checked:true,disabled:false,listeners:{check:changeListener},onRemoveFunction:PTC.search.RemoveContextCheckbox})}itemsArray[k]=newItem}var tempLength=itemsArray.length;for(var j=0;j<tempArray.length;j++){var tempItem=tempArray[j];itemsArray[tempLength]=tempItem;
tempLength++}itemsArray.splice(multiSelectPrefVal,multiSelectPrefVal);firstPanel.destroy();var fp=new Ext.Panel({renderTo:"recentlyUsedContexts",id:"chkGroupContextPicker",xtype:"container",cls:"x-form-check-group",layout:"table",defaultType:"checkbox",border:false});var panel2=Ext.getCmp("chkGroupContextPicker");for(var k=0;k<itemsArray.size();k++){var item=itemsArray[k];var optionInternalVal=item.initialConfig.name;var isChecked=item.initialConfig.checked;if(isChecked==true)if(contextSelected.length==
0)contextSelected=contextSelected+optionInternalVal;else contextSelected=contextSelected+","+optionInternalVal;var newItemToAdd=new PTC.search.RemovableCheckbox({boxLabel:""+item.initialConfig.boxLabel,name:""+optionInternalVal,id:""+optionInternalVal,checked:isChecked,listeners:{check:changeListener},onRemoveFunction:PTC.search.RemoveContextCheckbox});panel2.add(newItemToAdd);panel2.doLayout()}if($(pickerId+"$label$").value!="FIND_CONTEXT")for(var i=0;i<panel2.items.getCount();i++)panel2.items.get(i).disable();
$(pickerId).value=contextSelected}
function contextPickerCallBackMultiSelectSearchPage(objects,pickerId){var arrPickedObjects=objects.pickedObject;var contextList="";for(var j=0;j<arrPickedObjects.length;j++){var oid=objects.pickedObject[j]["oid"];if(contextList.length!=0)contextList=contextList+",";contextList=contextList+oid}updateSearchContextPreference(contextList);var checkedContextList=new Array;var indexCheckedContextList=0;for(var i=0;i<PTC.search.recentlyUsedContexts.getCount();i++){var item=Ext.getCmp(PTC.search.recentlyUsedContexts.itemAt(i).id);
if(item.getValue()==true&&item.getName()!="all_contexts")checkedContextList[indexCheckedContextList++]=item.getName()}for(var i=0;i<arrPickedObjects.length;i++){var alreadyPresent=false;for(var j=0;j<PTC.search.recentlyUsedContexts.getCount();j++){var itemId=PTC.search.recentlyUsedContexts.itemAt(j).id;var areEqual=compareOids(arrPickedObjects[i]["oid"],itemId);if(areEqual){alreadyPresent=true;checkedContextList[indexCheckedContextList++]=itemId;break}}if(!alreadyPresent){var newItem=createNewItem(arrPickedObjects[i]);
PTC.search.recentlyUsedContexts.add(newItem);checkedContextList[indexCheckedContextList++]=newItem.id}}PTC.search.sortRecentlyUsedContexts();PTC.search.renderRecentlyUsedContexts();var selectedContexts="";for(var i=0;i<checkedContextList.length;i++){var item=Ext.getCmp(checkedContextList[i]);var isFolder=false;if(item.getId().indexOf("folder")!=-1)isFolder=true;if(item.getValue()==false&&!isFolder){item.suspendEvents();item.setValue(true);item.resumeEvents();if(selectedContexts!="")selectedContexts=
selectedContexts+",";selectedContexts=selectedContexts+checkedContextList[i]}}if(checkedContextList.length==0){var allContexts=Ext.getCmp("all_contexts");if(allContexts.getValue()==false){allContexts.suspendEvents();allContexts.setValue(true);allContexts.resumeEvents()}}else{var allContexts=Ext.getCmp("all_contexts");if(allContexts.getValue()==true){allContexts.suspendEvents();allContexts.setValue(false);allContexts.resumeEvents()}}$(pickerId).value=selectedContexts;if(parent.allContextsCheckedStatus!=
0){parent.allContextsCheckedStatus=0;PTC.search.callUpdateAllContextOnServer("updateallContextsSelectedItem",PTC.search.ContexPickerData.allContextsSelectedName+"##0")}PTC.search.checkAllFavSelected()}function compareOids(oid1,oid2){if(oid1.startsWith("OR:")||oid1.startsWith("VR:"))oid1=oid1.substring(3);if(oid2.startsWith("OR:")||oid2.startsWith("VR:"))oid2=oid2.substring(3);return oid1==oid2}function createNewItem(pickedObject){return PTC.search.createNewItem(pickedObject)}
function updateSearchContextPreference(contextList){Ext.Ajax.request({url:"netmarkets/jsp/search/addContextToList.jsp",params:{contextsToAdd:contextList},mode:"POST"})}launchJCAPopupAction=function(actionNameToLaunch){var actionVar=document.getElementsByName(actionNameToLaunch);if(actionVar!="undefined"&&actionVar[0]!="undefined")actionVar[0].click()};function searchClose(){closePopupAndRefreshOpener()}
function disableMemberOfCheckBoxes(){if(document.getElementById("memberOfContainer")!=null&&document.getElementById("searchInUserOrg")!=null){document.getElementById("memberOfContainer").checked=false;document.getElementById("searchInUserOrg").checked=false;document.getElementById("memberOfContainer").disabled=true;document.getElementById("searchInUserOrg").disabled=true}}
function selectRecentlyVisitedContextJCACombo(pickerId){$(pickerId).value=$(pickerId+"$label$").value;addToMainFormAction($(pickerId).value)}
function contextPickerCallBackJCACombo(objects,pickerId){var comboBox=document.getElementById(pickerId+"$label$");var totalNoOfOptions=comboBox.length;var isObjectAlreadyAdded=false;var alreadyAddedIndex=0;for(var optionLength=0;optionLength<totalNoOfOptions;optionLength++){theElement=comboBox.options[optionLength].value;if(theElement==objects.pickedObject[0]["oid"]){isObjectAlreadyAdded=true;alreadyAddedIndex=optionLength}}if(isObjectAlreadyAdded==true){comboBox.options[alreadyAddedIndex].selected=
true;$(pickerId).value=$(pickerId+"$label$").value}else{var optionsArrayDisplayValues=new Array(1);var optionsArrayInternalValues=new Array(1);optionsArrayDisplayValues[0]=objects.pickedObject[0]["containerInfo.name"];optionsArrayInternalValues[0]=objects.pickedObject[0]["oid"];document.getElementById(pickerId).value=objects.pickedObject[0]["oid"];for(var optionLengthn=0;optionLengthn<totalNoOfOptions;optionLengthn++){var tempInternalVal=comboBox.options[optionLengthn].value;var tempDisplayVal=comboBox.options[optionLengthn].text;
optionsArrayDisplayValues[optionLengthn+1]=tempDisplayVal;optionsArrayInternalValues[optionLengthn+1]=tempInternalVal}optionsArrayInternalValues.splice(5,1);optionsArrayDisplayValues.splice(5,1);for(var k=0;k<optionsArrayInternalValues.length;k++)if(comboBox.options[k]!=null){comboBox.options[k].text=optionsArrayDisplayValues[k];comboBox.options[k].value=optionsArrayInternalValues[k]}else{comboBox.options.add(document.createElement("OPTION"));comboBox.options[k].text=optionsArrayDisplayValues[k];
comboBox.options[k].value=optionsArrayInternalValues[k]}comboBox.options[0].selected=true;document.getElementById(pickerId).value=objects.pickedObject[0]["oid"]}}Ext.namespace("PTC.search.picker");Ext.apply(PTC.search.picker,new Ext.util.Observable);PTC.search.picker.LB_CONTENT_IFRAME_ID="lbContentIframe";
PTC.search.picker.populateFunc=function(grid){grid.populatePreSelectionsConfig=function(preSelecionObj){preSelecionObj.comparableFn="PTC.search.picker.cmpFunction";var openerCompContext="";var openerContext=getMainForm().openerCompContext;if(typeof openerContext=="string")openerCompContext=getMainForm().openerCompContext.value;else openerCompContext=getMainForm().openerCompContext[0].value;var pickerId=getMainForm().pickerId.value;var hiddenFieldId=openerCompContext+pickerId;var targetElement=eval(window.opener.document.getElementById(""+
hiddenFieldId+""));var defaultValues;if(targetElement!=null)if(targetElement.type=="text"||targetElement.type=="hidden")defaultValues=targetElement.value;else for(var j=0;j<targetElement.options.length;j++)if(j==0)defaultValues=targetElement.options[j].value;else defaultValues=defaultValues+","+targetElement.options[j].value;if(defaultValues!=="")preSelecionObj.oids=defaultValues.split(",")}};
PTC.search.picker.cmpFunction=function(record,giventype){var id=record.id;var node=id.substring(id.lastIndexOf("$")+1,id.lastIndexOf("!*"));node=PTC.search.picker.removeEscapeChar(node);if(node==giventype)return true;else return false};PTC.search.picker.removeEscapeChar=function(node){var sNode=node.replace(new RegExp("[\\\\]+","gm"),"");sNode=sNode.substring(sNode.lastIndexOf("^")+1);sNode=sNode.substring(sNode.lastIndexOf("|")+1);return sNode};
PTC.search.picker.getFieldValue=function(fieldId,attName){attName=attName.toLowerCase();var field=$(fieldId);if(field)return field.getAttribute(attName);return""};PTC.search.picker.getDisplayFieldValue=function(displayFieldName){var displayField=document.getElementsByName(displayFieldName)[0];var displayValue="";if(displayField){displayValue=displayField.value;if(displayField.options)displayValue=""}return displayValue};
PTC.search.picker.getPickerFields=function(findBtnId){var jsonString=PTC.search.picker.getFieldValue(findBtnId,"pickerJson");return Ext.util.JSON.decode(jsonString)};PTC.search.picker.getPickerAction=function(findBtnId){return PTC.search.picker.getFieldValue(findBtnId,"pickerAction")};
PTC.search.picker.getPickerInfo=function(pickerId){var findBtnId=pickerId+"_FIND_BTN";var action=PTC.search.picker.getPickerAction(findBtnId);var fields=PTC.search.picker.getPickerFields(findBtnId);var info={};info.action=action;info.fields=fields;return info};
PTC.search.picker.loadPicker=function(pickerId,displayId,target,initialSelectedPickerValues){var pickerInfo;if(target===PTC.search.picker.LB_CONTENT_IFRAME_ID&&parent)pickerInfo=parent.PTC.search.picker.getPickerInfo(pickerId);else pickerInfo=opener.window.PTC.search.picker.getPickerInfo(pickerId);var action=pickerInfo.action;var fields=pickerInfo.fields;var defaultKeyword=PTC.search.picker.getDisplayFieldValue(displayId);if(defaultKeyword.length>0)fields.defaultKeyword=defaultKeyword;if(window.location.href.indexOf("portlet=poppedup")>=
0)fields.portlet="poppedup";fields.initialSelectedPickerValues=initialSelectedPickerValues;var myForm=new JsonForm(pickerId+"_FORM",action,fields,target);myForm.submit()};
PTC.search.picker.structuredEnumerationCallBack=function(pickerObject,fieldId,attr,displayFieldId){var pickedObjects=pickerObject.pickedObject;var internalFieldToUpdate=document.getElementById(fieldId);var displayFieldToUpdate=document.getElementById(displayFieldId);var newInternalValue="";var newDisplayValue="";for(var i=0;i<pickedObjects.length;i++){var internalName=pickedObjects[i]["internalName"];var displayAttribute=pickedObjects[i]["name"];newDisplayValue+=displayAttribute+", ";newInternalValue+=
internalName+",";displayFieldToUpdate.title=pickedObjects[i]["fullPath"]}newInternalValue=newInternalValue.substring(0,newInternalValue.length-1);newDisplayValue=newDisplayValue.substring(0,newDisplayValue.length-2);internalFieldToUpdate.value=newInternalValue;displayFieldToUpdate.value=newDisplayValue};
PTC.search.picker.clearStructuredEnumerationPickerValue=function(fieldId,displayFieldId){var internalFieldToUpdate=document.getElementById(fieldId);var displayFieldToUpdate=document.getElementById(displayFieldId);internalFieldToUpdate.value="";displayFieldToUpdate.value="";displayFieldToUpdate.title=""};
PTC.infoPage.ActiveTab=Ext.extend(Object,{init:function(infoModel){this.log=log4javascript.getLogger("PTC.infoPage.ActiveTab");this.infoModel=infoModel;this.stickinessKey="infoPage_lastActiveTab_"},getActiveTabId:function(tabSet){var activeTabId=this.getClientStoredActiveTabId(tabSet,this.infoModel);var tabIdOverride=this.getActiveTabOverride(tabSet,activeTabId);if(tabIdOverride){this.log.debug("getActiveTab - sticky active tab overriden by URL params");activeTabId=tabIdOverride}if(!activeTabId)activeTabId=
0;this.log.debug("getActiveTab - returning ",activeTabId);return activeTabId},getClientStoredActiveTabId:function(tabList,infoModel){if(infoModel&&tabList&&tabList.length>0){var activeTabKey=this.stickinessKey+PTC.infoPage.TabUtils.getObjectType(infoModel);var tabId=infoModel.getClientStorage().get(activeTabKey);this.log.debug("getClientStoredActiveTabId - get key ",activeTabKey,", found value ",tabId);if(tabId)for(var i=0,l=tabList.length;i<l;i++)if(tabList[i].actionID===tabId){this.log.debug("getClientStoredActiveTabId - returning active tab ",
tabList[i].id);return tabList[i].id}}this.log.debug("getClientStoredActiveTabId - returning null");return null},setActiveTab:function(tab){this.log.debug("set active tab called for tab ",tab.id);if(tab&&tab.initialConfig&&tab.ownerCt){var infoModel=tab.ownerCt.infoModel;var activeTabKey=this.stickinessKey+PTC.infoPage.TabUtils.getObjectType(infoModel);infoModel.getClientStorage().set(activeTabKey,tab.actionID);this.log.debug("set active tab with key ",activeTabKey,", and value ",tab.actionID);return true}return false},
getActiveTabOverride:function(tabSet,activeTabId){var tlnAction=extractParamValue(window.location.href,"tlnAction");var tlnType=extractParamValue(window.location.href,"tlnType");var tabAction=extractParamValue(window.location.href,"tabAction");var tabType=extractParamValue(window.location.href,"tabType");if(!tlnAction&&!tlnType&&!tabAction&&!tabType)return activeTabId;else if(tlnAction&&tlnType&&tabAction&&tabType){var tabId=this.infoModel.myTabConfig.id+"_"+tabType+"_"+tabAction;activeTabId=this.scrollToTabTable(tabSet,
tabId,tlnType,tlnAction)}else if(tlnAction&&tlnType){if(!activeTabId)activeTabId=tabSet[0].id;activeTabId=this.scrollToTabTable(tabSet,activeTabId,tlnType,tlnAction)}else if(tabAction&&tabType){var newActiveTabId=this.infoModel.myTabConfig.id+"_"+tabType+"_"+tabAction;var newActiveTab=PTC.infoPage.TabUtils.getTabById(tabSet,newActiveTabId);if(!newActiveTab){this.log.debug("WARNING: bad tab id. The url params specifying the tab forwarding may be invalid. ","newActiveTabId:'",newActiveTab,"'");this.showFailureMessage()}else activeTabId=
newActiveTab.id}else{this.log.debug("WARNING: invalid url params sent. You are missing a required param when attempting to forward ","to an info page tab or content item. Please update your url link with the correct params.");this.showFailureMessage()}this.removeURLTabParameters();return activeTabId},removeURLTabParameters:function(){PTC.util.removeURLParamsFromThisWindow(["tlnAction","tlnType","tabAction","tabType"])},scrollToActiveTabTableId:function(tableId){var tableContainer=PTC.infoPage.getTabPanel().getActiveTab().getTableContainer();
tableContainer.scrollTo.defer(2E3,tableContainer,[tableId])},scrollToActiveTabTableOnAvailable:function(tableId){Ext.ComponentMgr.onAvailable("wrap_"+tableId,this.scrollToActiveTabTableId.createCallback(tableId))},scrollToTabTable:function(tabSet,tabId,actionType,actionName){var result=null;if(tabSet&&tabId&&actionType&&actionName){var tableAction=actionType+actionName;var tableId=tabId+"_"+tableAction;var newTab=PTC.infoPage.TabUtils.getTabById(tabSet,tabId);if(newTab&&PTC.infoPage.TabUtils.isTableOnTab(newTab,
tableAction)){this.scrollToActiveTabTableOnAvailable(tableId);result=tabId}else{if(!newTab)this.log.debug("WARNING: bad tab id. The url params specifying the tab forwarding may be invalid. ","tabId:'",tabId,"'. Still attempting to find the tab on a different tab...");for(var i=0;i<tabSet.length;i++)if(PTC.infoPage.TabUtils.isTableOnTab(tabSet[i],tableAction)){this.scrollToActiveTabTableOnAvailable(tableId);return tabSet[i].id}var foundTable=PTC.infoPage.TabUtils.getTableOnActionModel(this.infoModel.thirdLevelNavModel.items,
tableAction);if(foundTable)PTC.infoPage.TabUtils.isTabPanelRendered(function(){var tabPanel=PTC.infoPage.getTabPanel();PTC.infoPage.getTabManager(tabPanel).add(function(newTab,tabPanel){PTC.infoPage.myTab.addCallback(newTab,tabPanel);(function(){var menuItem=newTab.getCustomizeMenuItem(actionType,actionName);menuItem.setChecked(true);newTab.doLayout()}).defer(2E3)})});else this.showFailureMessage()}}else this.log.error("ERROR: javascript func ActiveTab.scrollToTabTable invoked with incorrect params...");
return result},showFailureMessage:function(){var title=bundleHandler.get("com.ptc.core.ui.errorMessagesRB.REQUESTED_INFORMATION_NOT_AVAILABLE_HEADER");var msg=bundleHandler.get("com.ptc.core.ui.errorMessagesRB.REQUESTED_INFORMATION_NOT_AVAILABLE");PTC.messaging.showWarningMessage(title,msg)}});PTC.AdaptersAdmin={};
PTC.AdaptersAdmin.utils=function(){return{getParentByTagAndID:function(node,tagName,id){while(node&&node.tagName!="DIV"&&node.id!=id)node=node.parentNode;return node},maskMe:function(url,options){var myMask=new Ext.LoadMask(Ext.getBody(),{msg:bundleHandler.get("com.ptc.core.ui.navigationRB.LOADING")});var isEnabled=isOKEnabled();if(isEnabled)disableOkButton();myMask.show();requestHandler.doRequest(url,options);myMask.hide();if(isEnabled)enableOkButton()}}}();
PTC.AdaptersAdmin.AdapterAdminUtils=function(){return{showHideLcMappingIterationList:function(containerOid,lcTemplateOid){var options={asynchronous:false,method:"get",parameters:"containerOid="+containerOid+"&oid="+lcTemplateOid,onSuccess:function(xmlhttpObject,jsonHeaderObject){var iterationList=document.getElementById("integrityLCMapping.templates.iteration");for(var i=iterationList.options.length-1;i>=0;i--)iterationList.remove(i);var iterationInfo=Ext.util.JSON.decode(xmlhttpObject.responseText);
var parent=iterationList.parentNode.parentNode;parent.style.visibility="hidden";var selectedOid=Ext.get("integrityLCMapping.template.selected");selectedOid.dom.value=lcTemplateOid;if(iterationInfo&&iterationInfo.length>0){for(var i=0;i<iterationInfo.length;i++){var iteration=iterationInfo[i];iterationList.add(new Option(iteration.id,iteration.oid),null)}selectedOid.dom.value=iterationInfo[0].oid;parent.style.visibility="visible"}PTC.jca.table.Utils.reload("com.ptc.swlink.adaptersAdminUI.IntegrityLCMapping.stateTable",
true)}};PTC.AdaptersAdmin.utils.maskMe("ptc1/SWLinkAdapterAdminUtils/showHideLcMappingIterationList",options)},updateRefObjects:function(containerOid,adapterOid,refTypeElement,refObjElementId){var refType=refTypeElement.value;var options={asynchronous:false,method:"get",parameters:"adapterOid="+adapterOid+"&refType="+refType+"&containerRef="+containerOid,onSuccess:function(xmlhttpObject,jsonHeaderObject){var response=Ext.util.JSON.decode(xmlhttpObject.responseText);var internalValues=response["RefObjectInternalValues"];
var displayValues=response["RefObjectDisplayValues"];if(displayValues==null||displayValues.length<=0)displayValues=internalValues;var hiddenRefObjectElement=getElementByName(refObjElementId+"_hidden");hiddenRefObjectElement.value="";var refObjectElement=document.getElementById(refObjElementId);for(var i=refObjectElement.options.length-1;i>=0;i--)refObjectElement.remove(i);if(internalValues){hiddenRefObjectElement.value=internalValues;for(var i=0;i<internalValues.length;i++)refObjectElement.add(new Option(displayValues[i],
internalValues[i]),null)}}};PTC.AdaptersAdmin.utils.maskMe("ptc1/SWLinkAdapterAdminUtils/updateRefObjects",options)},validateMapFile:function(adapterOid,mapFile,shouldAlertSuccessMsg){var status=false;var options={asynchronous:false,method:"get",parameters:"adapterOid="+adapterOid+"&mapFile="+mapFile,onSuccess:function(xmlhttpObject,jsonHeaderObject){var response=Ext.util.JSON.decode(xmlhttpObject.responseText);var message=response["validationMessage"];status=response["validationStatus"]==="true";
if(!status||shouldAlertSuccessMsg&&status)wfalert_gen(message)}};PTC.AdaptersAdmin.utils.maskMe("ptc1/SWLinkAdapterAdminUtils/validateMapFile",options);return status},getMapFileDownloadUrl:function(repositoryName,mapFile,urlElementId){var options={asynchronous:true,method:"get",parameters:"repositoryName="+repositoryName+"&mapFile="+mapFile,onSuccess:function(xmlhttpObject,jsonHeaderObject){var response=Ext.util.JSON.decode(xmlhttpObject.responseText);var url=response["downloadUrl"];var element=document.getElementById(urlElementId);
if(element)element.href=url}};requestHandler.doRequest("ptc1/SWLinkAdapterAdminUtils/MapFileDownloadUrl",options)},isAdapterRunning:function(adapterName){var status=false;var options={asynchronous:false,method:"get",parameters:"adapterName="+adapterName,onSuccess:function(xmlhttpObject,jsonHeaderObject){var response=Ext.util.JSON.decode(xmlhttpObject.responseText);status=response["isAdapterRunning"]}};requestHandler.doRequest("ptc1/SWLinkAdapterAdminUtils/checkAdapterStatus",options);return status},
deletePersistentObject:function(oid){var status=true;var options={asynchronous:false,method:"get",parameters:"oid="+oid,onSuccess:function(xmlhttpObject,jsonHeaderObject){var response=Ext.util.JSON.decode(xmlhttpObject.responseText);status=response["isDeleted"];var errorMsg=response["errorMsg"];if(status===false)PTC.AdaptersAdmin.AdapterAdminUtils.showAlertMsg(errorMsg)}};requestHandler.doRequest("ptc1/SWLinkAdapterAdminUtils/deletePersistentObject",options);return status},isAdapterOrRepositoryPresent:function(adapterName,
repositoryName){var msg=null;var options={asynchronous:false,method:"get",parameters:"adapterName="+adapterName+"&repositoryName="+repositoryName,onSuccess:function(xmlhttpObject,jsonHeaderObject){var response=Ext.util.JSON.decode(xmlhttpObject.responseText);msg=response["errorMessage"]}};requestHandler.doRequest("ptc1/SWLinkAdapterAdminUtils/isAdapterOrRepositoryPresent",options);return msg},createUpdateConfigSpec:function(name,desc,labels,oid){var status=false;var options={asynchronous:false,method:"post",
parameters:"csName="+name+"&csDesc="+desc+"&csLabels="+labels+"&oid="+oid,onSuccess:function(xmlhttpObject,jsonHeaderObject){var response=Ext.util.JSON.decode(xmlhttpObject.responseText);status=response["status"]}};PTC.AdaptersAdmin.utils.maskMe("ptc1/SWLinkAdapterAdminUtils/createUpdateConfigSpec",options);return status},showAlertMsg:function(message,waitToClose){var closeAction=window.close;var width=Math.min(500,message.length+300);Ext.Msg.show({title:getBundleString("com.ptc.swlink.adaptersAdminUI.AdaptersAdminRB.ERROR_TITLE"),
msg:message,minWidth:width,maxWidth:800,buttons:{ok:getBundleString("com.ptc.swlink.adaptersAdminUI.AdaptersAdminRB.WARNING_OK")},icon:Ext.MessageBox.ERROR,fn:function(buttonId,text,opt){if(waitToClose){closeAction();return false}resetOkButton();resetNextBackButton(getCurrentStep());Ext.ComponentMgr.get("PJL_wizard_cancel").enable()}});if(waitToClose)window.close=function(){}},showAlert:function(msgKey,inserts,waitToClose){this.showAlertMsg(getBundleStringAndInserts(msgKey,inserts),waitToClose)},
showConfirmMsg:function(message,successAction,waitToClose,cancelAction){var closeAction=window.close;var width=Math.min(500,message.length+300);Ext.Msg.show({title:getBundleString("com.ptc.swlink.adaptersAdminUI.AdaptersAdminRB.WARNING_TITLE"),msg:message,minWidth:width,maxWidth:800,buttons:{ok:getBundleString("com.ptc.swlink.adaptersAdminUI.AdaptersAdminRB.WARNING_OK"),cancel:getBundleString("com.ptc.swlink.adaptersAdminUI.AdaptersAdminRB.WARNING_CANCEL")},icon:Ext.MessageBox.WARNING,fn:function(buttonId,
text,opt){if(buttonId==="ok"){if(waitToClose){closeAction();return false}if(successAction)successAction()}else{if(waitToClose)window.close=closeAction;if(cancelAction)cancelAction()}return false}});if(waitToClose)window.close=function(){};return false},showConfirm:function(msgKey,inserts,successAction,waitToClose,cancelAction){return this.showConfirmMsg(getBundleStringAndInserts(msgKey,inserts),successAction,waitToClose,cancelAction)},removeAllSelected:function(tableId,msgKey,inserts,removeVisually,
callback){var count=tableUtils.getTableSelectedRowsCountById(tableId);if(count==0)this.showAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");else{var onSuccess=function(){var selectionModel=tableUtils.getTable(tableId).getSelectionModel();var selectedRows=selectionModel.getSelections();var oids="";for(var i=0;i<selectedRows.length;i++)oids+="__@@__"+selectedRows[i].get("oid");var status=false;if(removeVisually===false)status=PTC.AdaptersAdmin.AdapterAdminUtils.deletePersistentObject(oids);
if(status===true){rowHandler.removeRows(oids.split("__@@__"),tableId,true);PTC.jca.table.handleSelectAllCheckbox(selectionModel)}if(callback)callback()};var onCancel=function(){tableUtils.getTable(tableId).getSelectionModel().clearSelections()};this.showConfirm(msgKey,inserts,onSuccess,false,onCancel)}return false},confirmOnCancel:function(msgKey,showConfirmIf){function setCancelAction(){Ext.ComponentMgr.get("PJL_wizard_cancel").on("click",function(){var shouldProceed=true;if(showConfirmIf)shouldProceed=
showConfirmIf();if(shouldProceed)return PTC.AdaptersAdmin.AdapterAdminUtils.showConfirm(msgKey,"",null,true);else return true})}Ext.ComponentMgr.onAvailable("PJL_wizard_cancel",setCancelAction)}}}();PTC.jca.batch={};
PTC.jca.batch.BatchRequest=Ext.extend(Object,{log:log4javascript.getLogger("PTC.jca.batch.BatchRequest"),requestsInHolding:[],timerInterval:200,maxBatchSize:20,waitForResponse:false,sending:false,constructor:function(config){config=config||{};Ext.apply(this,config);PTC.navigation.on("historyChange",this.cancelRequests,this,{single:true});this.scheduleSending()},scheduleSending:function(){var self=this;this.sending=true;this.timeout=setInterval(function(){self.processRequests()},this.timerInterval)},
addRequest:function(params){this.log.debug("Adding request to the queue",params);this.requestsInHolding.push(params);if(this.maxBatchSize>0&&this.requestsInHolding.length>=this.maxBatchSize)this.processRequests()},cancelRequests:function(){this.log.debug("Cleaning up the batch request for page change.");clearInterval(this.timeout);this.sending=false;this.requestsInHolding=[]},processRequests:function(){if(this.requestsInHolding.length>0){this.log.debug("Processing requests in holding");var currentRequest;
var requestsToProcess=[];var options=this.initializeRequest();while(currentRequest=this.requestsInHolding.shift())requestsToProcess.push(currentRequest);options.parameters.data=Ext.encode(requestsToProcess);this.sendRequest(options)}},initializeRequest:function(){var options={method:"post",onFailure:this.onFailure,onSuccess:this.onSuccess,parameters:{data:null}};return options},sendRequest:function(options){this.log.debug("Calling ajax request with the following options",options);requestHandler.doRequest(this.url,
options)}});PTC.jca.state.ClientStateProvider=function(config){PTC.jca.state.ClientStateProvider.superclass.constructor.call(this);var provider=PTC.jca.state.ClientStateStore.getProvider(config);this.provider=provider;this.cleansedKeyCache={};Ext.apply(this,config)};
Ext.extend(PTC.jca.state.ClientStateProvider,Ext.state.Provider,{set:function(name,value){if(!this.provider)return;name=this.cleanseKey(name);if(typeof value=="undefined"||value===null){this.clear(name);return}var val=this.encodeValue(value);this.provider.set(name,val);this.fireEvent("statechange",this,name,value)},get:function(name,defaultValue){if(!this.provider)return defaultValue;name=this.cleanseKey(name);var val=this.provider.get(name);if(val===null||typeof val=="undefined")return defaultValue;
return this.decodeValue(val)},clear:function(name){if(!this.provider)return;name=this.cleanseKey(name);this.provider.clear(name);this.fireEvent("statechange",this,name,null)},cleanseKey:function(key){var cleansedKey=key;if(!key)throw new Error("The key name should not be null or empty");else if(this.provider.name==="userData"){if(this.cleansedKeyCache[key])return this.cleansedKeyCache[key];cleansedKey=key.replace(/^\d/,"_").replace(/^\./,"_");cleansedKey=cleansedKey.replace(/[^a-zA-Z0-9_\.]/g,"_");
this.cleansedKeyCache[key]=cleansedKey}return cleansedKey}});PTC.jca.state.getSessionStateStore=function(){if(PTC.jca.state.sessionStateStore===undefined)PTC.jca.state.sessionStateStore=new PTC.jca.state.ClientStateProvider({domstorage:"session"});return PTC.jca.state.sessionStateStore};Ext.onReady(PTC.jca.state.getSessionStateStore);
PTC.jca.state.getLocalStateStore=function(){if(PTC.jca.state.localStateStore===undefined)PTC.jca.state.localStateStore=new PTC.jca.state.ClientStateProvider({domstorage:"local"});return PTC.jca.state.localStateStore};Ext.onReady(PTC.jca.state.getLocalStateStore);
PTC.jca.state.ClientStateStore=function(){function constructor(config){var log=log4javascript.getLogger("PTC.jca.state.ClientStateStore");var useLocal=false;if(config&&config.domstorage==="local")useLocal=true;var sessionStorage={name:"sessionStorage",isAvailable:function(){try{if(window.sessionStorage){window.sessionStorage.setItem("testKey","testValue");window.sessionStorage.removeItem("testKey");return true}}catch(e){return false}return false},set:function(name,value){try{log.debug(this.name," store will try to set key ",
name," to value ",value);window.sessionStorage.setItem(name,value)}catch(e){log.debug(this.name," store caught exception in set method for key ",name," and value ",value,e);return}},get:function(name){var val;try{val=window.sessionStorage.getItem(name);log.debug(this.name," store.get: for key ",name," got value ",val)}catch(e){log.error("session storage would not allow a getItem",name)}return val},clear:function(name){try{window.sessionStorage.removeItem(name)}catch(e){log.error("session storage would not allow a getItem",
name)}}};var localStorage={name:"localStorage",isAvailable:function(){try{return window.localStorage?true:false}catch(e){return false}},set:function(name,value){try{log.debug(this.name," store will try to set key ",name," to value ",value);window.localStorage.setItem(name,value)}catch(e){log.debug(this.name," store caught exception in set method for key ",name," and value ",value,e);return}},get:function(name){var val;try{val=window.localStorage.getItem(name);log.debug(this.name," store.get: for key ",
name," got value ",val)}catch(e){log.error("localStorage would not allow a getItem",name)}return val},clear:function(name){try{window.localStorage.removeItem(name)}catch(e){log.error("localStorage would not allow a removeItem",name)}}};var globalStorage={name:"globalStorage",isAvailable:function(){try{return window.globalStorage[location.host]?true:false}catch(e){return false}},set:function(name,value){try{log.debug(this.name," store will try to set key ",name," to value ",value);window.globalStorage[location.host].setItem(name,
value)}catch(e){log.debug(this.name," store caught exception in set method for key ",name," and value ",value,e);return}},get:function(name){var val;try{val=window.globalStorage[location.host].getItem(name);log.debug(this.name," store.get: for key ",name," got value ",val)}catch(e){log.error("global storage would not allow a getItem",name)}return val},clear:function(name){try{window.globalStorage[location.host].removeItem(name)}catch(e){log.error("global storage would not allow a removeItem",name)}}};
var userData={name:"userData",storeName:"ptcUserData",init:function(){var el;var elName="ieStorage";el=$(elName);if(!el){el=document.createElement("div");el.id=elName;el.style.display="none";el.addBehavior("#default#userData");document.body.appendChild(el)}return el},isAvailable:function(){if(Ext.isIE)try{var el=this.init();el.load(this.storeName);return true}catch(e){return false}return false},set:function(name,value){log.debug(this.name," store will try to set key ",name," to value ",value);var el=
this.init();var now=new Date;now.setTime(now.getTime()+1E3*60*60*24*7);var sExpirationDate=now.toUTCString();el.expires=sExpirationDate;try{el.setAttribute(name,value);el.save(this.storeName)}catch(e){log.debug(this.name," store caught exception in set method for key ",name," and value ",value,e);return}},get:function(name){try{var el=this.init();el.load(this.storeName);var val=el.getAttribute(name);log.debug(this.name," store.get: for key ",name," got value ",val);return val}catch(e){log.debug(this.name,
" store caught exception in get method for key ",name,e);return}},clear:function(name){var el=this.init();el.removeAttribute(name);el.save(this.storeName)}};var stores;if(useLocal===true)stores=[localStorage,globalStorage];else stores=[sessionStorage];stores.push(userData);stores.push(sessionStorage);for(var i=0;i<stores.length;i++){log.debug("trying store ",stores[i].name);if(stores[i].isAvailable()){log.debug("will use store ",stores[i].name);return stores[i]}}return null}return{getProvider:function(config){return constructor(config)}}}();
PTC.jca.dataSource={};PTC.jca.dataSource.log=log4javascript.getLogger("PTC.jca.dataSource");PTC.jca.requestPath="ptc1";PTC.jca.jsonSupport="JSON"in window;Ext.apply(PTC.jca.dataSource,new Ext.util.Observable);PTC.jca.dataSource.addEvents("complete","dynamicOperation","dscancelforced");PTC.jca.ChunkIterator=function(text,separatorText){this.text=text;this.cursor=0;this.success=true};PTC.jca.ChunkIterator.prototype={hasNext:function(){return this.cursor!=-1},next:function(){this.cursor=-1;return this.text}};
PTC.jca.ChunkReader=function(config){config=config||{};PTC.jca.ChunkReader.superclass.constructor.call(this,config)};Ext.extend(PTC.jca.ChunkReader,Ext.data.DataReader,{read:function(response){var text=response.responseText;return new PTC.jca.ChunkIterator(text,this.separatorText)},readRecords:function(json){return json}});
PTC.jca.DataSourceRegistry=function(){var SERVER_ERROR=1;var MAX_DATA_SOURCE_LIMIT=201;var PARTIAL_RESULTS_DISPLAYED=202;var AVAILABLE_DATA_EXCEEDS_RESULT_LIMIT=203;var TABLE_DATA_FEEDBACK_TYPE=501;var MAX_REQUESTS=3;var pendingRequests=new Ext.util.MixedCollection;var tableIdContainer=new Ext.util.MixedCollection;var chunkReader=new PTC.jca.ChunkReader;var pollingParams={method:"GET"};if(typeof getBaseHref==="function")pollingParams.url=getBaseHref()+PTC.jca.requestPath+"/ds";var poller=new Ext.data.HttpProxy(pollingParams);
var pendingDataSourceRequests=[];function killAllDataSources(){var ids=[];pendingRequests.eachKey(keyIterator,ids);PTC.jca.dataSource.log.debug("cancelling Data Source through killAllDataSources with id :-- "+ids);PTC.jca.DataSourceRegistry.cancelServerDataSources(ids)}Ext.EventManager.on(window,"unload",killAllDataSources);function needsPolling(chunk){if(!chunk||!chunk.id)return false;if(chunk.transmissionState&&chunk.transmissionState!=="COMPLETED")return true;return false}function loadChunk(request,
chunk){if(request.arg!==undefined){if(request.arg.params!==undefined&&request.arg.params.dynamicDataSource!==undefined)var params=request.arg.params;request.arg={};request.arg.params=params}request.arg.chunk=chunk;var records,result;var data;if(PTC.isDefined(chunk))data=chunk.data||[];else data=[];var totalCount=0;if(request.scope.getTotalCount()>0)totalCount=request.scope.getTotalCount();if(chunk.fromIndex===chunk.totalCount&&chunk.transmissionState!="OPEN"){if((chunk.fromIndex!==0||totalCount>0&&
chunk.fromIndex===0)&&chunk.resultState!="FAILED")if(chunk.transmissionState!="COMPLETED"||chunk.fromIndex===0){unmaskExpandNode(request);return true}if(PTC.jca.DataSourceRegistry.openRequests>0){loadChunk.defer(100,this,[request,chunk]);return-1}}if(chunk.fromIndex>totalCount+1){loadChunk.defer(100,this,[request,chunk]);return-1}else{result=needsPolling(chunk);if(result)poll();try{records=request.reader.readRecords(data);if(PTC.isDefined(chunk)&&chunk.totalCount!==undefined)records.totalRecords=
chunk.totalCount}catch(e){request.proxy.fireEvent("loadexception",this,request.arg,null,e);processRecords(request,chunk,null,false,false);return false}processRecords(request,chunk,records,true,result)}return result}function unmaskExpandNode(req){var expandNode=req&&req.arg&&req.arg.params&&req.arg.params.e;if(expandNode){var s=req.scope;s.fireEvent("unmaskExpandNode",s,req.arg.params.e)}}function processFeedbacks(request,store,feedbacks,records){var paging_session_id;var resultLimitHit=false;var moreData=
false;var partialResultException=false;var customFeedback=[];var i,j;for(i=0,j=feedbacks.length;i<j;i++){var feedback=feedbacks[i];if(feedback!==undefined)if(feedback.type===MAX_DATA_SOURCE_LIMIT){resultLimitHit=true;store.resultLimitReached=true}else if(feedback.type===PARTIAL_RESULTS_DISPLAYED)partialResultException=true;else if(feedback.type===AVAILABLE_DATA_EXCEEDS_RESULT_LIMIT)moreData=true;else if(feedback.type===TABLE_DATA_FEEDBACK_TYPE)paging_session_id=feedback.data.PAGING_SESSION_ID;else if(feedback.type===
SERVER_ERROR)request.scope.fireEvent("ServerError",bundleHandler.get("com.ptc.netmarkets.util.utilResource.SERVER_ERROR")+feedback.exceptionMessage,feedback.type);else customFeedback.push(feedback)}if(customFeedback.length>0)store.fireEvent("customfeedbackavailable",customFeedback);if(store.moreData===false)store.moreData=moreData;if(store.pagingSessionId===undefined)store.pagingSessionId=paging_session_id;if(resultLimitHit){store.resultLimitHit=true;if(!store.tree){var table=tableUtils.getTable(store.jscaTableID);
var isTableFilteredOnServer=PTC.jca.table.findInTable.isTableFilteredOnServer(table);var savedSearchTerm=PTC.jca.table.getObjectFromSession(store.jscaTableID,"searchInListTextBox");var selectedOnlyItem=Ext.getCmp(PTC.jca.table.getWTablePanelID(store.jscaTableID)+".selectedOnlyViewItem");var isExistingSavedSelectedOidList=false;if(selectedOnlyItem){var savedSelectedOidList=PTC.jca.table.getObjectFromSession(store.jscaTableID,selectedOnlyItem.id);if(typeof savedSelectedOidList==="object")isExistingSavedSelectedOidList=
true}if(!isTableFilteredOnServer&&savedSearchTerm!==""||isExistingSavedSelectedOidList)return true;request.scope.fireEvent("DSLoadingInterupted",bundleHandler.get("com.ptc.netmarkets.util.utilResource.MAX_DATASOURCE_LIMIT_REACHED_MESSAGE_TABLE_LEVEL"));PTC.jca.DataSourceRegistry.showIncompleteDataWarning("com.ptc.netmarkets.util.utilResource.MAX_DATASOURCE_LIMIT_REACHED_MESSAGE","com.ptc.netmarkets.util.utilResource.MAX_DATASOURCE_LIMIT_REACHED_MESSAGE_2")}else{request.scope.fireEvent("handlecanceltreeds",
store,records);request.scope.fireEvent("DSLoadingInteruptedTree",store,records)}}else store.resultLimitHit=false;if(!moreData&&partialResultException){request.scope.fireEvent("DSLoadingInterupted",bundleHandler.get("com.ptc.netmarkets.util.utilResource.QUERY_LIMIT_REACHED"));PTC.jca.DataSourceRegistry.showIncompleteDataWarning("com.ptc.netmarkets.util.utilResource.QUERY_LIMIT_REACHED","com.ptc.netmarkets.util.utilResource.QUERY_LIMIT_REACHED_DETAILED_MESSAGE")}}function delayedStoreUpdate(astore,
options){if(astore._sortChanged===true||astore.clientSortRequired===true){astore.suspendEvents();if(astore.groupField)astore.groupBy(astore.groupField,true);else astore.applySort();if(typeof astore.shiftKeyOn!=="undefined"&&astore.warningDisplayed!==true){PTC.jca.DataSourceRegistry.showIncompleteDataWarning("com.ptc.netmarkets.util.utilResource.SORTING_ON_INCOMPLETE_DATA_WARNING_MESSAGE","com.ptc.netmarkets.util.utilResource.SORTING_ON_INCOMPLETE_DATA_DETAILED_MESSAGE");astore.warningDisplayed=true}astore.resumeEvents()}if(astore.jsca_table===
undefined)astore.jsca_table=tableUtils.getTable(astore.jscaTableID);var isTableFilteredOnServer=PTC.jca.table.findInTable.isTableFilteredOnServer(tableUtils.getTable(astore.jscaTableID));var savedSearchTerm=PTC.jca.table.getObjectFromSession(astore.jscaTableID,"searchInListTextBox");if(savedSearchTerm!==""&&!isTableFilteredOnServer){astore.jsca_table.searchInString=PTC.jca.table.fit.getSafeSearchTerm(savedSearchTerm);var searchField=Ext.getCmp(astore.jscaTableID+".searchInListTextBox");searchField.clearTrigger.show()}var selectedOnlyItem=
Ext.getCmp(PTC.jca.table.getWTablePanelID(astore.jscaTableID)+".selectedOnlyViewItem");if(selectedOnlyItem&&astore.load_complete&&!isTableFilteredOnServer){var savedSelectedOidList=PTC.jca.table.getObjectFromSession(astore.jscaTableID,selectedOnlyItem.id);if(typeof savedSelectedOidList==="object"){PTC.jca.table.setSelectRowStatus(astore.jsca_table,savedSelectedOidList,true);selectedOnlyItem.checked=true}}var searchInListFiltered=PTC.jca.table.findInTable.isTableFilteredOnClient(astore.jsca_table)||
!isTableFilteredOnServer&&PTC.jca.table.stickiness.initializeSearchInListFilter(astore.jsca_table);if(searchInListFiltered&&!(selectedOnlyItem&&selectedOnlyItem.checked))astore.jsca_table.fireEvent("applySearchInList",astore.jsca_table);else if(!searchInListFiltered&&selectedOnlyItem&&selectedOnlyItem.checked)selectedOnlyItem.fireEvent("applySelectOnlyView",selectedOnlyItem,true);else if(searchInListFiltered&&selectedOnlyItem&&selectedOnlyItem.checked){astore.jsca_table.fireEvent("applySearchInList",
astore.jsca_table);selectedOnlyItem.fireEvent("applySelectOnlyView",selectedOnlyItem,true)}else astore.fireEvent("datachanged",astore,options);astore.fireEvent("asyncdatachunkloaded",astore)}function processRecords(request,chunk,records,success,needsPolling){var chunkIsNull=chunk===null||chunk===undefined;var store=request.scope,proxy=request.proxy;if(!chunkIsNull&&chunk.feedback!==undefined)processFeedbacks(request,store,chunk.feedback,records);if(chunkIsNull&&!proxy||!chunkIsNull&&isChunkProcessed(proxy,
chunk.fromIndex))return false;request.proxy.dataSourceLoading=needsPolling;var delay=5E3;var recordsLength=0;if(records&&records.records&&records.records.length)recordsLength=records.records.length;var dataLength=0;if(store)dataLength=store.getRecordsCount();if(!chunkIsNull&&(chunk.transmissionState==="COMPLETED"||chunk.transmissionState==="CLOSED")&&dataLength+recordsLength>=chunk.totalCount){store.load_complete=true;delay=0}PTC.jca.dataSource.log.debug("is load complete? ",store.load_complete,dataLength+
recordsLength,chunkIsNull?"null":chunk.totalCount,chunkIsNull?"null":chunk.transmissionState,"needs polling?",needsPolling);request.arg.add=true;if(!chunkIsNull&&records&&records.records&&records.records.length>0){store.suspendEvents();request.callback.call(store,records,request.arg,success);var countChanged=false;if(store.getTotalCount()<=50||!needsPolling){delay=0;PTC.jca.table.scroll.updateTableSize.defer(10,PTC.jca.table.scroll,[store.jscaTableID])}if(request.arg&&request.arg.params&&request.arg.params.e)store._loadingCount=
-1;if(store._loadingCount<=chunk.totalCount){store._loadingCount=chunk.totalCount;countChanged=true}else if(delay>0)delay=-1;if(store.tree)store.each(PTC.jca.expandRowIfAuto);store.resumeEvents();var options={countChanged:countChanged,chunk:chunk};if(store.dataChangeTask===undefined)store.dataChangeTask=new Ext.util.DelayedTask(delayedStoreUpdate);PTC.jca.dataSource.log.debug("datachanged? ",countChanged,delay,store._loadingCount,chunk.totalCount);PTC.jca.dataSource.log.debug("number of rows in each chunk ",
chunk.totalCount-chunk.fromIndex);if(delay>=0){store.dataChangeTask.delay_time=delay;store.dataChangeTask.delay(delay,null,store,[store,options])}setChunkProcessed(proxy,chunk.fromIndex)}else if(records&&records.records){var r=records.records;var rlen=r?r.length:0;var totalRecords=records.totalRecords||0;if(store.tree){store.page_offset=store.getPageOffsetFromOptions(request.arg);store.totalLength=Math.max(totalRecords||rlen,store.data.length)}else store.totalLength=Math.max(totalRecords,store.data.length+
rlen)}if(store.load_complete){if(store.getTotalCount()<=50)PTC.jca.table.scroll.updateTableSize.defer(10,PTC.jca.table.scroll,[store.jscaTableID]);store.fireEvent("asyncdatachunkloaded",store);store.fireEvent("dataSourceComplete",store);if(!chunkIsNull)PTC.jca.dataSource.fireEvent("complete",chunk.id);store.DATA_RENDERED=true;if(!chunkIsNull&&!needsPolling){removeStaleIdIfPresent(store.jscaTableID);pendingRequests.removeKey(chunk.id)}if(!needsPolling)unmaskExpandNode(request)}delete request.arg.chunk;
return true}function _poll(){var ids=[];pendingRequests.eachKey(keyIterator,ids);PTC.jca.DataSourceRegistry.pollingService(ids,pollingCallback)}function poll(){_poll();var i=PTC.jca.DataSourceRegistry.openRequests;while(i++<poller.max_requests)_poll.defer(100*i+10,this)}function keyIterator(id){this.push(id)}var pollingCallback=function(iterator,ids,success){PTC.jca.DataSourceRegistry.openRequests--;if(PTC.jca.DataSourceRegistry.openRequests<0)PTC.jca.DataSourceRegistry.openRequests=0;if(success){if(iterator&&
iterator.hasNext())loadEachChunk.call(iterator,ids)}else handleFailedPoll(iterator,ids)};function isChunkProcessed(proxy,fromIndex){return Ext.isChrome&&PTC.isDefined(proxy)&&proxy.processedChunks&&proxy.processedChunks.indexOf(fromIndex)>-1?true:false}function setChunkProcessed(proxy,fromIndex){if(!Ext.isChrome)return;if(!PTC.isDefined(proxy.processedChunks))proxy.processedChunks=[];proxy.processedChunks.push(fromIndex);PTC.jca.dataSource.log.debug("Number of chunks processed on chrome browser "+
proxy.processedChunks)}function loadEachChunk(ids){if(this.hasNext()){var text=this.next();var chunk;try{if(PTC.jca.jsonSupport)chunk=JSON.parse(text);else chunk=eval(text)}catch(e){PTC.jca.dataSource.log.error("json parse failed",ids.join())}if(chunk===null||chunk===undefined||chunk[0]===null){PTC.jca.dataSource.log.error("Unable to eval text: ",text," for ids: ",ids.join());handleFailedPoll(null,ids)}else{var i;for(i=0;i<chunk.length;i++){var request=pendingRequests.key(chunk[i].id);PTC.jca.dataSource.log.debug("pendingDataSourceRequests.remove:",
chunk[i].id);pendingDataSourceRequests.remove(chunk[i].id);if(request!==undefined&&!isChunkProcessed(request.proxy,chunk[i].fromIndex))loadChunk(request,chunk[i]);else PTC.jca.dataSource.log.info("No pending request found for id: ",chunk.id)}loadEachChunk.call(this)}}}function handleFailedPoll(chunks,ids){if(ids&&ids.length){var i,j;for(i=0,j=ids.length;i<j;i++){var request=pendingRequests.removeKey(ids[i]);if(request!==undefined){if(request.scope)removeStaleIdIfPresent.defer(400,this,[request.scope.jscaTableID,
true]);processRecords(request,null,false,false)}}}}function removeStaleIdIfPresent(tableId,forceRemove){if(tableIdContainer.containsKey(tableId)){var staleDSId=tableIdContainer.get(tableId);tableIdContainer.removeKey(tableId);PTC.jca.dataSource.log.debug("removeStaleIdIfPresent remove tableidcontainer:",tableId,staleDSId);if(!(pendingDataSourceRequests.indexOf(staleDSId)>=0)||forceRemove===true)return pendingRequests.removeKey(staleDSId)}return false}function addDSIdForPolling(dsId,request){PTC.jca.dataSource.log.debug("addDSIdForPolling:",
request.scope.jscaTableID,dsId);pendingRequests.add(dsId,request);tableIdContainer.add(request.scope.jscaTableID,dsId)}return{register:function(chunk,request,nodeExpand){var max_requests;if(nodeExpand)poller.max_requests=1;else poller.max_requests=MAX_REQUESTS;var cid=chunk.id;var completeFunc=function(id){if(id===cid){var store=request.scope;if(store){delete store.dataChangeTask;store._loadingCount=-1;store.isLoading=FALSE_FUNC}PTC.jca.dataSource.un("complete",completeFunc);pendingRequests.remove(cid);
completeFunc=null}};PTC.jca.dataSource.on("complete",completeFunc);var store=request.scope;if(store&&getWindow().PTC.performance.Timer.InfoEnabled)store.firstChunk=true;request.arg.add=true;PTC.jca.dataSource.log.debug("pendingDataSourceRequests.push:",chunk.id);pendingDataSourceRequests.push(chunk.id);removeStaleIdIfPresent(request.scope.jscaTableID);var comp=Ext.getCmp(request.scope.jscaTableID);if(comp){var tid=request.scope.jscaTableID;comp.on("beforedestroy",function(){removeStaleIdIfPresent(tid,
true);PTC.jca.dataSource.log.debug("pendingDataSourceRequests.remove:",cid);pendingDataSourceRequests.remove(cid);pendingRequests.remove(cid);chunk=null;request=null})}addDSIdForPolling(chunk.id,request);if(needsPolling(chunk))poll();return loadChunk(request,chunk)},getRequest:function(id){return pendingRequests.key(id)},killAllDataSources:killAllDataSources,pollingService:function(ids,callback,scope){if(!ids||ids.length<=0)return;if(PTC.jca.DataSourceRegistry.openRequests>=poller.max_requests){_poll.defer(24);
return}PTC.jca.dataSource.log.debug("Polling for :-- ",ids);Ext.Ajax.disableCaching=false;if(poller.conn){PTC.jca.dataSource.log.debug("Preparing connection for Datasource with ID for :-- "+ids);poller.conn.url=getBaseHref()+"ptc1/ds";PTC.jca.DataSourceRegistry.openRequests++;poller.doRequest(Ext.data.Api.actions.read,null,{ids:ids.join(),jsonSupport:PTC.jca.jsonSupport},chunkReader,callback,scope,ids)}else callback.call(scope,null,ids,false);Ext.Ajax.disableCaching=true},pollingParams:poller.conn,
cancelServerDataSources:function(ids){if(ids===null||ids.length===0)return;var url=PTC.jca.requestPath+"/ds?ids=";var i,l;for(i=0,l=ids.length;i<l;i++){var request=pendingRequests.key(ids[i]);if(PTC.isDefined(request)){PTC.jca.dataSource.log.debug("cancelling data source in cancelServerDataSources with id:-- ",ids[i]);pendingRequests.removeKey(ids[i]);if(ids.length>0)Ext.Ajax.request({url:getBaseHref()+url+ids,method:"DELETE"})}else PTC.jca.dataSource.log.debug("DS not found for id :-- "+ids[i])}},
newProxy:function(chunk){return new PTC.jca.DataSourceProxy(chunk)},newStore:function(config){if(config!==undefined&&config.chunk!==undefined&&config.proxy===undefined)config.proxy=this.newProxy(config.chunk);return new PTC.jca.DataSourcePagingStore(config)},newTreeStore:function(config){if(config&&config.chunk&&!config.proxy)config.proxy=this.newProxy(config.chunk);return new PTC.jca.DataSourceTreePagingStore(config)},processFeedbacks_jsUnit:function(request,store,feedbacks){if(store.jsunit===undefined);
else processFeedbacks(request,store,feedbacks);return},_pendingRequests:pendingRequests,_loadChunk:loadChunk,_poller:poller,needsPolling:needsPolling,_MAX_REQUESTS:MAX_REQUESTS,openRequests:0,_setTestMethod:function(name,func){eval(name+" = "+func)},_getTestMethod:function(name){return eval(name)}}}();
PTC.jca.DataSourceRegistry.killInternalDataSources=function(extComponent){var ids=[];if(extComponent&&extComponent.getEl==="function"&&extComponent.getEl()!==null){var tables=PTC.jca.table.Utils.getExtTables(extComponent.getEl().dom);var i,l;for(i=0,l=tables.length;i<l;i++){var store=tables[i].getStore();if(typeof store.isLoading=="function"&&store.isLoading())ids.push(tables[i].store.chunk.id)}PTC.jca.DataSourceRegistry.cancelServerDataSources(ids);if(store!==undefined)store.fireEvent("DSLoadingInterupted",
bundleHandler.get("com.ptc.netmarkets.util.utilResource.LOADING_CANCELLED_BY_USER"))}};
PTC.jca.DataSourceRegistry.killDataSource=function(store,dsId){if(store&&store.cancelBtnClicked){try{store.fireEvent("DSLoadingInterupted",bundleHandler.get("com.ptc.netmarkets.util.utilResource.LOADING_CANCELLED_BY_USER"));PTC.jca.dataSource.log.debug("DataSource cancelled by user with id :-- ",dsId)}catch(e){PTC.jca.dataSource.log.error("Could not fire the DSLoadingInterpupted Event",e)}PTC.jca.DataSourceRegistry.cancelServerDataSources(dsId);PTC.jca.dataSource.fireEvent("dscancelforced",store);
if(store.proxy){store.proxy.dataSourceLoading=false;store.fireEvent("datachanged",store)}}};
PTC.jca.DataSourceToolbar=function(barConfig){var tableID=barConfig.tableID;var barID=barConfig.isFooter===true?"footer_":"header_";var mask=new Ext.Toolbar.TextItem({xtype:"tbtext",id:barID+tableID+"_titleBarMask",height:20});var cancelButton=new PTC.jca.CancelDataLoadButton({id:barID+tableID+"_cancelDataSourceButton",tableid:tableID});return{isFooter:barConfig.isFooter,mask:mask,cancelButton:cancelButton,dsMaskListener:function(){var titleBarMaskEle=this.mask.el;var titleBarMask=new Ext.LoadMask(titleBarMaskEle,
{msg:bundleHandler.get("com.ptc.core.ui.navigationRB.LOADING"),msgCls:"titleBarMask"});titleBarMask.show();var extraMaskDiv=getElementsByClassNameAndTag("ext-el-mask",titleBarMask.el.dom,"div")[0];if(extraMaskDiv)Ext.removeNode(extraMaskDiv);var maskWheelDiv=getElementsByClassNameAndTag("titleBarMask",titleBarMask.el.dom,"div")[0];if(maskWheelDiv){var maskMsgDiv=maskWheelDiv.firstChild;if(maskMsgDiv)maskMsgDiv.className="titleBarkMaskMsg"}this.showTitleMasks();var store=this.store;if(!store.isLoading())this.hideTitleMasks();
store.on("reload",this.showTitleMasks,this);store.on("dataSourceComplete",this.hideTitleMasks,this);store.on("tableResize",this.hideTitleMasks,this);store.on("loadexception",this.hideTitleMasks,this);store.on("DSLoadingInterupted",this.hideTitleMasks,this)},showTitleMasks:function(){var titleBarMask=this.mask.el;if(titleBarMask.cachedWidth)titleBarMask.setWidth(titleBarMask.cachedWidth);titleBarMask.show();this.cancelButton.setVisible(true);this.doLayout(true,true)},hideTitleMasks:function(){var titleBarMask=
this.mask.el;if(titleBarMask&&titleBarMask.dom){if(titleBarMask.cachedWidth===undefined||titleBarMask.cachedWidth<titleBarMask.getWidth())titleBarMask.cachedWidth=titleBarMask.getWidth();titleBarMask.setWidth(0);titleBarMask.hide()}if(this.cancelButton&&this.cancelButton.el&&this.cancelButton.el.dom)this.cancelButton.setVisible(false);this.doLayout(true,true)}}};
PTC.jca.DataSourceRegistry.showIncompleteDataWarning=function(warningTitleResource,detailedMessageResource){var incompleteDataMsg={MessageTitle:bundleHandler.get(warningTitleResource),Messages:[bundleHandler.get(detailedMessageResource)],MessageType:"WARNING"};var currentWindow=getWindow();if(!PTC.isDefined(currentWindow.opener)||PTC.automation.isAutomationTest())currentWindow.PTC.getMainWindow().PTC.messaging.showInlineMessage([incompleteDataMsg])};
PTC.jca.DataSourcePagingStore=function(config){PTC.jca.DataSourcePagingStore.superclass.constructor.call(this,config);this.isLoading=function(){var proxy=this.proxy;return proxy!==undefined&&proxy.dataSourceLoading};this.addEvents("dataSourceComplete");this.addEvents("tableResize")};
Ext.extend(PTC.jca.DataSourcePagingStore,Ext.data.GroupingStore,{isLoading:function(){var proxy=this.proxy;return proxy!==undefined&&proxy.dataSourceLoading},getTotalCount:function(){var totalLength=this.totalLength||0;var result=Math.max(totalLength,this.getRecordsCount());if(isNaN(result))result=0;return result}});Ext.data.Store.prototype.getRecordsCount=function getRecordsCount(){var result=(this.allData||this.snapshot||this.data).length;if(!PTC.isDefined(result)||isNaN(result))result=0;return result};
PTC.jca.DataSourceTreePagingStore=function(config){PTC.jca.DataSourceTreePagingStore.superclass.constructor.call(this,config);this.addEvents("dataSourceComplete");this.addEvents("unmaskExpandNode")};
Ext.extend(PTC.jca.DataSourceTreePagingStore,Ext.ux.maximgb.tg.AdjacencyListStore,{isLoading:function(){var proxy=this.proxy;return proxy&&proxy.dataSourceLoading},loadRecords:function(o,options,success){var chunk=options.chunk;if(options.add&&chunk){if(this.allData!==undefined){this.data=this.allData;delete this.allData}if(options.params!==undefined)options.params.anode="dummyNode";var eventsSuspendedAlready=this.eventsSuspended;this.suspendEvents();PTC.jca.DataSourceTreePagingStore.superclass.loadRecords.call(this,
o,options,success);var r=o.records;this.totalLength=Math.max(o.totalRecords||r.length,this.data.length);if(!eventsSuspendedAlready)this.resumeEvents()}else PTC.jca.DataSourceTreePagingStore.superclass.loadRecords.call(this,o,options,success)},getTotalCount:function(){var result=Math.max(this.totalLength,(this.allData||this.snapshot||this.data).length);if(isNaN(result))result=0;return result},remove:function(record){PTC.jca.DataSourceTreePagingStore.superclass.remove.call(this,record);var removeExpandCollapseNorgie=
function(store,record){if(store.isLoading()){var removeExpandCollapseNorgieDelegate=removeExpandCollapseNorgie.createDelegate(store,[store,record],0);store.on("dataSourceComplete",removeExpandCollapseNorgieDelegate,store,{single:true})}else PTC.jca.TreeGrid.removeNorgie(store,record);removeExpandCollapseNorgie(store,record)}}});
PTC.jca.dynamicRequestCallback=function(r,o,s){if(r&&r.text)try{var BEGIN_FLAG="<!-- BEGIN PURE JSON --\>";var END_FLAG="<!-- END PURE JSON --\>";var jsonText=r.text;var iBegin=jsonText.indexOf(BEGIN_FLAG)+BEGIN_FLAG.length;var iEnd=jsonText.indexOf(END_FLAG,iBegin);jsonText=jsonText.substring(iBegin,iEnd);PTC.jca.dataSource.on("dynamicOperation",PTC.jca.dataSource._registerDynamic);PTC.navigation.evalPageScripts(jsonText)}catch(e){jsca.log(e)}};
PTC.jca.dataSource.getStore=function(tableID){var table=tableUtils.getTable(tableID);if(table)return table.store};
PTC.jca.dataSource._registerDynamic=function(jcaTableConfig,callback){var store=PTC.jca.dataSource.getStore(jcaTableConfig.tableID);if(!store){PTC.jca.dataSource._registerDynamic.defer(100,this,[jcaTableConfig,callback]);return}var expandProxy=new PTC.jca.DataSourceRegistry.newProxy(jcaTableConfig.chunk);expandProxy.setApi("read",getBaseHref()+PTC.jca.requestPath+"/ds");this.dataSourceLoading=true;var nodeExpand;if(store.tree)nodeExpand=true;PTC.jca.DataSourceRegistry.register(jcaTableConfig.chunk,
{proxy:expandProxy,reader:store.reader,callback:eval(jcaTableConfig.dynamicCallback),scope:store,arg:{chunk:jcaTableConfig.chunk,params:jcaTableConfig.storeURL.params}},nodeExpand);delete this.chunk;delete this.dynamicCallback};PTC.jca.dataSource.registerDynamic=function(jcaTableConfig){var grid=PTC.jca.table.Utils.getTable(jcaTableConfig.tableID);grid.jcaTableConfig=Ext.applyIf(eval(jcaTableConfig),grid.jcaTableConfig);PTC.jca.dataSource.fireEvent("dynamicOperation",grid.jcaTableConfig)};
PTC.jca.dataSource.doRequestWithExistingStore=function(store,pollingParams,params,arg,proxy,callback,queryString){if(pollingParams===undefined||pollingParams===null)pollingParams={method:"POST"};else if(pollingParams.method===null)pollingParams.method="POST";pollingParams.url=proxy.api.read.url;pollingParams.url=Ext.urlAppend(pollingParams.url,queryString);var newPoller=new Ext.data.HttpProxy(pollingParams);var rowReader=new PTC.jca.ChunkReader;newPoller.doRequest(Ext.data.Api.actions.read,null,params,
rowReader,callback,store,arg)};PTC.jca.dataSource.createParams=function(params){if(params===undefined)params={};params.acquire="false";return params};PTC.jca.dataSource.createQueryStringParams=function(params){var queryString="dynamicDataSource=true&tableId="+params.tableID;return queryString};
PTC.jca.dataSource.createParameterDataFromJson=function(params,queryStringInput){var data="";var queryString=queryStringInput;if(params.jsonData){for(var field in params)if(params.hasOwnProperty(field)){if("jsonData"===field)continue;var ampersand="";if(data)ampersand="&";data=data+ampersand+field+"="+params[field]}for(field in params.jsonData)if(params.jsonData.hasOwnProperty(field))data=data+ampersand+field+"=["+params.jsonData[field]+"]";if(data)queryString=queryString+"&"+data;params.jsonData=
queryString}};PTC.jca.dataSource.createArguments=function(arg){arg=arg===undefined?{}:arg;return arg};PTC.jca.dataSource.createPollingParams=function(proxy,pollingParams){pollingParams=pollingParams===undefined||pollingParams===null?{}:pollingParams;pollingParams.url=proxy.api.read.url;return pollingParams};PTC.jca.dataSource.reload=function(r,o,s){this.loadRecords.call(this,r,o,s)};
PTC.jca.expandNodes=function(r,o,s,scope){if(!scope)scope=this;var record;var isReload=false;scope.loadRecords.call(scope,r,o,s);if(o.params&&o.params.reload&&o.params.reload[0]==="true")isReload=true;if(o.params===undefined){if(scope.lastJsonData&&scope.lastJsonData.e){var ll=scope.lastJsonData.e.length;for(var i=0;i<ll;++i){o.params={anode:scope.lastJsonData.e[i]};scope.expandNodeCallback.call(scope,record,o,s)}scope.lastJsonData=undefined;o.params=undefined}}else if(o.params.e!==undefined){record=
scope.getById(o.params.e);o.params.anode=o.params.e;scope.expandNodeCallback.call(scope,record,o,s)}else if(r.records!==null){var ii,j;for(ii=0,j=r.records.length;ii<j;ii++){var rec=r.records[ii];o.params.anode=rec.id;var callExpand=true;if(isReload){rec.reloadExpand=true;if(!scope.isExpandedNode(rec))callExpand=false}if(callExpand)scope.expandNodeCallback.call(scope,rec,o,s)}}};PTC.jca.DataSourceProxy=function(chunk){PTC.jca.DataSourceProxy.superclass.constructor.call(this);this.chunk=chunk};
Ext.extend(PTC.jca.DataSourceProxy,Ext.data.DataProxy,{doRequest:function(action,rs,params,reader,callback,scope,arg){this.dataSourceLoading=true;PTC.jca.DataSourceRegistry.register(this.chunk,{proxy:this,reader:reader,callback:callback,scope:scope,arg:arg||{}});delete this.chunk}});
PTC.jca.DataSourceProxy.prototype.doRequest=PTC.jca.DataSourceProxy.prototype.doRequest.wrap(function(proceed,action,rs,params,reader,callback,scope,arg){var queryString;if(scope!==undefined&&(scope.norgieClicked===1||scope.performExpand)){delete scope.chunk;var userConformation=scope.expandBeyondLimit?true:PTC.jca.table.Utils.getDataLoadUserConfirmation(scope,"com.ptc.netmarkets.util.utilResource.UNBOUNDED_LOAD");if(!userConformation)if(scope.norgieClicked==1||scope.postCancelHandlerInfo===null){var record=
scope.getById(params.e);scope.jsca_table.handleLoadingIndicator(scope,record);return}scope.expandBeyondLimit=null;scope.norgieClicked=null;scope.performExpand=false;params=PTC.jca.dataSource.createParams(params);queryString=PTC.jca.dataSource.createQueryStringParams(params);var rowCount=scope.data!==null&&scope.data!==undefined?scope.data.length:0;if("jsonData"in params){scope.lastJsonData=params.jsonData;queryString=queryString+"&rowCount="+rowCount;PTC.jca.dataSource.createParameterDataFromJson(params,
queryString);queryString=""}else queryString=queryString+"&rowCount="+rowCount+"&e="+params.e;var pollingParams=PTC.jca.dataSource.createPollingParams(this,null);arg=PTC.jca.dataSource.createArguments(arg);PTC.jca.dataSource.doRequestWithExistingStore(scope,pollingParams,params,arg,this,PTC.jca.dynamicRequestCallback,queryString);params.oidToPopulate=null}else if(arg!==undefined&&arg.reload===true){params=PTC.jca.dataSource.createParams(params);queryString=PTC.jca.dataSource.createQueryStringParams(params);
queryString+="&rowCount=0&reload=true";pollingParams=PTC.jca.dataSource.createPollingParams(this,null);arg=PTC.jca.dataSource.createArguments(arg);PTC.jca.dataSource.doRequestWithExistingStore(scope,pollingParams,params,arg,this,PTC.jca.dynamicRequestCallback,queryString)}else proceed.call(this,action,rs,params,reader,callback,scope,arg)});Ext.ns("PTC.ux.grid");
PTC.ux.grid.DetailsPopupGrid=Ext.extend(Object,{constructor:function(config){config=config||{};Ext.apply(this,config)},init:function(grid){grid._launchEditDialog=this._launchEditDialog;grid._addQueryParams=this._addQueryParams;grid.saveDetailsPopup=this.saveDetailsPopup;grid.initializeDetailsPopup=this.initializeDetailsPopup;grid._cloneCellForDetailsPopup=this._cloneCellForDetailsPopup;grid.getStore().on("remove",function(store,record){if(!store._updateInProgress&&record.detailsPopupHiddenDivId){var element=
$(record.detailsPopupHiddenDivId);if(element&&element.parentNode)element.parentNode.removeChild(element)}})},initializeDetailsPopup:function(ap,oid){try{var table=this;var record=table.getStore().getAt(table.getStore().find("oid",oid));var columns=table.getColumnModel();var panelAttributes=ap.getAttributeIDs();for(var i=0,l=panelAttributes.length;i<l;i++){var attrId=panelAttributes[i];var potentialColumnId=attrId.replace(".","_");var cell=record.get(potentialColumnId);if(cell){var clonedCell=table._cloneCellForDetailsPopup(cell);
ap.setAttributeValue(attrId,clonedCell)}}}catch(e){PTC.log.error("Error in DetailsPopupGrid.initializeDetailsPopup().",e)}},saveDetailsPopup:function(attributePanelName,oid){try{var lightboxWindow=PTC.lightbox.getLightboxIframeWindow();var apDiv=lightboxWindow.Ext.query("div[id*='"+attributePanelName+"__AttributesTablePaneOuter']")[0];var ap=lightboxWindow.Ext.getCmp(apDiv.id);var panelAttributes=ap.getAttributeIDs();var table=this;var record=table.getStore().getAt(table.getStore().find("oid",oid));
var columns=table.getColumnModel();record.beginEdit();record.detailsPopupHiddenDivId="detailsPopupHiddenDivForRow_"+record.id;var div=this.getHiddenDiv(record.detailsPopupHiddenDivId);for(var i=0,l=panelAttributes.length;i<l;i++){var attrId=panelAttributes[i];try{var cell_TD=lightboxWindow.Ext.query("TD[attrId*="+attrId+"]")[0];var potentialColumnId=attrId.replace(".","_");var cell=ap.getAttributeValue(attrId);var clonedCell=table._cloneCellForDetailsPopup(cell);record.set(potentialColumnId,clonedCell);
var column=columns.getColumnById(potentialColumnId);if(!column){var attributeDivId=div.id+attrId;var attributeDiv=$(attributeDivId);if(!attributeDiv){attributeDiv=document.createElement("div");attributeDiv.id=attributeDivId;div.appendChild(attributeDiv)}attributeDiv.innerHTML=cell_TD.innerHTML}}catch(e){PTC.log.error("DetailsPopupGrid Error saving attrId ",attrId,e)}}record.endEdit();record.commit();return true}catch(ee){PTC.log.error("Error in DetailsPopupGrid.saveDetailsPopup().",ee)}return false},
_launchEditDialog:function(evt,url,formProcessorClasses,record){var table=this;if(!record)if(PTC.menu.contextOid){var store=table.getStore();record=store.getAt(store.find("oid",PTC.menu.contextOid))}else record=PTC.jca.table.Utils.findRecord(evt,table);if(record){var context=record.get("jsca_context");var oid=record.get("oid");var operation=record.get("operation");var formProcessor=operation==="CREATE"?formProcessorClasses.create:formProcessorClasses.edit;newLightBoxAction("editObject",this._addQueryParams(url,
record),"","","","","","","","","","","","","","","","","","",context,oid,formProcessor,"execute","null","","",false,"","row","",false,tableUtils.getFormattedTableId(table.id))}if(evt)Event.stop(evt);return false},_addQueryParams:function(url,record){var params={};params.portlet="poppedup";params.oid=record.get("oid");var objectHandle=record.get("objectHandle");params.currentObjectHandle=objectHandle;var operation=record.get("operation");params[objectHandle+"operation"]=operation;if(operation==="CREATE")params[objectHandle+
PTC.wizard.ITIID]=record.get(PTC.wizard.ITIID);else params[objectHandle+"editObjectRef"]=record.get("editObjectRef");var queryParams=$H(params).toQueryString();if(url.indexOf("?")>0)return url.concat("&").concat(queryParams);else return url.concat("?").concat(queryParams)},_cloneCellForDetailsPopup:function(obj){if(obj===null||typeof obj!=="object")return obj;var temp=isArray(obj)?[]:{};for(var property in obj)if(obj.hasOwnProperty(property))if(typeof obj[property]==="function")temp[property]=obj[property]._originalFuncString_;
else temp[property]=this._cloneCellForDetailsPopup(obj[property]);return temp}});PTC.ux.grid.DetailsPopupGrid.launchEditDialog=function(evt,url,formProcessorClasses){evt=evt||event;evt=evt.browserEvent||evt;var tableId=PTC.jca.table.Utils.findTableID(evt);if(!tableId){var rowMenu=Ext.getCmp("gridRowContextMenu");if(rowMenu)tableId=rowMenu.tableId}var table=PTC.jca.table.Utils.getTable(tableId);table._launchEditDialog(evt,url,formProcessorClasses)};
PTC.ux.grid.DetailsPopupGrid.launchEditDialogOnAdd=function(record,url,formProcessorClasses,tableId){if(record){var table=PTC.jca.table.Utils.getTable(tableId);table._launchEditDialog(null,url,formProcessorClasses,record)}return false};Ext.preg("detailspopupgrid",PTC.ux.grid.DetailsPopupGrid);PTC.action.FormResult=function(config){if(config){config.tableID=tableUtils.getUnformattedTableId(config.tableID);Ext.apply(this,config)}};
PTC.action.FormResult.prototype={getAddedOids:function(){return this._getOids(this.A)},getUpdatedOids:function(){return this._getOids(this.U)},getDeletedOids:function(){return this._getOids(this.Del)},_isEmpty:function(ob){var i;for(i in ob)if(ob[i]!=="function")return false;return true},hasAddedOids:function(){return!this._isEmpty(this.A)},hasUpdatedOids:function(){return!this._isEmpty(this.U)},hasDeletedOids:function(){return!this._isEmpty(this.Del)},hasAnyOids:function(){return this.hasAddedOids()||
this.hasUpdatedOids()||this.hasDeletedOids()},_iterator:function(property,value){this.oids=this.oids.concat(PTC.util.extractAllValues(value))},_collecAllOidsIterator:function(property,value){this.oids=this.oids.concat(PTC.util.extractAllValues(value));this.oids.push(property)},_locationIterator:function(key,value){this.location.push(key)},_getOids:function(anArray,iterator){if(!iterator)iterator=this._iterator;var iteratorScope={oids:[]};PTC.util.propertyIterator(anArray,iteratorScope,iterator,[]);
return iteratorScope.oids},getLocations:function(){var iteratorScope={location:[]};PTC.util.propertyIterator(this.A,iteratorScope,this._locationIterator);PTC.util.propertyIterator(this.U,iteratorScope,this._locationIterator);PTC.util.propertyIterator(this.Del,iteratorScope,this._locationIterator);return iteratorScope.location},getAddedLocations:function(){var iteratorScope={location:[]};PTC.util.propertyIterator(this.A,iteratorScope,this._locationIterator);return iteratorScope.location},isSuccess:function(){return this.status===
0},getTableId:function(){return this.tableID},convertOidReference:function(oid){var reference;if(!this.OR_TO_VR_MAP)return;if(oid.indexOf("OR:")>=0)reference=this.OR_TO_VR_MAP[oid];else PTC.util.propertyIterator(this.OR_TO_VR_MAP,this.OR_TO_VR_MAP,function(key,value){if(value===oid)reference=key});return reference},_updatedOidCheckIterator:function(key,value,oid){var oids=PTC.util.extractAllValues(value);var index=oids.indexOf(oid);if(index>=0)if(oids[index]===oid)this.oid=oids[index];if(key===oid)this.oid=
oids[0]},getUpdatedOid:function(oid){var iteratorScope={oid:null};PTC.util.propertyIterator(this.U,iteratorScope,this._updatedOidCheckIterator,[oid]);if(!iteratorScope.oid&&oid&&oid.indexOf("OR")>=0){oid=this.convertOidReference(oid);PTC.util.propertyIterator(this.U,iteratorScope,this._updatedOidCheckIterator,[oid])}return iteratorScope.oid}};Ext.ns("Ext.ux.grid");
Ext.ux.grid.GridFileInputHandler=Ext.extend(Object,{constructor:function(config){config=config||{};Ext.apply(this,config)},init:function(grid){this.view=grid.getView();grid.addClass("gridfileinputhandler");Ext.apply(this.view,this.viewOverrides);grid.enableColLock=false;grid.enableColumnMove=false;grid.enableSelectedOnly=false;grid.initialConfig.jcaTableConfig.findInTableMode=FindInTableMode.DISABLED;grid.disableMassUpdateOnRemove=true;this.view.doPartialDataChange=this.view.doPartialDataChange.wrap(this.doPartialDataChangeWrapper)},
viewOverrides:{doClean:Ext.emptyFn,onDenyColumnLock:TRUE_FUNC,enableGroupingMenu:false},doPartialDataChangeWrapper:function(p,full){if(this.grid&&this.grid.store&&!this.grid.store.sortInfo)full=false;return p.call(this,full)}});Ext.preg("gridfileinputhandler",Ext.ux.grid.GridFileInputHandler);Ext.grid.GridStateManager2=function(){this.state={}};PTC.jca.table.stickiness={};PTC.jca.table.stickiness.log={};
PTC.jca.table.getActiveViewInfo=function(grid){var activeViewInfo;if(grid.jcaTableConfig&&grid.jcaTableConfig.pickView){var pv=grid.jcaTableConfig.pickView;var activeViewUpdateCount=pv.activeViewUpdateCount;if(activeViewUpdateCount&&pv.activeViewOid)activeViewInfo={viewId:pv.activeViewOid,updateCount:parseInt(activeViewUpdateCount,10)}}return activeViewInfo};
Ext.grid.GridStateManager2.prototype={init:function(grid,provider){this.provider=provider;this.grid=grid;var restoreState=true;this.cm=grid.getColumnModel();var state=provider.get(this.getStateKey());var activeViewInfo_state=state?state.activeViewInfo:undefined;var activeViewInfo_config=PTC.jca.table.getActiveViewInfo(grid);if(activeViewInfo_state)if(activeViewInfo_config)if(activeViewInfo_state["viewId"]===activeViewInfo_config["viewId"]&&activeViewInfo_state["updateCount"]<activeViewInfo_config["updateCount"]){Ext.grid.GridStateManager2.updateState(grid,
provider);PTC.jca.clearMultiColumnSortString(grid.getId());state=provider.get(this.getStateKey());restoreState=false}else if(activeViewInfo_state["viewId"]!==activeViewInfo_config["viewId"]){provider.clear(this.getStateKey());restoreState=false}if(restoreState&&state)this.restoreState(state);this.grid.addEvents("columnConfigChange");this.grid.addEvents("updateTableSize");this.grid.on("columnConfigChange",Ext.grid.GridStateManager2.updateState.createCallback(this.grid,this.provider));this.grid.on("columnresize",
Ext.grid.GridStateManager2.updateState.createCallback(this.grid,this.provider));this.grid.on("updateTableSize",Ext.grid.GridStateManager2.updateTableHeight.createCallback(this.grid,this.provider));this.cm.on("hiddenchange",Ext.grid.GridStateManager2.updateState.createCallback(this.grid,this.provider));this.cm.on("columnmoved",Ext.grid.GridStateManager2.updateState.createCallback(this.grid,this.provider));this.cm.on("afterWrap",Ext.grid.GridStateManager2.updateState.createCallback(this.grid,this.provider))},
restoreState:function(state){var col,colConfig,config,i,sort;if("config"in state){config=state.config;var configLength=config.length;PTC.jca.table.stickiness.log.debug("Restoring table component state, number of columns : ",configLength);this.grid.view.variableRowHeight=state.variableRowHeight;if(this.cm.config&&this.cm.config.length===configLength)for(i=0;i<configLength;i++){colConfig=config[i];col=this.cm.getIndexById(colConfig.id);if(col!=-1){if(PTC.isDefined(colConfig.width))this.cm.config[col].width=
colConfig.width;if(PTC.isDefined(colConfig.isWrapped))this.cm.config[col].isWrapped=colConfig.isWrapped;if(col!=i)this.cm.moveColumn(col,i);if("hidden"in colConfig)this.cm.setHidden(i,colConfig.hidden);else this.cm.setHidden(i,false)}}}},resetState:function(){this.state.config=this.origConfig;this.restoreState(this.state)},getStateKey:function(){return this.grid.id+"-grid-state"},getState:function(){var cachedState=this.provider.get(this.getStateKey());return PTC.isDefined(cachedState)?cachedState:
{}},storeState:function(state){var stateKey=this.getStateKey();this.provider.set(stateKey,state)},destroy:function(){this.grid=undefined;this.cm=undefined;this.provider=undefined}};Ext.grid.GridStateManager2.updateTableHeight=function(grid,provider){var gridManager=grid.getStateManager();var state=gridManager.getState();state.tableHeight=grid.el.getHeight();gridManager.storeState(state)};
Ext.grid.GridStateManager2.updateState=function(grid,provider){var cm=grid.getColumnModel();var gridManager=grid.getStateManager();var state=gridManager.getState();var activeViewInfo_config=PTC.jca.table.getActiveViewInfo(grid);var c=[];for(var i=0;i<cm.config.length;i++)c.push({id:cm.config[i].id,hidden:cm.config[i].hidden,width:cm.config[i].width,isWrapped:cm.config[i].isWrapped});var obj=Ext.encode(c);state.config=Ext.decode(obj);state.variableRowHeight=grid.view.variableRowHeight;if(activeViewInfo_config)state.activeViewInfo=
activeViewInfo_config;gridManager.storeState(state)};
Ext.apply(Ext.grid.GridPanel.prototype,{restoreState:function(provider){if(!provider)provider=Ext.state.Manager;this.gsm=new Ext.grid.GridStateManager2;this.gsm.init(this,provider)},getStateManager:function(){return this.gsm},getStickyConfig:function(){var configState=this.getStateManager().getState();var currentConfig=null;if(configState&&"config"in configState)currentConfig=configState.config;return currentConfig},setStickyConfig:function(cfg){if(cfg){var gridManager=this.getStateManager();var state=
gridManager.getState();if(state){state.config=cfg;gridManager.storeState(state)}}},clearStickyConfig:function(){var sm=this.getStateManager();if(sm)sm.provider.clear(sm.getStateKey())},clearStickyConfigWidth:function(){var stickyConfig=this.getStickyConfig();if(stickyConfig){for(var i=0;i<stickyConfig.length;i++)delete stickyConfig[i].width;this.setStickyConfig(stickyConfig)}},setStickyConfigHidden:function(hide,colId){var gridManager=this.getStateManager();if(gridManager){var configState=gridManager.getState();
var currentConfig=null;if(configState&&"config"in configState){currentConfig=configState.config;if(currentConfig){for(var i=0;i<currentConfig.length;i++)if(currentConfig[i].id==colId){currentConfig[i].hidden=hide;break}configState.config=currentConfig;gridManager.storeState(configState)}}}},getCachedTableHeight:function(){var sm=this.getStateManager();var tableHeight;if(sm)var stateConfig=sm.provider.get(sm.getStateKey());if(PTC.isDefined(stateConfig))return stateConfig.tableHeight;return tableHeight}});
PTC.jca.table.stickiness=function(){var FOCUSED_ROW="_focusedRow";var FOCUSED_OFFSET="_focusOffset";var SEARCH_IN_LIST="_searchInList";var LOCKED_COLUMN_ID="_lockedColumnId";var BUFFER_VIEW_OFFSET=2;function clearAllTableStickiness(){var tables=tableUtils.getTables();for(var i=0,l=tables.length;i<l;i++){var gridId=tables[i].id;clearStickiness(gridId)}}PTC.navigation.on("historyChange",clearAllTableStickiness);var clearStickiness=function(gridId){PTC.attributeHelper.set(gridId+FOCUSED_ROW,null);PTC.attributeHelper.set(gridId+
FOCUSED_OFFSET,null);PTC.attributeHelper.set(gridId+SEARCH_IN_LIST,null);PTC.jca.table.stickiness.clearLockingStickiness(gridId);PTC.jca.table.stickiness.log.debug("Cleared stickiness for table component : ",gridId)};return{clearAllTablesStickiness:function(){clearAllTableStickiness()},clearTableStickiness:function(gridId){clearStickiness(gridId)},clearTableStickinessInTab:function(tabId){var tables=PTC.jca.table.Utils.getExtTables(Ext.get(tabId).dom);for(var i=0,length=tables.length;i<length;i++)PTC.jca.table.stickiness.clearTableStickiness(tables[i].id)},
setFocusRow:function(gridId,focusedRow){PTC.attributeHelper.set(gridId+FOCUSED_ROW,focusedRow)},getFocusRow:function(gridId){return PTC.attributeHelper.get(gridId+FOCUSED_ROW)},clearFocusRow:function(gridId){PTC.attributeHelper.set(gridId+FOCUSED_ROW,null);PTC.attributeHelper.set(gridId+FOCUSED_OFFSET,null)},setSearchInListText:function(gridId,searchText){PTC.attributeHelper.set(gridId+SEARCH_IN_LIST,searchText)},getSearchInListText:function(gridId){return PTC.attributeHelper.get(gridId+SEARCH_IN_LIST)},
clearSearchInListText:function(gridId){PTC.attributeHelper.set(gridId+SEARCH_IN_LIST,null)},setLockedColumnId:function(gridId,lockColumnId){PTC.attributeHelper.set(gridId+LOCKED_COLUMN_ID,lockColumnId)},getLockedColumnId:function(gridId){return PTC.attributeHelper.get(gridId+LOCKED_COLUMN_ID)},clearLockingStickiness:function(gridId){PTC.attributeHelper.set(gridId+LOCKED_COLUMN_ID,null)},setFocusOffset:function(gridId,offset){PTC.attributeHelper.set(gridId+FOCUSED_OFFSET,offset)},getFocusOffset:function(gridId){return PTC.attributeHelper.get(gridId+
FOCUSED_OFFSET)},clearFocusOffset:function(gridId){PTC.attributeHelper.set(gridId+FOCUSED_OFFSET,null)},getBufferViewOffset:function(){return BUFFER_VIEW_OFFSET},initializeSearchInListFilter:function(grid){if(grid){var searchText=PTC.jca.table.stickiness.getSearchInListText(grid.id);if(searchText&&searchText.trim().length>0){grid.searchInString=PTC.jca.table.fit.getSafeSearchTerm(searchText);var searchInListTextBox=Ext.getCmp(PTC.jca.table.findInTable.getSearchInListTextBoxName(grid.id));searchInListTextBox.setValue(searchText);
return true}}return false},applyTableStickiness:function(){var focusRowId=this.grid.scrollIndex;var alreadyCached=false;if(this.grid.skipFocusCheck!==true)if(focusRowId)alreadyCached=true;else focusRowId=PTC.jca.table.stickiness.getFocusRow(this.grid.id);if(focusRowId){var fRowIndex=PTC.jca.table.Utils.getRowByUniqueIdentifier(this.grid.getStore(),focusRowId);if(fRowIndex>-1){PTC.jca.table.Utils.focusRow(this.grid,fRowIndex,false,alreadyCached);if(this.grid.alreadyScrolled!==true)PTC.jca.table.Utils.scrollToFocusRow(this.grid,
fRowIndex)}}else this.grid.skipFocusCheck=true;PTC.jca.table.Utils.applyColumnLock(this.grid,true)}}}();PTC.jca.table.stickiness.log=log4javascript.getLogger("PTC.jca.table.stickiness");
PTC.util.HTMLEncoder={NBSP:"&nbsp;",AMPERSAND_HTML_ENCODED:"&#38;",LESS_THAN_HTML_ENCODED:"&lt;",GREATER_THAN_HTML_ENCODED:"&gt;",DOUBLE_QUOTE_HTML_ENCODED:"&quot;",SINGLE_QUOTE_HTML_ENCODED:"&#39;",handleAdjacentSpaces:function(str){function getReplacementString(spaces){var returnVal="";var i=spaces.length;while(i--)returnVal+=PTC.util.HTMLEncoder.NBSP;return returnVal}if(typeof str==="string")str=str.replace(/( ){2,}/g,getReplacementString);return str},encodeForHTMLContent:function(str){if(typeof str===
"string"){str=str.replace(/[&]/g,this.AMPERSAND_HTML_ENCODED);str=str.replace(/[<]/g,this.LESS_THAN_HTML_ENCODED);str=str.replace(/[>]/g,this.GREATER_THAN_HTML_ENCODED);str=str.replace(/[\"]/g,this.DOUBLE_QUOTE_HTML_ENCODED);str=str.replace(/[\']/g,this.SINGLE_QUOTE_HTML_ENCODED)}return str},encodeForHTMLAttribute:function(str){return this.encodeForHTMLContent(str)},encodeAndFormatForHTMLContent:function(str){return this.handleAdjacentSpaces(this.encodeForHTMLContent(str))},encodeForHTMLContentAndCreateHyperLinks:function(str){return this.encodeForHTMLContent(str)},
encodeForHTTPServletResponse:function(str){return this.encodeForHTMLContent(str)}};Ext.ns("PTC.ux.grid");PTC.ux.grid.RichTextGrid=Ext.extend(Object,{constructor:function(config){config=config||{};Ext.apply(this,config)},init:function(grid){grid.preventBodyReset=true;var view=grid.getView();if(view&&Ext.isFunction(view.setVariableRowHeight))view.setVariableRowHeight(true)}});Ext.preg("richtextgrid",PTC.ux.grid.RichTextGrid);
PTC.jca.state.ServerStateProvider=function(){function ServerStateProviderSingleton(config){ServerStateProviderSingleton.superclass.constructor.call(this);Ext.apply(this,config);this.url=getBaseHref()+"ptc1/stateManager/";this.cache=new Hash}Ext.extend(ServerStateProviderSingleton,Ext.state.Provider,{set:function(key,value){this.checkKey(key);if(this.cache.get(key)===value)return;var encodedValue=this.encodeValue(value);var options={method:"post",parameters:{key:key,value:encodedValue}};var transport=
requestHandler.doRequest(this.url,options);this.cache.set(key,value);this.fireEvent("statechange",this,key,value)},get:function(key,defaultValue){this.checkKey(key);var value=this.cache.get(key);if(value!==null&&value!==undefined)return value;else{var options={method:"get",asynchronous:false,parameters:{key:key}};var transport=requestHandler.doRequest(this.url,options);value=transport.responseText;if(value==="")value=defaultValue;else value=this.decodeValue(value);this.cache.set(key,value);return value}},
clear:function(key){this.set(key,"")},checkKey:function(key){if(!key)throw new Error("The key key should not be null or empty");}});var singleton=new ServerStateProviderSingleton({id:"infoPage.tabState"});return{get:function(key,defaultVal){return singleton.get(key,defaultVal)},set:function(key,value){singleton.set(key,value)},clear:function(key){singleton.clear(key)},checkKey:function(key){singleton.checkKey(key)},on:function(event,eventhandler){singleton.on(event,eventhandler)},clearAll:function(){singleton.cache=
new Hash;singleton.set("clearAll","");var msg={MessageTitle:bundleHandler.get("com.ptc.core.ui.successMessagesRB.SERVER_STICKINESS_CLEARED"),MessageType:"SUCCESS",Messages:[bundleHandler.get("com.ptc.core.ui.successMessagesRB.SERVER_STICKINESS_CLEARED_MSG")]};PTC.getMainWindow().PTC.messaging.showInlineMessage([msg])}}}();
PTC.jca.state.clearServerStickinessConfirmation=function(){var storageProvider=PTC.jca.state.ServerStateProvider;var clearSticky=JCAConfirm("com.ptc.netmarkets.software.softwareResource.SERVER_STORAGE_CONFIRMATION");if(clearSticky)storageProvider.clearAll()};PTC.SysNav={};PTC.SysNav.CLOSE_SYSNAV_WELCOME_PAGE="CloseSysNavWelcomePage";
Ext.ux.TabContextMenu=function(){function onContextMenu(tabPanel,item,e){e.stopEvent();if(item.allowContextMenu===false)return;var formAction=PTC.util.getFormAction(getMainForm());var params={context:decodeURIComponent(extractParamValue(formAction,"ContainerOid")),oid:item.oid,tableID:item.id,actionName:"actionsMenu"};PTC.menu.showActionsMenu(e,params,item)}this.init=function(tp){tp.on("contextmenu",onContextMenu)}};PTC.jca.manager={};PTC.jca.manager.log=log4javascript.getLogger("PTC.jca.manager");
PTC.jca.manager.jsonMethod="post";
PTC.jca.manager.TabManager=Ext.extend(Object,{constructor:function(config){config=config||{};config.url=config.url||getBaseHref()+"ptc1/tab/";Ext.apply(this,config)},init:function(tabPanel){this.tabPanel=tabPanel},invokeAction:function(tab,options){Ext.applyIf(options,{method:PTC.jca.manager.jsonMethod,onFailure:PTC.jca.manager.showFailureMessage});return requestHandler.doRequest(this.url,options)},add:function(callback,params){PTC.jca.manager.log.debug("Calling add() in TabManager, saving tab...");var tabPanel=
this.tabPanel;var newTab=null;var title=PTC.infoPage.myTab.getUniqueTabName(tabPanel);Ext.applyIf(params=params?params:{},{data:Ext.encode({name:title,tabSetKey:PTC.infoPage.TabUtils.getTabSetKey(tabPanel.infoModel),objectType:PTC.infoPage.TabUtils.getObjectType(tabPanel.infoModel),isPublic:false}),action:"create"});var options={parameters:params,onSuccess:function(response){var json=response.responseJSON;var tabPanelConfig=PTC.infoPage.myTab.getNewTabConfig(tabPanel,json);newTab=new PTC.infoPage.myTab.MyTabPanel(tabPanelConfig);
var addTabTab=Ext.get(tabPanel.id+"__new_tab_action");if(addTabTab)tabPanel.insert(tabPanel.items.length-1,newTab);else tabPanel.insert(tabPanel.items.length,newTab);tabPanel.setActiveTab(newTab.id);if(callback)callback(newTab,tabPanel);tabPanel.tabSet.saveTabOrderAddTab(tabPanel,newTab.actionID)}};this.invokeAction(null,options);return newTab},updateTab:function(tab,name,visibility,callback,failureCallback,params,isInherit){PTC.jca.manager.log.debug("entered TabManager.updateTab(). tab = ",tab,"name = ",
name,"visibility = ",visibility);var isPublic="";if(visibility)isPublic=visibility==="public";var infoModel=this.tabPanel.infoModel?this.tabPanel.infoModel:tab.getOwner().infoModel;Ext.applyIf(params=params?params:{},{data:Ext.encode({oid:tab.oid,name:name,isPublic:isPublic,tabSetKey:PTC.infoPage.TabUtils.getTabSetKey(infoModel),objectType:PTC.infoPage.TabUtils.getObjectType(infoModel),inherit:isInherit}),action:"update"});var options={parameters:params,onSuccess:function(response){if(callback)tab=
callback(tab,options.parameters)}};if(failureCallback)Ext.applyIf(options,{onFailure:function(response){failureCallback(tab,response)}});this.invokeAction(tab,options);return true},deleteTab:function(tab,callback){var tabPanel=this.tabPanel;var okButtonText=bundleHandler.get("com.ptc.core.ui.navigationRB.okButton");var cancelButtonText=bundleHandler.get("com.ptc.core.ui.navigationRB.cancelButton");Ext.Msg.show({title:bundleHandler.get("com.ptc.core.ui.confirmationMessagesRB.DELETE_TAB_CONFIRMATION_TITLE"),
msg:bundleHandler.get("com.ptc.core.ui.confirmationMessagesRB.DELETE_TAB_CONFIRMATION_MESSAGE"),buttons:{ok:okButtonText,cancel:cancelButtonText},icon:"deleteTab-confirm-icon",fn:function(buttonId,text,opt){if(buttonId==="ok"){PTC.jca.manager.log.debug("calling deleteTab() in TabManager, deleting tab: ",tab);var options={parameters:{data:Ext.encode({oid:tab.oid}),action:"delete"},onSuccess:function(response){var oldTables=PTC.infoPageTableMgr._getRenderedTablesForTab(tab.id);for(var i=0;i<oldTables.length;i++)PTC.infoPageTableMgr.removeRenderedTable(oldTables[i].containerDiv,
oldTables[i].tabId);if(typeof tab.getTableContainer==="function"){var tabContainer=tab.getTableContainer();if(tabContainer&&typeof tabContainer.clearTableStickinessInTab==="function")tabContainer.clearTableStickinessInTab(tab.id)}tabPanel.remove(tab);return callback?callback(tab):TRUE_FUNC}};PTC.infoPage.getTabManager(tabPanel).invokeAction(tab,options);return true}}});return false},getTabSet:function(){return this.tabPanel.items.items},setActiveTab:function(activeTab){this.activeTab=activeTab},getActiveTab:function(){return this.activeTab},
destroy:function(){delete this.activeTab;delete this.tabPanel}});
PTC.jca.manager.TabContentManager=Ext.extend(Object,{constructor:function(config){config=config||{};config.url=config.url||getBaseHref()+"ptc1/tab/";Ext.apply(this,config)},init:function(tab){this.tab=tab;this.invokeAction=PTC.util.delayAllCalls(this.invokeAction)},invokeAction:function(item,options,componentFilter){if(!this.tab.oid)return;var tabItems=[];this.tab.getTableContainer().items.each(function(table){if(componentFilter(item,table))tabItems.push({name:table.actionName,type:table.actionType})});
if(this.tab.isHomepageTab&&this.tab.isSiteConfig){this.createHomePageTab(tabItems);return}var obj={oid:this.tab.oid,components:tabItems};Ext.applyIf(options,{method:PTC.jca.manager.jsonMethod,parameters:{data:Ext.encode(obj),action:"update"},onFailure:PTC.jca.manager.showFailureMessage});requestHandler.doRequest(this.url,options)},createHomePageTab:function(tabItems){var tab=this.tab;var newClientTabOptions={parameters:{data:Ext.encode({name:"homepage",objectType:"home-page",tabSetKey:"home-page",
components:tabItems}),action:"create"},onSuccess:function(response){var json=response.responseJSON;tab.oid=json.oid;tab.isSiteConfig=false;tab.editable=true},onFailure:PTC.jca.manager.showFailureMessage};requestHandler.doRequest(this.url,newClientTabOptions)},add:function(item,callback){PTC.jca.manager.log.debug("calling add() in TabContentManager, adding item: ",item);return this.invokeAction(item,{onSucess:callback},TRUE_FUNC)},remove:function(item){PTC.jca.manager.log.debug("calling remove() in TabContentManager, removing item: ",
item);var tab=this.tab;var successFunc=function(){tab.remove(item)};var filter=function(item,table){return table.actionName!==item.actionName||table.actionType!==item.actionType};return this.invokeAction(item,{onSuccess:successFunc},filter)},saveItems:function(callback){PTC.jca.manager.log.debug("calling saveItems() in TabContentManager, saving item: ",this.tab.items);return this.invokeAction(this.tab.items,{onSuccess:callback},TRUE_FUNC)},getContents:function(){var items=[];if(PTC.infoPageTableMgr._getRenderedTablesForTab(this.tab.id).length===
0){if(this.tab.initialConfig&&this.tab.initialConfig.defaultItems)items=this.tab.initialConfig.defaultItems}else items=PTC.infoPageTableMgr._getRenderedTablesForTab(this.tab.id);return items},_getInfoPage:function(infoPageChild){if(!infoPageChild)return false;if(infoPageChild.initialConfig&&infoPageChild.initialConfig.cls==="infoPage")return infoPageChild;else return!infoPageChild.ownerCt?undefined:this._getInfoPage(infoPageChild.ownerCt)},reloadContents:function(){var items=this.getContents();var thirdLevelNavModel=
this.tab.thirdLevelNavModel;var serializedMainForm=Ext.lib.Ajax.serializeForm(getMainForm(this._getInfoPage(this.tab).getEl().dom));for(var i=0,l=items.length;i<l;i++){var item=items[i];var itemCconfig=PTC.actionModel.getActionConfig(item.id,thirdLevelNavModel);var itemDivId=item.containerDiv;var dom=Ext.get(itemDivId).dom;PTC.navigation.overwrite(dom,'<div style="background: url(netmarkets/javascript/ext/resources/images/default/shared/blue-loading.gif) no-repeat center center; height: 100px">&nbsp;</div>');
getElementHtml(serializedMainForm,itemDivId,true,itemCconfig.actionURL,false)}},destroy:function(){delete this.tab;delete this.invokeAction}});
PTC.jca.manager.PortalContentManager=Ext.extend(Object,{constructor:function(config){config=config||{};config.url=config.url||getBaseHref()+"ptc1/tab/";Ext.apply(this,config)},init:function(column){this.column=column;this.invokeAction=PTC.util.delayAllCalls(this.invokeAction)},invokeAction:function(paramData,action,onSuccess){var column=this.column;var components=[];var portlets=column.getPortlets();for(var i=0,l=portlets.length;i<l;i++){var portlet=portlets[i];components.push({name:portlet.actionName,
type:portlet.actionType,collapse:portlet.collapsed})}var data={name:"miniNavWidgets",components:components,isPublic:false};Ext.apply(data,paramData);var options={method:PTC.jca.manager.jsonMethod,parameters:{data:Ext.encode(data),action:action},onSuccess:onSuccess,onFailure:PTC.jca.manager.showFailureMessage};return requestHandler.doRequest(this.url,options)},create:function(){PTC.jca.manager.log.debug("Calling create() in PortalContentManager, saving portal column...");var column=this.column;var onSuccess=
function(response){var json=response.responseJSON;column.oid=json.oid};this.invokeAction({objectType:column.objectType,tabSetKey:column.tabSetKey},"create",onSuccess)},update:function(){PTC.jca.manager.log.debug("Calling update() in PortalContentManager, updating portlets...");this.invokeAction({oid:this.column.oid},"update",Ext.emptyFn)}});
PTC.jca.manager.showFailureMessage=function(){var title=bundleHandler.get("com.ptc.core.ui.errorMessagesRB.PERSIST_TAB_ERROR_HEADER");var msg=bundleHandler.get("com.ptc.core.ui.errorMessagesRB.PERSISTENCE_ERROR");PTC.messaging.showWarningMessage(title,msg)};
Ext.ux.TabScrollerAddTabButton=Ext.extend(Object,{constructor:function(config){config=config||{};Ext.apply(this,config)},init:function(tabPanel){Ext.apply(tabPanel,this.tabPanelMethods);tabPanel.TabScrollerAddTabButton=this;var thisRef=this;tabPanel.on({render:{scope:tabPanel,single:true,fn:function(){var newFn=tabPanel.createScrollers.createSequence(thisRef.createPanelsAddTabButton,this);tabPanel.createScrollers=newFn}}})},createPanelsAddTabButton:function(){var h=this.stripWrap.dom.offsetHeight;
var rtScrBtn=this.header.dom.firstChild;Ext.fly(rtScrBtn).applyStyles({right:"18px"});var stripWrap=Ext.get(this.strip.dom.parentNode);stripWrap.applyStyles({"margin-right":"36px"});var addTabButton=this.header.insertFirst({cls:"x-tab-addTabButton-right"});Ext.QuickTips.register({target:addTabButton,text:bundleHandler.getBundleStringAndInserts("com.ptc.core.ui.navigationRB.INFO_PAGE_NEW_TAB",[""])});var rightScroller=Ext.query(".x-tab-scroller-right");if(rightScroller.size()>0)Ext.QuickTips.register({target:rightScroller[0],
text:bundleHandler.get("com.ptc.core.ui.navigationRB.SCROLL_TABS_RIGHT")});addTabButton.setHeight(h);addTabButton.addClassOnOver("x-tab-addTabButton-over");addTabButton.on("click",this.addTabButtonHandler,this);var addTabTab=Ext.get("infoPageinfoPanelID__new_tab_action");if(addTabTab)addTabTab.hide();this.scrollLeft.show=this.scrollLeft.show.createSequence(function(){addTabButton.show();if(addTabTab===null)addTabTab=Ext.get("infoPageinfoPanelID__new_tab_action");if(addTabTab)addTabTab.hide();stripWrap.applyStyles({overflow:"hidden"})});
Ext.QuickTips.register({target:this.scrollLeft,text:bundleHandler.get("com.ptc.core.ui.navigationRB.SCROLL_TABS_LEFT")});var tabPanel=this;this.scrollLeft.hide=this.scrollLeft.hide.createSequence(function(){if(addTabTab===null)addTabTab=Ext.get("infoPageinfoPanelID__new_tab_action");if(addTabTab)addTabTab.show();else PTC.infoPage.myTab.addNewTabAction(tabPanel.id);addTabButton.hide();stripWrap.applyStyles({overflow:"visible"})})},tabPanelMethods:{addTabButtonHandler:function(e){PTC.infoPage.myTab.addNewTab(this)}}});
PTC.infoPage.TabSet=Ext.extend(Object,{constructor:function(config){config=config||{};Ext.apply(this,config)},TAB_ORDER_PREFIX:"infoPage_tabOrder_",MAX_NEW_TAB_LENGTH:9,FIRST_ARRAY_POSTION:0,LEFT_TAB_OFFSET:-1,RIGHT_TAB_OFFSET:1,getAllServerTabIds:function(){return Ext.pluck(this.serverTabSet,"actionID")},getPreferenceKey:function(){return this.TAB_ORDER_PREFIX+this.objectType+"_"+this.tabSetKey},saveTabOrderAddTab:function(tabPanel,actionID){this.superSetIds[this.superSetIds.length]=actionID;this.setPreferenceTabOrder(this.superSetIds)},
saveTabOrderRemoveTab:function(tabPanel,actionID){this.superSetIds.remove(actionID);this.setPreferenceTabOrder(this.superSetIds)},saveTabOrderDrag:function(tabPanel,actionID,toPosition){if(toPosition===this.FIRST_ARRAY_POSTION){this.superSetIds.remove(actionID);this.superSetIds.splice(this.FIRST_ARRAY_POSTION,0,actionID)}else{var leftTabActionId=tabPanel.items.items[toPosition+this.LEFT_TAB_OFFSET].actionID;this.superSetIds.remove(actionID);var leftTabIndex=0;for(var i=0;i<this.superSetIds.length;i++)if(this.superSetIds[i]===
leftTabActionId){leftTabIndex=i;break}this.superSetIds.splice(leftTabIndex+this.RIGHT_TAB_OFFSET,0,actionID)}this.setPreferenceTabOrder(this.superSetIds)},getPreferenceTabOrderString:function(){return PTC.jca.state.ServerStateProvider.get(this.getPreferenceKey())},setPreferenceTabOrder:function(idList){var idListString=idList.join(",");PTC.jca.state.ServerStateProvider.set(this.getPreferenceKey(),idListString)},getPreferenceTabOrder:function(){var idList=this.getPreferenceTabOrderString();if(!idList)return null;
return idList.split(",")},convertActionIdArrayToTabObjectArray:function(orderedTabIds){var orderResult=[];for(var j=orderedTabIds.length;j--;)for(var k=this.serverTabSet.length;k--;)if(this.serverTabSet[k].actionID===orderedTabIds[j]){orderResult[j]=this.serverTabSet[k];break}return orderResult},getCalculatedTabOrder:function(){var serverIds=this.getAllServerTabIds();this.superSetIds=serverIds.clone();var prefIds=this.getPreferenceTabOrder();if(prefIds===null||this.serverTabSet===null){PTC.infoPage.TabUtils.log.debug("no preference for this object currently exists so just returning it");
return this.serverTabSet}var addedServerIds=serverIds.clone();var validIds=prefIds.findAll(function(id){if(serverIds.include(id)){addedServerIds.remove(id);return true}});if(validIds.length===0||addedServerIds.length>this.MAX_NEW_TAB_LENGTH){PTC.infoPage.TabUtils.log.debug("no valid tabs to return so returning unchanged tabSet");return this.serverTabSet}var orderedTabIds=prefIds.clone();this.serverTabSet.each(function(tab){if(!orderedTabIds.include(tab.actionID))orderedTabIds[orderedTabIds.length]=
tab.actionID});this.superSetIds=orderedTabIds.clone();prefIds.each(function(tab){if(!serverIds.include(tab))orderedTabIds.remove(tab)});return this.convertActionIdArrayToTabObjectArray(orderedTabIds)}});
PTC.infoPage.TabUtils=function(){return{log:log4javascript.getLogger("PTC.infoPage.TabUtils"),getTabIdPrefix:function(infoModel){return infoModel.id+"_myTab"},getTabById:function(tabSet,tabId){for(var i=0;i<tabSet.length;i++)if(tabSet[i].id===tabId)return tabSet[i];return null},isTableOnTab:function(tab,tableAction){var tables=tab.tabContentManager?tab.tabContentManager.getContents():tab.defaultItems?tab.defaultItems:[];for(var i=0,numTables=tables.length;i<numTables;i++)if(tables[i].id===tableAction)return true;
return false},getTableOnActionModel:function(items,actionId,foundTable){for(var i=0;i<items.size();i++)if(items[i].items){foundTable=PTC.infoPage.TabUtils.getTableOnActionModel(items[i].items,actionId,foundTable);if(foundTable)break}else{var action=items[i].actionID;if(action&&action===actionId){foundTable=items[i];break}}return foundTable},isTabPanelRenderedTimeout:null,isTabPanelRendered:function(callback){if(PTC.infoPage.getTabPanel()&&PTC.infoPage.getTabPanel().getActiveTab()){clearTimeout(PTC.infoPage.TabUtils.isTabPanelRendered);
if(callback)callback.defer(1E3)}else if(!PTC.infoPage.isTabPanelRenderedTimeout)this.isTabPanelRenderedTimeout=setTimeout(function(){PTC.infoPage.TabUtils.isTabPanelRendered(callback)},1E3)},getTabSetKey:function(infoModel){return infoModel.tabSet.tabSetKey},getObjectType:function(infoModel){return infoModel.tabSet.objectType}}}();
if(typeof Ext!=="undefined"){PTC.navigation.stateProvider=new PTC.jca.state.ClientStateProvider({domstorage:"local"});Ext.ux.TreePanelStateful=Ext.extend(Ext.tree.TreePanel,{state:null,stateful:true,lastSelectedNode:null,stateEvents:[{click:{fn:function(node){PTC.navigation.stateProvider.set("LastSelectedNodePath_"+this.id,node.getPath());PTC.navigation.stateProvider.set("LastSelectedNodeId_"+this.id,node.id)}},expandnode:{fn:function(node){var currentPath=node.getPath();var newState=[];for(var i=
0;i<this.state.length;++i){var path=this.state[i];if(currentPath.indexOf(path)==-1)newState.push(path)}newState.push(currentPath);this.saveState(newState)}},collapsenode:{fn:function(node){if(node.id==this.root.id)return;var closedPath=node.getPath();var newState=[];var parentNode;for(var i=0;i<this.state.length;++i){var path=this.state[i];if(path.indexOf(closedPath)==-1)newState.push(path);else{parentNode=node.parentNode;if(parentNode.id!=this.root.id)newState.push(parentNode.getPath())}}if(newState.length===
0){parentNode=node.parentNode;newState.push(!parentNode?this.pathSeparator:parentNode.getPath())}this.saveState(newState)}},load:{fn:function(node){var lastSelectedNodePath=PTC.navigation.stateProvider.get("LastSelectedNodePath_"+this.id);var lastSelectedNodeId=PTC.navigation.stateProvider.get("LastSelectedNodeId_"+this.id);var rootNode=this.getRootNode();if(node.id==rootNode.id==lastSelectedNodeId){this.selectPath(lastSelectedNodePath);node.fireEvent("click",node);return}if(node.id==lastSelectedNodeId)node.fireEvent("click",
node);else{var childNode=node.findChild("id",lastSelectedNodeId);if(childNode&&childNode.isLeaf()){childNode.ensureVisible();this.selectPath(lastSelectedNodePath);childNode.fireEvent("click",childNode)}else if(childNode&&!childNode.isLeaf()){this.selectPath(lastSelectedNodePath);childNode.fireEvent("click",childNode)}}}},textchange:{fn:function(node,text,oldText){var lastSelectedNodePath=PTC.navigation.stateProvider.get("LastSelectedNodePath_"+this.id);var newSelectedNodePath=lastSelectedNodePath.replace(oldText,
text);PTC.navigation.stateProvider.set("LastSelectedNodePath_"+this.id,newSelectedNodePath);this.expandPath(node.getPath());this.selectPath(node.getPath())}},remove:{fn:function(tree,parent,node){var lastSelectedNodePath=PTC.navigation.stateProvider.get("LastSelectedNodePath_"+this.id);var lastSelectedNodeId=PTC.navigation.stateProvider.get("LastSelectedNodeId_"+this.id);if(node.id==lastSelectedNodeId){PTC.navigation.stateProvider.set("LastSelectedNodePath_"+this.id,parent.getPath());PTC.navigation.stateProvider.set("LastSelectedNodeId_"+
this.id,parent.id)}}},expand:{fn:function(){PTC.navigation.stateProvider.set("AccordionPanelExpanded",this.id)}},collapse:{fn:function(node){exc=function(node){var lastExpanded=PTC.navigation.stateProvider.get("AccordionPanelExpanded");if(lastExpanded==this.id)PTC.navigation.stateProvider.set("AccordionPanelExpanded","")};exc.defer(1,this,[node])}},resize:{fn:function(){PTC.navigation.stateProvider.set("AccordionPanelWidth",this.ownerCt.getInnerWidth())}}}],saveState:function(newState){this.state=
newState;PTC.navigation.stateProvider.set("TreePanelStateful_"+this.id,this.state)},restoreState:function(defaultPath){var lastSelectedNode=PTC.navigation.stateProvider.get("LastSelectedNodeId_"+this.id);var stateToRestore=this.state;if(this.state.length===0){var newState=[defaultPath];this.saveState(newState);this.expandPath(defaultPath);return}for(var i=0;i<stateToRestore.length;++i)try{var path=stateToRestore[i];this.expandPath(path)}catch(e){}},initComponent:function(){Ext.ux.TreePanelStateful.superclass.initComponent.call(this);
if(!this.stateful)this.stateful=true;if(!this.lastSelectedNode){var cookieLastSelectedNode=PTC.navigation.stateProvider.get("LastSelectedNodeId_"+this.id);if(!cookieLastSelectedNode)this.lastSelectedNode=this.root;else this.lastSelectedNode=cookieLastSelectedNode}if(!this.state){var cookieState=PTC.navigation.stateProvider.get("TreePanelStateful_"+this.id);if(!cookieState)this.state=[];else this.state=cookieState}}});Ext.ux.TreePanelStateful.restore=function(accordion){var expandedPanel=PTC.navigation.stateProvider.get("AccordionPanelExpanded");
if(expandedPanel){var panelToRestore=accordion.getComponent(expandedPanel);if(panelToRestore){panelToRestore.expand(false);panelToRestore.restoreState()}}}}Ext.ns("PTC.ux.grid");
PTC.ux.grid.WizardGrid=Ext.extend(Object,{constructor:function(config){config=config||{};Ext.apply(this,config)},init:function(grid){grid.on("submit",this.onSubmit,grid);grid.getHiddenDiv=this.getHiddenDiv;grid.ObjHandleHiddenInputTemplate=this.ObjHandleHiddenInputTemplate},onSubmit:function(){var table=this;var store=table.getStore();var html=[];var ITIID=PTC.wizard.ITIID;var hiddenInputTemplate=table.ObjHandleHiddenInputTemplate;store.each(function(row){var objectHandle=row.get("objectHandle");
var config={objectHandle:objectHandle};var tiid=row.get(ITIID);if(tiid){config.name=ITIID;config.value=tiid;html[html.length]=hiddenInputTemplate.apply(config)}var editObjectRef=row.get("editObjectRef");if(editObjectRef){config.name="editObjectRef";config.value=editObjectRef;html[html.length]=hiddenInputTemplate.apply(config)}var operation=row.get("operation");if(operation){config.name="operation";config.value=operation;html[html.length]=hiddenInputTemplate.apply(config)}});var id=table.id+"_FormDataFromOnSubmitListener";
var div=table.getHiddenDiv(id);div.innerHTML=html.join("")},getHiddenDiv:function(id){var form=getMainForm();var div=$(id);if(!div){div=form.ownerDocument.createElement("div");div.style.display="none";div.id=id;form.appendChild(div)}return div},ObjHandleHiddenInputTemplate:new Ext.Template('<input type="hidden" name="{objectHandle}{name}" value="{value}"/>',{compiled:true,disableFormats:true})});Ext.preg("wizardgrid",PTC.ux.grid.WizardGrid);PTC.taskbar={};
var insideIframe=getWindow().location.href!==window.location.href;
if(PTC.navigation.isShell()&&!insideIframe){PTC.taskbar.launchTaskbarListener=function(){if(top.PTC&&top.PTC.getMainWindow&&top.PTC.getMainWindow().PTC)top.PTC.getMainWindow().PTC.taskbar.launchTaskbar()};PTC.taskbar.AfterLoadContent=function(){if(taskWindow)PTC.taskbar.launchTaskbarListener()};PTC.taskbar.OnReady=function(){PTC.taskbar.launchTaskbarListener()};PTC.taskbar.launchTaskbarListener=PTC.util.delayAllCalls(PTC.taskbar.launchTaskbarListener);PTC.navigation.on("afterLoadContent",PTC.taskbar.AfterLoadContent);
PTC.onReady(PTC.taskbar.OnReady)}var taskDialogLoaded="";PTC.taskbar.taskbarWindow=null;PTC.taskbar.saveButton=null;PTC.taskbar.completeButton=null;PTC.taskbar.continueButton=null;taskWindow=null;var taskWindowX=-1;var taskWindowY=-1;function closingBar(){if(taskWindow){taskWindow.destroy();taskWindow=null}taskDialogLoaded="";if(PTC.taskbar.taskbarWindow){PTC.taskbar.taskbarWindow.close();PTC.taskbar.taskbarWindow.destroy()}return false}
function getTaskbarCommentValue(){var commentTextArea=document.getElementById("taskbar_comment");if(commentTextArea)return commentTextArea.value;else return commentTextArea}function taskbarCommentSaved(req){var response=new String(req.responseText);var commentsOld=document.getElementById("taskbar_comment___old");if(commentsOld)commentsOld.value=getTaskbarCommentValue();PTC.taskbar.saveButton.disable()}
function saveTaskbarCommentFromLightBox(data){var commentTextArea=data.getElementById("taskbar_comment");var commentTextAreaValue="";if(commentTextArea)commentTextAreaValue=commentTextArea.value;else commentTextAreaValue=commentTextArea;var jspName="netmarkets/jsp/workitem/taskbarActions.jsp";var fullURL=jspName;var selection="textareaComment="+commentTextAreaValue+"&taskbarOperation=Save";if(taskDialogLoaded&&taskDialogLoaded.length>0)selection+="&taskWindowOid="+taskDialogLoaded;PTC.taskbar.sendRequest(fullURL,
taskbarCommentSaved,null,"POST",selection,true)}function saveTaskbarComment(){var commentTextAreaValue=getTaskbarCommentValue();var jspName="netmarkets/jsp/workitem/taskbarActions.jsp";var fullURL=jspName;var selection="textareaComment="+commentTextAreaValue+"&taskbarOperation=Save";PTC.taskbar.sendRequest(fullURL,taskbarCommentSaved,null,"POST",selection,true)}
function taskbarCompletedSuccessfully(req){var response=new String(req.responseText);response=response.trim();if(response.startsWith("sucecss")){wfalert(getBundleStringAndInserts("wt.workflow.worklist.worklistResource.TASK_WINDOW_COMPLETE_MESSAGE"));closingBar()}else if(response.startsWith("javascript:"))eval(response)}
function completeTaskbar(){var commentTextAreaValue=getTaskbarCommentValue();var jspName="netmarkets/jsp/workitem/taskbarActions.jsp";var fullURL=jspName;var selection="textareaComment="+commentTextAreaValue+"&taskbarOperation=Complete";if(taskDialogLoaded&&taskDialogLoaded.length>0)selection+="&taskWindowOid="+taskDialogLoaded;PTC.taskbar.sendRequest(fullURL,taskbarCompletedSuccessfully,null,"POST",selection,true)}
function popupCompleteTaskbar(){var commentTextAreaValue=getTaskbarCommentValue();popupAction("taskbarWizard","ptc1/workitem/taskbarWizard","textareaComment",commentTextAreaValue,"oid",taskDialogLoaded,"","","","","","","","","portlet","poppedup","context","work$workflowTaskbar$$","","","work$workflowTaskbar$$","none","com.ptc.netmarkets.work.NmWorkItemCommands","completeTask","height=700,width=650","null","null",false,"P27","","",false,"null")}
function mainComplete(data){if(data.getElementById("popup"))popupCompleteTaskbar();else completeTaskbar()}function continueToTaskDetails(data){var url=data.getElementsByName("TaskDetailsLink")[0];if(url&&url.value)PTC.navigation.loadContent(url.value+"&toMainTab=true");else JCAAlert("Something went wrong !!")}
function unsavedCommentsConfirm(){var commentTextAreaValue=getTaskbarCommentValue();var commentsOld=document.getElementById("taskbar_comment___old");if(commentsOld)commentsOld=commentsOld.value;else commentsOld="";if(commentTextAreaValue!=commentsOld)return wfconfirm(getBundleStringAndInserts("wt.workflow.worklist.worklistResource.TASK_WINDOW_CLOSE_CONFIRMATION_MESSAGE"));else return true}function taskbarClosedSuccessfully(req){var response=new String(req.responseText);closingBar()}
function closeTaskbar(){if(!unsavedCommentsConfirm())return false;var commentTextAreaValue=getTaskbarCommentValue();var jspName="netmarkets/jsp/workitem/taskbarActions.jsp";var fullURL=jspName;var selection="textareaComment="+commentTextAreaValue+"&taskbarOperation=Close";PTC.taskbar.sendRequest(fullURL,taskbarClosedSuccessfully,null,"POST",selection,true)}function updateTaskbarComment(){var commentTextArea=document.getElementById("taskbar_comment");if(commentTextArea);}
PTC.taskbar.showTaskbar=function(req){var response=new String(req.responseText);if(response&&response.length>0&!(response.trim()==="null")){if(taskDialogLoaded===response.trim())return;PTC.taskbar.saveButton=new Ext.Button({id:"WorkItemSave",text:getBundleStringAndInserts("wt.workflow.worklist.worklistResource.TASK_WINDOW_SAVE_BUTTON"),handler:function(){saveTaskbarCommentFromLightBox(document)}});PTC.taskbar.completeButton=new Ext.Button({id:"WorkItemCompleteTask",text:getBundleStringAndInserts("wt.workflow.worklist.worklistResource.TASK_WINDOW_COMPLETE_TASK_BUTTON"),
handler:function(){mainComplete(document)}});PTC.taskbar.continueButton=new Ext.Button({id:"WorkItemContinue",text:getBundleStringAndInserts("wt.workflow.worklist.worklistResource.TASK_WINDOW_CONTINUE_BUTTON"),handler:function(){continueToTaskDetails(document)}});if(taskWindow){taskWindow.destroy();taskWindow=null}var dialog=new Ext.Window({id:"workflow light box",autoLoad:transferParam(window.location.href,"netmarkets/jsp/workitem/workflowTaskbar.jsp","jcaDebug=true"),requestMethod:"get",width:560,
height:205,positionInCenter:true,title:getBundleStringAndInserts("wt.workflow.worklist.worklistResource.TASK_WINDOW_TITLE"),modal:false,autoScroll:false,isExistingLightBox:true,overflow:"auto",collapsible:true,beforeclose:closeTaskbar,monitorResize:true,buttons:[PTC.taskbar.saveButton,PTC.taskbar.continueButton]});dialog.on("beforeclose",closeTaskbar);dialog.on("collapse",function(){taskWindowX=this.x;taskWindowY=this.y;this.setPosition(getWindowWidth()-this.getBox().width,getWindowHeight()-30)});
dialog.on("beforeexpand",function(){if(taskWindowX==-1)this.setPosition(getWindowWidth()/2-560,getWindowHeight()/2-205);else this.setPosition(taskWindowX,taskWindowY)});dialog.show();taskWindow=dialog;taskDialogLoaded=response.trim()}else closingBar()};PTC.taskbar.sendRequest=function(url,callbackMethod,onError,method,params,async){var options={parameters:params,onSuccess:callbackMethod,onFailure:onError,method:method,asynchronous:async?async:true};var xmlHttp=requestHandler.doRequest(url,options)};
PTC.taskbar.launchTaskbar=function(data){var jspName="netmarkets/jsp/workitem/fetchTaskbarStatus.jsp";var fullURL=jspName;PTC.taskbar.sendRequest(fullURL,PTC.taskbar.showTaskbar,null,"POST",null,true);if(data)PTC.navigation.loadContent(data)};PTC.actionModel={};PTC.action.SEPARATOR_KEY="separator";Ext.apply(PTC.action,new Ext.util.Observable);PTC.action.addEvents("objectsaffected");PTC.action.actionWindows=[];PTC.action.addActionWindow=function(window){if(window)PTC.action.actionWindows.push(window)};
PTC.action.removeActionWindow=function(window){var i,name;if(Ext.isString(window))name=window;else name=window.name;i=PTC.action.actionWindows.length;while(i--)try{if(name===PTC.action.actionWindows[i].name||PTC.action.actionWindows[i].closed)PTC.action.actionWindows.splice(i,1)}catch(e){PTC.action.log.warn("could not access a property on a cached window reference in PTC.action.actionWindows")}};PTC.action.removeWindowOnUnloadListener=function(){if(opener&&opener.PTC)opener.PTC.action.removeActionWindow(window.name)};
Ext.EventManager.on(window,"unload",PTC.action.removeWindowOnUnloadListener);PTC.action.actionTarget=null;PTC.action._actionTargetWindowMap={};PTC.action.setActionTarget=function(name,target){if(target)PTC.action._actionTargetWindowMap[name]=target};PTC.action.getActionTarget=function(name){return PTC.action._actionTargetWindowMap[name]};PTC.action.removeActionTarget=function(name){delete PTC.action._actionTargetWindowMap[name]};
function getCookie(name){var idx=document.cookie.lastIndexOf(name+"=");if(idx==-1)return null;var value=document.cookie.substring(idx+name.length+1);var end=value.indexOf(";");if(end==-1)end=value.length;value=value.substring(0,end);value=unescape(value);return value}function addCookie(name,value){var newcookie=escape(name)+"="+escape(value)+";";newcookie+="expires=Sun, 21-Feb-2010 01:00:00 GMT;";this.document.cookie+=newcookie}function setActionNumber(mform){}
PTC.action.fixIconForSSL=function(item){if(Ext.isIE7||Ext.isIE8)if(item.icon&&item.icon.indexOf(getBaseHref())<0)item.icon=getBaseHref()+item.icon};PTC.action.addorSetFormValue=function(key,value,form){if(form[key])form[key].value=value;else JCAappendFormHiddenInput(form,key,value)};
function setActionFormData(compContext,elemAddress,actionClass,actionMethod,executeLocation,mform){PTC.action.addorSetFormValue("compContext",compContext,mform);PTC.action.addorSetFormValue("elemAddress",elemAddress,mform);PTC.action.addorSetFormValue("actionClass",actionClass,mform);PTC.action.addorSetFormValue("actionMethod",actionMethod,mform);PTC.action.addorSetFormValue("executeLocation",executeLocation,mform)}
function clearActionFormData(){var mform=getMainForm();if(!mform)return;if(mform.compContext)mform.compContext.value="none";if(mform.elemAddress)mform.elemAddress.value="none";if(mform.actionClass)mform.actionClass.value="none";if(mform.actionMethod)mform.actionMethod.value="none";if(mform.executeLocation)mform.executeLocation.value="inbegin"}
function setDialogFormData(buttonName){if(getMainForm().dialogButton)getMainForm().dialogButton.value=buttonName;var sels=document.getElementsByTagName("input");if(sels){var alength=sels.length;for(var i=0;i<alength;i++)if(sels[i].type=="file"){var docName=sels[i].value;var sepChar="\\";if(docName.indexOf("/")>0)sepChar="/";if(docName.indexOf(sepChar)>=0){var ele=document.createElement("input");ele.type="hidden";ele.name="file_has_dir";ele.value="true";getMainForm().appendChild(ele)}}}}
function clearDialogFormData(){if(getMainForm().dialogButton)getMainForm().dialogButton.value="none"}
function prepareToSubmitMain(compContext,elemAddress,actionClass,actionMethod,executeLocation,mform,setFormData,isSelectRequired,tableID){if(mform||tableID&&tableID!=="null")PTC.util._setMainFormStartingElement(mform?mform:tableID);if(mform)PTC.action.log.debug("prepareToSubmitMain, mform.action:",PTC.util.getFormAction(mform));else PTC.action.log.debug("prepareToSubmitMain, mform (the page's main form) is null");setLocation();if(!validateSelected(isSelectRequired,tableID,elemAddress))return false;
if((actionMethod==="undoCheckOut"||actionMethod==="list_undoCheckOut")&&actionClass==="com.ptc.netmarkets.model.NmObjectCommands"){if(actionMethod==="list_undoCheckOut"){var oidString="Nothing is selected";var sels;if(tableID)sels=getJCASelectedTableItems(tableID);else sels=document.getElementByTagName("input");if(sels){var oidSelected=false;var alength=sels.length;for(var i=0;i<alength;i++)if(sels[i].checked){oidSelected=true;oidString=sels[i].value}}if(!oidSelected){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");
return}else if(!JCAConfirm("com.ptc.netmarkets.util.utilResource.CONFIRM_UNDO_CHECKOUT")){if(window.opener)closePopupAndRefreshOpener();return false}}}else if(actionMethod==="execute"&&(actionClass==="com.ptc.windchill.enterprise.wip.UndoCheckoutObjectFormProcessor"||actionClass==="com.ptc.windchill.enterprise.wip.UndoCheckoutListFormProcessor"))if(executeLocation==="editCancelButton");else{if(!JCAConfirm("com.ptc.netmarkets.util.utilResource.CONFIRM_UNDO_CHECKOUT")){if(window.opener)closePopupAndRefreshOpener();
return false}}else if(actionMethod==="removeShare"&&actionClass==="com.ptc.netmarkets.model.NmObjectCommands"&&elemAddress.toLowerCase().indexOf("epmdocument")>=0)if(!JCAConfirm("com.ptc.netmarkets.paste.pasteResource.SANDBOX_CONFIRM_REMOVE_SHARE_MSG"))return false;if(actionMethod==="list_delete"&&actionClass==="com.ptc.netmarkets.projectPlan.NmProjectPlanCommands"||actionMethod==="delete"&&actionClass==="com.ptc.netmarkets.actionitem.NmActionItemCommands")if(!JCAConfirm("com.ptc.netmarkets.util.utilResource.CONFIRM_DELETE"))return false;
if(setFormData)setActionFormData(compContext,elemAddress,actionClass,actionMethod,executeLocation,mform);return true}function prepareToSubmit(compContext,elemAddress,actionClass,actionMethod,executeLocation,isSelectRequired){return prepareToSubmitMain(compContext,elemAddress,actionClass,actionMethod,executeLocation,getMainForm(),true,isSelectRequired,"")}
function changeFormWithParams(mform,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,url){var formvar=[];if(params0&&params0.length>=1)formvar.push(JCAappendFormHiddenInput(mform,params0,params1));if(params2&&params2.length>=1)formvar.push(JCAappendFormHiddenInput(mform,params2,params3));if(params4&&params4.length>=1)formvar.push(JCAappendFormHiddenInput(mform,params4,params5));if(params6&&params6.length>=
1)formvar.push(JCAappendFormHiddenInput(mform,params6,params7));if(params8&&params8.length>=1)formvar.push(JCAappendFormHiddenInput(mform,params8,params9));if(params10&&params10.length>=1)formvar.push(JCAappendFormHiddenInput(mform,params10,params11));if(params12&&params12.length>=1)formvar.push(JCAappendFormHiddenInput(mform,params12,params13));if(params14&&params14.length>=1)formvar.push(JCAappendFormHiddenInput(mform,params14,params15));if(params16&&params16.length>=1)formvar.push(JCAappendFormHiddenInput(mform,
params16,params17));if(url){formvar.push(JCAappendFormHiddenInput(mform,"refreshByAction","true"));var curIdx=url.indexOf("?");var curlParams=$H(url.substring(curIdx+1).toQueryParams());curlParams.each(function(item){formvar.push(JCAappendFormHiddenInput(mform,decodeURIComponent(item.key),decodeURIComponent(item.value)))})}return formvar}
function removeFormElements(elems){try{if(!elems||elems.length<=0)return;var mform=getMainForm();var elems_length=elems.length;for(var i=0;i<elems_length;i++)if(elems[i]&&elems[i].parentNode)if(elems[i].parentNode==mform){mform.removeChild(elems[i]);mform[elems[i].name]=null}}catch(e){PTC.action.log.debug("Exception caught and ignored in removeFormElements()",e)}}
function removeOnClickTemp(mform){if(!mform)mform=getMainForm();if(mform&&mform.onClickValidationTemp)mform.onClickValidationTemp=undefined}function getCompContext(contextString){var result=null;if(contextString&&typeof contextString.lastIndexOf==="function"){var idx=contextString.lastIndexOf("$");if(idx==-1)result=contextString;else result=contextString.substring(0,idx+1)}return result}
PTC.action.getPageContext=function(){var url=PTC.util.getFormAction(getMainForm());var oid=extractParamValue(url,"oid");url=url.substring(0,url.indexOf("?"));var paths=url.split("/");var ctx=paths[paths.length-2]+"$"+paths[paths.length-1]+"$"+decodeURIComponent(oid)+"$";return ctx};PTC.action.openHelpOverview=function(){window.open(PTC.attributeHelper.get("HCHOverviewHREF"),"")};
function getElementAddress(contextObject){if(!contextObject)return"";if(contextObject&&contextObject.cachedElemAddress)return contextObject.cachedElemAddress;var contextString;if(contextObject.value)contextString=contextObject.value.substring(0,contextObject.value.length-2);else contextString=""+contextObject;var result=null;if(contextString){var idx=contextString.lastIndexOf("$");if(idx==-1)result=contextString;else result=contextString.substring(idx+1)}contextObject.cachedElemAddress=result;return result}
function getOidFromRowValue(contextString){var result=null;if(contextString){var idx=contextString.lastIndexOf("$");if(idx==-1)result=contextString;else result=contextString.substring(idx+1);idx=result.lastIndexOf("^");if(idx>0)result=result.substring(idx+1);idx=result.lastIndexOf("!");if(idx>0)result=result.substring(0,idx)}return result}
function appendToElemAddress(context,oid){var result=context;if(oid){var idx=context.lastIndexOf("!*");result=context.substring(0,idx)+"^"+oid+"!*"}return result}function getSelectedOidString(tableID){var resultArray=getJSCASelectedTableItems(tableUtils.getUnformattedTableId(tableID));var resultOidList=oidUtils.newOidSet();resultOidList.addAll(resultArray);return resultOidList.toString()}
function submitIt(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,alertMessage,noneMessage,isDCA,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID){try{if(compContext===""&&elemAddress===""){var trnode=getParentNodeByTag(Ext.getDom(shortCut),"TR");var tablerows=getElementsByClassNameAndTag("JCA_tablerow",trnode,"input");
if(tablerows&&tablerows.length>0){var rowValue=tablerows[0].value;params15=rowValue;compContext=getCompContext(rowValue);elemAddress=getElementAddress(rowValue);params17=getOidFromRowValue(rowValue);params16="oid"}else compContext=PTC.action.getPageContext()}rowHighlighter.reset();tableUtils.toggleDisabledSelectedRows(tableID,true);if(tableID&&tableID!=="null")PTC.util._setMainFormStartingElement(tableID);var mform=getMainForm();if(prepareToSubmitMain(compContext,elemAddress,actionClass,actionMethod,
windowName,mform,true,isSelectRequired,tableID)){if(!PTC.validation.doOnClickValidation(mform,false)){clearActionFormData();return}var isAction=actionMethod&&actionClass&&windowName&&windowName.toLowerCase().indexOf("search")<0;if(ajaxClass)isAction=false;if(!handleDynamicAction(mform,compContext,elemAddress,actionClass,actionMethod,windowName,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,false,
"",isAjaxEnabled,ajaxClass,tableID,true,true,true,null,null,isAction)){var formElems=changeFormWithParams(mform,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,url);formElems.push(JCAappendFormHiddenInput(mform,"tableID",tableID));formElems.push(JCAappendFormHiddenInput(mform,"AjaxEnabled",isAjaxEnabled));var validTable=tableID&&tableID!="null"&&Ext.getDom(tableID);if(isAjaxEnabled!=="page"&&validTable){refreshCurrentElement(tableID,
true,true);jsca.unSelectAll(null,tableID);clearActionFormData()}else if(currentStepStrName){refreshCurrentStep();clearActionFormData()}else{if(!callUserSubmitFunction())return false;if(isAjaxEnabled!=="page"){var portletelem=[];if(formElems&&formElems.length>0){var formElems_length=formElems.length;for(var i=0;i<formElems_length;i++)if(formElems[i]&&formElems[i].name&&formElems[i].name=="portlet")portletelem.push(formElems[i])}removeFormElements(portletelem)}formElems.push(JCAappendFormHiddenInput(mform,
"tableID",tableID));disableIEButtonsOnSubmit();PTC.navigation.submitForm(mform);clearActionFormData()}removeFormElements(formElems)}else clearActionFormData()}else PTC.action.log.debug("prepareToSubmitMain() returned false. mform.action:",PTC.util.getFormAction(mform))}catch(e){var eString=Ext.encode(e);PTC.action.log.error("js exception in submitIt(): ",eString)}finally{removeOnClickTemp(mform);tableUtils.toggleDisabledSelectedRows(tableID,false)}}
function submitItTo(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,alertMessage,noneMessage,isDCA,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID){var mform=getMainForm(tableID);if(prepareToSubmitMain(compContext,elemAddress,actionClass,actionMethod,windowName,mform,true,false,tableID)){changeFormWithParams(mform,
params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17);PTC.util.setFormAction(mform,url)}callUserSubmitFunction();disableIEButtonsOnSubmit();PTC.navigation.submitForm()}
function prepareToSubmitPopupForm(buttonName,iframeDoc){var mform;if(iframeDoc)mform=iframeDoc.forms.mainform;else mform=getMainForm();if(prepareToSubmitMain(mform.openerCompContext.value,mform.openerElemAddress.value,mform.openerActionClass.value,mform.openerActionMethod.value,mform.openerExecuteLocation.value,mform,true,false,"")){setDialogFormData(buttonName);return true}return false}
function submitPopupForm(buttonName){if(prepareToSubmitPopupForm(buttonName)){if(!callUserSubmitFunction())return false;disableIEButtonsOnSubmit();getMainForm().submit();return true}}
function getStatusbarValueFromMoreInfo(str){var index0=-1;var index1=-1;var retStr=null;index0=str.indexOf("statusbar",0);if(index0>=0){index0=str.indexOf("=",index0);if(index0>0){index0++;while(str.charAt(index0)==" ")index0++;var wspaceindex=str.indexOf(" ",index0);var commaindex=str.indexOf(",",index0);if(wspaceindex>=0&&commaindex>=0)index1=wspaceindex<commaindex?wspaceindex:commaindex;else if(wspaceindex>=0&&commaindex<0)index1=wspaceindex;else if(wspaceindex<0&&commaindex>=0)index1=commaindex;
else index1=str.length;if(index1>0)retStr=str.substring(index0,index1)}}return retStr}function getWindowSizeFromMoreInfo(str,token){var index0=-1;var index1=-1;var retStr=PTC.action.getMoreInfo(str,token);if(retStr){var intValue=parseInt(retStr,10);if(isNaN(intValue)||intValue<10)retStr=null}return retStr}
PTC.action.getMoreInfo=function(str,token){var index0=-1;var index1=-1;var retStr=null;index0=str.indexOf(token,0);if(index0>=0){index0=str.indexOf("=",index0);if(index0>0){index0++;while(str.charAt(index0)==" ")index0++;var wspaceindex=str.indexOf(" ",index0);var commaindex=str.indexOf(",",index0);if(wspaceindex>=0&&commaindex>=0)index1=wspaceindex<commaindex?wspaceindex:commaindex;else if(wspaceindex>=0&&commaindex<0)index1=wspaceindex;else if(wspaceindex<0&&commaindex>=0)index1=commaindex;else index1=
str.length;if(index1>0)retStr=str.substring(index0,index1)}}return retStr};PTC.action.getWindowSizeFromCookie=function(windowName){return PTC.jca.state.getLocalStateStore().get("nmwindowsize"+windowName)};getWindowSizeFromCookie=PTC.action.getWindowSizeFromCookie;
PTC.action.setWindowSizeCookie=function(){var windowName,mform=getMainForm();if(mform&&mform.windowNameForCookie)windowName=mform.windowNameForCookie.value;else windowName=window.name;if(windowName&&typeof windowName!="undefined"&&windowName!="none"){var index=windowName.indexOf("_SM");if(index>0)windowName=windowName.substring(0,index);var windowWidth=Browser.getWindowWidth();var windowHeight=Browser.getWindowHeight();var xpos=Browser.getX();var ypos=Browser.getY();var prevValue=PTC.action.getWindowSizeFromCookie(windowName);
var delta=99;if(typeof prevValue!="undefined")delta=Math.abs(prevValue.width-windowWidth)+Math.abs(prevValue.height-windowHeight)+Math.abs(prevValue.x-xpos)+Math.abs(prevValue.y-ypos);if(delta>10){var savedValue={width:windowWidth,height:windowHeight,x:xpos,y:ypos};PTC.jca.state.getLocalStateStore().set("nmwindowsize"+windowName,savedValue)}}};setWindowSizeCookie=PTC.action.setWindowSizeCookie;
function submitFormToNewPJLWindow(newURL,winName,props,theForm,isLightbox){PTC.action.log.debug("submitFormToNewPJLWindow - props: ",props);if(!theForm||theForm.constructor==Array||theForm[0]&&theForm[0].action||theForm.action)theForm=getMainForm();var tempAction=PTC.util.getFormAction(theForm);var tempTarget=theForm.target;var ele=document.createElement("input");ele.type="hidden";ele.name="ActionSource";ele.value="PJLseedObjects";theForm.appendChild(ele);PTC.util.setFormAction(theForm,newURL);var submitForm=
true;var actionURLValue=PTC.util.getFormAction(theForm);if(isLightbox||PTC.lightbox.isActionRenderedAsLightbox({actionURL:actionURLValue})){PTC.action.log.debug("submitFormToNewPJLWindow: rendering ",actionURLValue," as lightbox");var lightboxProps=props.replace(/,/g,"&");var lightboxParams=Ext.urlDecode(lightboxProps);var config={form:theForm};if(lightboxParams.height)config.height=lightboxParams.height;if(lightboxParams.width)config.width=lightboxParams.width;var lbOptions=PTC.lightbox.renderFormActionAsLightbox(config);
submitForm=lbOptions.submitForm;if(submitForm&&lbOptions.target)theForm.setAttribute("target",lbOptions.target)}else{theForm.target=winName;actionwin=window.open("",winName,props);PTC.action.addActionWindow(actionwin)}disableIEButtonsOnSubmit();if(submitForm)theForm.submit();else PTC.action.log.debug("submitFormToNewPJLWindow: Form not submiited as submitForm was false.");PTC.util.setFormAction(theForm,tempAction);theForm.target=tempTarget;ele.parentNode.removeChild(ele)}
function countSoid(windowUrl){var k=0;var index=0;while(index>=0){index=windowUrl.indexOf("soid",index);if(index>0){k++;index++}}return k}function countSelected(){return getSelectedItems().length}function removeSoidParams(url){var splitUrl=url.split("&");var SARRAY="soidarray=";var newUrl=splitUrl[0];var alength=splitUrl.length;for(var i=1;i<alength;i++){var p=splitUrl[i];if(p.substr(0,5)!=="soid="&&p.substr(0,SARRAY.length)!=SARRAY)newUrl+="&"+p}return newUrl}
function toggleFormElementOnOff(state,formName,elementName){if(state==="on")window.document.forms[formName].elements[elementName].disabled=false;else if(state==="off")window.document.forms[formName].elements[elementName].disabled=true}function setParentURL(url){if(PTC.util.isJSUrl(url))cleanAndEval(url);else{var appendChar="&";if(url.indexOf("?")==-1)appendChar="?";url=url+appendChar+"returl="+encodeURIComponent(window.opener.top.location.href);opener.PTC.navigation.loadContent(url)}}
function postToUrl(mform,copyurl,paramurl,isNoContent,alertMessage,skipCount,noneMessage,isDCA,unselectwhendone,dontDecode,tableId){var showCBMessage3=true;try{if(typeof showCBMessage!=="undefined")showCBMessage3=showCBMessage}catch(e){showCBMessage=true;showCBMessage3=true}if(mform){var k=countSelected();if(k<=0)k+=countSoid(copyurl);if(k<=0&&(copyurl.indexOf("list_c")>0||copyurl.indexOf("add_to_hot")>0))if(noneMessage)JCAAlert(noneMessage);else wfalert_gen("Nothing Selected.");else{if(!paramurl||
paramurl.length<=2){paramurl=copyurl.substring(copyurl.indexOf("?")+1);copyurl=copyurl.substring(0,copyurl.indexOf("?"))}else if(paramurl&&paramurl.indexOf("soid")<0){paramurl="soidarray="+encodeURIComponent(paramurl);dontDecode=true}if(!dontDecode)if(paramurl.toLowerCase().indexOf("%3a")>0)paramurl=decodeURIComponent(paramurl);if(paramurl&&paramurl.charAt(0)==="?")paramurl=paramurl.substring(1);var options={asynchronous:false,parameters:paramurl,skipCoding:true};var transport=requestHandler.doRequest(copyurl,
options);var response=transport.responseText;if(response)k=response;var clippedCount=k*1;if(clippedCount<=0)showCBMessage3=false;showCBMess(showCBMessage3,alertMessage,k,skipCount,noneMessage);if(unselectwhendone)unSelectAll(document.getElementsByTagName("input"));else if(tableId)unSelectAll(null,tableId)}}else{getWindow().location=combineURL(copyurl,paramurl);k=countSoid(copyurl);showCBMess(showCBMessage3,alertMessage,k,skipCount);unSelectAll(document.getElementsByTagName("input"))}if(getWindow().location.href.indexOf("more.jsp")>=
0)wfWindowClose()}function checkPopupPositionOffsetFromCookie(win_xc,win_yc,width,height,screen){var res=[];res[0]=win_xc<0||win_xc+width>screen.availWidth?0:win_xc;res[1]=win_yc<0||win_yc+height>screen.availHeight?0:win_yc;return res}
function popupActionMainImpl(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,mform,isNoContent,alertMessage,noneMessage,isDCA,ignoreSelected,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID,postForm,isLightbox){PTC.action.log.debug("popupActionMainImpl - Entered popupActionMainImpl");PTC.action.log.debug("popupActionMainImpl - moreInfo: ",
moreInfo);try{if(compContext===""&&elemAddress===""){var trnode=getParentNodeByTag(Ext.getDom(shortCut),"TR");var tablerows=getElementsByClassNameAndTag("JCA_tablerow",trnode,"input");if(tablerows&&tablerows.length>0){var rowValue=tablerows[0].value;params15=rowValue;compContext=getCompContext(rowValue);elemAddress=getElementAddress(rowValue);params17=getOidFromRowValue(rowValue);params16="oid"}else{compContext=PTC.action.getPageContext();if(params14==="context"&&params15==="")params15=compContext}}tableUtils.toggleDisabledSelectedRows(tableID,
true);if(!validateSelected(isSelectRequired,tableID,elemAddress))return false;var sizeString=null;var width=null;var height=null;var win_xc=null;var win_yc=null;if(tableID&&tableID!=="null")PTC.util._setMainFormStartingElement(tableID);var windowform=mform?mform:getMainForm();var windowCookieName=null;if(windowform&&windowform.windowNameForCookie)windowCookieName=windowform.windowNameForCookie.value;else windowCookieName=windowName;PTC.action.log.debug("popupActionMainImpl: windowCookieName: ",windowCookieName);
var sizeData=PTC.action.getWindowSizeFromCookie(windowCookieName);if(sizeData){width=sizeData.width;height=sizeData.height;sizeString="width="+width+",height="+height;win_xc=sizeData.x;win_yc=sizeData.y}else{var widthAsString=getWindowSizeFromMoreInfo(moreInfo,"width");if(widthAsString)width=parseInt(widthAsString,10);var heightAsString=getWindowSizeFromMoreInfo(moreInfo,"height");if(heightAsString)height=parseInt(heightAsString,10);sizeString="width="+width+",height="+height}var sizeDefined=width&&
height;var arrlength=0;var winFeatures=[];winFeatures[arrlength++]="resizable=yes";var showScrollBars=PTC.action.getMoreInfo(moreInfo,"scrollbars");var scrollbars="scrollbars=";scrollbars+=showScrollBars?showScrollBars:"yes";winFeatures[arrlength++]=scrollbars;winFeatures[arrlength++]="menubar=no";winFeatures[arrlength++]="toolbar=no";winFeatures[arrlength++]="location=no";var showStatusBar=getStatusbarValueFromMoreInfo(moreInfo,"statusbar");if(showStatusBar=="true")winFeatures[arrlength++]="status=yes";
else winFeatures[arrlength++]="status=no";if(!isLightbox){width=width||600;height=height||500}var y_pos=null;var x_pos=null;if(win_xc&&win_yc){var res=checkPopupPositionOffsetFromCookie(win_xc,win_yc,width,height,screen);x_pos=res[0];y_pos=res[1]}else{var win_x=Browser.getX();var win_y=Browser.getY();y_pos=win_y+Ext.getBody().getHeight()-height/2;x_pos=win_x+Ext.getBody().getWidth()-width/2;if(y_pos+height>screen.availHeight||x_pos+width>screen.availWidth){y_pos=(screen.availHeight-height)/2;x_pos=
(screen.availWidth-width)/2}}winFeatures[arrlength++]="top="+y_pos;winFeatures[arrlength++]="left="+x_pos;if(sizeDefined)winFeatures[arrlength++]=sizeString;else{if(width)winFeatures[arrlength++]="width="+width;if(height)winFeatures[arrlength++]="height="+height}winFeatures.length=arrlength;var winFeaturesStr=winFeatures.join(",");try{if(isWf())winFeaturesStr+=",use_html_title=yes"}catch(e){PTC.action.log.debug("Exception caught and ignored in isWf()",e)}if(url.charAt(0)!=="h")url=getBaseHref()+url;
winFeaturesStr=jcaSetPosition(winFeaturesStr);var windowUrl=getNewUrl(mform,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,ignoreSelected,false,false,isAjaxEnabled,ajaxClass,actionClass,actionMethod,tableID,windowName);if(mform&&mform.popupCompContext){mform.popupCompContext.value=compContext;mform.popupElemAddress.value=elemAddress;mform.popupActionClass.value=actionClass;mform.popupActionMethod.value=
actionMethod;mform.popupExecuteLocation.value="inbegin";if(sizeDefined){mform.nmopenwidth.value=width;mform.nmopenheight.value=height}}else if(!mform){var formParam="formName=";var formIndex=windowUrl.indexOf(formParam);if(formIndex>0){var formIndexEnd=windowUrl.indexOf("&",formIndex);var formName=windowUrl.substring(formIndex+formParam.length,formIndexEnd);mform=document.forms[formName]}}if(!PTC.validation.doOnClickValidation(mform))return;if(isNoContent){var unselectwhendone=!(isAjaxEnabled&&isAjaxEnabled!==
"page");postToUrl(mform,windowUrl,"",true,alertMessage,false,noneMessage,true,unselectwhendone,false,tableID)}else{if(mform&&mform.userPopupActionFunction)windowUrl=mform.userPopupActionFunction(mform,actionMethod,windowUrl);if(windowUrl){if(windowUrl.length>1500&&isSomethingChecked(null)){multiSelectObjects(mform);windowUrl=removeSoidParams(windowUrl)}windowName=windowName+"_SM"+(new Date).getTime();PTC.action.setActionTarget(windowName,PTC.action.actionTarget);if(postForm)submitFormToNewPJLWindow(windowUrl,
windowName,winFeaturesStr,mform,isLightbox);else if(isAjaxEnabled==="popupMenu")showDynamicMenu(windowUrl,shortCut);else if(isAjaxEnabled==="thirdLevelNav")switchTLNContent(windowUrl,true);else{var tempActionWin=PTC.util.openWindow(windowUrl,windowName,winFeaturesStr);PTC.action.addActionWindow(tempActionWin);if(!tempActionWin)return null;else{actionwin=tempActionWin;setTimeout(function(){if(tempActionWin&&typeof tempActionWin.focus!=="undefined")tempActionWin.focus()},1);return tempActionWin}}}}}finally{removeOnClickTemp(mform);
tableUtils.toggleDisabledSelectedRows(tableID,false)}}CADX_PARAMS=["wsLock","wscontext","wsName","placeHolder","cadName","localid","authApp","doctype"];
function popupAction(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,alertMessage,noneMessage,isDCA,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID){var currentUrl=getWindow().location.href;CADX_PARAMS.each(function(param){url=transferParam(currentUrl,url,param)});if(windowName){var mainForm=getMainForm(tableID);
JCAappendFormHiddenInput(mainForm,"windowNameForCookie",windowName);var index=windowName.lastIndexOf("_");if(index>=0)windowName=windowName.substring(0,index)}popupActionMainImpl(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,getMainForm(tableID),false,alertMessage,noneMessage,isDCA,false,shortCut,isAjaxEnabled,ajaxClass,
isSelectRequired,tableID)}
function noContentAction(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,alertMessage,noneMessage,isDCA,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID){popupActionMainImpl(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,
params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,getMainForm(tableID),true,alertMessage,noneMessage,isDCA,false,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID)}
function popupActionMain(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,alertMessage,noneMessage,isDCA,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID){popupActionMainImpl(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,
params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,getMainForm(tableID),false,alertMessage,noneMessage,isDCA,false,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID)}function getCurrentActionContextString(){var mform=getMainForm();if(mform&&mform.popupElemAddress&&mform.popupCompContext){var oid=mform.popupElemAddress.value;var context=mform.popupCompContext.value;return context+oid}}
function submitMultiSelectFormToNewPJLWindow(newURL,winName,props,theForm){var isChecked=isSomethingChecked();if(!isChecked)JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");else submitFormToNewPJLWindow(newURL,winName,props,theForm)}function getOidFromURL(url){var param=extractParamValue(url,"oid");return param}
function newWindowAction(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,alertMessage,noneMessage,isDCA,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID,isLightBox){var mform=null;if(url){var formName=extractParamValue(url,"formName");if(formName)mform=document.forms[formName]}if(!mform)mform=getMainForm(tableID);
popupActionMainImpl(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,mform,false,alertMessage,noneMessage,isDCA,false,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID,true,isLightBox)}
function newLightBoxAction(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,alertMessage,noneMessage,isDCA,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID){newWindowAction(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,
params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,alertMessage,noneMessage,isDCA,shortCut,isAjaxEnabled,ajaxClass,isSelectRequired,tableID,true)}
function popupActionMainExt(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,actionClass,actionMethod,moreInfo,mform,isNoContent,alertMessage,noneMessage){popupActionMainImpl(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,compContext,elemAddress,
actionClass,actionMethod,moreInfo,mform,isNoContent,alertMessage,noneMessage,true)}
function popupActionExternal(urlBridge,urlPopup,windowName,moreInfo,htmlFormName,oid,isMultiselect,isProductStructure,isDCA,actionClass,actionMethod,noneSelectedMsg){var spscopyVal=null;var soidVal=null;var soidarray=null;var htmlForm=cleanAndEval("document.forms."+htmlFormName);if(isMultiselect){var formElements=htmlForm.elements;var soid=getSelectedObjectsExternal(formElements,isDCA);soidarray=buildStringParam(soid);if(soidarray.indexOf("soid")<=0&&soidarray.length<1){wfalert(noneSelectedMsg);return}if(isProductStructure)spscopyVal=
"true"}else soidVal="object~"+oid;var mform=null;if(htmlFormName)mform=document.forms[htmlFormName];var compContext=null;var elemAddress=null;popupActionMainExt(windowName,urlBridge,"urlPopup",urlPopup,"oid",oid,"spscopy",spscopyVal,"soid",soidVal,"soidarray",soidarray,"portlet","poppedup","",null,"",null,"",null,compContext,elemAddress,actionClass,actionMethod,moreInfo,mform,false,null,null)}
function newWindowActionMain(windowName,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,moreInfo,mform,isAjaxEnabled,ajaxClass,tableID){var windowUrl=getNewUrl(mform,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,false,false,false,isAjaxEnabled,ajaxClass,tableID);actionwin=wfWindowOpen(windowUrl,
windowName+"_SM"+(new Date).getTime(),"resizable=yes,scrollbars=yes,menubar=yes,toolbar=yes,location=yes,status=yes,"+moreInfo);PTC.action.addActionWindow(actionwin)}
function truncateWizardTitle(){if(!isIE&&currentStepStrName){var allElements=getElementsByClassNameAndTag("wizTitleTD",null,"TD");var allElements_length=allElements.length;for(var elementIndex=0;elementIndex<allElements_length;elementIndex++){var currentElement=allElements[elementIndex];var elementWidth=currentElement.offsetWidth*0.75;var ellipsisElement=currentElement.cloneNode(true);document.body.appendChild(ellipsisElement);ellipsisElement.textContent=currentElement.title;var completeContent=ellipsisElement.textContent;
var ellipsisOk=ellipsisElement.offsetWidth<=elementWidth;var currentIndex=0;while(!ellipsisOk){ellipsisElement.textContent=completeContent.substring(0,currentIndex)+"...";ellipsisOk=ellipsisElement.offsetWidth>elementWidth;currentIndex++}currentElement.textContent=ellipsisElement.textContent;document.body.removeChild(ellipsisElement)}}}
function initPopupForm(){try{if(isWizardWindow())PTC.wizard.on("wizardLoadComplete",function(){window.onresize=onResizeWindow});else window.onresize=onResizeWindow;var mform=getMainForm();if(getPopupOpenerWindow()&&!getPopupOpenerWindow().closed)if(getPopupOpenerWindow().document&&getPopupOpenerWindow().getMainForm){var opform=getPopupOpenerWindow().getMainForm();if(!is_nav&&opform)if(opform.nmopenwidth&&opform.nmopenwidth.value&&opform.nmopenwidth.value!=="none"&&opform.nmopenheight&&opform.nmopenheight.value&&
opform.nmopenheight.value!=="none"){var openwidth=parseInt(opform.nmopenwidth.value,10);var openheight=parseInt(opform.nmopenheight.value,10);mform.nmdeltawidth.value=0;mform.nmdeltaheight.value=0}var windowNameForCookie=opform.windowNameForCookie;if(windowNameForCookie)JCAappendFormHiddenInput(mform,"windowNameForCookie",windowNameForCookie.value);var skipInit=extractParamValue(window.location.href,"skipInit");if(mform.openerCompContext.value==="none"&&skipInit!=="true"){mform.nmwindowname.value=
window.name;if(opform&&opform.popupCompContext){mform.openerCompContext.value=opform.popupCompContext.value;mform.openerElemAddress.value=opform.popupElemAddress.value;mform.openerActionClass.value=opform.popupActionClass.value;mform.openerActionMethod.value=opform.popupActionMethod.value;mform.openerExecuteLocation.value=opform.popupExecuteLocation.value;var selectedFromWizardTag=mform.selectedInOpener_FromWizardTag;if(selectedFromWizardTag){mform.selectedInOpener.value=selectedFromWizardTag.value;
mform.selectedInOpener_FromWizardTag.value=""}else{var sset=false;var opformsels=getPopupOpenerWindow().document.getElementsByTagName("input");if(opformsels)if(opformsels.length>0){var count=0;var alength=opformsels.length;for(var i=0;i<alength;i++)if(opformsels[i].type==="checkbox"&&opformsels[i].checked)count++;if(count>0){var sarr=[];var ind=0;for(var m=0;m<alength;m++)if(opformsels[m].type==="checkbox"&&opformsels[m].checked)sarr[ind++]=opformsels[m].value;mform.selectedInOpener.value=sarr.join("-");
sset=true}}else try{if(opformsels&&opformsels.type==="checkbox"&&opformsels.checked){mform.selectedInOpener.value=opformsels.value;sset=true}}catch(e){PTC.action.log.debug("Exception caught and ignored in initPopupForm()",e)}if(!sset)mform.selectedInOpener.value="none"}}}}truncateWizardTitle()}catch(ex){}finally{initPopupForm=TRUE_FUNC}}function resetPopupForm(){window.onresize=onResizeWindow;clearActionFormData();clearDialogFormData()}
prepareToRefreshOpener=function(){if(getPopupOpenerWindow()&&getPopupOpenerWindow().document&&getPopupOpenerWindow().getMainForm()){var oform=getPopupOpenerWindow().getMainForm();if(oform&&oform.refreshedFromPopup){oform.refreshedFromPopup.value="yes";if(oform.instructions&&getMainForm()&&getMainForm().openerInstructions)oform.instructions.value=getMainForm().openerInstructions.value}}};
function PJLrefreshOpener(){if(getPopupOpenerWindow()&&getPopupOpenerWindow().document&&window.opener.getMainForm()){resetPopupForm();prepareToRefreshOpener()}refreshOpenerOnly()}function refreshForAssociation(newOid,oldOid){refreshOpener()}
refreshOpenerOnly=function(){if(getPopupOpenerWindow()){var _opener=getPopupOpenerWindow();var extraFormElems;var refreshByAction=null;var openerDocument;try{try{refreshByAction=_opener.JCAappendFormHiddenInput(_opener.getMainForm(),"refreshByAction","true");if(getWindow().location.href.indexOf("fireSearchOnActionRefresh")>0)extraFormElems=_opener.JCAappendFormHiddenInput(_opener.getMainForm(),"fireSearchOnActionRefresh",extractParamValue(getWindow().location.href,"fireSearchOnActionRefresh"));else extraFormElems=
[];extraFormElems.push(refreshByAction);openerDocument=_opener.document}catch(e){PTC.action.log.debug("Exception caught and ignored in refreshOpenerOnly()",e)}if(!openerDocument)return;if(_opener&&_opener.document&&_opener.getMainForm()){var mainform=_opener.getMainForm();var urlstr=window.location.href;urlstr=urlstr.substring(urlstr.indexOf("?")+1);var params=urlstr.parseQuery();if(params.tableID&&isArray(params.tableID))params.tableID=params.tableID[0];if(!_opener.handleDynamicAction(mainform,"",
"","","","","dynamicUpdate","true","","","","","","","","","","","","","","","","",true,window.location.href,"",null,params.tableID,true,true,true)){var refreshSearchTable=_opener.document.createElement("INPUT");refreshSearchTable.type="hidden";refreshSearchTable.name="refreshSearchTable";refreshSearchTable.value="Yes";mainform.appendChild(refreshSearchTable);if(_opener.currentStepStrName){_opener.refreshCurrentStep();_opener.clearActionFormData()}else if(params.AjaxEnabled&&params.AjaxEnabled!==
"null"&&(params.AjaxEnabled==="row"||params.AjaxEnabled==="component")&&params.tableID&&params.tableID!=="null"){_opener.refreshCurrentElement(params.tableID,!PTC.isOldGecko(),false);try{_opener.clearActionFormData()}catch(ex){PTC.action.log.debug("opener may not exist anymore, may be closing...",ex)}}else{_opener.disableIEButtonsOnSubmit();try{_opener.PTC.navigation.submitForm()}catch(exe){PTC.action.log.debug("opener may not exist anymore, may be closing...",exe)}}}else clearActionFormData()}else if(window.opener.deleteChangeObject)window.opener.refreshForAssociation();
else PTC.navigation.reload()}finally{if(openerDocument)try{_opener.removeFormElements(extraFormElems);_opener.removeFormElements(refreshByAction)}catch(e_removeForm){PTC.action.log.debug("Could not remove form elements from opener. Opener may be refreshing form.",e_removeForm)}}}else if(window.opener){var mainPageHref=window.opener.location.href;window.opener.location.href=mainPageHref}else wfWindowClose1()};closePopupAndRefreshOpener=function(){prepareToRefreshOpener();refreshOpenerOnly();wfWindowClose1()};
function closePopupAndReloadOpener(){var openerWin=getWindow().opener;if(openerWin&&!openerWin.closed)openerWin.PTC.navigation.reload();wfWindowCloseMyWindow(getWindow())}function submitTo(url){if(callUserSubmitFunction()){clearActionFormData();clearDialogFormData();PTC.util.setFormAction(getMainForm(),url+"");disableIEButtonsOnSubmit();PTC.navigation.submitForm()}}
function setWindowLocation(aUrl){if(aUrl&&aUrl.indexOf("http")<0&&!PTC.util.isJSUrl(aUrl))aUrl=getBaseHref()+aUrl;if(!PTC.util.isJSUrl(aUrl)&&PTC.lightbox.isActionRenderedAsLightbox({actionURL:aUrl}))PTC.lightbox.activate({contentHref:aUrl});else{if(PTC.navigator&&PTC.navigator.isExpanded())PTC.navigator.collapseNavigator();if(Ext.isIE)Ext.menu.MenuMgr.hideAll();getWindow().PTC.navigation.loadContent(aUrl)}return false}function setCadxWindowLocation(aUrl,method){return setWindowLocation(aUrl)}
function getTableId(event){!event?event:window.event;var target=event.target?event.target:event.srcElement;var tableID=tableUtils.findParentTableNodeId(target.parentNode);var ele=document.createElement("input");ele.type="hidden";ele.id="editpropertytableid";ele.value=tableID;getMainForm().appendChild(ele);return true}PTC.actionModel.walkActionModelAndApply=function(model,method){if(model&&model.items)PTC.actionModel.applyFunctionToItems(model.items,method,true,false)};
PTC.actionModel.walkActionModelAndApplyToChildModels=function(model,method){if(model&&model.items)PTC.actionModel.applyFunctionToItems(model.items,method,true,true)};PTC.actionModel.walkActionModelAndApplyToAll=function(model,method){if(model&&model.items)PTC.actionModel.applyFunctionToItems(model.items,method,true,true)};
PTC.actionModel.applyFunctionToItems=function(items,method,applyToItems,applyToSubMenus){for(var i=0;i<items.size();i++)if(items[i].items){if(applyToSubMenus)method(items[i]);PTC.actionModel.applyFunctionToItems(items[i].items,method,applyToItems,applyToSubMenus)}else if(applyToItems)method(items[i])};
PTC.actionModel.getActionConfig=function(id,actionModel){var actionConfigs=actionModel.actionConfigs;if(!actionConfigs){actionConfigs=[];PTC.actionModel.walkActionModelAndApply(actionModel,function(actionConfig){actionConfigs[actionConfig.actionID]=actionConfig});actionModel.actionConfigs=actionConfigs}return actionConfigs[id]};PTC.onReady(function(){PTC.action.log=log4javascript.getLogger("PTC.action")});Ext.ns("PTC.ws");
PTC.ws.closePopupAndReloadOpener=function(){PTC.action.log.debug("PTC.ws.closePopupAndReloadOpener: Entered closePopupAndReloadOpener");var openerWin=getWindow().opener;if(openerWin)if(!openerWin.closed)if(Ext.isFunction(openerWin.refreshWS))openerWin.refreshWS();else openerWin.top.PTC.navigation.reload();else PTC.action.log.debug("PTC.ws.closePopupAndReloadOpener: opener window is already closed? It could not be reloaded.");else PTC.action.log.debug("PTC.ws.closePopupAndReloadOpener: opener window is not found? It could not be reloaded.");
wfWindowClose()};Ext.ns("PTC.cadexport");
PTC.cadexport.launchExportWindow=function(event,target,table){var selectionsSpan=$("checkboxesFor_"+table.getId());if(selectionsSpan===null||selectionsSpan.childElements().length===0){JCAAlert("com.ptc.windchill.uwgm.cadx.export.exportResource.NOTHING_SELECTED");return}var hasValidElements=false,invalidElements=[],selectionInputs=selectionsSpan.childElements();for(var i=0;i<selectionInputs.length;i++){var input=selectionInputs[i];if(input.getValue().indexOf("wt.epm.EPMDocument")!==-1)hasValidElements=
true;else invalidElements.push(input)}if(!hasValidElements){JCAAlert("com.ptc.windchill.uwgm.cadx.export.exportResource.NO_EPM_DOCS_SELECTED");return}if(invalidElements.length>0)if(JCAConfirm("com.ptc.windchill.uwgm.cadx.export.exportResource.SOME_NON_EPM_DOCS_SELECTED"))for(var i=0;i<invalidElements.length;i++)selectionsSpan.removeChild(invalidElements[i]);else return;var url=getBaseHref()+"servlet/WindchillAuthGW/wt.enterprise.URLProcessor/URLTemplateAction?u8&action="+target.actionName;submitFormToNewPJLWindow(url,
null,"",getMainForm(),true);for(var i=0;i<invalidElements.length;i++)selectionsSpan.appendChild(invalidElements[i])};
var asyncResponseHandler=function(){var ERROR_FLAG="Error: ";var REFRESH_FLAG="Refresh: ";var DELETE_FLAG="Delete_Flag:::";var REDIRECT_FLAG="Redirect URL: ";var CONSOLE_FLAG="CONSOLE_URL::";var PAGE_START="DYNAMIC_PAGE_START:--\>";var PAGE_END="<!--DYNAMIC_PAGE_END:";var FORM_START="<!-- FORM_RESULT --\>";var FORM_END="<!-- END_FORM_RESULT --\>";function processResponse(responseText,response){var processed=false;var skipScripts=response.isAjaxEnabled=="row";response.dynamicText=asyncResponseHandler.stripText(responseText,
null,skipScripts);if(!response.dynamicText||response.dynamicText==="")response.dynamicText=responseText;if(response.dynamicText){processErrors(response);if(processRefresh(response))processed=true;if(tableUtils.isExt()){if(PTC.jca.processUpdate(response))processed=true;if(PTC.jca.processDelete(response))processed=true}if(processConsole(response))processed=true}if(processForm(responseText,response))processed=true;if(!processed&&response.refreshOnNoOp){processed=processCurrentStep(response);if(!processed){processed=
processRedirect(response);if(!processed)getUpdateOpenerWindow().PTC.navigation.submitForm()}}if(response.disableSelected)enableIds(response,true)}function processErrors(response){var errorText=getErrorText(response.dynamicText);if(errorText){enableIds(response);wfalert(errorText)}}function enableIds(response,toggleChecked){if(response.selectedItems)response.selectedItems.enable(toggleChecked)}function getErrorText(text){var result=null;var idx=text.indexOf(ERROR_FLAG);if(idx!=-1&&text.indexOf('"'+
ERROR_FLAG)==-1)result=text.substring(idx+7);return result}function processRefresh(response){if(response.dynamicText.indexOf(REFRESH_FLAG)==-1)return false;clearActionFormData();if(currentStepStrName)refreshCurrentStep();else PTC.navigation.reload();return true}function processDelete(response){if(response.dynamicText.indexOf(DELETE_FLAG)==-1&&response.ajaxClass!="NONE")return false;if(response.selectedItems&&response.tableID){var tID=tableUtils.getUnformattedTableId(response.tableID);var divEle=getWindow().$("checkboxesFor_"+
tID);if(divEle)divEle.remove();tableUtils.updateHeader(response.tableID);tableUtils.updateFooterCount(response.tableID,0)}return true}function processConsole(response){var result=false;var text=response.dynamicText;var idx=text.indexOf(CONSOLE_FLAG);if(idx!=-1){result=true;text=text.substring(idx+13);eval(text);enableIds(response)}return result}function parseUrl(text,start,end){if(!end)end=">";var result=null;var idx=text.indexOf(start);if(idx!=-1){idx+=start.length;var closeIdx=text.indexOf(end,
idx);if(closeIdx==-1)closeIdx=text.length;result=text.substring(idx,closeIdx)}return result}function processRedirect(response){var result=false;var url=parseUrl(response,REDIRECT_FLAG);if(url){result=true;top.window.PTC.navigation.loadContent(url)}return result}function processForm(responseText,response){var result=false;if(responseText.indexOf(FORM_START)!=-1){var formResultText=asyncResponseHandler.stripText(responseText,null,true,FORM_START,FORM_END);if(formResultText&&formResultText.length>10){PTC.navigation.evalPageScripts(formResultText);
result=true}}return result}function processCurrentStep(response){var result=true;if(response.isAjaxEnabled=="row"){response.disableSelected=false;var flushInput=JCAappendFormHiddenInput(getMainForm(),"dynamicFlush","true");if(currentStepStrName){refreshCurrentStep();getMainForm().removeChild(flushInput)}else PTC.navigation.submitForm()}else if(currentStepStrName){var curStep=$(currentStepStrName);if(curStep){PTC.util.purge(curStep,true);curStep.innerHTML=response.dynamicText;initSelects(curStep)}}else if(getUpdateOpenerWindow().getCurrentStep){var step=
getUpdateOpenerWindow().getCurrentStep();if(step&&step.length>0)getupdateOpenerWindow().refreshCurrentStep()}else result=false;return result}return{handleResponse:function(responseText,response){try{if(response.preProcessor)response.preProcessor();processResponse(responseText,response)}catch(e){var message="Error in handleResponse. Will try to recover by re-submitting the form for this page.";if(PTC.getMainWindow().PTC.debug.isJsDebug())PTC.log.error(message,e);else PTC.log.debug(message,e);var mform=
getMainForm();if(mform){clearActionFormData();if(!isWizardWindow())PTC.navigation.submitForm()}}clearActionFormData()},stripText:function(text,divId,skipScriptEval,start,end){if(!start){start=PAGE_START;end=PAGE_END}var startIdx=text.indexOf(start);if(startIdx==-1)startIdx=0;else startIdx+=start.length;var endIdx=text.lastIndexOf(end);if(endIdx==-1)endIdx=text.length;if(divId&&divId!==""){var divStart='<div id="'+divId+'"';var divStartIdx=text.indexOf(divStart,startIdx);if(divStartIdx!=-1){divStartIdx=
text.indexOf(">",divStartIdx);if(divStartIdx!=-1){divStartIdx++;var divEndIdx=text.lastIndexOf("</div>");if(divStartIdx<divEndIdx<endIdx){startIdx=divStartIdx;endIdx=divEndIdx}}}}if(startIdx!==0||endIdx!=text.length){text=text.substring(startIdx,endIdx);if(!skipScriptEval)PTC.navigation.evalPageScripts(text)}else if(text.indexOf("<html>")!=-1)text="";return text}}}();Ext.namespace("ATO.util");Ext.namespace("ATO.choicerule");Ext.namespace("ATO.components");Ext.namespace("ATO.components.ChoiceComponent");
$ato=function(id){var r=$(id);if(!r){var ar=Ext.DomQuery.select("[name='"+id+"']");if(ar.length>0)r=ar[0]}return r};function deleteConfirm(evt,table,confirm_message){if(table){var checked=isSomethingChecked(table.id);if(checked===false){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");Event.stop(evt);return false}}if(!confirm_message)confirm_message="com.ptc.netmarkets.util.utilResource.CONFIRM_DELETE";return JCAConfirm(evt,confirm_message)}
ATO.util.handleSubmitResult=function(orig,status,nextAction,js,URL,dynamicRefreshInfo){nextAction=4;orig(status,nextAction,js,URL,dynamicRefreshInfo);if(opener)opener.location.reload();wfWindowClose()};
ATO.util.editCancelPrepare=function(orig){var isCheckedout=$("isCheckedOutByUser")?$("isCheckedOutByUser").value:"false";var indAssignedExpMode=$("indAssignedExpMode")?$("indAssignedExpMode").value:"false";if(indAssignedExpMode==="true"||isCheckedout==="false"&&JCAConfirm("com.ptc.netmarkets.util.utilResource.CONFIRM_UNDO_CHECKOUT")){handleSubmitResult=handleSubmitResult.wrap(ATO.util.handleSubmitResult);return true}return orig()};
ATO.util.getFilteredAndNonFilteredItems=function(table){var items=[];if(table){var records=table.store.data.items;for(var rIdx=0,rlen=records.length;rIdx<rlen;rIdx++)items.push(records[rIdx]);if(table.store.isFiltered()===true){var filteredItems=tableUtils.getFilteredOutTableRows(table.store);for(var snapIdx=0,len=filteredItems.length;snapIdx<len;snapIdx++)items.push(filteredItems[snapIdx])}}return items};
ATO.util.setHiddenFieldValue=function(id,value){var form=getMainForm();!$ato(id)?JCAappendFormHiddenInput(form,id,value):($ato(id).value=value)};ATO.util.handleSpecialChars=function(str){var specialChars={};specialChars["&quot;"]='"';specialChars["&amp;"]="&";specialChars["&gt;"]=">";specialChars["&lt;"]="<";specialChars["&#39;"]="'";for(key in specialChars)str=replaceAll(str,key,specialChars[key]);return str};
ATO.util.getAdvancedExpressionData=function(tableId){if(!tableId){var tables=tableUtils.getTables();var len=tables.length;for(var i=0;i<len;i++){tableId=tables[i].id;if(tableId.startsWith("expressionable.mvc."))break;tableId=null}}var table=tableUtils.getTable(tableId);if(table){var jsonExpr={expressions:[]};var rows=ATO.util.getFilteredAndNonFilteredItems(table);var length=rows.length;for(var i=0;i<length;i++){var json={};var record=rows[i];if(!record)continue;var expression=ATO.util.handleSpecialChars(record.get("expressionField").gui.displayValue);
var description=ATO.util.handleSpecialChars(record.get("description").gui.displayValue);json.expression=expression;json.description=description;json.oid=record.get("oid");jsonExpr.expressions.push(json)}var ruleMembers=Ext.getDom("hdnExpressionMembers");if(!ruleMembers){var mainForm=getMainForm(tableId);ruleMembers=JCAappendFormHiddenInput(mainForm,"hdnExpressionMembers","")}var expstr=Ext.encode(jsonExpr);ruleMembers.value=expstr}return true};Ext.namespace("PTC.attribute.gui");
PTC.attribute.gui=function(){var ATTR_TYPE_BOOLEAN="Boolean";var ATTR_TYPE_STR="String";var ATTR_TYPE_DATE="Date";var ATTR_TYPE_TIMESTAMP="Timestamp";var ATTR_TYPE_INT="Integer";var ATTR_TYPE_REAL="Real";var ATTR_TYPE_FLOAT="Float";var ATTR_TYPE_REALWITHUNITS="RealWithUnits";var ATTR_TYPE_UNITS="Unit";var ATTR_TYPE_URL="URL";var ATTR_TYPE_URL_S="Url";var NMACTION_RENDERER="jsca.columns.nmActionRenderer";var NUM_RENDERER="jsca.columns.numericRenderer";var BOOLEAN_RENDERER="jsca.columns.booleanRenderer";
var LINK_RENDERER="jsca.columns.linkRenderer";var TYPE_INT="java.lang.Integer";var TYPE_FLOAT="com.ptc.core.meta.common.FloatingPoint";var TYPE_FLOAT_WITH_UNITS="wt.units.FloatingPointWithUnits";var isLink=function(value){if(value!==null&&value.indexOf("://")>0)return true;return false};var getStringValue=function(value){var htmlCont="";if(PTC.isDefined(value))if(PTC.attribute.gui.Utils.allowLinkRendering()&&isLink(value))htmlCont="<A HREF='"+value+"'>"+value+"</A>";else htmlCont=Ext.util.Format.htmlEncode(value);
return htmlCont};var getBooleanValue=function(value){if(typeof value==="string")value=value.toUpperCase()==="TRUE";if(PTC.isDefined(value))value=value?"TRUE":"FALSE";else value="";return value};var getDatevalue=function(value){var date="";if(typeof value==="string")date=Ext.util.Format.htmlEncode(value);else date=value;return date};var isSupported=function(attrType,value){if(typeof value==="boolean"||value instanceof Date)return true;if(PTC.isDefined(attrType)&&(ATTR_TYPE_STR===attrType||ATTR_TYPE_INT===
attrType||ATTR_TYPE_BOOLEAN===attrType||ATTR_TYPE_DATE===attrType||ATTR_TYPE_TIMESTAMP===attrType||ATTR_TYPE_REAL===attrType||ATTR_TYPE_FLOAT===attrType||ATTR_TYPE_REALWITHUNITS===attrType||ATTR_TYPE_UNITS===attrType||ATTR_TYPE_URL===attrType||ATTR_TYPE_URL_S===attrType))return true;return false};var _update=function(attrValue,newValue,attrType,options){PTC.attribute.gui.Utils.resetForUpdate(attrValue.gui);if(ATTR_TYPE_STR===attrType){attrValue.gui.html=getStringValue(newValue);return attrValue}if(typeof newValue===
"boolean"||ATTR_TYPE_BOOLEAN===attrType){attrValue.gui.rawValue=getBooleanValue(newValue);return attrValue}if(ATTR_TYPE_DATE===attrType||ATTR_TYPE_TIMESTAMP===attrType||newValue instanceof Date){attrValue.gui.html=PTC.isDefined(newValue)?PTC.attribute.gui.Utils.getFormatedDate(newValue):"";return attrValue}if(ATTR_TYPE_INT===attrType){attrValue.gui.type="java.lang.Integer";attrValue.gui.rawValue=PTC.isDefined(newValue)?newValue:"";return attrValue}if(ATTR_TYPE_REAL===attrType||ATTR_TYPE_FLOAT===attrType){attrValue.gui.type=
"com.ptc.core.meta.common.FloatingPoint";attrValue.gui.rawValue=newValue;return attrValue}if(ATTR_TYPE_REALWITHUNITS===attrType||ATTR_TYPE_UNITS===attrType){attrValue.gui.type="wt.units.FloatingPointWithUnits";if(ATTR_TYPE_REALWITHUNITS===attrType){var precision="";var unitOfMeasure=attrValue.gui.unitOfMeasure;if(PTC.isDefined(options)){if(PTC.isDefined(options.precision))precision=options.precision;if(PTC.isDefined(options.unitOfMeasure))unitOfMeasure=options.unitOfMeasure}attrValue.gui.rawValue=
""+newValue+"|"+precision+"|"+unitOfMeasure}else attrValue.gui.rawValue=newValue;return attrValue}if(ATTR_TYPE_URL===attrType||ATTR_TYPE_URL_S===attrType){attrValue.gui.rawValue=newValue;return attrValue}var _newValue=PTC.isDefined(newValue)?newValue:"";if(attrValue.renderer===NMACTION_RENDERER)attrValue.gui.html=_newValue;else attrValue.gui.rawValue=_newValue;return attrValue};var _create=function(newValue,attrType){if(ATTR_TYPE_STR===attrType)return{gui:{html:getStringValue(newValue)}};if(typeof newValue===
"boolean"||ATTR_TYPE_BOOLEAN===attrType)return{gui:{rawValue:getBooleanValue(newValue)},renderer:BOOLEAN_RENDERER};if(ATTR_TYPE_DATE===attrType||ATTR_TYPE_TIMESTAMP===attrType||newValue instanceof Date){var date=PTC.isDefined(newValue)?PTC.attribute.gui.Utils.getFormatedDate(newValue):"";return{gui:{html:date}}}if(ATTR_TYPE_INT===attrType)return{gui:{type:TYPE_INT,rawValue:PTC.isDefined(newValue)?newValue:""},renderer:NUM_RENDERER};if(ATTR_TYPE_REAL===attrType||ATTR_TYPE_FLOAT===attrType)return{gui:{type:TYPE_FLOAT,
rawValue:newValue},renderer:NUM_RENDERER};if(ATTR_TYPE_REALWITHUNITS===attrType||ATTR_TYPE_UNITS===attrType)return{gui:{type:TYPE_FLOAT_WITH_UNITS,rawValue:newValue},renderer:NUM_RENDERER};if(ATTR_TYPE_URL===attrType||ATTR_TYPE_URL_S===attrType)return{gui:{rawValue:newValue},renderer:LINK_RENDERER};return{gui:{rawValue:PTC.isDefined(newValue)?newValue:""}}};return{create:function(value,attrType){var gui=_create(value,attrType);return PTC.util.HTMLEncoder.handleAdjacentSpaces(gui)},update:function(attrValue,
value,attrType,options){if(!PTC.isDefined(attrValue))if(isSupported(attrType,value))return _create(value,attrType);else{if(attrType===undefined&&typeof value=="string")return getStringValue(value);return value}var gui;if(typeof attrValue==="object"&&attrValue.gui)gui=_update(attrValue,value,attrType,options);else if(typeof attrValue=="string"&&typeof value=="string")gui=getStringValue(value);else{if(attrType===undefined){if(typeof value=="string")return getStringValue(value);return value}gui=attrValue}return PTC.util.HTMLEncoder.handleAdjacentSpaces(gui)}}}();
PTC.attribute.gui.Utils=function(){return{allowLinkRendering:function(){return PTC.attributeHelper.get("createHyperlinks")},resetForUpdate:function(gui){if(PTC.isDefined(gui)){gui.html=undefined;gui.displayValue=undefined;gui.value=undefined;gui.rawValue=undefined;gui.comparable=undefined}},getFormatedDate:function(value){if(typeof value=="string"&&value.indexOf("new Date")!=-1)value=new Date(eval(value));if(value instanceof Date)try{var formatdatefunc=PTC.attributeHelper.get("DateRenderer");return formatdatefunc(value)}catch(e){return Ext.util.Format.htmlEncode(value)}else return Ext.util.Format.htmlEncode(value)}}}();
PTC.attributeHelper=function(){};PTC.attributeHelper._cache={};PTC.attributeHelper.get=function(key){PTC.attributeHelper._initializeCache();try{return PTC.attributeHelper._cache[key]}catch(e){return null}};PTC.attributeHelper.set=function(key,attributeData){try{PTC.attributeHelper._cache[key]=attributeData}catch(e){}};
PTC.attributeHelper._initializeCache=function(){try{var win=PTC.getMainWindow();var windowHref=window.location.href;if(win&&win.PTC&&win.location.href===windowHref)if(parent&&parent.PTC)win=parent;if(win&&win.location.href!==window.location.href&&win.PTC){win.PTC.attributeHelper._initializeCache();PTC.attributeHelper._cache=win.PTC.attributeHelper._cache;bundleHandler._setCache(win.bundleHandler._getCache());if(typeof win.PTC.attributeHelper.initializeVariables==="function")win.PTC.attributeHelper.initializeVariables.call(window);
PTC.attributeHelper._initializeCache=Ext.emptyFn;bundleHandler._initializeCache=Ext.emptyFn;return}}catch(e){PTC.log.error(e)}var options={method:"get",asynchronous:false};var url=getBaseHref()+"netmarkets/jsp/util/localizedData.jsp?d="+PTC.util.getUniqueId();options.onSuccess=function(transport){PTC.navigation.evalPageScripts(transport.responseText)};options.onFailure=options.onException=function(){PTC.attributeHelper._initializeCache=PTC.attributeHelper._initializeCacheOld;PTC.log.error("could not load the attribute cache")};
PTC.attributeHelper._initializeCacheOld=PTC.attributeHelper._initializeCache;PTC.attributeHelper._initializeCache=Ext.emptyFn;requestHandler.doRequest(url,options)};Ext.namespace("PTC.attributePanel");Ext.apply(PTC.attributePanel,new Ext.util.Observable);PTC.attributePanel.log=log4javascript.getLogger("PTC.attributePanel");PTC.attributePanel.addEvents("beforeRender","afterRender");
PTC.attributePanel.attributeGroup=function(groupData){if(groupData.nestedFlag){var nestedItems=[];for(var j=0;j<groupData.groups.length;j++)nestedItems.push(new PTC.attributePanel.attributeGroup(groupData.groups[j]));var useAutoWidth=PTC.attributePanel._useAutoWidth(groupData);var outerFieldSet={id:groupData.id,xtype:"fieldset",title:'<span class="attributePanel-fieldset-title">'+(groupData.label||"")+"</span>",collapsed:false,autoHeight:true,autoWidth:useAutoWidth,collapsible:true,items:nestedItems,
listeners:{}};if(!useAutoWidth)outerFieldSet.listeners.resize=function(attGroup,resizedWidth){PTC.attributePanel.resizeGroupWidth(attGroup,resizedWidth)};PTC.attributePanel.attributeGroup.superclass.constructor.call(this,outerFieldSet)}else{var store=new Ext.data.JsonStore({data:groupData,root:"rows",fields:["columns"]});var tpl=PTC.attributePanel.getXTemplate(groupData.renderOnTop);tpl.attributePanelJSCACellRenderer=function(data,attrId){var jsca_value="";try{var jsca_row={item:data};jsca_row.get=
function(id){return data};var jsca_col={id:attrId};this.id=groupData.id+"_"+attrId+"_aPanel";this.attributeGroupId=groupData.id;if(data===undefined)return jsca_value;var jsca_renderer=data.renderer||jsca.columns.simpleRenderer;if(typeof jsca_renderer==="string")jsca_renderer=PTC.util.convertStringToFunc(jsca_renderer);if(typeof jsca_renderer==="function")jsca_value=jsca_renderer(this,jsca_col,jsca_row)}catch(e){PTC.attributePanel.log.error("Error rendering attribute: "+attrId,e);jsca_value='<span style="color:red;">Error rendering '+
attrId+". Check javascript console for stack trace.</span>"}return jsca_value};var groupId=PTC.wizard.getCurrentObjectHandle()+groupData.id;useAutoWidth=PTC.attributePanel._useAutoWidth(groupData);groupId=groupId.replace(/ /g,"_");var groupConfig={title:'<span class="attributePanel-fieldset-title">'+(groupData.label||"")+"</span>",id:groupId,batchAttrId:groupData.batchAttrId,xtype:"fieldset",collapsible:true,autoHeight:true,autoWidth:useAutoWidth,renderOnTop:groupData.renderOnTop,hideIfNullValueInClient:groupData.hideIfNullValueInClient,
clientValueUpdatesComplete:true,items:[{xtype:"dataview",id:"dataStore"+groupId,store:store,tpl:tpl,autoHeight:true,autoWidth:true,itemSelector:"table.attributePanel-group-panel"}],listeners:{afterLayout:function(group){this.setLabelWidths(group)}}};if(!useAutoWidth)groupConfig.listeners.resize=function(attGroup,resizedWidth){PTC.attributePanel.resizeGroupWidth(attGroup,resizedWidth)};PTC.attributePanel.attributeGroup.superclass.constructor.call(this,groupConfig);this.setLabelWidths=PTC.util.delayAllCalls(this.setLabelWidths)}};
PTC.attributePanel._useAutoWidth=function(groupData){return!Ext.isIE||groupData.forceAutoWidth===true};
PTC.attributePanel.resizeGroupWidth=function(attGroup,resizedWidth){var fieldsetDomEl=attGroup.getEl();var contentDomNode=Ext.DomQuery.select('table[class="attributePanel-group-panel"]',fieldsetDomEl.dom);if(contentDomNode){var fieldSetPadding=parseInt(fieldsetDomEl.getStyle("padding-left"),12)+parseInt(fieldsetDomEl.getStyle("padding-right"),12);var maxFieldsetWidth=0;if(contentDomNode.length>1)for(groupNumber=contentDomNode.length;groupNumber--;){var newFieldsetWidth=contentDomNode[groupNumber].offsetWidth+
fieldSetPadding;if(newFieldsetWidth>maxFieldsetWidth)maxFieldsetWidth=newFieldsetWidth}else if(contentDomNode[0])maxFieldsetWidth=contentDomNode[0].offsetWidth+fieldSetPadding;if(maxFieldsetWidth>=resizedWidth)attGroup.setWidth(maxFieldsetWidth);else attGroup.setWidth("auto")}};
PTC.attributePanel.getRenderOnTopTemplate=function(){if(PTC.attributePanel.renderOnTopTemplate===undefined)PTC.attributePanel.renderOnTopTemplate=new Ext.XTemplate('<table class="attributePanel-group-panel">','<tpl for=".">',"<tr>",'<tpl for="columns">','<td class="attributePanel-asterisk">{asteriskValue}</td><td id="{labelId}"','<tpl if="PTC.automation.isAutomationTest()">',' attrid="{id}"',"</tpl>",' class="attributePanel-label{[(values.colSpan && values.colSpan > 1) ? " fullWidth" : ""]}"',' {[(values.colSpan && values.colSpan > 1) ? " colspan=" + ((values.colSpan * 2) - 1) : ""]}',
'>{label}{[(values.label && values.label != "&nbsp;") ? ":" : ""]}</td>',"</tpl>","</tr>","<tr>",'<tpl for="columns">','<td class="attributePanel-asterisk"></td><td',' class="attributePanel-value{[(values.colSpan && values.colSpan > 1) ? " fullWidth" : ""]}"',' attrId="{values.id}"{[(values.colSpan && values.colSpan > 1) ? " colspan=" + ((values.colSpan * 2) - 1) : ""]}> {[this.attributePanelJSCACellRenderer(values.value, values.id) ]} </td>',"</tpl>","</tr>","</tpl>","</table>");return PTC.attributePanel.renderOnTopTemplate};
PTC.attributePanel.getDefaultTemplate=function(){if(PTC.attributePanel.defaultTemplate===undefined)PTC.attributePanel.defaultTemplate=new Ext.XTemplate('<table class="attributePanel-group-panel">','<tpl for=".">',"<tr>",'<tpl for="columns">','<td class="attributePanel-asterisk">{asteriskValue}</td><td id="{labelId}" class="attributePanel-label">{label}{[(values.label && values.label != "&nbsp;") ? ":" : ""]}</td><td',' class="attributePanel-value{[(values.colSpan && values.colSpan > 1) ? " fullWidth" : ""]}"',
' attrId="{values.id}"{[(values.colSpan && values.colSpan > 1) ? " colspan=" + ((values.colSpan * 3) - 2) : ""]}> {[this.attributePanelJSCACellRenderer(values.value, values.id) ]} </td>',"</tpl>","</tr>","</tpl>","</table>");return PTC.attributePanel.defaultTemplate};PTC.attributePanel.getXTemplate=function(renderOnTop){if(renderOnTop===true)return PTC.attributePanel.getRenderOnTopTemplate();return PTC.attributePanel.getDefaultTemplate()};
PTC.attributePanel.getStringLength=function(string){var SPACE_CONSTANT="&nbsp;";var originalStrLen=string.length;var regExp=new RegExp(SPACE_CONSTANT,"g");var occurenceArray=string.match(regExp);if(occurenceArray){var totalOccurances=occurenceArray.length;return originalStrLen-totalOccurances*5}return originalStrLen};
Ext.extend(PTC.attributePanel.attributeGroup,Ext.form.FieldSet,{setLabelWidths:function(parentContainer){var cmp=this.getComponent("dataStore"+this.id);if(!cmp||!cmp.store)return;try{var dataSet=cmp.store.data;var widthCache={};var maxColumns=[];var i,j;for(i=dataSet.items.length;i--;){var cols=dataSet.items[i].data.columns;for(j=cols.length;j--;){var col=cols[j];var l=col.label;if(l==="&nbsp;")continue;if(l){var currentMax=maxColumns[j];var lengthOfLabel=PTC.attributePanel.getStringLength(l);if(col.asteriskValue)lengthOfLabel=
lengthOfLabel+2;if(!currentMax||lengthOfLabel>currentMax.length)maxColumns[j]={id:col.labelId,length:lengthOfLabel};else if(lengthOfLabel===currentMax.length){var currentMaxWidth=this.getLabelWidth(currentMax.id,widthCache);var potentialMaxWidth=this.getLabelWidth(col.labelId,widthCache);if(potentialMaxWidth>currentMaxWidth)currentMax.id=col.labelId}}}}var attrColumnWidth=parentContainer.getWidth()/maxColumns.length;if(attrColumnWidth===0)return;var maxWidth=Math.round(attrColumnWidth/3);if(parentContainer.renderOnTop===
true)maxWidth=attrColumnWidth;for(i=maxColumns.length;i--;)if(maxColumns[i]){var labelId=maxColumns[i].id;var labelWidth=this.getLabelWidth(labelId,widthCache);var dom=Ext.getDom(labelId);var maxed=labelWidth<maxWidth;if(parentContainer.renderOnTop===true)dom.style.width=maxWidth+"px";else dom.style.width=maxed?labelWidth+"px":maxWidth+"px";dom.style.whiteSpace=maxed?"nowrap":"normal"}}catch(e){PTC.attributePanel.log.error("attributes panel cannot reset the widths, the panel is gone")}},getLabelWidth:function(id,
widthCache){var result=widthCache[id];if(!result){var dom=Ext.getDom(id);if(!PTC.attributePanel.labelTextMetric)PTC.attributePanel.labelTextMetric=Ext.util.TextMetrics.createInstance(dom);result=PTC.attributePanel.labelTextMetric.getWidth(dom.innerHTML);widthCache[id]=result}return result},getAttributeIDs:function(){var idList=[];var index=0;var _item=this.items.get(0);if(_item.id==="dataStore"+this.id){var dataSet=this.items.get(0).store.data;dataSet.each(function(rowDef){var allCols=rowDef.data.columns;
allCols.each(function(col){idList[index]=col.id;index++})})}return idList},getRows:function(){var dataSet=this.items.get(0).store.data;return dataSet},getRow:function(index){var dataSet=this.items.get(0).store.data;return dataSet.get(index)},removeAllRows:function(){var dataSet=this.items.get(0).store.data;dataSet.clear()},addOneColumnRow:function(id,label,value){PTC.attributePanel.log.debug("addOneColumnRow : id : "+id+"\tvalue : ["+value+"]\tlabel : "+label);var rowRecord=new Ext.data.Record({allColsInRowHidden:false,
columns:[{id:id,colSpan:1,value:value,"class":"class com.ptc.core.components.tags.attributePanel.RenderAttributePanelTag$AttributeModel",label:label,labelId:id+(new Date).getTime()}],"class":"class com.ptc.core.components.tags.attributePanel.RenderAttributePanelTag$AttributesInRowModel"});var dataSet=this.items.get(0).store.data;dataSet.add(rowRecord)},addRowRecord:function(record){var dataSet=this.items.get(0).store.data;dataSet.add(record)},getStore:function(){return this.items.get(0).store},sortOnFirstColumn:function(){var direction=
"ASC";var store=this.getStore();var custSortFunc=function(r1,r2){var v1=r1.data.columns[0].label;var v2=r2.data.columns[0].label;return v1>v2?1:v1<v2?-1:0};store.data.sort(direction,custSortFunc);if(store.snapshot&&store.snapshot!=store.data)store.snapshot.sort(direction,custSortFunc)},setClientValueUpdatesComplete:function(value){this.clientValueUpdatesComplete=value;this.datachangedEventFired=false;var remove=this._handleHideifNullValue();if(remove){var panel=this.findParentByType(PTC.attributePanel.AttributePanel);
panel.remove(this);PTC.attributePanel.log.debug("setClientValueUpdatesComplete groups2remove : "+this.label)}else if(this.datachangedEventFired===false){var store=this.getStore();store.fireEvent("datachanged",store)}},_handleHideifNullValueByFilter:function(){var applyFilter=true;var dataSet=this.getRows();dataSet.each(function(rowDef){var allCols=rowDef.data.columns;if(allCols&&allCols.length>1){applyFilter=false;return applyFilter}});PTC.attributePanel.log.debug("_handleHideifNullValueByFilter : "+
this.label+"\t"+applyFilter);if(applyFilter){var store=this.getStore();store.filterBy(function(record){var _ret=false;if(record.data.columns[0]){var empty_value=PTC.attributePanel.attributeGroup.Utils.isHideIfNullValue(record.data.columns[0].value);_ret=!empty_value}return _ret});this.datachangedEventFired=true}return applyFilter},_handleHideifNullValueByLabelUpdate:function(){var rows2remove=[];var dataSet=this.getRows();dataSet.each(function(rowDef){var allCols=rowDef.data.columns;var remove=true;
allCols.each(function(col){if(PTC.attributePanel.attributeGroup.Utils.isHideIfNullValue(col.value))col.label="";else remove=false;PTC.attributePanel.log.debug("_handleHideifNullValueByLabelUpdate : id : "+col.id+"\tvalue : ["+col.value+"]\tlabel : "+col.label)});if(remove)rows2remove.push(rowDef)});for(var k=0;k<rows2remove.length;k++)dataSet.remove(rows2remove[k])},_handleHideifNullValue:function(){var removeGroup=false;if(this.clientValueUpdatesComplete){if(this.hideIfNullValueInClient){var appliedFilter=
this._handleHideifNullValueByFilter();if(!appliedFilter)this._handleHideifNullValueByLabelUpdate()}if(this.getRows().length===0)removeGroup=true}return removeGroup}});
PTC.attributePanel.AttributePanel=function(panelData){var panelItems=[];var jcaDebugInfo=PTC.debug.getJCADebugHTML(panelData);if(panelData.record)this.populateDataFromRecord(panelData);for(var i=0,l=panelData.groups.length;i<l;i++){if(jcaDebugInfo)panelData.groups[i].label=panelData.groups[i].label+jcaDebugInfo;if(panelData.forceAutoWidth)panelData.groups[i].forceAutoWidth=true;panelItems.push(new PTC.attributePanel.attributeGroup(panelData.groups[i]))}var builderId="";var uniqId="";if(typeof PTC.attributePanel.AttributePanel.ap!=
"undefined"&&panelData.useExistingDUniqueDivs!==false){builderId=PTC.attributePanel.AttributePanel.ap.builderId();uniqId=PTC.attributePanel.AttributePanel.ap.uniqueValue()}var objectHandle=PTC.wizard.getCurrentObjectHandle();var titleDiv=objectHandle+builderId+"__AttributesTablePaneOuter_"+uniqId;var fieldsetDiv=objectHandle+builderId+"__AttributesTablePaneInner_"+uniqId;var panelConfig={id:titleDiv,screenType:panelData.id,title:panelData.title,items:panelItems,cls:"attribute-apanel x-reset",storeURL:panelData.storeURL,
applyTo:panelData.applyTo,renderTo:panelData.renderTo,existingFormId:panelData.existingFormId,monitorResize:true};if(isIE)panelConfig.border=false;if(panelData.render!==false)if(panelData.componentType==="MINI_INFO"){panelConfig.applyTo="attributesPanel";panelConfig.existingFormId="attributesPanelInner"}else{panelConfig.applyTo=titleDiv;panelConfig.existingFormId=fieldsetDiv}if(!Ext.getDom(panelConfig.existingFormId)){var div=document.createElement("div");div.id=panelConfig.applyTo;var innerDiv=document.createElement("div");
innerDiv.id=panelConfig.existingFormId;div.appendChild(innerDiv);if(Ext.getDom(panelData.parentID))Ext.getDom(panelData.parentID).appendChild(div)}PTC.attributePanel.AttributePanel.superclass.constructor.call(this,panelConfig)};
Ext.extend(PTC.attributePanel.AttributePanel,Ext.form.FormPanel,{existingFormId:null,createForm:function(){var config=Ext.applyIf({listeners:{}},this.initialConfig);return new Ext.form.BasicForm(this.initialConfig.existingFormId,config)},onRender:function(ct,position){PTC.attributePanel.fireEvent("beforeRender",this);this.initFields();this._handleHideifNullValue();if(isIE)this.bodyCfg=null;Ext.FormPanel.superclass.onRender.call(this,ct,position);if(!this.existingFormId){var o={tag:"form",method:this.method||
"POST",id:this.formId||Ext.id()};if(this.fileUpload)o.enctype="multipart/form-data";this.form.initEl(this.body.createChild(o))}var header=Ext.getCmp(this.id).header;if(header)Ext.getCmp(this.id).header.setDisplayed(false)},afterRender:function(ct){PTC.attributePanel.AttributePanel.superclass.afterRender.apply(this,arguments);PTC.attributePanel.fireEvent("afterRender",this)},_handleHideifNullValue:function(){var groups=this.getGroups();var groups2remove=[];groups.each(function(group){var removeGrp=
group._handleHideifNullValue();if(removeGrp){PTC.attributePanel.log.debug("groups2remove : "+group.label);groups2remove.push(group)}});for(var j=0;j<groups2remove.length;j++)groups.remove(groups2remove[j])},getAttributeValue:function(id){var result;this.iterateAttributes(function(col){if(col.id===id){result=col.value;return result}});return result},setAttributeValue:function(id,value){var returnVal=false;this.iterateAttributes(function(col){if(col.id===id){col.value=PTC.util.HTMLEncoder.handleAdjacentSpaces(value);
returnVal=true;return true}});return returnVal},updateAttributeValue:function(id,value,attrType,options){var returnVal=false;this.iterateAttributes(function(col){if(col.id===id)if("true"!==col.valueHidden){col.value=PTC.attribute.gui.update(col.value,value,attrType,options);returnVal=true;return true}else PTC.attributePanel.log.debug("updateAttributeValue : Can't update value for hidden-value attribute with id "+id)});return returnVal},iterateAttributes:function(callback){this.items.each(function(item){var dataSet=
item.getComponent("dataStore"+item.id).store.data;dataSet.each(function(rowDef){var allCols=rowDef.data.columns;allCols.each(callback)})})},populateDataFromRecord:function(config){var rec=config.record;var i=config.groups.length;while(i--){var g=config.groups[i];var j=g.rows.length;while(j--){var row=g.rows[j];var k=row.columns.length;while(k--){var cell=row.columns[k];cell.value=rec.get(cell.id)}}}},getAttributeIDs:function(){var idList=[];var index=0;this.items.each(function(item){var dataSet=item.getComponent("dataStore"+
item.id).store.data;dataSet.each(function(rowDef){var allCols=rowDef.data.columns;allCols.each(function(col){idList[index]=col.id;index++})})});return idList},getGroupIDs:function(){var idList=[];var index=0;this.items.each(function(item){idList[index]=item.id;index++});return idList},getGroup:function(groupId){var group;this.items.each(function(item){if(item.id===groupId){group=item;return}});return group},getGroupWithBatchAttr:function(batchAttrId){var groups=this.getGroups();var result;groups.each(function(group){if(batchAttrId===
group.batchAttrId){result=group;return}});return result},getGroups:function(){return this.items},addGroup:function(group){this.items.add(group)},domChangeEventListener:function(evt,element){var tag=element.tagName.toLowerCase();if(tag==="input"||tag==="select"||tag==="textarea"){var panel=this;var cell_TD=getParentNodeByTag(element,"TD");var attrId=cell_TD.getAttribute("attrId");var cell=panel.getAttributeValue(attrId);if(cell)PTC.wizard.saveTableData.saveNewValueToCell(element,cell,cell_TD)}}});
PTC.attributePanel.findParentAttributePanel=function(childElement){var attributePanel;var childEl=Ext.get(childElement);if(childEl){var attrPanelEl=childEl.findParent("div.attribute-apanel");if(attrPanelEl)attributePanel=Ext.getCmp(attrPanelEl.id)}return attributePanel};
PTC.attributePanel.Utils=function(){return{createDynamicAttributePanel:function(attributePanel,attributeIDArray,callBackFunction,params){var successFunction=function(response){var panelData=Ext.util.JSON.decode(response.responseText.trim());panelData.id=attributePanel.id+"_dynamic";panelData.render=false;panelData.useExistingDUniqueDivs=false;var dynamic_attrpanel=new PTC.attributePanel.AttributePanel(panelData);if(typeof callBackFunction=="function")callBackFunction(dynamic_attrpanel)};var params_combo=
params!==undefined?params:{};params_combo.dynamicProperty=attributeIDArray.toString();var ajax_url=getBaseHref()+Ext.urlAppend(attributePanel.storeURL.url,Ext.urlEncode(attributePanel.storeURL.params));var options={method:"get",asynchronous:true,requestHeaders:["Accept","application/json"],onSuccess:successFunction,parameters:params_combo};requestHandler.doRequest(ajax_url,options)},resetguiValueProps:function(gui){if(PTC.isDefined(gui)){gui.html=undefined;gui.displayValue=undefined;gui.value=undefined;
gui.rawValue=undefined}}}}();PTC.attributePanel.attributeGroup.Utils=function(){return{isHideIfNullValue:function(data){var value=data;if(data&&data.gui)if(PTC.isDefined(data.gui.html))value=data.gui.html;else if(PTC.isDefined(data.gui.displayValue))value=data.gui.displayValue;else if(PTC.isDefined(data.gui.value))value=data.gui.value;else value=data.gui.rawValue;if(typeof value==="string")value=value.trim();if(!value||value===""||value==="&nbsp;")return true;return false}}}();
Ext.reg("attributePanel",PTC.attributePanel.AttributePanel);Ext.namespace("PTC.auditing");PTC.autosuggest={log:log4javascript.getLogger("PTC.autosuggest")};
PTC.autosuggest.suggestBoxHandler=function(){var suggestIds={};var suggestBoxes={};var listeners={};return{addSuggestBoxValueListener:function(hiddenId,listener){if(typeof listener==="function"){var suggestBox=suggestBoxes[hiddenId];if(suggestBox!==undefined)suggestBox.on("select",listener);else listeners[hiddenId]=listener}},registerSuggestBox:function(suggestBox){suggestBoxes[suggestBox.hiddenName]=suggestBox;var listener=listeners[suggestBox.hiddenName];if(listener!==undefined)suggestBox.on("select",
listener)},addSuggestBoxId:function(id){suggestIds[id]=true},isAutoSuggest:function(id){return suggestIds[id]===true}}}();
PTC.autosuggest.SuggestBox=Ext.extend(Ext.form.ComboBox,{initComponent:function(){PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- Start initComponent for "+this.id);PTC.autosuggest.SuggestBox.superclass.initComponent.call(this);if(this.hasOwnProperty("id")&&this.hasOwnProperty("applyTo")){var ele=Ext.get(this.id);var spanEl;if(this.underlyingDOMElementSpanId)spanEl=Ext.get(this.underlyingDOMElementSpanId);if(!ele)if(spanEl&&spanEl.dom){if(this.htmlOfUnderlyingDOMelement){PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- Inserting HTML for underlying DOM element of "+
this.id);spanEl.dom.innerHTML=this.htmlOfUnderlyingDOMelement}else PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- ERROR !!! No HTML received for underlying DOM element of "+this.id);ele=Ext.get(this.id);if(!ele)PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- DOM element didnt get  created yet !!! for "+this.id);else PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- Successfully recreated DOM element for "+this.id)}else PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- No  spanEl or spanEl.dom !!! for "+
this.id)}PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- End initComponent for "+this.id+"\n")},applyToMarkup:function(applyTo){PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- Start Destroyer for "+this.id);PTC.autosuggest.SuggestBox.superclass.applyToMarkup.call(this,this.id);PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- End Destroyer for "+this.id)},constructor:function(suggestConfig){PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- Start constructor for "+suggestConfig.id);
Ext.applyIf(suggestConfig.storeConfig,{proxy:new Ext.data.HttpProxy({url:"servlet/SuggestServlet",restful:true}),reader:new Ext.data.JsonReader({idProperty:"valueText",root:"results",totalProperty:"totalCount",successProperty:"success",fields:[{name:"valueText"},{name:"displayText"},{name:"additionalText"}]}),listeners:{beforeload:function(store){if(store.proxy.activeRequest&&store.proxy.activeRequest.read&&store.proxy.activeRequest.read.conn)requestHandler.abort(store.proxy.activeRequest.read.conn)}}});
var resultTpl=new Ext.XTemplate('<tpl for="."><div id="autoSuggestEntry_{valueText}" ext:qtip="{displayText}<tpl if="additionalText"> ({additionalText})</tpl>" class="x-combo-list-item">{displayText}<tpl if="additionalText"> ({additionalText})</tpl></div></tpl>',{compiled:true,disableFormats:true});Ext.applyIf(suggestConfig,{store:new Ext.data.Store(suggestConfig.storeConfig),displayField:"displayText",valueField:"valueText",submitValue:true,loadingText:bundleHandler.get("com.ptc.core.ui.tableRB.SEARCH_IN_PROGRESS"),
minChars:3,queryDelay:600,resizable:true,selectOnFocus:true,forceSelection:true,minListWidth:300,hideTrigger:true,tpl:resultTpl,listeners:{afterrender:function(component){var autoSuggestField=component.getEl();autoSuggestField.removeClass("x-form-text");autoSuggestField.parent().addClass("autoSuggestField-wrap")},beforeselect:function(component,record){return Ext.isDefined(record.data.valueText)&&record.data.valueText!==""},focus:function(component){component.getEl().removeClass("x-form-focus");this.lastSelectionText=
component.el.dom.value},select:function(component){(function(){component.getEl().removeClass("x-form-focus")}).defer(1);PTC.wizard.saveTableData.callDomChangeListener(component.el.dom)}}});PTC.autosuggest.SuggestBox.superclass.constructor.call(this,suggestConfig);PTC.autosuggest.suggestBoxHandler.registerSuggestBox(this);PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- End constructor for "+suggestConfig.id)},destroy:function(){PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- Start Destroyer for "+
this.id);PTC.autosuggest.SuggestBox.superclass.destroy.call(this);PTC.autosuggest.log.debug("PTC.autosuggest.SuggestBox- End Destroyer for "+this.id)}});PTC.automation={};PTC.automation.log=log4javascript.getLogger("PTC.automation");PTC.automation.table={};PTC.automation.tree={};PTC.automation.wizard={};PTC.automation.page={};PTC.automation.nav={};PTC.automation.menu={};
PTC.automation.table.getTable=function(tableId){var table=PTC.automation.page.getCmp(tableId);if(table&&(table instanceof Ext.grid.GridPanel||table.jcaTableConfig&&table.jcaTableConfig.tableID))return table};PTC.automation.page.getCmp=function(cmpId){return PTC.util.getCmpInAllPTCnameSpaces(cmpId)};
PTC.automation.table.isReady=function(tableId){try{if(PTC.automation.isAjaxRequestPending()){PTC.automation.log.debug("PTC.automation.table.isReady returning false because ajax requests are pending "+tableId);return false}var table=PTC.automation.table.getTable(tableId);if(table&&table.getStore()){if(table.fitDone===false){PTC.automation.log.debug("PTC.automation.table.isReady returning false because find in tree is not done for tableId "+tableId);return false}if(table.getStore().isLoading()){PTC.automation.log.debug("PTC.automation.table.isReady returning false because data is still loading for tableId "+
tableId);return false}var titleBar=table.getTopToolbar();if(titleBar){var cancelButton=titleBar.findById(table.cancelBtnId);if(cancelButton&&cancelButton.isVisible()){PTC.automation.log.debug("PTC.automation.table.isReady returning false because cancel button still visible for tableId "+tableId);return false}}var ready=table.getStore().DATA_RENDERED;PTC.automation.log.debug("PTC.automation.table.isReady returning "+ready+" for tableId "+tableId);return ready}else PTC.automation.log.error("PTC.automation.table.isReady returning false because table or store was not found for tableId "+
tableId)}catch(e){PTC.automation.log.debug("Error in table.isReady("+tableId+")",e)}return false};PTC.automation.isAutomationTest=function(){return PTC.automation.stateProvider.get("isAutomationTest")};PTC.automation.table.focusRowWithContent=function(tableId,content,exactContent){var index=PTC.automation.table.findRowWithContent(tableId,content,exactContent);PTC.automation.table.focusRowWithIndex(tableId,index)};
PTC.automation.table.focusRowWithIndex=function(tableId,index){var table=PTC.automation.table.getTable(tableId);if(index<=1)table.getView().scrollToTop();else{index=index-1;table.getView().focusRow(index)}};
PTC.automation.table.findRowWithContent=function(tableId,content,exactContent){var table=PTC.automation.table.getTable(tableId);var store=table.getStore();var colModel=table.getColumnModel();var colCount=colModel.getColumnCount(false);var index=store.findBy(function(record,id){var len=content.length;var results=new Array(len);var column;for(var i=0;i<colCount;i++){column=colModel.getColumnAt(i);if(PTC.jca.ColumnUtils.isVisibleDataColumn(column)){var text=jsca.columns.getJSCASearchText(table,column,
record).trim();for(var k=0;k<len;k++){PTC.automation.log.debug("test "+text+"content "+content[k]);if(text===content[k]||text.toLowerCase().indexOf(content[k].toLowerCase())!==-1&&!exactContent){if(len===1)return true;results[k]=true}}}if(results.compact().length===results.length)return true}PTC.automation.log.debug("PTC.automation.table.findRowWithContent unable to find "+escape(content)+" for table with ID "+tableId+".  exactContent match is set to "+exactContent);return false});return index+1};
PTC.automation.table.getCellText=function(cellObj){try{var type=typeof cellObj;if(type=="string")return cellObj;else return getJSCASearchTextForCell(cellObj)}catch(err){}return""};
PTC.automation.table.findRowsWithContent=function(tableId,content,exactContent,colIndex){var table=PTC.automation.table.getTable(tableId);var store=table.getStore();var colModel=table.getColumnModel();var colCount=colModel.getColumnCount(true);var rowIndexes=[];var rowCount=store.getCount();var columnConfigs=colModel.config;var len=content.length;for(var r=0;r<rowCount;r++){var record=store.getAt(r);var results=new Array(len);var curVal;var text;var column;if(colIndex>0){column=colModel.getColumnAt(colIndex);
text=jsca.columns.getJSCASearchText(table,column,record).trim();if(text==content[0]||text.toLowerCase().indexOf(content[0].toLowerCase())!=-1&&!exactContent)rowIndexes.push(r+1)}else for(var c=0;c<colCount;c++){column=colModel.getColumnAt(c);if(PTC.jca.ColumnUtils.isVisibleDataColumn(column)){text=jsca.columns.getJSCASearchText(table,column,record).trim();for(var k=0;k<len;k++)if(text===content[k]||text.toLowerCase().indexOf(content[k].toLowerCase())!==-1&&!exactContent){if(len===1){rowIndexes.push(r+
1);break}results[k]=true}}if(results.compact().length===results.length){rowIndexes.push(r+1);break}}}return rowIndexes};PTC.automation.table.isViewListOpen=function(id){var v=PTC.automation.page.getCmp(id);return v.view.el.isVisible(true)};
PTC.automation.table.getValueForComboListView=function(id,view){var v=PTC.automation.page.getCmp(id);var value="";var record=v.findRecord(v.displayField,view);if(record!==undefined&&record!==null){value=record.get(v.valueField);PTC.automation.log.debug("PTC.automation.table.getValueForComboListView  view:"+view+" value:"+value)}else PTC.automation.log.debug("PTC.automation.table.getValueForComboListView unable to find value for view "+escape(view));return value};
PTC.automation.table.selectView=function(id,view){var v=PTC.automation.page.getCmp(id);if(!v.view&&v.initList)v.initList();if(v.selectByValue(view)){var index=v.view.getSelectedIndexes()[0];var r=v.store.getAt(index);v.onSelect(r,index)}else{if(id==="cwsContainerName"){var store=v.getStore();store.findBy(function(listItem){if(listItem.json&&listItem.json[1]===view){view=listItem.id;return true}})}v.setValue(view)}};
PTC.automation.table.getAllViewOptions=function(id){var v=PTC.automation.page.getCmp(id);var s=v.store;var result=[];s.each(function(r){result.push(r.get("text"))});return result.join(",")};PTC.automation.table.isColumnResizable=function(tableId,colIndex){return PTC.automation.table.getTable(tableId).getColumnModel().isResizable(colIndex)};
PTC.automation.table.getToolbarButtonID=function(tableID,tooltip){var rval="";var toolbarItems=PTC.automation.page.getCmp(tableID+".toolBar").items.items;for(i=0,l=toolbarItems.length;i<l;i++){var item=toolbarItems[i];if(item.tooltip){var ttext=item.tooltip.toLowerCase?item.tooltip:item.tooltip.text;if(ttext&&ttext.toLowerCase().trim()==tooltip.toLowerCase().trim())rval=item.id}}return rval};
PTC.automation.wizard.isReady=function(){try{if(PTC.automation.isAjaxRequestPending()){PTC.automation.log.debug("PTC.automation.wizard.isReady returning false because ajax requests are pending");return false}if(!PTC.isReady()){PTC.automation.log.debug("PTC.automation.wizard.isReady returning false since PTC.isReady() was false");return false}}catch(e){PTC.automation.log.error("Error in wizard.isReady",e)}PTC.automation.log.debug("PTC.automation.wizard.isReady returning true");return true};
PTC.automation.nav.isReady=function(id){try{if(PTC.automation.isAjaxRequestPending()){PTC.automation.log.debug("PTC.automation.nav.isReady returning false because ajax requests are pending");return false}PTC.automation.log.debug("PTC.automation.nav.isReady called with id "+id);if(!PTC.automation.page.isReady()){PTC.automation.log.debug("PTC.automation.nav.isReady returning false because page is not ready");return false}if(id==="footer"||id==="header"){if(!Ext.get(id))return false;return true}else{var navPanel=
Ext.getCmp(id+"Navigation");if(!navPanel||!navPanel.root||navPanel.root.isLoading()){PTC.automation.log.debug("PTC.automation.nav.isReady returning false because navPanel/root is not found or is loading");return false}var childNodes=navPanel.root.childNodes;if(!childNodes){PTC.automation.log.debug("PTC.automation.nav.isReady returning true because panel is loaded and no children were found");return true}for(var i=0,l=childNodes.length;i<l;i++){var node=childNodes[i];if(!node.isLeaf()&&node.isLoading()){PTC.automation.log.debug("PTC.automation.nav.isReady returning false because node is loading");
return false}}PTC.automation.log.debug("PTC.automation.nav.isReady returning true because panel and children are loaded");return true}}catch(e){PTC.automation.log.error("Error in nav.isReady("+id+")"+e)}return true};
PTC.automation.page.isReady=function(){try{if(PTC.automation.isAjaxRequestPending()){PTC.automation.log.debug("PTC.automation.page.isReady returning false because ajax requests are pending");return false}if(!PTC.isReady()){PTC.automation.log.debug("PTC.automation.page.isReady returning false because PTC.isReady() was false");return false}if(PTC.htmlcomp.isCadxAction){var isCadxComponentReady=PTC.htmlcomp.isCadxComponentsReady();PTC.automation.log.debug("PTC.automation.page.isReady returning ",isCadxComponentReady,
" for this cadx action");return isCadxComponentReady}}catch(e){PTC.automation.log.error("PTC.automation.page.isReady returning false, Error in page.isReady",e);return false}PTC.automation.log.debug("PTC.automation.page.isReady returning true");return true};PTC.automation.isAjaxRequestPending=function(){return PTC.automation._ajaxCalls>0};
PTC.automation.getTimedOutMessage=function(scriptThatTimedOut){var messagesToLog=[];messagesToLog[0]="";messagesToLog[messagesToLog.length]="TEST TIMED OUT evaluating script "+scriptThatTimedOut;if(PTC.automation.isAjaxRequestPending()){messagesToLog[messagesToLog.length]="There are ajax requests pending.";messagesToLog[messagesToLog.length]="-- Started ajax requests -- "+PTC.automation._startedCalls.length;PTC.automation._startedCalls.each(function(url){messagesToLog[messagesToLog.length]=url});
messagesToLog[messagesToLog.length]="-- Finished ajax requests -- "+PTC.automation._finishedCalls.length;PTC.automation._finishedCalls.each(function(url){messagesToLog[messagesToLog.length]=url})}else messagesToLog[messagesToLog.length]="No ajax requests pending.";var html=document.documentElement.innerHTML.toLowerCase();if(html.indexOf("windchill error")>0)messagesToLog[messagesToLog.length]="Found string 'Windchill Error' in HTML.";if(html.indexOf("http status 404")>0||html.indexOf("http status 500")>
0)messagesToLog[messagesToLog.length]="Found error code 'HTTP Status 404' or 'HTTP Status 500' in HTML.";messagesToLog[messagesToLog.length]="Check the method server log for exceptions.";messagesToLog[messagesToLog.length]="There may have been js errors, try the scenario manually and check for js errors in the browser.";messagesToLog[messagesToLog.length]='In the MS log, the exact time a message was logged is the long integer immediately following the URL "|1258659279030|".';messagesToLog[messagesToLog.length]=
"";PTC.automation.log.debug.apply(PTC.automation.log,messagesToLog);PTC.log.sendAllMessages();var result="";messagesToLog.each(function(message){result=result+message+"\n"});return result};PTC.automation._ajaxCalls=0;PTC.automation._startedCalls=[];PTC.automation._finishedCalls=[];PTC.automation.stateProvider=new PTC.jca.state.ClientStateProvider;
PTC.automation.ajaxRequest={_PARAMS_TO_PRINT:3,toString:function(){var returnVal="url='"+this.url+"'";var params=this.params;var paramLength=0;for(var p in params)if(params.hasOwnProperty(p))++paramLength;returnVal+=", params={ ";if(paramLength>0){var i=1;for(var par in params)if(params.hasOwnProperty(par)){if(i>PTC.automation.ajaxRequest._PARAMS_TO_PRINT){returnVal+=paramLength+1-i+" more...";break}returnVal+=par+"=";var val=params[par];if(typeof val==="string")returnVal+="'"+val+"'";else returnVal+=
""+val+"";if(i<paramLength)returnVal+=", ";else returnVal+=" ";i++}}returnVal+="}";return returnVal}};
PTC.onReady(function(){var seleniumParam=extractParamValue(PTC.automation.getMainWindow().location.href,"forceTrail");if(seleniumParam!=="true")PTC.log.enablePopupAppender();if(seleniumParam==="true"||PTC.automation.isAutomationTest()){PTC.automation.log.debug("Selenium test being run, so initialize the page for automation.");PTC.automation.init()}else if(PTC.trail.isTrailEnabled()){PTC.automation.log.debug("Being executed in trail enabled browser so keeping a count of pending ajax requests ");PTC.automation.stateProvider.set("isAutomationTest",
true);PTC.jca.table.Utils.cachedIsTrail=true;var excludePatterns="x-auto,ext-gen,ext-comp,"+PTC.trail.GENERATED_ID;PTC.trail.log.debug("PTC.trail ignoring clicks on ids matching excludePatterns ",excludePatterns);ProECommandVoid("SetTrailRecordPolicy?policy=No_Load_Url&use_dot_iframe_delimiter=false&exclude_patterns="+excludePatterns);PTC.automation.init()}});PTC.automation.enableThumbnailPopup=false;PTC.automation.wvs_mt_mouseover=function(){if(PTC.automation.enableThumbnailPopup)wvs_mt_mouseover_custom.call(this)};
PTC.automation.init=function(hybrid){PTC.log.enableLogging("&jsLog=PTC.navigation,PTC.automation");PTC.automation.stateProvider.set("isAutomationTest",true);PTC.automation.log.debug("PTC.automation initializing: "+window.location.href);PTC.automation.log.debug("PTC.automation is hybrid ? "+hybrid);var startAjaxRequest=function(url){PTC.automation._ajaxCalls++;PTC.automation._startedCalls[PTC.automation._startedCalls.length]=url;PTC.automation.log.debug("PTC.automation ajax request started. Current count of open requests: "+
PTC.automation._ajaxCalls+url)};var finishAjaxRequest=function(url){PTC.automation._ajaxCalls--;PTC.automation._finishedCalls[PTC.automation._finishedCalls.length]=url;if(PTC.automation._ajaxCalls<=0){PTC.automation._startedCalls=[];PTC.automation._finishedCalls=[];if(PTC.automation._ajaxCalls!==0){PTC.automation.log.debug("Count of ajax calls was negative. Resetting to 0.");PTC.automation._ajaxCalls=0}}PTC.automation.log.debug("PTC.automation ajax request finished. Current count of open requests: "+
PTC.automation._ajaxCalls+" "+url)};PTC.automation.log.debug("counting requests made via Ajax.Request.prototype.request ");Ajax.Request.prototype.request=Ajax.Request.prototype.request.wrap(function(original,url){if(this.options!==undefined&&this.options.onSuccess!==undefined){startAjaxRequest(url);this.options.onSuccess=this.options.onSuccess.wrap(function(originalSuccess,a,b,c,d,e){try{var result=originalSuccess(a,b,c,d,e)}finally{finishAjaxRequest(url)}return result})}return original(url)});PTC.automation.log.debug("counting requests made via Ext.Ajax");
Ext.Ajax.on("beforerequest",function(conn,options){options.toString=PTC.automation.ajaxRequest.toString;startAjaxRequest(options.toString());return true});Ext.Ajax.on("beforerequest",function(){Ext.Ajax.on("requestcomplete",function(conn,response,options){options.toString=PTC.automation.ajaxRequest.toString;finishAjaxRequest(options.toString());return true});return true},this,{single:true});Ext.Ajax.on("requestexception",function(conn,response,options){PTC.automation.log.debug("Error requesting URL "+
options.url);PTC.automation.log.debug("Error response.status was "+response.status);PTC.automation.log.debug("Error response.statusText was "+response.statusText);PTC.automation.log.debug("Error response.responseXML was "+response.responseXML);PTC.automation.log.debug("Error response.responseText was "+response.responseText);var optionsString=Ext.encode(options);PTC.automation.log.debug("Request Options: "+optionsString)});PTC.messaging.getDeferTimeoutMill=function(){return PTC.messaging.deferTimeoutMill};
PTC.messaging.deferTimeoutMill=14E3;stopProgress=stopProgress.wrap(function(p){PTC.automation.wizard.isReady=TRUE_FUNC;return p.call(this)});goProgress=goProgress.wrap(function(p){PTC.automation.wizard.isReady=FALSE_FUNC;return p.call(this)});PTC.automation.log.debug("Hiding tooltips so they don't interfere with clicks");Ext.util.CSS.createStyleSheet(".x-tip { z-index: -999 !important; } \n.x-shadow, .x-ie-shadow { z-index: -999 !important; } \n.dynpopupblock{ z-index : -999 !important; }");if(hybrid)try{PTC.automation.log.debug("Removing tooltip DOM elements");
Ext.DomQuery.select(".x-tip, .x-shadow, .x-ie-shadow , .dynpopupblock").each(function(e){var parent=e.parentNode;parent.removeChild(e);parent.addChild(e)})}catch(e){PTC.automation.log.debug("Error trying to handle tooltips. "+e)}PTC.automation.init=TRUE_FUNC;wvs_mt_mouseover_custom=wvs_mt_mouseover;wvs_mt_mouseover=PTC.automation.wvs_mt_mouseover};
PTC.automation.menu.getMenus=function(win){var _getMenus=function(win,menus){if("Ext"in win&&"PTC"in win){var divs=win.Ext.DomQuery.select("div[class*='x-menu']");divs.each(function(item){var menu=win.Ext.getCmp(item.id);if(menu!==undefined)menus.push(menu)})}return menus};var menus=_getMenus(window,[]);for(var i=0,l=frames.length;i<l;i++)menus=_getMenus(frames[i],menus);return menus};
PTC.automation.menu.isMenuOpen=function(){var menus=PTC.automation.menu.getMenus();for(var i=0,l=menus.length;i<l;i++)if(menus[i].isVisible())return true;return false};
PTC.automation.menu.getVisibleMenuId=function(itemText){var menus=PTC.automation.menu.getMenus();var hasGivenItem=itemText?function(item){if(item.el&&item.el.dom)if(item.el.dom.innerText&&item.el.dom.innerText===itemText)return true;else if(item.el.dom.textContent&&item.el.dom.textContent===itemText)return true;return item.text===itemText}:TRUE_FUNC;for(var i=menus.length-1;i>=0;i--){var menu=menus[i];if(menu.isVisible()&&menu.findBy(hasGivenItem).length>0)return menu.id}return false};
PTC.automation.menu.isSubMenuOpen=function(){var menus=PTC.automation.menu.getMenus();var count=0;for(var i=0,l=menus.length;i<l;i++)if(menus[i].isVisible())count++;return count>=2};PTC.automation.getMainWindow=function(){if(PTC.lightbox.isLightbox(self))return PTC.lightbox.getParentWindow();else return getWindow()};
PTC.automation.getCollapsibleFrameStyle=function(title){var elements=Ext.DomQuery.jsSelect(".attributePanel-fieldset-title");var el=null;for(var i=0;i<elements.length;i++)if(elements[i].innerHTML===title){el=elements[i];break}if(el===null)return"Element Not Found";return el.parentNode.parentNode.nextSibling.getAttribute("style")};
PTC.automation.menu.isMenuItemEnabled=function(itemText){var desiredId=PTC.automation.menu.getVisibleMenuId();var menu=Ext.menu.MenuMgr.get(desiredId);var disabledFlag=false;menu.items.each(function(item){if(item.text===itemText)if(item.disabled===true)disabledFlag=true});if(disabledFlag===false)return true;return false};
PTC.automation.menu.getSubMenuItemList=function(){var menuId=PTC.automation.menu.getVisibleMenuId();if(!menuId){PTC.automation.log.debug("PTC.automation.menu.getItemList returning false because No Menu Open");return false}var itemList=[];var menu=Ext.menu.MenuMgr.get(menuId);menu.items.each(function(item){itemList.push(item.text)});return itemList.toString()};
PTC.automation.menu.getItemList=function(){var menuId=PTC.automation.menu.getVisibleMenuId();var itemList=[];var menu=Ext.menu.MenuMgr.get(menuId);menu.items.each(function(item){itemList.push(item.text)});return itemList.toString()};PTC.automation.forceSetAutomationTestState=function(){PTC.automation.init(true);this.log.debug("PTC.automation.forceSetAutomationTestState force setting AutomationTest state to true");var iframeCount=frames.length;for(var index=0;index<iframeCount;index++)if("PTC"in frames[index])frames[index].PTC.automation.init(true)};
PTC.automation.tree.hasChild=function(tableID,parentRow,columnName,childName){var table=PTC.jca.table.Utils.getTable(tableID);var store=table.getStore();var record=store.getAt(parentRow);var descendants=store.getNodeChildren(record);var inc=0;var limit=descendants?descendants.length-1:0;var result=false;while(!result&&inc<=limit){var item=descendants[inc++].data[columnName];var netItem=Ext.isObject(item)&&Ext.isObject(item.gui)&&item.gui.comparable?item.gui.comparable:Ext.isObject(item)&&item.comparable?
item.comparable:item;result=netItem===childName}return result};
PTC.automation.hybrid=function(){var log=log4javascript.getLogger("PTC.automation.hybrid");log.info("PTC.automation.hybrid namespace created");return{callForCreoActions:function(success,errorMessage){log.info("callForCreoActions started");var mainWindow=PTC.automation.getMainWindow();mainWindow.creoDone=false;mainWindow.seleniumPaused=true;if(success)ProECommandVoid("SeleniumPaused?succ");else ProECommandVoid("SeleniumPaused?fail."+errorMessage)},areCreoActionsDone:function(){var mainWindow=PTC.automation.getMainWindow();
log.info("areCreoActionsDone called. creoDone = "+mainWindow.creoDone);return mainWindow.creoDone},setCreoDone:function(){var mainWindow=PTC.automation.getMainWindow();mainWindow.creoDone=true;log.info("setCreoDone called. creoDone = "+mainWindow.creoDone)},resumeSelenium:function(){log.info("resumeSelenium called");PTC.automation.hybrid.setCreoDone()},waitForSelenium:function(){var mainWindow=PTC.automation.getMainWindow();log.info("isSeleniumPaused called. seleniumPaused = "+mainWindow.seleniumPaused);
return mainWindow.seleniumPaused},clearSeleniumPaused:function(){var mainWindow=PTC.automation.getMainWindow();mainWindow.seleniumPaused=false;log.info("clearSeleniumPaused called. seleniumPaused = "+mainWindow.seleniumPaused)},endSelenium:function(success,errorMessage){log.info("endSelenium started");var mainWindow=PTC.automation.getMainWindow();mainWindow.creoDone=false;mainWindow.seleniumPaused=false;log.info("endSelenium, success = "+success);if(success)ProECommandVoid("SeleniumDone?succ");else ProECommandVoid("SeleniumDone?fail."+
errorMessage);log.info("endSelenium, finished")}}}();
PTC.automation.validation=function(){var log=log4javascript.getLogger("PTC.automation.validation");log.info("PTC.automation.validation namespace created");return{getJSCATableColumns:function(tableid){this.initExportListOperation();var table=PTC.jca.table.Utils.getTable(tableid);return this.explist.getHeaders(this.explist.getExportColumns(table))},getJSCATableRows:function(tableid){this.initExportListOperation();var table=PTC.jca.table.Utils.getTable(tableid);return this.explist.getAllExportRows(table,
this.explist.getExportColumns(table))},getBaseInfoPageHeaders:function(){return $$("div#infoPageitemDisplayID div.x-panel-body.x-panel-body-noheader.x-panel-body-noborder [ext:qtip]","div#infoPageitemDisplayID div.x-panel-body.x-panel-body-noheader.x-panel-body-noborder div#infoPageinfoPageIdentityDisplayPanel span#infoPageIdentityDisplayText span").map(function(val,i){return val.textContent||val.innerText||val.getAttribute("ext:qtip")||val.nodeValue||""})},getBaseInfoPageFieldSets:function(){var data=
$$("#infoPageinfoPanelID fieldset").map(function(val,i){var fieldset=val.getAttribute("id");var valnode=$(val).select("span.attributePanel-fieldset-title")[0];return[valnode.textContent||valnode.innerText||valnode.nodeValue||"",$$("fieldset#"+fieldset+" td.attributePanel-label","fieldset#"+fieldset+" td.attributePanel-value").map(function(val,i){return val.textContent||val.innerText||val.nodeValue||""})]});return data},getCADDocInfoPageContext:function(){return[$$("table#csToggle.x-btn-pressed").length==
1,$$("table#wsToggle.x-btn-pressed").length==1]},initExportListOperation:function(){if(this.explist===undefined)this.explist=new exportListOperation;this.explist.nonExportableColumns={selection:true,checker:true,nmActions:true,infoPageAction:false,formatIcon:true,FBDiscuss:true,FBRouted:true,FBDeliverables:true,search_thumbnail:true,smallThumbnail:true,openAsscContent:false,wsobjActions:false,compare:true,launchIncorpHangingChange:true,mailToCreator:true,selectChoicesAction:true};this.explist.isExportable=
function(column){return!this.nonExportableColumns[column.id]&&!column.grid&&!column.id.startsWith("infoPageActionReporting")}}}}();Ext.namespace("PTC.autosuggest.toolbar");
PTC.autosuggest.toolbar.SuggestToolbar=Ext.extend(Ext.Toolbar,{constructor:function(config){var sb1,sb2,items,table;Ext.applyIf(config,{width:275,minChars:3,queryDelay:600,maxresults:50,minListWidth:300*config.attributes.length});sb1=this.buildSuggestBox(config.attributes[0],config.attributes[1],false,config);items=[{xtype:"box",autoEl:{tag:"img",src:"netmarkets/images/add16x16.gif"}},sb1];if(config.attributes.length>1){sb2=this.buildSuggestBox(config.attributes[1],config.attributes[0],true,config);
items.push(" ",sb2)}PTC.autosuggest.toolbar.SuggestToolbar.superclass.constructor.call(this,{id:config.tableID+".pickerToolBar",items:items});table=Ext.ComponentMgr.get(config.tableID);this.render(table.bbar,0);table.getBottomToolbar().doLayout(false,true)},buildSuggestBox:function(firstAttribute,secondAttribute,switchColumns,config){var resultTpl,itemTypeInstanceId,baseParams,mform,serializedForm;if(secondAttribute===undefined)secondAttribute={};baseParams={serviceKey:config.suggestServiceKey,maxResults:config.maxresults,
includeTypeInstanceIdsuggestSuffix:"true",displayAttributesuggestSuffix:firstAttribute.attributeName,displayAttributeAdditionalAttributessuggestSuffix:firstAttribute.extraAttributes,extraSuggestAttributessuggestSuffix:secondAttribute.attributeName,extraSuggestAttributesAdditionalAttributessuggestSuffix:secondAttribute.extraAttributes,oid:decodeURIComponent(extractParamValue(window.location.href,"oid")),context:decodeURIComponent(extractParamValue(window.location.href,"context")),configClassNamesuggestSuffix:config.configClassName};
mform=getMainForm();serializedForm=Form.serialize(mform,true);Ext.applyIf(baseParams,serializedForm);var sb_name=new PTC.autosuggest.SuggestBox({width:config.width,minListWidth:config.minListWidth,minChars:config.minChars,queryDelay:config.queryDelay,hiddenName:"",emptyText:firstAttribute.attributeLabel,style:"font-size: 12px",callbackFunction:PTC.util.convertStringToFunc(config.suggestCallbackFunction),pickerId:config.pickerId,storeConfig:{baseParams:baseParams,proxy:new Ext.data.HttpProxy({url:"servlet/SuggestServlet",
restful:false})}});if(switchColumns)resultTpl=new Ext.XTemplate('<table><tpl for="."><tr class="x-combo-list-item"><td>{additionalText}</td><td style="padding-left: 8px">{displayText}</td></tr></tpl></table>',{compiled:true,disableFormats:true});else resultTpl=new Ext.XTemplate('<table><tpl for="."><tr class="x-combo-list-item"><td>{displayText}</td><tpl if="additionalText"><td style="padding-left: 8px">{additionalText}</td></tpl></tr></tpl></table>',{compiled:true,disableFormats:true});sb_name.tpl=
resultTpl;sb_name.on("select",function(combobox,record,index){var objects={};var picked={name:record.data.displayText,oid:record.data.valueText,"class":record.data.className};objects.pickedObject=[picked];combobox.clearValue();combobox.callbackFunction(objects,combobox.pickerId)});return sb_name}});var BASELINE_OBJECTS_JSP="/netmarkets/jsp/baseline/baselineObjects.jsp";var BASELINE_OBJECTS_TABLE="table__baselineMembersTable_TABLE";var BASELINEABLES_TO_ADD_HIDDEN="BASELINEABLES_TO_ADD_HIDDEN";
function baselineSearchCallback(objects){var baselinePicked=objects.pickedObject;var oid=baselinePicked[0].oid;var name=baselinePicked[0].name;bElement=document.getElementById("baselineOid");bElement.value=oid;nElement=document.getElementById("baselineSearchPicker$label$");nElement.value=name}
function copyDynamicData(oid,name,curWindow){if(name!=null&&name.length>0){if(!curWindow)curWindow=window;bElement=curWindow.document.getElementById("baselineOid");bElement.value=oid;nElement=curWindow.document.getElementById("baselineSearchPicker$label$");nElement.value=name}}
function baselineCollectorCallback(results,tableId,baselineOid){var oids="";if(results){var resultList=results.getOIDs();for(i=0;i<resultList.length;i++)oids=oids+"___"+resultList[i]}if(resultList.length>0){oids=oids.substring(3,oids.length);var url="netmarkets/jsp/baseline/collectMembers.jsp";var baselineOidParam="";if(baselineOid)baselineOidParam="&baselineOid="+baselineOid;var loader=new ajax.ContentLoader(url,refreshBaselineObjsTable,null,"POST","soidarray="+oids+baselineOidParam)}}
function baselineOkValidationCollectorCallback(results,caller){if(caller&&caller.baselineOkValidationCollectorCallback)return caller.baselineOkValidationCollectorCallback(results,null);else{var element=document.getElementById(BASELINEABLES_TO_ADD_HIDDEN);if(element)element.parentNode.removeChild(element);appendFormHiddenInput(getMainForm(),BASELINEABLES_TO_ADD_HIDDEN,results.getOIDs());var wfalertOriginal=wfalert;wfalert=function(message){Ext.MessageBox.show({title:bundleHandler.get("com.ptc.core.ui.errorMessagesRB.ACTION_DENIED"),
msg:"<div style='max-height:500px; overflow:auto;'>"+message.replace(/\n/g,"<br>")+"</div>",buttons:{ok:bundleHandler.get("com.ptc.core.ui.navigationRB.okButton")},icon:Ext.MessageBox.WARNING,width:500,fn:function(buttonId){}})};var status=PTC.validation.callAJAXValidation("addToBaseline");wfalert=wfalertOriginal;return status}}
function refreshBaselineObjsTable(){tableDiv=document.getElementById(BASELINE_OBJECTS_TABLE);if(tableDiv)refreshElement(BASELINE_OBJECTS_TABLE,BASELINE_OBJECTS_JSP,false);else window.location.reload()}function baselineCollectorCallbackNPA(results,tableId){if(results)var resultList=results.getOIDs();if(resultList.length>0){params={doAjaxUpdate:true,preventDuplicates:true,addDone:false};rowHandler.addRows(resultList,tableId,null,params)}}
function addBaselineTableRows(results,tableId){if(results.length>0){params={doAjaxUpdate:true,preventDuplicates:true,addDone:false};rowHandler.addRows(results,tableId,null,params)}return true}function addBaselineTableRows_picker(results,tableId){if(results.length>0){params={doAjaxUpdate:true,preventDuplicates:true,addDone:false};rowHandler.addRows(results,tableId,null,params)}return true}
function resetPrimaryObject(event){var tableId="baselineMembersNPATable";var table=getTableById(tableId);var newPrimaryRow=PTC.jca.table.Utils.findRecord(event,table);if(newPrimaryRow&&newPrimaryRow.data){var newPrimaryOid=newPrimaryRow.data.oid;var primaryElement=document.getElementById("primaryItem");if(primaryElement){var oldPrimaryOid=primaryElement.value;if(oldPrimaryOid&&oldPrimaryOid==newPrimaryOid)primaryElement.value="";else primaryElement.value=newPrimaryOid}var updateRowParams={doAjaxUpdate:true,
preventDuplicates:true};var updateOids=[newPrimaryOid];if(oldPrimaryOid&&oldPrimaryOid!=newPrimaryOid)updateOids.push(oldPrimaryOid);rowHandler.updateRows(updateOids,tableId,updateRowParams)}}function refreshBaselineAttributes(){if(document.getElementById("attributesPanelWrapper")&&document.getElementById("attributesPanelWrapper").style.display!="none")refreshElement("attributesPanelWrapper","/netmarkets/jsp/baseline/info.jsp")}
var handleFormResultForBaselineAction=function(formResult){if(formResult.extraData&&formResult.extraData.handleMultipleVersionConflict){var resultJsonString=formResult.extraData.baselineJSON;PTC.baseline.handleMultipleVersionConflict(resultJsonString,false)}else if(formResult.extraData.jsValue&&formResult.extraData.jsValue.trim()!=null){var jsValue=formResult.extraData.jsValue;eval(jsValue)}return true};
PTC.baseline=function(){var detectVersionConflict=function(){var formData=Ext.lib.Ajax.serializeForm(getMainForm());var options={asynchronous:true,method:"POST",evalScripts:true,parameters:formData,onSuccess:PTC.baseline.handleResponse};requestHandler.doRequest("ptc1/mulitpleVersionConflict",options)};var promptForMultipleVersionReplace=function(baselineConflictInfo){var result=true;var formattedBaselineables='<div style="white-space:nowrap; max-height:500px; overflow:auto;"><br>';var baselineablesInternal=
baselineConflictInfo.baselineInternal;var baselineablesExternal=baselineConflictInfo.baselineExternal;var baselineOid=baselineConflictInfo.baselineOid;var localizedTitle=baselineConflictInfo.messageTitle;var localizedMessage=baselineConflictInfo.warningMessage;var yesButtonOption=baselineConflictInfo.yesButtonOption;var noButtonOption=baselineConflictInfo.noButtonOption;var baselineableLength=baselineablesExternal.length;for(var i=0;i<baselineablesExternal.length;i++){var object=baselineablesExternal[i];
var oldBaselineable=object.oldBaseline;var newBaselineable=object.newBaseline;formattedBaselineables+="<br>"+oldBaselineable+"<br>-> "+newBaselineable+"<br>"}formattedBaselineables+="</div>";Ext.MessageBox.show({title:localizedTitle,msg:localizedMessage+formattedBaselineables,buttons:{ok:yesButtonOption,cancel:noButtonOption},icon:Ext.MessageBox.QUESTION,width:600,fn:function(buttonId){if(buttonId==="ok"){PTC.getMainWindow().baselineCollectorCallback({getOIDs:function(){return baselineablesInternal}},
null,baselineOid);appendFormHiddenInput(getMainForm(),"versionMarkedAsConflict","");result=onSubmit(true)}else if(buttonId==="cancel"){appendFormHiddenInput(getMainForm(),"versionMarkedAsConflict",baselineablesInternal);result=onSubmit(true)}}});return result};return{submitAddToBaselineWizard:function(){disableButtons();disableIEButtonsOnSubmit();var status=checkSubmitStatus();if(!status){enableButtons();return false}detectVersionConflict();return true},handleResponse:function(resp){var conflictInfo=
false;try{if(resp.responseText){var json=Ext.util.JSON.decode(resp.responseText);if(json&&json.conflictInfo){var resultJsonString=json.conflictInfo;PTC.baseline.handleMultipleVersionConflict(resultJsonString,false);conflictInfo=true}}if(!conflictInfo){appendFormHiddenInput(getMainForm(),"versionMarkedAsConflict","");onSubmit(true)}}catch(e){alert(e)}return true},handleMultipleVersionConflict:function(resultJsonString,isWizardWindow){var resultJson=Ext.util.JSON.decode(resultJsonString);if(isWizardWindow)window.opener.promptForMultipleVersionReplace(resultJson);
else promptForMultipleVersionReplace(resultJson)}}}();jsca.columns.booleanRenderer=function(table,column,row){var data=jsca.columns.getCellValue(column,row);var result=" ";if(data&&data.rawValue){result=data.rawValue;var attributeData=PTC.attributeHelper.get("Boolean");if(attributeData)result=attributeData[result]}data.comparable=result;data.value=result;result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};
jsca.columns.booleanComparable=function(data){var result=data.rawValue||(data.gui?data.gui.rawValue:null);if(result){var attributeData=PTC.attributeHelper.get("Boolean");if(attributeData)return attributeData[result]}return" "};jsca.columns.booleanRenderer.exportRenderer=jsca.columns.booleanRenderer;jsca.columns.booleanRenderer.searchFunc=jsca.columns.booleanRenderer;PTC.navigation.breadcrumb={};PTC.navigation.breadcrumb.SEPARATOR="&nbsp;&gt;&nbsp;";PTC.navigation.breadcrumb.ELLIPSIS="&nbsp;&hellip;&nbsp;";
PTC.navigation.breadcrumb.TOOLTIPID="breadcrumbTooltipId";PTC.navigation.breadcrumb.RECENTLY_ACCESSED_BUTTON_ID=PTC.navigation.contentTabID+"_recentlyAccessed";
PTC.navigation.breadcrumb.Panel=Ext.extend(Ext.Panel,{id:PTC.navigation.contentTabID+"_crumbs",layout:"hbox",border:false,flex:1,height:20,layoutConfig:{align:"stretchmax"},addCrumbs:function(crumbArray){this.crumbJSON=crumbArray;this.removeAll(true);var configSize=crumbArray.size();this.tipHTML="";for(var i=0;i<configSize;i++){crumbArray[i].needsSeparator=i>0;var aCrumb=new PTC.navigation.breadcrumb.Crumb(crumbArray[i]);this.tipHTML+=aCrumb.getHtml()+" ";this.crumbJSON[i].html=aCrumb.getHtml();this.add(aCrumb);
this.doLayout();this.crumbJSON[i].crumbWidth=this.getComponent(0).getWidth();this.removeAll(true)}if(this.tip!==undefined&&this.tip!==null){if(!this.tip.body)this.tip.showAt([0,0]);this.tip.body.dom.innerHTML=this.tipHTML;this.tip.hide()}else this.on("afterlayout",this._createTip,this,{single:true});this._calculateCrumbsToDisplay();if(this.resizeListener===undefined){this.resizeListener=true;this.on("resize",this._calculateCrumbsToDisplay)}},_createTip:function(){if(this.tip===undefined||this.tip===
null){this.tip=new Ext.ToolTip({id:PTC.navigation.breadcrumb.TOOLTIPID,disabled:this.tipDisabled,target:this.body,trackMouse:false,hideDelay:500,maxWidth:500,dismissDelay:0,hideTimeout:null,html:this.tipHTML,_addMouseListeners:function(){this.mon(this.getEl(),"mouseenter",this._mouseEnter);this.mon(this.getEl(),"mouseleave",this._mouseLeave);this.mon(this.getEl(),"click",this.dismissAfterDelay)},_mouseEnter:function(){var tooltip=Ext.getCmp(PTC.navigation.breadcrumb.TOOLTIPID);tooltip.on("beforehide",
FALSE_FUNC);if(tooltip.hideTimeout!==null){clearTimeout(tooltip.hideTimeout);tooltip.hideTimeout=null}},_mouseLeave:function(){var tooltip=Ext.getCmp(PTC.navigation.breadcrumb.TOOLTIPID);tooltip.dismissAfterDelay()},dismissAfterDelay:function(){var tooltip=Ext.getCmp(PTC.navigation.breadcrumb.TOOLTIPID);tooltip.un("beforehide",FALSE_FUNC);tooltip.hideTimeout=setTimeout(function(){tooltip.hide()},tooltip.hideDelay)}});this.tip.on("afterrender",this.tip._addMouseListeners,this.tip,{single:true})}},
_calculateCrumbsToDisplay:function(){var totalWidth=this.getWidth()-50;var consumedWidth=0;var crumbs=this.crumbJSON.clone();var frontCrumbs=[];var endCrumbs=[];while(consumedWidth<totalWidth&&crumbs.length>0){var frontCrumb=crumbs[0];var crumbWidth=frontCrumb.crumbWidth;if(consumedWidth+crumbWidth>totalWidth)break;crumbs.remove(frontCrumb);consumedWidth+=crumbWidth;frontCrumbs.push(frontCrumb);if(crumbs.length===0)break;var endCrumb=crumbs[crumbs.length-1];crumbWidth=endCrumb.crumbWidth;if(consumedWidth+
crumbWidth>totalWidth)break;crumbs.pop();consumedWidth+=crumbWidth;endCrumbs.push(endCrumb)}endCrumbs.reverse();var finalCrumbs=frontCrumbs;if(crumbs.length>0){finalCrumbs.push({html:PTC.navigation.breadcrumb.SEPARATOR+PTC.navigation.breadcrumb.ELLIPSIS});this._setTooltipEnabled(true)}else this._setTooltipEnabled(false);finalCrumbs=finalCrumbs.concat(endCrumbs);this._createAndAddCrumbs(finalCrumbs)},_createAndAddCrumbs:function(finalCrumbs){this.removeAll(true);var length=finalCrumbs.length;var allCrumbsHtml=
"";for(var i=0;i<length;i++)allCrumbsHtml+=finalCrumbs[i].html;this.add(new Ext.Panel({html:allCrumbsHtml}));this.doLayout()},_setTooltipEnabled:function(enable){if(Ext.isEmpty(this.tip))this.tipDisabled=!enable;else if(enable)this.tip.enable();else this.tip.disable()}});
PTC.navigation.breadcrumb.HeaderPanel=Ext.extend(Ext.Panel,{constructor:function(){var homePageIconBox=new Ext.BoxComponent({id:"homePageIconID",cls:"home_icon_header home_icon",listeners:{render:function(){var homePageTooltip=new Ext.ToolTip({id:"homePageTooltip",target:"homePageIconID",html:bundleHandler.get("com.ptc.core.ui.navigationRB.WIN_TITLE_HOME_TAB_HOME")});this.mon(this.getEl(),"click",function(){PTC.navigation.goHome()})}}});var breadcrumbPanel=new PTC.navigation.breadcrumb.Panel;var recentlyAccessedButton=
{id:PTC.navigation.breadcrumb.RECENTLY_ACCESSED_BUTTON_ID,xtype:"dynamicMenuButton",text:bundleHandler.get("com.ptc.core.ui.navigationRB.RECENT_LIST"),menuAlign:"tr-br?",menu:{xtype:"dynamicMenu",requestUrl:"servlet/RecentList"}};var ProjectStatusPanelComp=new Ext.Panel({id:"DummyProjectStatusPanel",height:25,width:1});if(typeof isProjectLinkInstalled!=="undefined")ProjectStatusPanelComp=new PTC.projectstatus.ProjectStatusPanel;var config={id:PTC.navigation.contentTabID+"_breadcrumb",border:false,
layout:"hbox",layoutConfig:{align:"middle"},margins:"8 0 6 6",items:[homePageIconBox,breadcrumbPanel,ProjectStatusPanelComp,recentlyAccessedButton]};PTC.navigation.breadcrumb.HeaderPanel.superclass.constructor.call(this,config);if(getWindow()==PTC.getMainWindow()){PTC.action.on("objectsaffected",PTC.navigation.breadcrumb.refresh,null,{delay:isWf()?0:1});PTC.navigation.on("historyChange",PTC.navigation.breadcrumb.update,null,{delay:1});if(typeof isProjectLinkInstalled!=="undefined"){PTC.action.on("objectsaffected",
PTC.projectstatus.ProjectStatusPanel.onObjectsAffected,null,{delay:isWf()?0:1});PTC.navigation.on("historyChange",PTC.projectstatus.ProjectStatusPanel.update,null,{delay:1});PTC.infoPage.on("afterRender",PTC.projectstatus.ProjectStatusPanel.refresh)}}}});
PTC.navigation.breadcrumb.Crumb=function(remoteConfig){var config=Ext.copyTo({},remoteConfig,"url, text, needsSeparator");config.hasUrl=config.url&&config.url.length>0;config.hasText=config.text&&config.text.length>0;config.trlId=config.hasText&&PTC.trail.isTrailEnabled()?' trlId="breadcrumbLink_'+config.text+'"':"";config.tpl=new Ext.XTemplate(['<tpl if="needsSeparator">',PTC.navigation.breadcrumb.SEPARATOR,"</tpl>",'<span class="breadcrumb">','<tpl if="hasUrl">',"<a{trlId} href={url}>","</tpl>",
'<tpl if="hasText">',"{text}","</tpl>",'<tpl if="hasUrl">',"</a>","</tpl>","</span>"],{compiled:true});PTC.navigation.breadcrumb.Crumb.superclass.constructor.call(this,config);this.html=this.tpl.apply(config);this.getHtml=function(){return this.html}};Ext.extend(PTC.navigation.breadcrumb.Crumb,Ext.Container,{});
PTC.navigation.breadcrumb.update=function(url){var breadcrumbUrl=getBaseHref()+"ptc1/breadcrumb/";var options={method:"post",asynchronous:true,onSuccess:PTC.navigation.breadcrumb.onSuccess,parameters:{url:url}};requestHandler.doRequest(breadcrumbUrl,options)};PTC.navigation.breadcrumb.update=PTC.util.delayAllCalls(PTC.navigation.breadcrumb.update);
PTC.navigation.breadcrumb.onSuccess=function(xmlHttp){var breadcrumbItems=Ext.util.JSON.decode(xmlHttp.responseText);var breadcrumbPanel=Ext.getCmp(PTC.navigation.contentTabID+"_crumbs");if(breadcrumbPanel)breadcrumbPanel.addCrumbs(breadcrumbItems)};PTC.navigation.breadcrumb.refresh=function(refreshInfo){var currentPageOid=decodeURIComponent(extractParamValue(window.location.href,"oid"));for(var key in refreshInfo.U)if(key===currentPageOid){PTC.navigation.breadcrumb.update(window.location.href);break}return true};
function _Browser(){return this}var Browser=new _Browser;_Browser.prototype.getWindowWidth=function getWindowWidth(){var windowWidth=-1;if(navigator.appName.indexOf("Microsoft")!=-1)if(document.documentElement.clientWidth>0)windowWidth=document.documentElement.clientWidth;else windowWidth=document.body.offsetWidth;else windowWidth=window.innerWidth;return windowWidth};
_Browser.prototype.getWindowHeight=function getWindowHeight(){var windowHeight=-1;if(navigator.appName.indexOf("Microsoft")!=-1)if(document.documentElement.clientWidth>0)windowHeight=document.documentElement.clientHeight;else windowHeight=document.body.offsetHeight;else windowHeight=window.innerHeight;return windowHeight};
_Browser.prototype.getScrollX=function getBrowserScrollX(){var scrollX=document.body.scrollLeft;if(navigator.appName.indexOf("Microsoft")!=-1){if(document.documentElement&&document.documentElement.scrollLeft)scrollX=document.documentElement.scrollLeft}else scrollX=self.pageXOffset;return scrollX};
_Browser.prototype.getScrollY=function getBrowserScrollY(){var scrollY=document.body.scrollTop;if(navigator.appName.indexOf("Microsoft")!=-1){if(document.documentElement&&document.documentElement.scrollTop)scrollY=document.documentElement.scrollTop}else scrollY=self.pageYOffset;return scrollY};_Browser.prototype.getElementOffsetTop=function getBrowserElementOffsetTop(element){if(element){var top=element.offsetTop;while(element.offsetParent){top+=element.offsetParent.offsetTop;element=element.offsetParent}return top}return 0};
_Browser.prototype.getElementOffsetLeft=function getBrowserElementOffsetLeft(element){if(element){var left=element.offsetLeft;while(element.offsetParent){left+=element.offsetParent.offsetLeft;element=element.offsetParent}return left}return 0};_Browser.prototype.getX=function getX(){return getWindow().screenX?getWindow().screenX:top.screenLeft-4};
_Browser.prototype.getY=function getY(){var y;if(isWf()&&window.screenTop)y=window.screenTop-24;else if(window.screenY)y=window.screenY;else y=window.screenTop-30;return y};var done=true;
function getProELinkFromServer(isMenu,an1,href){if(!isWf())return true;if(!isMenu)an1.style.visibility="hidden";if(!href&&isMenu&&CONTEXT_OID)href="netmarkets/jsp/part/download.jsp?oid="+CONTEXT_OID;done=false;var url=href+"&iscad=true&openInProe=true";var options={method:"get",asynchronous:false};var xmlhttp=requestHandler.doRequest(url,options);if(xmlhttp.readyState==4){var resp=xmlhttp.responseText;var newhref="";var newonclick=null;if(resp.indexOf(" oc=")>0){newhref=resp.substring(0,resp.indexOf(" oc="));
newonclick=resp.substring(resp.indexOf(" oc=")+15);if(resp.indexOf("alert")>0)newonclick=resp.substring(resp.indexOf(" oc=")+4);if(newonclick.length>5){if(newonclick.indexOf("return(false)")>0)newonclick=newonclick.substring(0,newonclick.indexOf("return(false)"));if(newonclick.indexOf("return false")>0)newonclick=newonclick.substring(0,newonclick.indexOf("return false"));if(!isMenu)an1.onclick=function(){eval(newonclick);return false};else{done=true;eval(newonclick);return false}}}else{if(resp.toLowerCase().indexOf("<a")>=
0){var hrefstr='href="';resp=resp.substring(resp.indexOf(hrefstr)+hrefstr.length);resp=resp.substring(0,resp.indexOf('"'))}newhref=resp}if(!isMenu){an1.href=newhref;an1.style.visibility="visible";done=true;ProETrailWrite("Open in PROE:"+an1.id)}}}
function calculateProeLink(an){var an1;if(an.tagName=="IMG")an1=an.parentNode;else an1=an;if(an1.tagName=="CENTER")an1=an1.parentNode;if(an1&&an1.href&&an1.href.indexOf("tpub")<0&&an1.href.toLowerCase().indexOf("epmdocument")>0&&an1.href.indexOf("part/download.jsp")>0)return getProELinkFromServer(false,an1,an1.href);else return true}
function engage(evt){if(done){evt=evt?evt:event;var target=evt.target?evt.target:evt.srcElement;if(target.tagName=="IMG")target=target.parentNode;if(target.tagName=="CENTER")target=target.parentNode;if(target.href)calculateProeLink(target);return}}function wfinit(){if(isWf())document.onmousedown=engage}
function registerOld(){var sname=getMainForm().serverName.value;var baseURL=getMainForm().base.value;var wsname=getMainForm().ws.value;var isAnchor="false";var pst="RegisterServer?"+"server="+sname+"&base="+baseURL+"&ws="+wsname+"&anchor=false&type=pjl";ProECommandVoid(pst);return true}
function register(sname,wsname,baseURL,serverType,containerName,closeOnSuccess){var isAnchor="false";var pst="RegisterServer?"+"server="+sname+"&base="+baseURL+"&ws="+wsname+"&anchor=false&type="+serverType+"&contextType=Project&context="+containerName;ProECommandVoid(pst);if(closeOnSuccess)WaitAndClose();return true}function registerClose(sname,wsname,baseURL,serverType,containerName){var registered=register(sname,wsname,baseURL,serverType,containerName);if(registered===true)WaitAndClose()}
function resetSelection(a){a.selectedIndex=0}var myCalendarWindow;
function newCalendarWindow(evnt,url,moreUrlInfo){var properties="left="+(evnt.screenX+20);properties+=",top="+(evnt.screenY+1);properties+=",dependent=1,titlebar=0,resizable=no,";properties+=moreUrlInfo+", location=0, fullscreen=0, channelmode=0,directories=0, menubar=0,scrollbars=0, status=0,toolbar=0";if(isWf()){myCalendarWindow=wfWindowOpen(url,"cal",properties);PTC.Calendar.initializeCalendarPicker(myCalendarWindow)}else{myCalendarWindow=wfWindowOpen(url,"cal",properties);PTC.Calendar.initializeCalendarPicker.defer(200,
PTC.Calendar,[myCalendarWindow,url])}}function getLastDayOfMonth(targetMonth,targetYear){var dayList=[31,28,31,30,31,30,31,31,30,31,30,31];if(targetYear%4===0&&targetYear%100!==0||targetYear%400===0)dayList[1]=29;if(targetMonth===0)targetMonth=12;return dayList[targetMonth-1]}function formatReportDate(formStr){if(formStr===0)formStr=12;var outputStr=formStr;if(outputStr.length==1)outputStr="0"+outputStr;return outputStr}
PTC.Calendar={getDateInputField:function(calendarPicker){var dateInputField;if(calendarPicker){var sibling=calendarPicker.previousSibling;var siblingCount=1;while(sibling&&siblingCount<=4){if(sibling.tagName&&sibling.tagName.toUpperCase()==="INPUT"&&sibling.type&&sibling.type.toLowerCase()==="text"){dateInputField=sibling;break}sibling=sibling.previousSibling;siblingCount++}if(!dateInputField&&calendarPicker.parentNode){var inputFields=calendarPicker.parentNode.getElementsByTagName("input");for(var i=
0;i<inputFields.length;i++)if(inputFields[i].type.toLowerCase()==="text"){dateInputField=inputFields[i];break}}}return dateInputField},initializeCalendarPicker:function(calendarWindow,url){if(url)calendarWindow.location.href=url;if(calendarWindow&&!calendarWindow.opener)calendarWindow.opener=self}};if(!PTC.cat)PTC.cat={};PTC.cat.log=log4javascript.getLogger("PTC.cat");PTC.cat.FormResult={SUCCESS:0,FAILURE:1,REFRESH_OPENER:1,LOAD_OPENER_URL:2};PTC.cat.hyperlinkFieldURL="";
PTC.cat.pickerGWTCallbacks=new Object;PTC.cat.pickerWindows=new Object;function gwtPickerCallback(result,pickerId,displayAttr,displayFieldId){var theGWTCallback=PTC.cat.pickerGWTCallbacks[pickerId];eval(theGWTCallback(result.pickedObject))}
PTC.cat.PickerHelper={launchPicker:function(info,event,callback){PTC.cat.pickerGWTCallbacks[info.params.pickerId]=callback;PTC.cat.PickerHelper.launchPickerViaPost(info,event);return true},launchPickerViaPost:function(info,event){var pickerId=info.params.pickerId;var actionName=info.params.actionName;var catPickerForm;var picker;if(PTC.lightbox.isActionRenderedAsLightbox({actionName:actionName})){catPickerForm=window.document.createElement("FORM");catPickerForm.target="getLightboxWindowId()";picker=
window}else{var picker=window.open("",pickerId,"height=768,width=550,resizable=yes,scrollbars=yes,menubar=no,toolbar=no,location=no,status=no");catPickerForm=picker.document.createElement("FORM");catPickerForm.target=pickerId;PTC.cat.pickerWindows[pickerId]=picker}catPickerForm.name="CATJCAPickerForm";catPickerForm.id="CATJCAPickerForm";catPickerForm.method="POST";var url=getBaseHref();if(url.charAt(url.length-1)=="/"&&info.url.charAt(0)=="/")url+=".";url+=info.url;info.params.pickerCallback="gwtPickerCallback";
url+=url.indexOf("?")>0?"&":"?";url+=Ext.urlEncode(info.params);catPickerForm.action=url;if(PTC.lightbox.isActionRenderedAsLightbox({actionName:actionName})){var activateResult=PTC.lightbox.renderFormActionAsLightbox({form:catPickerForm});this.setDeactivateOptions();catPickerForm.target=PTC.lightbox.getLightboxWindowId()}if(picker.document.body==null)picker.onload=function(){picker.document.body.appendChild(catPickerForm);catPickerForm.submit()};else{picker.document.body.appendChild(catPickerForm);
catPickerForm.submit()}},cleanupPicker:function(pickerId){if(typeof PTC.cat.pickerGWTCallbacks[pickerId]!="undefined")PTC.cat.pickerGWTCallbacks[pickerId]=null;if(typeof PTC.cat.pickerWindows[pickerId]!="undefined"){var picker_window=PTC.cat.pickerWindows[pickerId];if(!picker_window.closed)picker_window.close();PTC.cat.pickerWindows[pickerId]=null}},setDeactivateOptions:function(){PTC.lightbox.setDeactivateOptions({loadURL:""})}};
PTC.cat.WizardHelper={handleSubmitResult:function(status,nextAction,js,URL,dynamicRefreshInfo){var formResult=PTC.cat.FormResult;var callback=PTC.cat.WizardHelper.getCallback(getWindow());if(nextAction===formResult.REFRESH_OPENER&&callback){callback.call(this,dynamicRefreshInfo);new Ajax.Request(getBaseHref()+"netmarkets/jsp/util/clearDynamicAttributes.jsp?dynamicFlush=true",{asynchronous:true});handleWizWindow(status)}else return handleSubmitResult.apply(this,arguments)},callback:null,setCallback:function(wizard,
callback){if(wizard){var intervalID;var setCallBackInterval=function(){try{if(wizard&&"PTC"in wizard&&"cat"in wizard.PTC&&"WizardHelper"in wizard.PTC.cat&&!wizard.PTC.cat.WizardHelper.windowReloadInProgress){wizard.callback=callback;clearInterval(intervalID);setCallBackInterval=null}}catch(e){clearInterval(intervalID);setCallBackInterval=null;wizard.PTC.log.error("PTC.cat.WizardHelper.setCallback - Exception caught when trying to set GWT callback for an action: ",e.message)}};intervalID=setInterval(setCallBackInterval,
100);PTC.cat.WizardHelper.callback=callback}},getCallback:function(aWindow){return aWindow.callback},setCallbackAfterWindowReload:function(wizardWindow){var callback=PTC.cat.WizardHelper.getCallback(wizardWindow);if(callback){wizardWindow.PTC.cat.WizardHelper.windowReloadInProgress=true;PTC.cat.WizardHelper.setCallback(wizardWindow,callback)}},launchActionGet:function(info,event,callback){var params={oid:info.oid,actionName:info.action.name,wizardActionClass:info.action.actionClass,wizardActionMethod:info.action.actionMethod,
AjaxEnabled:info.action.ajaxType,portlet:"poppedup",soid:info.soid,rootOid:info.rootOid};var url="";if(info.action.url.charAt(0)=="/")url+=info.action.url.substring(1);else url+=info.action.url;url+=url.indexOf("?")>0?"&":"?";url+=Ext.urlEncode(params);if(typeof info.coid!=="undefined"){var coid={coid:info.coid};url+="&"+Ext.urlEncode(coid)}if(typeof PTC.cat["nonce_key"]!=="undefined"&&typeof PTC.cat["nonce"]!=="undefined"){var nonce_param={};nonce_param[PTC.cat["nonce_key"]]=PTC.cat["nonce"];url+=
"&"+Ext.urlEncode(nonce_param)}if(PTC.lightbox.isActionRenderedAsLightbox({actionName:info.action.action})){url+=url.indexOf("?")>0?"&":"?";url+="action="+info.action.action;var activateResult=PTC.lightbox.activate({requestMethod:"get",contentHref:url})}else try{PTC.navigation.loadContent(url);PTC.cat.WizardHelper.setCallback(wizard,callback)}catch(e){}},launchActionPost:function(info,event,callback,trulyPost){var wName;if(typeof info.action.name=="undefined")wName="CATJCAActionWindow";else wName=
info.action.name;var catActionForm=new Element("Form",{name:"CATJCAActionForm",id:"CATJCAActionForm",method:"post"});document.body.appendChild(catActionForm);var alreadyAdded=new Set;alreadyAdded.addAll(["oid","action","soid","actions","parentPartStr","context","ncId","moduleName","applyCSToTop","applyDCSToUnresolved"]);for(var property in info){if(alreadyAdded.contains(property))continue;JCAappendFormHiddenInput(catActionForm,property,info[property])}JCAappendFormHiddenInput(getMainForm(),"windowNameForCookie",
info.action.name+"_"+info.action.actionType);JCAappendFormHiddenInput(catActionForm,"windowNameForCookie",info.action.name+"_"+info.action.actionType);var url=getBaseHref();if(url.charAt(url.length-1)=="/"&&info.action.url.charAt(0)=="/")url+=".";url+=info.action.url;url+=url.indexOf("?")>0?"&":"?";var params={wizardActionMethod:info.action.actionMethod,AjaxEnabled:info.action.ajaxType,portlet:"poppedup"};url+=Ext.urlEncode(params);if(typeof info.oid!=="undefined"){var oid={oid:info.oid};url+="&"+
Ext.urlEncode(oid)}if(typeof info.coid!=="undefined"){var coid={ContainerOid:info.coid};url+="&"+Ext.urlEncode(coid)}if(typeof info.action.actionClass!=="undefined"){var actionClass={wizardActionClass:info.action.actionClass};url+="&"+Ext.urlEncode(actionClass)}if(typeof info.action.name!=="undefined"){var actionName={actionName:info.action.name};url+="&"+Ext.urlEncode(actionName);if(info.action.name=="replacements"){var actions_param={actions:info.actions};url+="&"+Ext.urlEncode(actions_param);var parentPartStr=
{parentPartStr:info.parentPartStr};url+="&"+Ext.urlEncode(parentPartStr)}}if(typeof info.context!=="undefined"){var context_param={context:info.context};url+="&"+Ext.urlEncode(context_param)}if(typeof info.action.action!=="undefined"){var action_param={action:info.action.action};url+="&"+Ext.urlEncode(action_param)}if(typeof info.ncId!=="undefined"){var ncId_param={ncId:info.ncId};url+="&"+Ext.urlEncode(ncId_param)}if(typeof info.moduleName!=="undefined"){var moduleName_param={moduleName:info.moduleName};
url+="&"+Ext.urlEncode(moduleName_param)}if(typeof info.partid!=="undefined"){var partid_param={partid:info.partid};url+="&"+Ext.urlEncode(partid_param)}if(typeof info.partstructure!=="undefined"){var partstructure_param={partstructure:info.partstructure};url+="&"+Ext.urlEncode(partstructure_param)}if(typeof info.navcriteriaid!=="undefined"){var navcriteriaid_param={navcriteriaid:info.navcriteriaid};url+="&"+Ext.urlEncode(navcriteriaid_param)}if(typeof info.ncCacheHostName!=="undefined"){var ncCacheHostName_param=
{ncCacheHostName:info.ncCacheHostName};url+="&"+Ext.urlEncode(ncCacheHostName_param)}if(typeof info.ncCacheSessionId!=="undefined"){var ncCacheSessionId_param={ncCacheSessionId:info.ncCacheSessionId};url+="&"+Ext.urlEncode(ncCacheSessionId_param)}if(typeof info.ncCacheCookieType!=="undefined"){var ncCacheCookieType_param={ncCacheCookieType:info.ncCacheCookieType};url+="&"+Ext.urlEncode(ncCacheCookieType_param)}if(typeof info.collectorcacheid!=="undefined"){var collectorcacheid_param={collectorcacheid:info.collectorcacheid};
url+="&"+Ext.urlEncode(collectorcacheid_param)}if(typeof info.applyCSToTop!=="undefined"){var applyCSToTop_param={applyCSToTop:info.applyCSToTop};url+="&"+Ext.urlEncode(applyCSToTop_param)}if(typeof info.applyDCSToUnresolved!=="undefined"){var applyDCSToUnresolved_param={applyDCSToUnresolved:info.applyDCSToUnresolved};url+="&"+Ext.urlEncode(applyDCSToUnresolved_param)}if(typeof info.rootOid!=="undefined"){var rootOid_param={rootOid:info.rootOid};url+="&"+Ext.urlEncode(rootOid_param)}if(typeof info.compContext!==
"undefined"){var compContext_param={compContext:info.compContext};url+="&"+Ext.urlEncode(compContext_param)}var soidStr="";if(typeof info.soid!=="undefined")if(!trulyPost&&typeof info.action.actionClass!=="undefined"){var soidsLength=info.soid.length;for(var indx=0;indx<soidsLength;indx++)soidStr+="&soid="+info.soid[indx]}else if(typeof info.isAddToProjectAction!=="undefined"){var soidarray="";for(var six=0;six<info.soid.length;six++){soidarray+=info.soid[six];soidarray+=";"}soidarray=soidarray.substring(0,
soidarray.length-1);var paraInput=JCAnewHiddenInputElement("psbAdd2ProjInfo",soidarray,catActionForm);catActionForm.appendChild(paraInput)}else if(typeof info.isDownloadSelectedDocsAction!=="undefined"){var soidsLength=info.soid.length;var delimitedOids="";for(var indx=0;indx<soidsLength;indx++){delimitedOids+=info.soid[indx];if(indx<soidsLength-1)delimitedOids+=";"}var soid_param={soid:delimitedOids};url+="&"+Ext.urlEncode(soid_param)}else if(trulyPost)for(var six=0;six<info.soid.length;six++){var paraInput=
JCAnewHiddenInputElement("soid",info.soid[six],catActionForm);catActionForm.appendChild(paraInput)}else{var soidarray="";for(var six=0;six<info.soid.length;six++){soidarray+=info.soid[six];soidarray+="; "}soidarray=soidarray.substring(0,soidarray.length-2);var paraInput=JCAnewHiddenInputElement("soid",soidarray,catActionForm);catActionForm.appendChild(paraInput)}if(soidStr!=="")url+=soidStr;if(typeof PTC.cat["nonce_key"]!=="undefined"&&typeof PTC.cat["nonce"]!=="undefined"){var nonce_param={};nonce_param[PTC.cat["nonce_key"]]=
PTC.cat["nonce"];url+="&"+Ext.urlEncode(nonce_param)}var lightBox=PTC.lightbox.isActionRenderedAsLightbox({actionName:info.action.action});var wizard;if(lightBox==true){catActionForm.action=url;catActionForm.target="getLightboxWindowId()";wizard=window;var activateResult=PTC.lightbox.renderFormActionAsLightbox({form:catActionForm});this.setDeactivateOptions();catActionForm.submit()}else{if(trulyPost||typeof info.isNewCARAction!=="undefined"||typeof info.isNewImageAction!=="undefined"){popupForm=catActionForm;
postForm=true}else{popupForm=null;postForm=false}if(typeof info.isCreatePARAction!=="undefined")wizard=window.parent.popupActionMainImpl(wName,url,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,info.context,null,info.action.actionClass,info.action.actionMethod,info.action.moreUrlInfo,popupForm,false,null,null,false,false,false,false,null,false,"",postForm,false);else wizard=popupActionMainImpl(wName,url,null,null,null,null,null,null,null,null,null,null,null,
null,null,null,null,null,null,null,info.context,null,info.action.actionClass,info.action.actionMethod,info.action.moreUrlInfo,popupForm,false,null,null,false,false,false,false,null,false,"",postForm,false);if(info.isUseCurrentWindowAsCallback)wizard=window;if(trulyPost)wizard=actionwin}document.body.removeChild(catActionForm);if(wizard)PTC.cat.WizardHelper.setCallback(wizard,callback)},launchAction:function(info,event,callback,trulyPost){if(!info.action.onclick||eval(info.action.onclick)){try{if(parent&&
parent.PTC&&parent.PTC.infoPage.getTabPanel())PTC.action.actionTarget=parent.PTC.action.actionTarget=parent.PTC.infoPage.getTabPanel().activeTab}catch(e){PTC.cat.log.debug("Could not set the action target for gwt app")}if(info.action.windowType=="page")PTC.cat.WizardHelper.launchActionGet(info,event,callback);else PTC.cat.WizardHelper.launchActionPost(info,event,callback,trulyPost);return true}return false},setDeactivateOptions:function(){PTC.lightbox.setDeactivateOptions({loadURL:""})},launchNonWizardAction:function(info,
event){var params=new Array;var i=0;var alreadyAdded=new Set;alreadyAdded.addAll(["oid","action","context","coid","soid"]);for(var property in info){if(alreadyAdded.contains(property))continue;params[i++]=property;params[i++]=info[property]}var windowName;if(typeof info.action.name!=="undefined")windowName=info.action.name;else if(typeof info.action.action!=="undefined")windowName=info.action.action;if(typeof info.coid!=="undefined"){params[i++]="ContainerOid";params[i++]=info.coid}if(typeof info.oid!==
"undefined"){params[i++]="oid";params[i++]=info.oid}if(typeof info.context!=="undefined"){params[i++]="context";params[i++]=info.context}if(typeof info.soid!=="undefined")if(info.soid.length>1){var soidarray="";for(var six=0;six<info.soid.length;six++){if(six>0)soidarray+="___";soidarray+=info.soid[six]}params[i++]="soidarray";params[i++]=soidarray}else{params[i++]="soid";params[i++]=info.soid}params[i++]="componentType";params[i++]="INFO";params[i++]="portlet";params[i++]="poppedup";if(typeof PTC.cat["nonce_key"]!==
"undefined"&&typeof PTC.cat["nonce"]!=="undefined"){params[i++]=PTC.cat["nonce_key"];params[i++]=PTC.cat["nonce"]}for(;i<18;i++)params[i]="";var compContext="";if(typeof info.compContext!=="undefined")compContext=info.compContext;else compContext=PTC.action.getPageContext();PTC.getMainWindow().submitIt(windowName,"null",params[0],params[1],params[2],params[3],params[4],params[5],params[6],params[7],params[8],params[9],params[10],params[11],params[12],params[13],params[14],params[15],params[16],params[17],
compContext,"",info.action.actionClass,info.action.actionMethod,"null","","",false,"",info.action.ajaxType,"",false,null)},gwtPreventReload:false,isGWTPreventReload:function(){var gwtReload=false;if(typeof parent.PTC.cat.WizardHelper.gwtPreventReload!=="undefined")if(parent.PTC.cat.WizardHelper.gwtPreventReload===true){gwtReload=true;parent.PTC.cat.WizardHelper.gwtPreventReload=false}return gwtReload},structureComponentReviseCallBack:null,getStructureComponentReviseCallBack:function(){return parent.PTC.cat.WizardHelper.structureComponentReviseCallBack}};
PTC.cat.ActiveViewFilterHelper={evaluateFilter:function(filter,item){if(typeof item["dates_to_convert"]!="undefined"){var dates_to_convert=item["dates_to_convert"];for(key in dates_to_convert){var value=dates_to_convert[key];if(value==null)item[key]=null;else{var a_date=new Date(parseInt(value));item[key]=a_date}}item["dates_to_convert"]=null}var result=eval(filter);item=null;return result}};
PTC.infoPage.on("afterRender",function(){var tabPanel=PTC.infoPage.getTabPanel();PTC.infoPage.onStructureTab=false;PTC.infoPage.leftStructureTab=false;if(tabPanel)tabPanel.on("beforetabchange",function(tabpanel,newTab,old){if(newTab&&newTab.id.indexOf("GWT")>0){PTC.infoPage.onStructureTab=true;PTC.infoPage.leftStructureTab=false}else{PTC.infoPage.leftStructureTab=true;PTC.infoPage.onStructureTab=false}})});
PTC.onReady(function(){PTC.trail.addDomDumpHandler("StructureComponent_Dom_Dump","PTC.trail.structureComponent.domDumpHandler","/netmarkets/javascript/util/trail/structureComponent.js")});PTC.changeTemplate={};
PTC.changeTemplate.toggleTemplateTypePicker=function(checkbox,id){var firstRender=Ext.getDom(id).innerHTML==="";if(checkbox.checked===true&&firstRender){console.log("Initial render");refreshElement(id,"ptc1/comp/change.automateFastTrack")}else if(checkbox.checked===true){console.log("CHECKED: TRUE");Ext.getDom(id).style.visibility="visible"}else{console.log("CHECKED: FALSE");Ext.getDom(id).style.visibility="hidden"}};
PTC.changeTemplate.getSelectedChangeNoticeType=function(id){var comboBox=Ext.getDom(id);var option=comboBox.options[comboBox.selectedIndex];return option.value};PTC.changeTemplate.updateTemplateFromType=function(id){appendFormHiddenInput(getMainForm(),"changeTypePickerHidden",PTC.changeTemplate.getSelectedChangeNoticeType(id));refreshElement("change.automateFastTrack","ptc1/comp/change.automateFastTrack")};PTC.charting={};PTC.charting.log=log4javascript.getLogger("PTC.charting");
PTC.charting.colorWindchill=["rgb(0,103,180)","rgb(117,190,233)","rgb(111,174,171)","rgb(141,200,90)","rgb(213,224,77)","rgb(255,198,55)","rgb(247,142,30)","rgb(120,128,22)","rgb(84,137,42)","rgb(59,105,106)"];PTC.charting.colorColorblind=["rgb(102,153,204)","rgb(136,204,238)","rgb(68,170,153)","rgb(17,119,51)","rgb(153,153,51)","rgb(221,204,119)","rgb(204,102,119)","rgb(170,68,102)","rgb(136,34,85)","rgb(170,68,153)"];
PTC.charting.colorBright=["rgb(192,0,0)","rgb(255,0,0)","rgb(255,192,0)","rgb(255,255,0)","rgb(146,208,80)","rgb(0,176,80)","rgb(44,194,252)","rgb(2,130,226)","rgb(2,56,169)","rgb(112,48,160)"];PTC.charting.colorEarthtone=["rgb(177,124,7)","rgb(185,54,0)","rgb(133,181,129)","rgb(199,123,53)","rgb(25,170,162)","rgb(205,94,23)","rgb(26,129,26)","rgb(185,185,0)","rgb(153,71,19)","rgb(96,132,27)"];
PTC.charting.checkBoxes=["showYAxisGrid","showXAxisGrid","showDataLabels","showTooltips","showBackground","horizontalAxisLabels","showLegend","showPieAsDonut","showLine","showRegressionLine"];PTC.charting.maxChartsPerPage=4;PTC.charting.chartOptions=[];PTC.charting.savedChartNames=[];
PTC.charting.addChart=function(chartConfig){var tableId=chartConfig.tableId;var chartIndex=chartConfig.chartIndex;if(!PTC.isDefinedAndNotEmptyString(chartIndex))chartIndex=0;var chartDivId=chartConfig.chartDivId;if(!PTC.isDefinedAndNotEmptyString(chartDivId))chartDivId="chartingDiv"+chartIndex;var chartData=null;var errorMessage=null;if(chartConfig.chartData){chartData=Ext.util.JSON.decode(chartConfig.chartData);errorMessage=PTC.charting._checkForServerError(chartData)}else{errorMessage="MESSAGE_NO_DATA_TO_CHART";
PTC.charting.log.debug("Add chart error message encountered ",errorMessage)}Ext.applyIf(chartConfig,PTC.charting._getDefaultChartConfig());var div=null;if(chartConfig.showChartInline==="true"){chartDivId=chartDivId+"inline";var tableDiv=document.getElementById(tableId);div=document.getElementById(chartDivId);if(tableDiv!==null)if(div===null){var newDiv=document.createElement("div");newDiv.id=chartDivId;newDiv.setAttribute("style","display:inline-block;padding:5px;");tableDiv.parentNode.insertBefore(newDiv,
tableDiv);PTC.charting.log.debug("Added inline chart div, table div ",newDiv,tableDiv)}}if(!("Ext4"in window)){PTC.navigation.loadScript("netmarkets/javascript/ext/ext-all-sandbox-debug.js");if(!("Ext4"in window))if("ExtSandbox1"in window)Ext4=ExtSandbox1;else Ext4=ExtBox1;Ext4.supports.init()}PTC.onReady(function(){var dataStore=PTC.charting._getDataStore(chartConfig.chartType,chartData);var colorPalette=PTC.charting.colorWindchill;if(chartConfig.colorPalette=="COLOR_PALETTE_2")colorPalette=PTC.charting.colorColorblind;
else if(chartConfig.colorPalette=="COLOR_PALETTE_3")colorPalette=PTC.charting.colorBright;else if(chartConfig.colorPalette=="COLOR_PALETTE_4")colorPalette=PTC.charting.colorEarthtone;Ext4.chart.theme.WindchillChart=Ext4.extend(Ext4.chart.theme.Base,{constructor:function(config){Ext4.chart.theme.Base.prototype.constructor.call(this,Ext4.apply({colors:colorPalette},config))}});if(!errorMessage){var chartItem=PTC.charting._getChartItem(chartConfig,dataStore,colorPalette);PTC.charting.log.debug("Creating chart item with config ",
chartConfig)}div=document.getElementById(chartDivId);if(div!==null){div.innerHTML="";PTC.charting.log.debug("Clearing chart div ",chartDivId)}var tools=null;if(chartConfig.showChartInline==="true"){if(chartConfig.chartOwnedByUser==="true")tools=[{id:"search",disabled:true,disabledClass:"x-item-disabled",qtip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.HEADER_CHART_SETTINGS")),handler:function(event,toolEl,panel){PTC.charting.openChartOptions(tableId,chartIndex)}},
{id:"close",qtip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.HEADER_CLOSE_CHART")),handler:function(event,toolEl,panel){PTC.charting._closeChartWindow(chartIndex,chartDivId)}}];else tools=[{id:"close",qtip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.HEADER_CLOSE_CHART")),handler:function(event,toolEl,panel){PTC.charting._closeChartWindow(chartIndex,chartDivId)}}];var collapsible=true;if(chartConfig.windowControlsOff===
true){collapsible=false;tools=[];chartConfig.chartTitle='<font style="font-weight:bold;font-size:11px;color:#464646;">'+chartConfig.chartTitle+"</font>"}var inlineChartPanelDiv="chartPanel"+chartIndex+"inlineChartDiv";var displayHtml='<div id="'+inlineChartPanelDiv+'"></div>';if(errorMessage){displayHtml=PTC.charting._getErrorMessageHtml(errorMessage);PTC.charting.log.debug("Add chart error message encountered ",errorMessage," chart index: ",chartIndex)}PTC.charting.log.debug("Creating portlet ",
"chartPanel"+chartIndex+"inline");var chart=Ext.create({xtype:"portlet",title:chartConfig.chartTitle,collapsible:collapsible,tools:tools,width:375,height:470,resizable:false,border:0,shadow:false,id:"chartPanel"+chartIndex+"inline",renderTo:chartDivId,layout:"fit",items:[{html:displayHtml}]});if(!errorMessage){PTC.charting.log.debug("Creating 4.0 panel and chart rendered to  ","chartPanel"+chartIndex+"inlineChart",inlineChartPanelDiv);var chartInline=Ext4.create("Ext.panel.Panel",{xtype:"panel",width:370,
height:440,resizable:false,id:"chartPanel"+chartIndex+"inlineChart",renderTo:inlineChartPanelDiv,border:0,shadow:false,layout:"fit",items:[chartItem]})}}else{PTC.charting._enableSavedChartActions(chartIndex);PTC.charting.log.debug("Creating 4.0 PREVIEW panel and chart rendered to ","chartPanel"+chartIndex,chartDivId);Ext4.create("Ext.panel.Panel",{xtype:"portal",width:370,height:440,resizable:false,id:"chartPanel"+chartIndex,renderTo:chartDivId,border:false,layout:"fit",items:[chartItem]})}})};
PTC.charting._getDataStore=function(chartType,chartData){var dataStore=null;if(chartType=="columnstacked"||chartType=="barstacked"||chartType=="columnclustered"){if(chartData&&chartData.length>0){var fieldNames=PTC.charting._getFieldsFromChartData(chartData,true);dataStore=Ext4.create("store.json",{fields:fieldNames,data:chartData})}}else dataStore=Ext4.create("store.json",{fields:["xData","yData"],data:chartData});return dataStore};
PTC.charting._getFieldsFromChartData=function(chartData,includeXdata){var fields=[];if(includeXdata)fields.push("xData");for(var key in chartData[0])if(key!="xData"){key=key.replace(/\./g," ");fields.push(key)}return fields};
PTC.charting._getTableColumnsAndType=function(tableId){var columnData=[];var columnName=null;var columnDataType=null;var table=PTC.jca.table.Utils.getTable(tableId);var store=table.getStore();var count=store.getCount();var row=null;if(count>0)row=store.getAt(0);var exportObj=new exportListOperation;var tableColumns=exportObj.getExportColumns(table);var columnNames=[];for(var i=0,l=tableColumns.length;i<l;i++){var headerName=tableColumns[i].header;var dataType=tableColumns[i].dataType;if(headerName.indexOf("<span")===
-1){if(!dataType)dataType=PTC.charting._getDataTypeFromTable(row,tableColumns[i].id);tableColumns[i].dataType=dataType}}return tableColumns};PTC.charting._getTableColumnData=function(tableId){var tableColumns=PTC.charting._getTableColumnsAndType(tableId);var columns=[];for(var i=0,l=tableColumns.length;i<l;i++)columns.push(tableColumns[i].header);return columns};
PTC.charting._getDataTypeFromTable=function(row,columnId){if(!row)return null;var column=row.get(columnId);var comparable=jsca.getComparable(column);if(typeof comparable==="string")return"string";else if(typeof comparable==="number")if(comparable>0)return"date";else return"number";return null};
PTC.charting._getTableColumns=function(tableColumns,includeBlankColumn){var columnNames=[];if(includeBlankColumn&&includeBlankColumn===true)columnNames.push(["",""]);for(var i=0,l=tableColumns.length;i<l;i++){var headerName=tableColumns[i].header;var dataType=tableColumns[i].dataType;var id=tableColumns[i].id;if(!dataType||dataType!=="number"&&dataType!=="date")dataType="string";iconName="netmarkets/images/charts/datatype_chart_"+dataType+".png";if(headerName.indexOf("<span")===-1&&headerName.indexOf("&nbsp;&nbsp;")!==
0&&id.indexOf("infoPageAction")!==0)columnNames.push([headerName,dataType,iconName])}var columns=new Ext.data.ArrayStore({fields:["text","dataType","iconName"],data:columnNames});return columns};
PTC.charting._getServerChartData=function(tableId,chartConfig){var selectedOnlyMenu=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId)+".selectedOnlyViewItem");if(selectedOnlyMenu&&selectedOnlyMenu.checked===true)selectedOnlyMenu.setChecked(false);var chartDataArray=[];var exportColumnArrayY=[];var exportColumnArrayX=[];var exportObj=new exportListOperation;var table=PTC.jca.table.Utils.getTable(tableId);var exportColumnObjects=exportObj.getExportColumns(table);var yData=null;var xData=null;for(var i=
0,l=exportColumnObjects.length;i<l;i++)if(exportColumnObjects[i].header==chartConfig.yField){exportColumnArrayY.push(exportColumnObjects[i]);yData=exportObj.getAllExportRows(table,exportColumnArrayY)}else if(exportColumnObjects[i].header==chartConfig.xField){exportColumnArrayX.push(exportColumnObjects[i]);xData=exportObj.getAllExportRows(table,exportColumnArrayX)}if(!yData||yData.length===0){PTC.charting.log.debug("No data to chart, skipping get server data");var chartForm=PTC.charting._getForm(chartConfig.chartIndex);
if(chartForm)chartForm.findField("chartData"+chartConfig.chartIndex).setValue(null);chartConfig.chartData=null;if(chartConfig.showChartInline==="true")PTC.charting.addChart(chartConfig);else PTC.charting._formatErrorMessage("MESSAGE_NO_DATA_TO_CHART",chartConfig)}else{PTC.charting._displayLoadingIcon(chartConfig.chartIndex,chartConfig.chartDivId);PTC.charting.log.debug("Requesting server data");Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/components/charts/getChartData.jsp",success:PTC.charting._processChartDataRequest,
params:{chartColumnY:chartConfig.yField,dataTypeY:chartConfig.yFieldDataType,chartColumnX:chartConfig.xField,chartType:chartConfig.chartType,displayValueCount:chartConfig.displayValueCount,chartIndex:chartConfig.chartIndex,chartConfig:chartConfig,yData:yData,xData:xData}})}};
PTC.charting._processChartDataRequest=function(response,options){var responseJSON=Ext.util.JSON.decode(response.responseText.replace(/&quot;/g,'"'));var errorMessage=PTC.charting._checkForServerError(responseJSON);var chartConfig=options.params.chartConfig;var index=chartConfig.chartIndex;var chartData=Ext.util.JSON.encode(responseJSON);chartConfig.chartData=chartData;var chartForm=PTC.charting._getForm(index);if(chartForm){var chartDataField=chartForm.findField("chartData"+index);chartDataField.setValue(chartData)}PTC.charting.log.debug("Data returned from the server");
if(!errorMessage)PTC.charting.addChart(chartConfig);else if(chartConfig.showChartInline==="true")PTC.charting.addChart(chartConfig);else PTC.charting._formatErrorMessage(errorMessage,chartConfig)};
PTC.charting._checkForServerError=function(responseJSON){var success=true;var errorMessage="MESSAGE_ERROR_PROCESSING_CHART_DATA";if(responseJSON.hasOwnProperty("0")&&responseJSON.hasOwnProperty("1")){var name=decodeURIComponent(responseJSON["0"].name).replace(/\+/g," ");var value=decodeURIComponent(responseJSON["0"].value).replace(/\+/g," ");if(name=="success")if(value=="false"){success=false;var name2=decodeURIComponent(responseJSON["1"].name).replace(/\+/g," ");var value2=decodeURIComponent(responseJSON["1"].value).replace(/\+/g,
" ");if(name2=="errorMessage")errorMessage=value2}}if(success===false)return errorMessage;else return null};
PTC.charting._updateComboBoxColumns=function(chartIndex,form){var tableColumns=PTC.charting._getTableColumnsAndType("adhocTable");var yColumnNames=PTC.charting._getTableColumns(tableColumns,false);var xColumnNames=PTC.charting._getTableColumns(tableColumns,true);var yAxis=form.findField("yField"+chartIndex);var recordIndex=-1;if(yAxis){recordIndex=yColumnNames.findExact("text",yAxis.getValue());if(recordIndex<0)yAxis.clearValue();yAxis.bindStore(yColumnNames)}var xAxis=form.findField("xField"+chartIndex);
if(xAxis){if(xAxis.getValue()!==""){recordIndex=xColumnNames.findExact("text",xAxis.getValue());if(recordIndex<0)xAxis.clearValue()}xAxis.bindStore(xColumnNames)}};
PTC.charting._clearChartWindows=function(){for(var i=0,l=PTC.charting.maxChartsPerPage;i<l;i++){var chartOptionsWindow=Ext.getCmp("chartOptionsWindow"+i);var chartDiv=document.getElementById("chartingDiv"+i+"inline");if(!chartDiv&&chartOptionsWindow)if(chartOptionsWindow.hidden){PTC.charting.log.debug("Clearing leftover form index",i);PTC.charting._removeChartPreviewPanel(i);chartOptionsWindow.destroy()}}};
PTC.charting._closeChartWindow=function(chartIndex,chartDivId){var removeWindow=Ext.getCmp("chartOptionsWindow"+chartIndex);if(removeWindow)removeWindow.destroy();PTC.charting._removeChartPanel(chartIndex);var removeDiv=document.getElementById(chartDivId);if(removeDiv)removeDiv.parentNode.removeChild(removeDiv);PTC.charting.chartOptions[chartIndex]="N/A";if(PTC.reportBuilder.chartOptions)PTC.reportBuilder.chartOptions=PTC.charting.chartOptions};
PTC.charting._removeChartPanel=function(chartIndex){if("Ext4"in window){var removeChart=Ext4.getCmp("chartItem"+chartIndex+"inline");if(removeChart){PTC.charting.log.debug("Removing chart","chartItem"+chartIndex+"inline");removeChart.destroy()}var removeChartPanel=Ext4.getCmp("chartPanel"+chartIndex+"inlineChart");if(removeChartPanel){removeChartPanel.destroy();PTC.charting.log.debug("Removing chart panel 4.0","chartPanel"+chartIndex+"inlineChart")}}removePanel=Ext.getCmp("chartPanel"+chartIndex+
"inline");if(removePanel){removePanel.destroy();PTC.charting.log.debug("Removing chart panel","chartPanel"+chartIndex+"inline")}};
PTC.charting._removeChartPreviewPanel=function(chartIndex){if("Ext4"in window){var removeChart=Ext4.getCmp("chartItem"+chartIndex);if(removeChart){PTC.charting.log.debug("Removing chart","chartItem"+chartIndex);removeChart.destroy()}var removeChartPanel=Ext4.getCmp("chartPanel"+chartIndex);if(removeChartPanel){removeChartPanel.destroy();PTC.charting.log.debug("Removing chart panel 4.0","chartPanel"+chartIndex)}}};
PTC.charting._selectTableRows=function(tableId,spriteValue,columnName){var selectedOnlyMenu=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId)+".selectedOnlyViewItem");if(selectedOnlyMenu){jsca.unSelectHiddenCheckboxes(tableId);if(selectedOnlyMenu.checked===true)selectedOnlyMenu.setChecked(false);var table=PTC.jca.table.Utils.getTable(tableId);var exportObj=new exportListOperation;var exportColumnObjects=exportObj.getExportColumns(table);var exportColumnArray=[];var data=null;for(var i=0,l=exportColumnObjects.length;i<
l;i++)if(exportColumnObjects[i].header==columnName){exportColumnArray.push(exportColumnObjects[i]);data=exportObj.getAllExportRows(table,exportColumnArray);break}var rowsChecked=false;if(data)for(i=0,l=data.length;i<l;i++){rowsChecked=true;if(spriteValue==data[i][0]){table.getSelectionModel().selectRow(i,true);rowsChecked=true}}if(rowsChecked)selectedOnlyMenu.setChecked(true)}};
PTC.charting.openChartOptions=function(tableId,chartIndex){if(!PTC.isDefined(tableId))tableId=this.tableId;if(!PTC.isDefined(chartIndex))chartIndex=-1;var chartData=null;var chartOptionsWindow=null;var chartsExist=false;var chartConfig=null;var loadChart=false;var numActiveCharts=0;if(chartIndex<0)if(PTC.charting.chartOptions.length<1)chartIndex=0;else{for(var i=0,len=PTC.charting.chartOptions.length;i<len;i++)if(PTC.charting.chartOptions[i]!=="N/A")numActiveCharts++;chartIndex=PTC.charting.chartOptions.length++}else{chartConfig=
PTC.charting.chartOptions[chartIndex];loadChart=true}if(numActiveCharts>=PTC.charting.maxChartsPerPage){PTC.charting._formatPageMessage("com.ptc.core.components.chart.chartResource.MESSAGE_MAX_CHARTS_EXCEEDED_TITLE","com.ptc.core.components.chart.chartResource.MESSAGE_MAX_CHARTS_EXCEEDED","FAILURE");return}var chartDivId="chartingDiv"+chartIndex;var tableColumns=PTC.charting._getTableColumnsAndType(tableId);var yColumnNames=PTC.charting._getTableColumns(tableColumns,false);var xColumnNames=PTC.charting._getTableColumns(tableColumns,
true);var windowHeight=660;var innerPanelsHeight=515;var displaySectionFirstLabelWidth=75;var displaySectionSecondLabelWidth=230;var displaySectionThirdLabelWidth=130;var rowHeight=25;var lineHeightSetting="95%;";var topSectionRowHeight=26;var labelRowHeight=30;var rightComboBoxWidth=125;var buttonsWidth=515;var axisTitleLabelWidth=170;var axisTitleTextboxWidth=340;var firstSectionWidth=595;var firstSectionIndent=10;var displayFieldsetWidth=buttonsWidth+30;var displayFieldsetCompositeWidth=buttonsWidth;
var axisFieldWidth=(displayFieldsetWidth-20)/2;var axisSectionInputWidth=axisFieldWidth-30;var chartButtonSpacer=19;var thisFormId="chartSettingsForm"+chartIndex;var thisPanelId="chartSettingsPanel"+chartIndex;var valueString=" "+PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.DROPDOWN_VALUE_STRING"));var reportTemplateOid=null;var reportTemplateOidField=document.getElementById("reportTemplateOid");if(reportTemplateOidField)reportTemplateOid=reportTemplateOidField.getValue();
var savedReportOid=null;var savedReportOidField=document.getElementById("savedReportLoadedOid");if(savedReportOidField)savedReportOid=savedReportOidField.getValue();chartOptionsWindow=Ext.getCmp("chartOptionsWindow"+chartIndex);var chartTitleText=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FORM_NEW_CHART"));if(loadChart){chartTitleText=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FORM_EDIT_CHART"));var config=Ext.util.JSON.decode(chartConfig);
if(config.chartTitle.length>0)chartTitleText=chartTitleText+" - "+config.chartTitle}var titleBarButtons=[{xtype:"tbtext",id:"titleBarText"+chartIndex,text:chartTitleText},"->"];var helpButton=PTC.help.createHelpButtonConfigForSelector("ChartAbout");if(helpButton)titleBarButtons.push(helpButton);var titleBar=new Ext.Toolbar({id:"titleBar"+chartIndex,cls:"x-panel-header wizard-title-text",items:titleBarButtons});PTC.charting.log.debug("Creating new form id and panel id ",thisPanelId,thisFormId);var newWindow=
false;if(!chartOptionsWindow){newWindow=true;PTC.charting.log.debug("Creating new chart options window ","chartOptionsWindow"+chartIndex);chartOptionsWindow=new Ext.Window({id:"chartOptionsWindow"+chartIndex,renderTo:document.body,autoScroll:true,width:1010,height:windowHeight,tbar:titleBar,bodyCssClass:"wizbodybg",layout:"fit",draggable:true,closable:false,collapsible:false,resizable:false,items:[{xtype:"panel",baseCls:"wizardPanel",items:[{xtype:"form",bodyBorder:true,border:true,id:thisPanelId,
formId:thisFormId,method:"POST",url:getBaseHref()+"netmarkets/jsp/components/charts/getChartPrintWindow.jsp",padding:7,labelSeparator:"",hideLabel:true,baseCls:"wizardPanel-body wizardPanel-body-noheader",items:[{xtype:"compositefield",id:"savedChartField"+chartIndex,name:"savedChartField"+chartIndex,height:rowHeight,width:970,hideLabel:true,labelSeparator:"",items:[{xtype:"spacer",width:640},{xtype:"trigger",width:275,editable:false,emptyText:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVED_CHARTS_DROPDOWN")),
onTriggerClick:function(){this.menu.show(this.el)},name:"triggerSaveChartName"+chartIndex,id:"triggerSaveChartName"+chartIndex,menu:new Ext.menu.Menu({id:"menuSaveChartName"+chartIndex,name:"menuSaveChartName"+chartIndex,width:275,floating:true})},{xtype:"box",id:"saveChartIcon"+chartIndex,width:16,autoEl:{tag:"a",href:PTC.jslint.SCRIPT_URL_STRING+"var abc = doNothing()",title:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVE_CHART_BUTTON_TOOLTIP")),children:[{tag:"img",
src:"netmarkets/images/save_disabled.png"}]}},{xtype:"box",id:"saveAsChartIcon"+chartIndex,width:16,autoEl:{tag:"a",href:PTC.jslint.SCRIPT_URL_STRING+"var abc = doNothing()",title:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVE_CHART_AS_BUTTON_TOOLTIP")),children:[{tag:"img",src:"netmarkets/images/save_as_disabled.png"}]}}]},{xtype:"panel",layout:"column",items:[{columnWidth:".59",items:[{xtype:"panel",frame:true,height:innerPanelsHeight,baseCls:"x-box",items:[{xtype:"hidden",
name:"thisChartIndex",value:chartIndex},{xtype:"hidden",name:"chartData"+chartIndex},{xtype:"hidden",name:"yFieldDataType"+chartIndex,value:""},{xtype:"hidden",name:"xFieldDataType"+chartIndex,value:""},{xtype:"hidden",name:"chartIndex"+chartIndex,value:chartIndex},{xtype:"hidden",name:"tableId"+chartIndex,value:tableId},{xtype:"hidden",name:"chartDivId"+chartIndex,value:chartDivId},{xtype:"hidden",name:"chartType"+chartIndex,value:""},{xtype:"hidden",name:"yFieldPrevious"+chartIndex,value:""},{xtype:"hidden",
name:"xFieldPrevious"+chartIndex,value:""},{xtype:"hidden",name:"chartTypePrevious"+chartIndex,value:""},{xtype:"hidden",name:"showChartInline"+chartIndex,value:false},{xtype:"hidden",name:"savedChartLoadedOid"+chartIndex,value:""},{xtype:"hidden",name:"savedChartName"+chartIndex,value:""},{xtype:"hidden",name:"chartExists"+chartIndex,value:false},{xtype:"hidden",name:"reportTemplateOid"+chartIndex,value:reportTemplateOid},{xtype:"hidden",name:"savedReportOid"+chartIndex,value:savedReportOid},{xtype:"hidden",
name:"chartOwnedByUser"+chartIndex,value:true},{xtype:"label",height:topSectionRowHeight,style:"font-weight: bold; padding: 4px;",text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.AXES_HEADER_TEXT"))},{xtype:"spacer",height:12},{xtype:"compositefield",width:firstSectionWidth,height:topSectionRowHeight,hideLabel:true,items:[{xtype:"label",width:firstSectionIndent,html:"&nbsp;&nbsp;*"},{xtype:"label",style:"line-height:"+lineHeightSetting,height:labelRowHeight,
width:axisTitleLabelWidth,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.HEADER_Y_AXIS"))},{xtype:"combo",labelSeparator:"",name:"yField"+chartIndex,id:"yField"+chartIndex,hiddenName:"yFieldValue"+chartIndex,store:yColumnNames,valueField:"text",displayField:"text",triggerAction:"all",mode:"local",editable:false,allowBlank:true,listeners:{select:function(combo,record){PTC.charting._processDataSelection(combo,record.get("dataType"),chartIndex)}}}]},{xtype:"compositefield",
width:firstSectionWidth,height:topSectionRowHeight,hideLabel:true,items:[{xtype:"spacer",width:firstSectionIndent},{xtype:"label",id:"xFieldComboLabel"+chartIndex,style:"line-height:"+lineHeightSetting,disabled:true,height:labelRowHeight,width:axisTitleLabelWidth,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.HEADER_X_AXIS"))},{xtype:"combo",labelSeparator:"",name:"xField"+chartIndex,id:"xField"+chartIndex,hiddenName:"xFieldValue"+chartIndex,store:xColumnNames,
valueField:"text",displayField:"text",triggerAction:"all",mode:"local",editable:false,disabled:true,tpl:'<tpl for="."><div class="x-combo-list-item">{text}&nbsp;</div></tpl>',listeners:{select:function(combo,record){PTC.charting._processDataSelection(combo,record.get("dataType"),chartIndex)}},allowBlank:true}]},{xtype:"spacer",height:15},{xtype:"compositefield",width:firstSectionWidth,height:topSectionRowHeight,hideLabel:true,items:[{xtype:"spacer",width:firstSectionIndent},{xtype:"label",height:labelRowHeight,
style:"line-height:"+lineHeightSetting,width:axisTitleLabelWidth,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_CHART_TITLE"))},{xtype:"textfield",hideLabel:true,width:axisTitleTextboxWidth,id:"chartTitle"+chartIndex,name:"chartTitle"+chartIndex,listeners:{change:function(){PTC.charting._updateChartSettings(chartIndex)}}}]},{xtype:"compositefield",width:firstSectionWidth,height:topSectionRowHeight,hideLabel:true,items:[{xtype:"spacer",width:firstSectionIndent},
{xtype:"label",style:"line-height:"+lineHeightSetting,height:labelRowHeight,width:axisTitleLabelWidth,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.HORIZONTAL_AXIS_LABEL"))},{xtype:"textfield",hideLabel:true,name:"xFieldLabel"+chartIndex,id:"xFieldLabel"+chartIndex,width:axisTitleTextboxWidth,listeners:{change:function(){PTC.charting._updateChartSettings(chartIndex)}}}]},{xtype:"compositefield",width:firstSectionWidth,height:topSectionRowHeight,hideLabel:true,
items:[{xtype:"spacer",width:firstSectionIndent},{xtype:"label",style:"line-height:"+lineHeightSetting,height:labelRowHeight,width:axisTitleLabelWidth,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.VERTICAL_AXIS_LABEL"))},{xtype:"textfield",hideLabel:true,width:axisTitleTextboxWidth,name:"yFieldLabel"+chartIndex,id:"yFieldLabel"+chartIndex,listeners:{change:function(){PTC.charting._updateChartSettings(chartIndex)}}}]},{xtype:"fieldset",title:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.HEADER_CHART_LAYOUT")),
labelWidth:displaySectionFirstLabelWidth-5,labelSeparator:"",width:displayFieldsetWidth,collapsible:false,items:[{xtype:"toolbar",id:"chartTypeButtons"+chartIndex,name:"chartTypeButtons"+chartIndex,style:"background-color:white; border-style:none;",hideLabel:true,width:buttonsWidth,items:[{id:"column"+chartIndex,name:"column"+chartIndex,icon:"netmarkets/images/charts/chart_column_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_COLUMN"))},
{xtype:"tbspacer",width:chartButtonSpacer},{id:"bar"+chartIndex,name:"bar"+chartIndex,icon:"netmarkets/images/charts/chart_bar_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_BAR"))},{xtype:"tbspacer",width:chartButtonSpacer},{id:"pie"+chartIndex,name:"pie"+chartIndex,icon:"netmarkets/images/charts/chart_pie_disabled.png",enableToggle:true,
toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_PIE"))},{xtype:"tbspacer",width:chartButtonSpacer},{id:"pareto"+chartIndex,name:"pareto"+chartIndex,icon:"netmarkets/images/charts/chart_pareto_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_PARETO"))},
{xtype:"tbspacer",width:chartButtonSpacer},{id:"line"+chartIndex,name:"line"+chartIndex,icon:"netmarkets/images/charts/chart_line_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_LINE"))},{xtype:"tbspacer",width:chartButtonSpacer},{id:"histogram"+chartIndex,name:"histogram"+chartIndex,icon:"netmarkets/images/charts/chart_histogram_disabled.png",
enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_HISTOGRAM"))},{xtype:"tbspacer",width:chartButtonSpacer},{id:"histogram_horz"+chartIndex,name:"histogram_horz"+chartIndex,icon:"netmarkets/images/charts/chart_histogram_horz_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_HISTOGRAM_HORZ"))},
{xtype:"tbspacer",width:chartButtonSpacer},{id:"aging"+chartIndex,name:"aging"+chartIndex,icon:"netmarkets/images/charts/chart_aging_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_AGING"))},{xtype:"tbspacer",width:chartButtonSpacer},{id:"columnstacked"+chartIndex,named:"columnstacked"+chartIndex,icon:"netmarkets/images/charts/chart_columnstacked_disabled.png",
enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_STACKED_COLUMN"))},{xtype:"tbspacer",width:chartButtonSpacer},{id:"barstacked"+chartIndex,name:"barstacked"+chartIndex,icon:"netmarkets/images/charts/chart_barstacked_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_STACKED_BAR"))},
{xtype:"tbspacer",width:chartButtonSpacer},{id:"columnclustered"+chartIndex,name:"columnclustered"+chartIndex,icon:"netmarkets/images/charts/chart_columnclustered_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_CLUSTERED_COLUMN"))},{xtype:"tbspacer",width:chartButtonSpacer},{id:"scattergroup"+chartIndex,name:"scattergroup"+chartIndex,icon:"netmarkets/images/charts/chart_scattergroup_disabled.png",
enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_SCATTER_GROUP"))},{xtype:"tbspacer",width:chartButtonSpacer},{id:"scatterplot"+chartIndex,name:"scatterplot"+chartIndex,icon:"netmarkets/images/charts/chart_scatterplot_disabled.png",enableToggle:true,toggleGroup:"chartButtons",handler:PTC.charting._setChartType,disabled:true,tooltip:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TYPE_SCATTER_PLOT"))}]},
{xtype:"spacer",height:10},{xtype:"compositefield",id:"compositeRow1"+chartIndex,name:"compositeRow1"+chartIndex,width:displayFieldsetCompositeWidth,height:rowHeight,hideLabel:true,items:[{xtype:"checkbox",name:"showYAxisGrid"+chartIndex,id:"showYAxisGrid"+chartIndex,hideLabel:true,width:15,value:"ON",listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},{xtype:"label",id:"showYAxisGrid_Label"+chartIndex,style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_SHOW_Y_AXIS_GRID")),
width:displaySectionSecondLabelWidth},{xtype:"label",id:"displayValueCount_Label"+chartIndex,style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_VALUES_DISPLAYED")),width:displaySectionThirdLabelWidth},{xtype:"combo",name:"displayValueCount"+chartIndex,id:"displayValueCount"+chartIndex,width:rightComboBoxWidth,labelSeparator:"",valueField:"countId",displayField:"count",hiddenName:"displayValueCountValue"+chartIndex,
triggerAction:"all",mode:"local",editable:false,allowBlank:true,value:10,store:new Ext.data.ArrayStore({id:0,fields:["countId","count"],data:[[3,"3"+valueString],[5,"5"+valueString],[10,"10"+valueString],[15,"15"+valueString],[20,"20"+valueString],[25,"25"+valueString]]}),listeners:{select:function(){PTC.charting._updateChartDataLimit(chartIndex)}}}]},{xtype:"compositefield",id:"compositeRow2"+chartIndex,name:"compositeRow2"+chartIndex,width:displayFieldsetCompositeWidth,height:rowHeight,hideLabel:true,
items:[{xtype:"checkbox",name:"showXAxisGrid"+chartIndex,id:"showXAxisGrid"+chartIndex,hideLabel:true,width:15,disabled:true,listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},{xtype:"label",id:"showXAxisGrid_Label"+chartIndex,style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_SHOW_X_AXIS_GRID")),disabled:true,width:displaySectionSecondLabelWidth},{xtype:"label",style:"line-height:"+lineHeightSetting,
text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_COLOR_PALETTE")),width:displaySectionThirdLabelWidth},{xtype:"combo",name:"colorPalette"+chartIndex,id:"colorPalette"+chartIndex,width:rightComboBoxWidth,labelSeparator:"",valueField:"colorId",displayField:"color",hiddenName:"colorPaletteValue"+chartIndex,triggerAction:"all",mode:"local",editable:false,allowBlank:false,value:"COLOR_PALETTE_1",store:new Ext.data.ArrayStore({id:0,fields:["colorId","color"],
data:[["COLOR_PALETTE_1",PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.COLOR_PALETTE_1"))],["COLOR_PALETTE_2",PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.COLOR_PALETTE_2"))],["COLOR_PALETTE_3",PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.COLOR_PALETTE_3"))],["COLOR_PALETTE_4",PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.COLOR_PALETTE_4"))]]}),
listeners:{select:function(){PTC.charting._updateChartDataLimit(chartIndex)}}}]},{xtype:"compositefield",id:"compositeRow3"+chartIndex,name:"compositeRow3"+chartIndex,width:displayFieldsetCompositeWidth,height:rowHeight,hideLabel:true,items:[{xtype:"checkbox",name:"showDataLabels"+chartIndex,id:"showDataLabels"+chartIndex,hideLabel:true,width:15,listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},{xtype:"label",style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_SHOW_DATA_LABELS")),
width:displaySectionSecondLabelWidth},{xtype:"label",style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_FONT_SIZE")),width:displaySectionThirdLabelWidth},{xtype:"combo",name:"fontSize"+chartIndex,id:"fontSize"+chartIndex,width:rightComboBoxWidth,labelSeparator:"",valueField:"fontId",displayField:"fontsize",hiddenName:"fontSizeValue"+chartIndex,triggerAction:"all",mode:"local",editable:false,allowBlank:true,value:"FONT_SIZE_SMALL",
store:new Ext.data.ArrayStore({id:0,fields:["fontId","fontsize"],data:[["FONT_SIZE_SMALL",PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FONT_SIZE_SMALL"))],["FONT_SIZE_MEDIUM",PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FONT_SIZE_MEDUIM"))],["FONT_SIZE_LARGE",PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FONT_SIZE_LARGE"))]]}),listeners:{select:function(){PTC.charting._updateChartDataLimit(chartIndex)}}}]},
{xtype:"compositefield",id:"compositeRow4"+chartIndex,name:"compositeRow4"+chartIndex,width:displayFieldsetCompositeWidth,height:rowHeight,hideLabel:true,items:[{xtype:"checkbox",name:"showTooltips"+chartIndex,id:"showTooltips"+chartIndex,hideLabel:true,width:15,checked:true,value:true,listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},{xtype:"label",style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_TOOLTIPS")),
width:displaySectionSecondLabelWidth},{xtype:"label",style:"line-height:"+lineHeightSetting,id:"agingChartUnits_Label"+chartIndex,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_CHART_UNITS")),width:displaySectionThirdLabelWidth,disabled:true},{xtype:"combo",name:"agingChartUnits"+chartIndex,id:"agingChartUnits"+chartIndex,width:rightComboBoxWidth,labelSeparator:"",valueField:"unit",displayField:"unit",triggerAction:"all",mode:"local",editable:false,
allowBlank:true,disabled:true,value:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_UNITS_DAYS")),store:new Ext.data.ArrayStore({id:0,fields:["unit"],data:[PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_UNITS_DAYS")),PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_UNITS_WEEKS")),PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_UNITS_MONTHS")),
PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_UNITS_QUARTERS")),PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_UNITS_YEARS"))]})}]},{xtype:"compositefield",id:"compositeRow5"+chartIndex,name:"compositeRow5"+chartIndex,width:displayFieldsetCompositeWidth,height:rowHeight,hideLabel:true,items:[{xtype:"checkbox",name:"showBackground"+chartIndex,id:"showBackground"+chartIndex,hideLabel:true,width:15,disabled:false,
listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},{xtype:"label",style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_SHOW_BACKGROUND")),disabled:false,width:displaySectionSecondLabelWidth},{xtype:"checkbox",name:"showPieAsDonut"+chartIndex,id:"showPieAsDonut"+chartIndex,hideLabel:true,width:15,disabled:true,listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},{xtype:"label",
style:"line-height:"+lineHeightSetting,id:"showPieAsDonut_Label"+chartIndex,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_PIE_AS_DONUT")),disabled:true}]},{xtype:"compositefield",id:"compositeRow6"+chartIndex,name:"compositeRow6"+chartIndex,width:displayFieldsetCompositeWidth,height:rowHeight,hideLabel:true,items:[{xtype:"checkbox",name:"horizontalAxisLabels"+chartIndex,id:"horizontalAxisLabels"+chartIndex,hideLabel:true,width:15,disabled:true,listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},
{xtype:"label",id:"horizontalAxisLabels_Label"+chartIndex,style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_SHOW_HORIZONTAL_LABELS")),width:displaySectionSecondLabelWidth},{xtype:"checkbox",name:"showLine"+chartIndex,id:"showLine"+chartIndex,hideLabel:true,disabled:true,width:15,listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},{xtype:"label",id:"showLine_Label"+chartIndex,style:"line-height:"+
lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_SHOW_LINE")),disabled:true,width:displaySectionSecondLabelWidth}]},{xtype:"compositefield",id:"compositeRow7"+chartIndex,name:"compositeRow7"+chartIndex,width:displayFieldsetCompositeWidth,height:rowHeight,hideLabel:true,items:[{xtype:"checkbox",name:"showLegend"+chartIndex,id:"showLegend"+chartIndex,hideLabel:true,width:15,disabled:true,listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},
{xtype:"label",id:"showLegend_Label"+chartIndex,style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_SHOW_LEGEND")),disabled:true,width:displaySectionSecondLabelWidth},{xtype:"checkbox",name:"showRegressionLine"+chartIndex,id:"showRegressionLine"+chartIndex,hideLabel:true,disabled:true,width:15,listeners:{check:function(){PTC.charting._updateChartSettings(chartIndex)}}},{xtype:"label",id:"showRegressionLine_Label"+
chartIndex,style:"line-height:"+lineHeightSetting,text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.OPTION_SHOW_REGRESSION")),disabled:true,width:displaySectionSecondLabelWidth}]}]}]}]},{columnWidth:".41",items:[{xtype:"panel",frame:true,height:innerPanelsHeight,baseCls:"x-box",html:'<div id="'+chartDivId+'"></div>'}]}]},{xtype:"panel",border:false,buttonAlign:"left",fbar:[{xtype:"tbtext",text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FORM_REQUIRED_FIELD"))},
"->",{xtype:"button",text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FORM_PRINT_BUTTON")),handler:function(){var form=Ext.getCmp(thisPanelId).getForm();var el=form.getEl().dom;var target=document.createAttribute("target");target.nodeValue="_blank";el.setAttributeNode(target);el.action=form.url;el.submit()}},{xtype:"tbspacer",width:30},{xtype:"button",text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FORM_OK_BUTTON")),
handler:function(){var form=PTC.charting._getForm(chartIndex);form.findField("showChartInline"+chartIndex).setValue(true);var chartConfig=PTC.charting._getChartConfigFromForm(chartIndex);form.findField("showChartInline"+chartIndex).setValue(false);PTC.charting.addChart(chartConfig);var chartOptionsWindow=Ext.getCmp("chartOptionsWindow"+chartIndex);chartOptionsWindow.destroy()}},{xtype:"button",text:PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.FORM_CANCEL_BUTTON")),
handler:function(){var inlinePanel=Ext.getCmp("chartPanel"+chartIndex+"inline");var chartOptionsWindow=Ext.getCmp("chartOptionsWindow"+chartIndex);if(inlinePanel){PTC.charting._removeChartPreviewPanel(i);chartOptionsWindow.destroy()}else{chartOptionsWindow.destroy();PTC.charting.chartOptions[chartIndex]="N/A";if(PTC.reportBuilder.chartOptions)PTC.reportBuilder.chartOptions=PTC.charting.chartOptions}}},{xtype:"tbspacer"}]}]}]}]})}if(loadChart){PTC.charting._loadChartConfigToForm(chartIndex);PTC.charting._getSavedChartsMenuData(chartIndex);
chartOptionsWindow.show();chartOptionsWindow.alignTo(document.body,"tl-tl",[25,25])}else{chartOptionsWindow.show();chartOptionsWindow.alignTo(document.body,"tl-tl",[25,25]);PTC.charting._getSavedChartsMenuData(chartIndex)}};
PTC.charting._setChartType=function(item){var formId=item.findParentByType("form").getId();var index=formId.substring(18,19);var form=Ext.getCmp(formId).getForm();var chartType=item.getId();var chartTypeLen=chartType.length-index.length;chartType=chartType.substring(0,chartTypeLen);form.findField("chartType"+index).setValue(chartType);PTC.charting._setChartOptions(chartType,index);PTC.charting._updateChartPreview(index,false)};
PTC.charting._updateChartPreview=function(index,fromSavedReport){var form=PTC.charting._getForm(index);var chartConfig=PTC.charting._getChartConfigFromForm(index);var yFieldPrevious=form.findField("yFieldPrevious"+index).getValue();var xFieldPrevious=form.findField("xFieldPrevious"+index).getValue();var chartTypePrevious=form.findField("chartTypePrevious"+index).getValue();var dataChanged=false;var chartTypeChanged=false;form.findField("yFieldPrevious"+index).setValue(chartConfig.yField);form.findField("xFieldPrevious"+
index).setValue(chartConfig.xField);form.findField("chartTypePrevious"+index).setValue(chartConfig.chartType);if(yFieldPrevious!=chartConfig.yField||xFieldPrevious!=chartConfig.xField)dataChanged=true;if(chartTypePrevious!=chartConfig.chartType)chartTypeChanged=true;if(fromSavedReport===false)chartConfig=PTC.charting._setAxisLabels(chartConfig,chartTypePrevious,dataChanged,chartTypeChanged);if(dataChanged||chartTypeChanged)PTC.charting._getServerChartData(chartConfig.tableId,chartConfig);else PTC.charting.addChart(chartConfig)};
PTC.charting._updateChartDataLimit=function(index){if(PTC.charting._getFormValue(index,"chartExists")=="true"){var chartConfig=PTC.charting._getChartConfigFromForm(index);var tableId=PTC.charting._getFormValue(index,"tableId");PTC.charting._getServerChartData(tableId,chartConfig)}};PTC.charting._updateChartSettings=function(index){if(PTC.charting._getFormValue(index,"chartExists")=="true"){var chartConfig=PTC.charting._getChartConfigFromForm(index);PTC.charting.addChart(chartConfig)}};
PTC.charting._getChartConfigFromForm=function(index){var form=PTC.charting._getForm(index);var chartConfig={chartDivId:form.findField("chartDivId"+index).getValue(),chartIndex:form.findField("chartIndex"+index).getValue(),chartOwnedByUser:form.findField("chartOwnedByUser"+index).getValue(),chartTitle:form.findField("chartTitle"+index).getValue(),chartType:form.findField("chartType"+index).getValue(),colorPalette:form.findField("colorPalette"+index).getValue(),colorPaletteValue:form.findField("colorPaletteValue"+
index).getValue(),displayValueCount:form.findField("displayValueCount"+index).getValue(),displayValueCountValue:form.findField("displayValueCountValue"+index).getValue(),fontSize:form.findField("fontSize"+index).getValue(),fontSizeValue:form.findField("fontSizeValue"+index).getValue(),horizontalAxisLabels:form.findField("horizontalAxisLabels"+index).getValue(),reportTemplateOid:form.findField("reportTemplateOid"+index).getValue(),savedChartLoadedOid:form.findField("savedChartLoadedOid"+index).getValue(),
savedChartName:form.findField("savedChartName"+index).getValue(),savedReportOid:form.findField("savedReportOid"+index).getValue(),showBackground:form.findField("showBackground"+index).getValue(),showChartInline:form.findField("showChartInline"+index).getValue(),showDataLabels:form.findField("showDataLabels"+index).getValue(),showLegend:form.findField("showLegend"+index).getValue(),showPieAsDonut:form.findField("showPieAsDonut"+index).getValue(),showTooltips:form.findField("showTooltips"+index).getValue(),
showXAxisGrid:form.findField("showXAxisGrid"+index).getValue(),showYAxisGrid:form.findField("showYAxisGrid"+index).getValue(),tableId:form.findField("tableId"+index).getValue(),xField:form.findField("xField"+index).getValue(),xFieldDataType:form.findField("xFieldDataType"+index).getValue(),xFieldLabel:form.findField("xFieldLabel"+index).getValue(),xFieldValue:form.findField("xFieldValue"+index).getValue(),yField:form.findField("yField"+index).getValue(),yFieldDataType:form.findField("yFieldDataType"+
index).getValue(),yFieldLabel:form.findField("yFieldLabel"+index).getValue(),yFieldValue:form.findField("yFieldValue"+index).getValue()};var jsonString=JSON.stringify(chartConfig);PTC.charting.chartOptions[index]=jsonString;if(PTC.reportBuilder.chartOptions)PTC.reportBuilder.chartOptions=PTC.charting.chartOptions;chartConfig.chartData=form.findField("chartData"+index).getValue();return chartConfig};
PTC.charting._loadChartConfigToForm=function(chartIndex){var form=PTC.charting._getForm(chartIndex);var chartConfigData=PTC.charting.chartOptions[chartIndex];var chartConfig=Ext.util.JSON.decode(chartConfigData);if(form){PTC.charting._setFormValue(form,chartIndex,"chartDivId",chartConfig.chartDivId);PTC.charting._setFormValue(form,chartIndex,"chartIndex",chartConfig.chartIndex);PTC.charting._setFormValue(form,chartIndex,"chartOwnedByUser",chartConfig.chartOwnedByUser);PTC.charting._setFormValue(form,
chartIndex,"chartTitle",chartConfig.chartTitle);PTC.charting._setFormValue(form,chartIndex,"chartType",chartConfig.chartType);PTC.charting._setFormValue(form,chartIndex,"colorPalette",chartConfig.colorPalette);PTC.charting._setFormValue(form,chartIndex,"displayValueCount",chartConfig.displayValueCount);PTC.charting._setFormValue(form,chartIndex,"fontSize",chartConfig.fontSize);PTC.charting._setFormValue(form,chartIndex,"horizontalAxisLabels",chartConfig.horizontalAxisLabels);PTC.charting._setFormValue(form,
chartIndex,"reportTemplateOid",chartConfig.reportTemplateOid);PTC.charting._setFormValue(form,chartIndex,"savedChartLoadedOid",chartConfig.savedChartLoadedOid);PTC.charting._setFormValue(form,chartIndex,"savedChartName",chartConfig.savedChartName);PTC.charting._setFormValue(form,chartIndex,"savedReportOid",chartConfig.savedReportOid);PTC.charting._setFormValue(form,chartIndex,"showBackground",chartConfig.showBackground);PTC.charting._setFormValue(form,chartIndex,"showDataLabels",chartConfig.showDataLabels);
PTC.charting._setFormValue(form,chartIndex,"showLegend",chartConfig.showLegend);PTC.charting._setFormValue(form,chartIndex,"showPieAsDonut",chartConfig.showPieAsDonut);PTC.charting._setFormValue(form,chartIndex,"showTooltips",chartConfig.showTooltips);PTC.charting._setFormValue(form,chartIndex,"showXAxisGrid",chartConfig.showXAxisGrid);PTC.charting._setFormValue(form,chartIndex,"showYAxisGrid",chartConfig.showYAxisGrid);PTC.charting._setFormValue(form,chartIndex,"tableId",chartConfig.tableId);PTC.charting._setFormValue(form,
chartIndex,"xField",chartConfig.xField);PTC.charting._setFormValue(form,chartIndex,"xFieldDataType",chartConfig.xFieldDataType);PTC.charting._setFormValue(form,chartIndex,"xFieldLabel",chartConfig.xFieldLabel);PTC.charting._setFormValue(form,chartIndex,"yField",chartConfig.yField);PTC.charting._setFormValue(form,chartIndex,"yFieldDataType",chartConfig.yFieldDataType);PTC.charting._setFormValue(form,chartIndex,"yFieldLabel",chartConfig.yFieldLabel);var chartButton=Ext.getCmp(chartConfig.chartType+
chartIndex);if(chartButton)chartButton.toggle(true);PTC.charting._manageChartButtons(chartIndex,false);PTC.charting._setChartOptions(chartConfig.chartType,chartIndex);PTC.charting._updateChartPreview(chartIndex,true)}};
PTC.charting._getDefaultChartConfig=function(){var chartConfig={chartData:"",chartTitle:"",chartType:"",colorPalette:"COLOR_PALETTE_1",colorPaletteValue:"COLOR_PALETTE_1",displayValueCount:"10",displayValueCountValue:"10",fontSize:"FONT_SIZE_SMALL",fontSizeValue:"FONT_SIZE_SMALL",horizontalAxisLabels:false,showBackground:false,showChartInline:false,showDataLabels:false,showLegend:false,showPieAsDonut:false,showTooltips:true,showXAxisGrid:false,showYAxisGrid:false,windowControlsOff:false,xField:"",
xFieldDataType:null,xFieldLabel:"",xFieldValue:"",yField:"",yFieldDataType:"",yFieldLabel:"",yFieldValue:""};return chartConfig};
PTC.charting._getSaveChartMenuText=function(oid,displayText,toolTip,deleteTooltip,chartIndex,disabled){var href=PTC.jslint.SCRIPT_URL_STRING+'PTC.charting._getSavedChartData("'+oid+'","'+chartIndex+'");';var display="<table ><tr><td >";if(disabled){display+='<div id="savedChartMenu'+oid+'" class="x-menu-list-item x-item-disabled" style="width:225px;">';href='"'+PTC.jslint.SCRIPT_URL_STRING+'var abc = doNothing();"'}else display+='<div id="savedChartMenu'+oid+'" class="x-menu-list-item" style="width:225px;">';
display+='<div id="savedChartMenu'+oid+'" class="x-menu-list-item" style="width:225px;">';if(toolTip==="")display+='<a id="load'+displayText+'" href='+href+">"+displayText+"</a></div>";else display+='<a  ext:qtip="'+toolTip+'" href='+href+">"+displayText+"</a></div>";display+='</td><td align="right">';display+='<a id="delete'+displayText+'" href=javascript:PTC.charting._deleteSavedChartData("'+oid+'","'+chartIndex+'"); >'+'<img ext:qtip="'+deleteTooltip+'" height="9" width="9" BORDER=0 src="netmarkets/images/delete9x9.png"/></a>';
display+="</td></tr></table>";return display};
PTC.charting._saveChartSettings=function(chartIndex,newChartName,saveType){var form=PTC.charting._getForm(chartIndex);var tableId=form.findField("tableId"+chartIndex).getValue();var reportTemplateOid=form.findField("reportTemplateOid"+chartIndex).getValue();var savedChartLoadedOid=form.findField("savedChartLoadedOid"+chartIndex).getValue();if(saveType=="saveAs"){form.findField("savedChartLoadedOid"+chartIndex).setValue("");form.findField("savedReportOid"+chartIndex).setValue("");savedChartLoadedOid=
"";PTC.charting._getChartConfigFromForm(chartIndex)}var saveChartData=form.findField("chartData"+chartIndex).getValue();form.findField("chartData"+chartIndex).setValue(null);var formData=Ext.Ajax.serializeForm(Ext.getDom("chartSettingsForm"+chartIndex));form.findField("chartData"+chartIndex).setValue(saveChartData);Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/components/charts/saveChartSettings.jsp",success:PTC.charting._processSaveChartRequest,faulure:PTC.charting._processFailedRequest,params:{chartIndex:chartIndex,
tableId:tableId,reportTemplateOid:reportTemplateOid,savedChartLoadedOid:savedChartLoadedOid,newChartName:newChartName,saveType:saveType,saveWithReport:false,formData:formData,chartOptions:PTC.charting.chartOptions}})};
PTC.charting._saveChartSettingsWithReport=function(newOrModify,thisSavedReportOid){Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/components/charts/saveChartSettings.jsp",success:PTC.charting._processSaveChartRequest,faulure:PTC.charting._processFailedRequest,params:{saveWithReport:true,newOrModify:newOrModify,thisSavedReportOid:thisSavedReportOid,chartOptions:PTC.charting.chartOptions}})};
PTC.charting._processSaveChartRequest=function(response,options){var responseJSON=Ext.util.JSON.decode(response.responseText);var form=PTC.charting._getForm(options.params.chartIndex);var saveWithReport=options.params.saveWithReport;var success=true;var errorMessage=null;var tokens=null;var chartOptionsIndex=null;var savedReportOid=null;var savedChartLoadedOid=null;for(var key in responseJSON)if(responseJSON.hasOwnProperty(key)){var name=decodeURIComponent(responseJSON[key].name).replace(/\+/g," ");
var value=decodeURIComponent(responseJSON[key].value).replace(/\+/g," ");if(name=="success")if(value=="true")success=true;else success=false;else if(name=="errorMessage"){errorMessage=value;errorMessage=errorMessage.replace(/\s/g,"&nbsp;")}else if(name=="savedChartLoadedOid")form.findField("savedChartLoadedOid"+options.params.chartIndex).setValue(value);else if(saveWithReport===true){tokens=name.split("|");if(name.startsWith("savedReportOid")){PTC.charting._modifyChartOption(tokens[1],tokens[0],value);
PTC.charting._modifyChartOption(tokens[1],"chartIndex",tokens[1])}else if(name.startsWith("savedChartLoadedOid"))PTC.charting._modifyChartOption(tokens[1],tokens[0],value);else if(name.startsWith("savedChartName"))PTC.charting._modifyChartOption(tokens[1],tokens[0],value)}}if(success===true){PTC.charting._getSavedChartsMenuData(options.params.chartIndex);if(!saveWithReport){var title=bundleHandler.get("com.ptc.core.components.chart.chartResource.MESSAGE_TITLE_SAVE_SUCCESSFUL");var message=bundleHandler.getBundleStringAndInserts("com.ptc.core.components.chart.chartResource.MESSAGE_SAVE_SUCCESSFUL",
[options.params.newChartName]);PTC.messaging.showInlineMessage([{MessageTitle:title,Messages:[message],MessageType:"SUCCESS"}]);var triggerItem=Ext.getCmp("triggerSaveChartName"+options.params.chartIndex);triggerItem.setValue(options.params.newChartName);form.findField("savedChartName"+options.params.chartIndex).setValue(options.params.newChartName)}}else{var titleFailed=bundleHandler.get("com.ptc.core.components.chart.chartResource.MESSAGE_TITLE_SAVE_FAILED");PTC.messaging.showInlineMessage([{MessageTitle:titleFailed,
Messages:[errorMessage],MessageType:"FAILURE"}])}};
PTC.charting._getSavedChartsMenuData=function(chartIndex){var form=PTC.charting._getForm(chartIndex);if(form){var savedChartLoadedOid=form.findField("savedChartLoadedOid"+chartIndex).getValue();var reportTemplateOid=form.findField("reportTemplateOid"+chartIndex).getValue();var tableId=form.findField("tableId"+chartIndex).getValue();Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/components/charts/getSavedChartMenuData.jsp",success:PTC.charting._loadSavedChartMenu,faulure:PTC.charting._processFailedRequest,
params:{savedChartLoadedOid:savedChartLoadedOid,reportTemplateOid:reportTemplateOid,tableId:tableId,chartIndex:chartIndex}})}};
PTC.charting._loadSavedChartMenu=function(response,options){var form=PTC.charting._getForm(options.params.chartIndex);var loadMenu=Ext.getCmp("menuSaveChartName"+options.params.chartIndex);var triggerItem=Ext.getCmp("triggerSaveChartName"+options.params.chartIndex);loadMenu.removeAll();PTC.charting.savedChartNames=[];var savedChartLoadedOid=options.params.savedChartLoadedOid;var deleteTooltip=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.DELETE_CHART_TOOLTIP"));
var missingColumnTooltip=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.TABLE_MISSING_CHART_COLUMNS"));var toolTip="";var columns=PTC.charting._getTableColumnData(form.findField("tableId"+options.params.chartIndex).getValue());var responseJSON=Ext.util.JSON.decode(response.responseText);for(var key in responseJSON)if(responseJSON.hasOwnProperty(key)){var menuId=decodeURIComponent(responseJSON[key].menuId).replace(/\+/g," ");var name=decodeURIComponent(responseJSON[key].name).replace(/\+/g,
" ");var tokens=name.split("|");name=tokens[0];var yField=tokens[1];var xField=tokens[2];if(savedChartLoadedOid==menuId)triggerItem.setValue(name);var savedChartArray=[menuId,name];PTC.charting.savedChartNames.push(savedChartArray);toolTip="";var disabled=false;if(columns.indexOf(yField)<0){disabled=true;toolTip=missingColumnTooltip+yField}if(xField!==""&&columns.indexOf(xField)<0)if(disabled)toolTip=toolTip+","+xField;else{disabled=true;toolTip=missingColumnTooltip+xField}var labelWidth=Ext.util.TextMetrics.createInstance(document.body).getWidth(name);
if(labelWidth>270){if(toolTip==="")toolTip=name;name=Ext.util.Format.ellipsis(name,33,false)}loadMenu.addItem(new Ext.menu.Item({text:PTC.charting._getSaveChartMenuText(menuId,name,toolTip,deleteTooltip,options.params.chartIndex,disabled),id:menuId,data:menuId,hideOnClick:false}))}loadMenu.addSeparator();PTC.charting._addSavedChartMenuActions(options.params.chartIndex)};
PTC.charting._addSavedChartMenuActions=function(chartIndex){var loadMenu=Ext.getCmp("menuSaveChartName"+chartIndex);var disabled=true;if(PTC.charting._getFormValue(chartIndex,"chartExists")=="false"){saveIcon="netmarkets/images/save_disabled.png";saveAsIcon="netmarkets/images/save_as_disabled.png"}else{disabled=false;saveIcon="netmarkets/images/save.png";saveAsIcon="netmarkets/images/saveas.png"}loadMenu.addItem(new Ext.menu.Item({id:"triggerSave"+chartIndex,text:bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVE_MENU_ITEM"),
hideOnClick:true,disabled:disabled,handler:PTC.charting._saveChartRequest.createDelegate(this,[chartIndex,"save"]),data:"",icon:saveIcon}));loadMenu.addItem(new Ext.menu.Item({id:"triggerSaveAs"+chartIndex,text:bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVE_AS_MENU_ITEM"),hideOnClick:true,disabled:disabled,handler:PTC.charting._saveChartRequest.createDelegate(this,[chartIndex,"saveAs"]),data:"",icon:saveAsIcon}))};
PTC.charting._enableSavedChartActions=function(chartIndex){var form=PTC.charting._getForm(chartIndex);if(form&&form.findField("chartExists"+chartIndex).getValue()=="false"){form.findField("chartExists"+chartIndex).setValue(true);var saveMenuItem=Ext.getCmp("triggerSave"+chartIndex);var saveAsMenuItem=Ext.getCmp("triggerSaveAs"+chartIndex);var loadMenu=Ext.getCmp("menuSaveChartName"+chartIndex);loadMenu.remove(saveAsMenuItem);loadMenu.remove(saveMenuItem);PTC.charting._addSavedChartMenuActions(chartIndex);
var saveChartIcon=Ext.getCmp("saveChartIcon"+chartIndex);saveChartIcon.el.dom.href=PTC.jslint.SCRIPT_URL_STRING+"PTC.charting._saveChartRequest('"+chartIndex+"','save')";saveChartIcon.el.dom.firstChild.src="netmarkets/images/save.png";var saveAsChartIcon=Ext.getCmp("saveAsChartIcon"+chartIndex);saveAsChartIcon.el.dom.href=PTC.jslint.SCRIPT_URL_STRING+"PTC.charting._saveChartRequest('"+chartIndex+"','saveAs')";saveAsChartIcon.el.dom.firstChild.src="netmarkets/images/saveas.png"}};
PTC.charting._getSavedChartData=function(savedChartOid,chartIndex){var savedChartName=PTC.charting._getSavedChartNameFromOid(savedChartOid);var triggerItem=Ext.getCmp("triggerSaveChartName"+chartIndex);triggerItem.setValue(savedChartName);var loadMenu=Ext.getCmp("menuSaveChartName"+chartIndex);loadMenu.hide();Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/components/charts/getSavedChart.jsp",success:PTC.charting._loadSavedChartData,faulure:PTC.charting._processFailedRequest,params:{savedChartOid:savedChartOid,
getChartsForSavedReport:false,chartIndex:chartIndex,savedChartName:savedChartName}})};PTC.charting._getSavedChartsForReport=function(savedReportOid){Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/components/charts/getSavedChart.jsp",success:PTC.charting._loadSavedChartsFromReport,faulure:PTC.charting._processFailedRequest,params:{getChartsForSavedReport:true,savedReportOid:savedReportOid}})};
PTC.charting._modifyChartOption=function(chartOptionsIndex,name,value){var config=Ext.util.JSON.decode(PTC.charting.chartOptions[chartOptionsIndex]);config[name]=value;PTC.charting.chartOptions[chartOptionsIndex]=JSON.stringify(config);if(PTC.reportBuilder.chartOptions)PTC.reportBuilder.chartOptions=PTC.charting.chartOptions};
PTC.charting._getSavedChartNameFromOid=function(oid){for(var i=0,len=PTC.charting.savedChartNames.length;i<len;i++)if(PTC.charting.savedChartNames[i][0]===oid)return PTC.charting.savedChartNames[i][1];return""};
PTC.charting._loadSavedChartData=function(response,options){var chartIndex=options.params.chartIndex;var form=PTC.charting._getForm(chartIndex);PTC.charting._clearChartData(form,chartIndex);var responseJSON=Ext.util.JSON.decode(response.responseText);var chartType="";for(var key in responseJSON)if(responseJSON.hasOwnProperty(key)){var name=decodeURIComponent(responseJSON[key].name).replace(/\+/g," ");var value=decodeURIComponent(responseJSON[key].value).replace(/\+/g," ");PTC.charting._setFormValue(form,
chartIndex,name,value);if(name=="chartType")chartType=value}form.findField("savedChartName"+chartIndex).setValue(options.params.savedChartName);Ext.getCmp(chartType+options.params.chartIndex).toggle(true);PTC.charting._manageChartButtons(options.params.chartIndex,false);PTC.charting._setChartOptions(chartType,options.params.chartIndex);PTC.charting._updateChartPreview(options.params.chartIndex,true)};
PTC.charting._loadSavedChartsFromReport=function(response,options){var responseJSON=Ext.util.JSON.decode(response.responseText);var count=responseJSON.length;PTC.charting.chartOptions=[];var chartConfig={};Ext.applyIf(chartConfig,PTC.charting._getDefaultChartConfig());for(var i=0,l=count;i<l;i++){var jsonItem=responseJSON[i];for(var key in jsonItem)if(jsonItem.hasOwnProperty(key)){var name=decodeURIComponent(jsonItem[key].name).replace(/\+/g," ");var value=decodeURIComponent(jsonItem[key].value).replace(/\+/g,
" ");if(PTC.charting.checkBoxes.indexOf(name)>-1)chartConfig[name]=PTC.charting._getCheckboxValue(value);else chartConfig[name]=value}chartConfig.showChartInline="true";chartConfig.chartIndex=i;chartConfig.savedReportOid=options.params.savedReportOid;chartConfig.colorPalette=chartConfig.colorPaletteValue;chartConfig.displayValueCount=chartConfig.displayValueCountValue;chartConfig.fontSize=chartConfig.fontSizeValue;chartConfig.xField=chartConfig.xFieldValue;chartConfig.yField=chartConfig.yFieldValue;
var jsonString=JSON.stringify(chartConfig);PTC.charting.chartOptions[i]=jsonString}PTC.reportBuilder.chartOptions=PTC.charting.chartOptions};PTC.charting._setFormValue=function(form,chartIndex,fieldName,value){var formField=form.findField(fieldName+chartIndex);if(formField){if(formField.disabled)formField.enable();formField.suspendEvents(false);formField.setValue(value);formField.resumeEvents()}};
PTC.charting._getCheckboxValue=function(value){if(value)if(value==="on"||value==="true")return true;else return false;return false};PTC.charting._clearChartData=function(form,chartIndex){PTC.charting.checkBoxes.each(function(item){PTC.charting._clearCheckbox(item,form,chartIndex)});["yFieldPrevious","xFieldPrevious","chartTypePrevious","chartTitle","yFieldLabel","xFieldLabel","yField","xField"].each(function(item){PTC.charting._clearFormSetting(item,form,chartIndex)})};
PTC.charting._clearCheckbox=function(formFieldName,form,chartIndex){var formField=form.findField(formFieldName+chartIndex);if(formField){if(formField.disabled)formField.enable();formField.suspendEvents(false);formField.setValue(false);formField.resumeEvents();if(formFieldName=="showXAxisGrid"||formFieldName=="showLegend"||formFieldName=="showPieAsDonut"||formFieldName=="showLine"||formFieldName=="showRegressionLine"){formField.disable();var label=Ext.getCmp(formFieldName+"_Label"+chartIndex);label.disable()}}};
PTC.charting._clearFormSetting=function(formFieldName,form,chartIndex){var formField=form.findField(formFieldName+chartIndex);if(formField){if(formField.disabled)formField.enable();formField.suspendEvents(false);formField.setValue("");formField.resumeEvents()}};
PTC.charting._deleteSavedChartData=function(savedChartOid,chartIndex){var triggerItem=Ext.getCmp("triggerSaveChartName"+chartIndex);var loadMenu=Ext.getCmp("menuSaveChartName"+chartIndex);loadMenu.hide();Ext.Msg.show({title:bundleHandler.get("com.ptc.core.components.chart.chartResource.MESSAGE_TITLE_CONFIRM_DELETE"),msg:bundleHandler.getBundleStringAndInserts("com.ptc.core.components.chart.chartResource.MESSAGE_CONFIRM_DELETE",[PTC.charting._getSavedChartNameFromOid(savedChartOid)]),minWidth:600,
maxWidth:600,closable:false,buttons:{yes:bundleHandler.get("com.ptc.core.components.chart.chartResource.MESSAGE_CONFIRM_YES"),no:bundleHandler.get("com.ptc.core.components.chart.chartResource.MESSAGE_CONFIRM_NO")},icon:Ext.MessageBox.QUESTION,fn:function(buttonId){if(buttonId=="yes")Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/components/charts/deleteSavedChart.jsp",success:PTC.charting._processDeleteChartRequest,params:{savedChartOid:savedChartOid,chartIndex:chartIndex}})}})};
PTC.charting._getForm=function(chartIndex){var panel=Ext.getCmp("chartSettingsPanel"+chartIndex);if(panel)return Ext.getCmp("chartSettingsPanel"+chartIndex).getForm();return null};PTC.charting._getFormValue=function(chartIndex,formField){return PTC.charting._getForm(chartIndex).findField(formField+chartIndex).getValue()};PTC.charting._getFormfieldValue=function(chartIndex,formField,form){return form.findField(formField+chartIndex).getValue()};
PTC.charting._getFormfield=function(chartIndex,formField,form){return form.findField(formField+chartIndex)};
PTC.charting._processDeleteChartRequest=function(response,options){var responseJSON=Ext.util.JSON.decode(response.responseText.replace(/&quot;/g,'"'));var errorMessage=PTC.charting._checkForServerError(responseJSON);var triggerItem=Ext.getCmp("triggerSaveChartName"+options.params.chartIndex);var loadMenu=Ext.getCmp("menuSaveChartName"+options.params.chartIndex);var savedChartLoadedOid=PTC.charting._getFormValue(options.params.chartIndex,"savedChartLoadedOid");if(errorMessage){var title=bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVED_CHART_FAILED_TITLE");
showInlineMessage(title,errorMessage,"FAILURE")}else{var allItems=loadMenu.items;var removeItem=null;for(var i=0,len=allItems.length;i<len;i++){var mItem=allItems.get(i);if(mItem.id==options.params.savedChartOid){removeItem=mItem;var deleteIndex=-1;for(var j=0,len2=PTC.charting.savedChartNames.length;j<len2;j++)if(PTC.charting.savedChartNames[j][0]==mItem.data){deleteIndex=j;break}if(deleteIndex!=-1)PTC.charting.savedChartNames.splice(deleteIndex,1);break}}if(removeItem){if(savedChartLoadedOid==removeItem.id)triggerItem.reset();
loadMenu.remove(mItem)}}loadMenu.hide()};
PTC.charting._saveChartRequest=function(chartIndex,saveType){var form=PTC.charting._getForm(chartIndex);var chartName=PTC.charting._getFormfieldValue(chartIndex,"savedChartName",form);var chartTitle=PTC.charting._getFormfieldValue(chartIndex,"chartTitle",form);var savedReportOid=PTC.charting._getFormfieldValue(chartIndex,"savedReportOid",form);if(PTC.isDefinedAndNotEmptyString(savedReportOid)&&saveType=="save")Ext.Msg.show({title:bundleHandler.get("com.ptc.core.components.chart.chartResource.MESSAGE_TITLE_CONFIRM_MODIFY"),msg:bundleHandler.getBundleStringAndInserts("com.ptc.core.components.chart.chartResource.MESSAGE_CONFIRM_MODIFY"),
minWidth:600,maxWidth:600,closable:false,buttons:{yes:bundleHandler.get("com.ptc.core.components.chart.chartResource.MESSAGE_CONFIRM_YES"),no:bundleHandler.get("com.ptc.core.components.chart.chartResource.MESSAGE_CONFIRM_NO")},icon:Ext.MessageBox.QUESTION,fn:function(buttonId){if(buttonId=="yes")PTC.charting._completeSaveChartRequest(chartIndex,chartName,chartTitle,saveType)}});else PTC.charting._completeSaveChartRequest(chartIndex,chartName,chartTitle,saveType)};
PTC.charting._completeSaveChartRequest=function(chartIndex,chartName,chartTitle,saveType){if(saveType=="saveAs"){if(chartName==="")chartName=chartTitle;PTC.charting._createSaveChartDialog(chartIndex,chartName)}else if(chartName==="")PTC.charting._createSaveChartDialog(chartIndex,chartTitle);else PTC.charting._saveChartSettings(chartIndex,chartName,"save")};
PTC.charting._createSaveChartDialog=function(chartIndex,defaultText){var windowId="saveChartDialog";var OKButtonText=bundleHandler.get("com.ptc.core.components.chart.chartResource.OK_DIALOG_BUTTON");var duplicateErrorMessage=bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVED_CHART_DUPLICATE_NAME");var OKButton=new Ext.Button({text:OKButtonText,formBind:true,handler:function(button,event){var nameField=Ext.getCmp("newName");var newChartName=PTC.util.unescapeHTML(nameField.getValue().strip());
var dupFound=false;for(var i=0,len=PTC.charting.savedChartNames.length;i<len;i++){var nm=PTC.charting.savedChartNames[i][1].toLowerCase();if(PTC.charting.savedChartNames[i][1].toLowerCase()===newChartName.toLowerCase()){dupFound=true;break}}if(dupFound)nameField.markInvalid(duplicateErrorMessage);else{PTC.charting._saveChartSettings(chartIndex,newChartName,"saveAs");Ext.getCmp(windowId).close()}}});var cancelButtonText=bundleHandler.get("com.ptc.core.components.chart.chartResource.CANCEL_DIALOG_BUTTON");
var cancelButton=new Ext.Button({text:cancelButtonText,handler:function(button,event){Ext.getCmp(windowId).close()}});var label=bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVED_CHART_PROMPT_TEXT");var labelWidth=Ext.util.TextMetrics.createInstance(document.body).getWidth(label)+30;var maxLabelWidth=120;var extraWindowWidth=0;if(labelWidth>120){extraWindowWidth=labelWidth-120;maxLabelWidth=labelWidth}var lightboxConfig={windowId:windowId,formId:"saveChartForm",defaultFieldValue:defaultText,
maxLabelWidth:maxLabelWidth,fieldWidth:325,windowWidth:480+extraWindowWidth,OKButton:OKButton,cancelButton:cancelButton,promptText:label,promptTitle:bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVED_CHART_PROMPT_TITLE"),charsExceededMessage:bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVED_CHART_CHARS_EXCEEDED"),blankTextMessage:bundleHandler.get("com.ptc.core.components.chart.chartResource.SAVED_CHART_NAME_EMPTY"),maxLengthField:60};var win=PTC.lightbox.createSimpleLightBoxWindowAndFormFromConfig(lightboxConfig);
win.show()};PTC.charting._processFailedRequest=function(){alert("Error processing ajax request")};PTC.charting._processDataSelection=function(combo,dataType,index){var form=PTC.charting._getForm(index);var axis=combo.getId();if(axis=="yField"+index)form.findField("yFieldDataType"+index).setValue(dataType);else form.findField("xFieldDataType"+index).setValue(dataType);PTC.charting._manageChartButtons(index,true)};
PTC.charting._manageChartButtons=function(index,setDefaultChart){var form=PTC.charting._getForm(index);var yField=form.findField("yField"+index).getValue();var yFieldDataType=form.findField("yFieldDataType"+index).getValue();var xField=form.findField("xField"+index).getValue();var xFieldDataType=form.findField("xFieldDataType"+index).getValue();var chartType=form.findField("chartType"+index).getValue();var chartTypePrevious=form.findField("chartTypePrevious"+index).getValue();var xAxisField=Ext.getCmp("xField"+
index);if(xAxisField.disabled){xAxisField.enable();var label=Ext.getCmp("xFieldComboLabel"+index);label.enable()}var singleVariable=false;var multiVariable=false;if(yField===""&&xField!==""){singleVariable=true;dataType=xFieldDataType}else if(yField!==""&&xField===""){singleVariable=true;dataType=yFieldDataType}else if(yField!==""&&xField!=="")multiVariable=true;if(singleVariable&&(dataType=="string"||dataType=="number")){PTC.charting._disableMultiVariableButtons(index);["column","bar","pie","pareto",
"line"].each(function(item){PTC.charting._enableChartButton(item,index)});PTC.charting._disableChartButton("aging",index);if(dataType=="number"){PTC.charting._enableChartButton("histogram",index);PTC.charting._enableChartButton("histogram_horz",index);if(setDefaultChart)if(chartTypePrevious===""||chartTypePrevious!="column"+index&&chartTypePrevious!="bar"+index&&chartTypePrevious!="pie"+index&&chartTypePrevious!="pareto"+index&&chartTypePrevious!="line"+index&&chartTypePrevious!="histogram_horz"+
index&&chartTypePrevious!="histogram"+index){Ext.getCmp("histogram"+index).toggle(true);PTC.charting._setChartType(Ext.getCmp("histogram"+index))}else PTC.charting._setChartType(Ext.getCmp(chartTypePrevious))}else{PTC.charting._disableChartButton("histogram",index);PTC.charting._disableChartButton("histogram_horz",index);if(setDefaultChart)if(chartTypePrevious===""||chartTypePrevious!="column"+index&&chartTypePrevious!="bar"+index&&chartTypePrevious!="pie"+index&&chartTypePrevious!="pareto"+index&&
chartTypePrevious!="line"+index){Ext.getCmp("column"+index).toggle(true);PTC.charting._setChartType(Ext.getCmp("column"+index))}else PTC.charting._setChartType(Ext.getCmp(chartTypePrevious))}}else if(singleVariable&&dataType=="date"){PTC.charting._disableMultiVariableButtons(index);["histogram","histogram_horz"].each(function(item){PTC.charting._enableChartButton(item,index)});["column","bar","pie","pareto","line","aging"].each(function(item){PTC.charting._disableChartButton(item,index)});if(setDefaultChart)if(chartTypePrevious===
""||chartTypePrevious!="histogram"+index&&chartTypePrevious!="histogram_horz"+index&&chartTypePrevious!="aging"+index){Ext.getCmp("histogram"+index).toggle(true);PTC.charting._setChartType(Ext.getCmp("histogram"+index))}}else if(multiVariable){PTC.charting._disableSingleVariableButtons(index);var yFieldCategorical=false;var xFieldCategorical=false;if(yFieldDataType=="string"||yFieldDataType=="number")yFieldCategorical=true;if(xFieldDataType=="string"||xFieldDataType=="number")xFieldCategorical=true;
if(yFieldCategorical&&xFieldCategorical){["columnstacked","barstacked","columnclustered"].each(function(item){PTC.charting._enableChartButton(item,index)});if(yFieldDataType=="number"||xFieldDataType=="number")PTC.charting._disableChartButton("scattergroup",index);else PTC.charting._disableChartButton("scattergroup",index);if(yFieldDataType=="number"&&xFieldDataType=="number")PTC.charting._disableChartButton("scatterplot",index);else PTC.charting._disableChartButton("scatterplot",index)}else{PTC.charting._disableMultiVariableButtons(index);
PTC.charting._displayErrorMessage("MESSAGE_CHART_NOT_AVAILABLE",index);return}if(setDefaultChart)if(yFieldDataType=="number"&&xFieldDataType=="number"&&(chartTypePrevious===""||chartTypePrevious!="columnstacked"+index&&chartTypePrevious!="barstacked"+index&&chartTypePrevious!="columnclustered"+index&&chartTypePrevious!="scattergroup"+index)){Ext.getCmp("columnstacked"+index).toggle(true);PTC.charting._setChartType(Ext.getCmp("columnstacked"+index))}else if((yFieldDataType=="number"||xFieldDataType==
"number")&&(chartTypePrevious===""||chartTypePrevious!="columnstacked"+index&&chartTypePrevious!="barstacked"+index&&chartTypePrevious!="columnclustered"+index)){Ext.getCmp("columnstacked"+index).toggle(true);PTC.charting._setChartType(Ext.getCmp("columnstacked"+index))}else if(yFieldCategorical&&xFieldCategorical&&(chartTypePrevious===""||chartTypePrevious!="columnstacked"+index&&chartTypePrevious!="barstacked"+index&&chartTypePrevious!="columnclustered"+index)){Ext.getCmp("columnstacked"+index).toggle(true);
PTC.charting._setChartType(Ext.getCmp("columnstacked"+index))}}};PTC.charting._disableSingleVariableButtons=function(index,chartType){["column","bar","pie","pareto","line","histogram","histogram_horz","aging"].each(function(item){PTC.charting._disableChartButton(item,index)})};PTC.charting._disableMultiVariableButtons=function(index,chartType){["columnstacked","barstacked","columnclustered","scattergroup","scatterplot"].each(function(item){PTC.charting._disableChartButton(item,index)})};
PTC.charting._disableSingleVariableButtons=function(index,chartType){["column","bar","pie","pareto","line","histogram","histogram_horz","aging"].each(function(item){PTC.charting._disableChartButton(item,index)})};
PTC.charting._setAxisLabels=function(chartConfig,previousChartType,dataChanged,chartTypeChanged){var form=PTC.charting._getForm(chartConfig.chartIndex);var chartType=chartConfig.chartType;var horizontalLabel=PTC.charting._getFormfield(chartConfig.chartIndex,"xFieldLabel",form);var verticalLabel=PTC.charting._getFormfield(chartConfig.chartIndex,"yFieldLabel",form);var chartTitleLabel=PTC.charting._getFormfield(chartConfig.chartIndex,"chartTitle",form);var chartTitleDivider=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.CHART_TITLE_DIVIDER"));
var count=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.AXES_LABEL_COUNT"));var range=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.AXES_LABEL_RANGE"));var percentage=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource.AXES_LABEL_PERCENTAGE"));if(dataChanged===true){if(chartType=="histogram"||chartType=="histogram_horz")horizontalLabel.setValue(chartConfig.yField+" "+range);else if(chartType!==
"pie")horizontalLabel.setValue(chartConfig.yField);if(chartType=="columnstacked"||chartType=="columnclustered"||chartType=="barstacked")chartTitleLabel.setValue(chartConfig.yField+" "+chartTitleDivider+" "+chartConfig.xField);else chartTitleLabel.setValue(chartConfig.yField)}if(dataChanged===true||chartTypeChanged===true)if(chartType=="pareto")verticalLabel.setValue(percentage);else verticalLabel.setValue(count);chartConfig.xFieldLabel=horizontalLabel.getValue();chartConfig.yFieldLabel=verticalLabel.getValue();
chartConfig.chartTitle=chartTitleLabel.getValue();return chartConfig};
PTC.charting._setChartOptions=function(chartType,index){if(chartType=="column"||chartType=="bar"||chartType=="pareto"||chartType=="histogram"||chartType=="histogram_horz"||chartType=="scattergroup"||chartType=="aging"||chartType=="line"){["showXAxisGrid","showYAxisGrid","horizontalAxisLabels"].each(function(item){PTC.charting._enableChartOption(item,index)});["showLegend","showPieAsDonut","showRegressionLine","showLine"].each(function(item){PTC.charting._disableChartOption(item,index)});if(chartType!=
"bar"&&chartType!="histogram_horz")PTC.charting._enableChartOption("horizontalAxisLabels",index);else PTC.charting._disableChartOption("horizontalAxisLabels",index);if(chartType!="aging")PTC.charting._disableChartOption("agingChartUnits",index);else PTC.charting._enableChartOption("agingChartUnits",index);if(chartType!="histogram"&&chartType!="histogram_horz")PTC.charting._enableChartOption("displayValueCount",index);else PTC.charting._disableChartOption("displayValueCount",index)}else if(chartType==
"pie"){["showXAxisGrid","showYAxisGrid","horizontalAxisLabels","showRegressionLine","showLine","agingChartUnits"].each(function(item){PTC.charting._disableChartOption(item,index)});PTC.charting._enableChartOption("showLegend",index);PTC.charting._enableChartOption("showPieAsDonut",index)}else if(chartType=="columnstacked"||chartType=="barstacked"||chartType=="columnclustered"){["showXAxisGrid","showYAxisGrid","horizontalAxisLabels","showLegend"].each(function(item){PTC.charting._enableChartOption(item,
index)});["showPieAsDonut","showRegressionLine","showLine","agingChartUnits"].each(function(item){PTC.charting._disableChartOption(item,index)});if(chartType=="barstacked")PTC.charting._disableChartOption("horizontalAxisLabels",index)}else if(chartType=="scatterplot"){["showXAxisGrid","showYAxisGrid","horizontalAxisLabels","showRegressionLine","showLine"].each(function(item){PTC.charting._enableChartOption(item,index)});["showLegend","showPieAsDonut","agingChartUnits"].each(function(item){PTC.charting._disableChartOption(item,
index)})}};PTC.charting._enableChartButton=function(chartType,index){var button=Ext.getCmp(chartType+index);if(button&&button.disabled===true){var iconName="netmarkets/images/charts/chart_"+chartType+".png";button.enable();button.setIcon(iconName)}};PTC.charting._disableChartButton=function(chartType,index){var button=Ext.getCmp(chartType+index);if(button&&button.disabled===false){var iconName="netmarkets/images/charts/chart_"+chartType+"_disabled.png";button.disable();button.setIcon(iconName);if(button.pressed)button.toggle(false)}};
PTC.charting._enableChartOption=function(optionName,index){var option=Ext.getCmp(optionName+index);if(option&&option.disabled===true)option.enable();var label=Ext.getCmp(optionName+"_Label"+index);if(label&&label.disabled===true)label.enable()};PTC.charting._disableChartOption=function(optionName,index){var option=Ext.getCmp(optionName+index);if(option&&option.disabled===false){option.disable();var label=Ext.getCmp(optionName+"_Label"+index);label.disable()}};
PTC.charting._findIndex=function(array,value){var ctr="";for(var i=0,l=array.length;i<l;i++)if(array[i]==value)return i;return ctr};
PTC.charting._getMaxValue=function(dataArray,numericField){var max=0;var i;var chartData=Ext.util.JSON.decode(dataArray);if(numericField.length==1)for(i=0,l=chartData.length;i<l;i++){if(!isNaN(chartData[i][numericField])&&chartData[i][numericField]>max)max=chartData[i][numericField]}else for(i=0,l=chartData.length;i<l;i++){var rowMax=0;for(var j=0,k=numericField.length;j<k;j++)if(!isNaN(chartData[i][numericField[j]]))rowMax=rowMax+chartData[i][numericField[j]];if(rowMax>max)max=rowMax}return max};
PTC.charting._formatErrorMessage=function(errorMsgId,chartConfig){PTC.charting._displayErrorMessage(errorMsgId,chartConfig.chartIndex,chartConfig.chartDivId)};
PTC.charting._displayErrorMessage=function(errorMsgId,chartIndex,chartDiv){if(!chartDiv)chartDiv="chartingDiv"+chartIndex;div=document.getElementById(chartDiv);if(div!==null)div.innerHTML="";var messageText=PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource."+errorMsgId));var errorMessageHtml="<br/><img src='netmarkets/images/warning_16x16.gif' border='0'>&nbsp;&nbsp;&nbsp;"+messageText;var errorMsg=new Ext.Container({border:0,id:"chartPanel"+chartIndex,renderTo:chartDiv,
items:[{cls:"msgLabel",html:errorMessageHtml}]})};PTC.charting._displayLoadingIcon=function(chartIndex,chartDiv){if(!chartDiv)chartDiv="chartingDiv"+chartIndex;var div=document.getElementById(chartDiv);if(div!==null){div.innerHTML="";var divHtml='<div id="'+chartDiv+'" style="height: 500px"></div>';var divContent=new Ext.Container({border:0,cls:"contentloading",id:"chartPanel"+chartIndex,renderTo:chartDiv,items:[{html:divHtml}]})}};
PTC.charting._formatPageMessage=function(messageTitleId,messageId,messageType){var messageTitle=bundleHandler.get(messageTitleId);var message=bundleHandler.get(messageId);var msgObject=[{MessageTitle:messageTitle,Messages:[message],MessageType:messageType}];PTC.messaging.showInlineMessage(msgObject)};
PTC.charting._getErrorMessageHtml=function(errorMsgId){return"<br/><br/><img src='netmarkets/images/warning_16x16.gif' border='0'>&nbsp;&nbsp;&nbsp;"+PTC.util.unescapeHTML(bundleHandler.get("com.ptc.core.components.chart.chartResource."+errorMsgId))};PTC.charting._stringLabelRenderer=function(label){if(!label)return"";else return Ext.util.Format.ellipsis(label,25,false)};
PTC.charting._getChartItem=function(chartConfig,dataStore,colorPalette){var series=null;var chartIndex=chartConfig.chartIndex;var axisLabelFont=null;var axisLabelTitleFont=null;var axisTitleFont=null;var legendFont=null;var dataLabelFont=null;if(chartConfig.fontSize=="FONT_SIZE_LARGE"){axisLabelFont="13px Arial";axisLabelTitleFont="bold 14px Arial";axisTitleFont="bold 16px Arial";legendFont="13px Arial";dataLabelFont="13px Arial"}else if(chartConfig.fontSize=="FONT_SIZE_MEDIUM"){axisLabelFont="11px Arial";
axisLabelTitleFont="bold 12px Arial";axisTitleFont="bold 14px Arial";legendFont="11px Arial";dataLabelFont="11px Arial"}else{axisLabelFont="9px Arial";axisLabelTitleFont="bold 11px Arial";axisTitleFont="bold 12px Arial";legendFont="9px Arial";dataLabelFont="9px Arial"}var chartItemId="chartItem"+chartIndex;if(chartConfig.showChartInline==="true")chartItemId=chartItemId+"inline";var chartItem={flex:1,xtype:"chart",id:chartItemId,store:dataStore,theme:"WindchillChart",resizable:false,shadow:true,animate:true};
if(chartConfig.showBackground){var backgroundConfig={background:{fill:"#F2F2F2"}};Ext.apply(chartItem,backgroundConfig)}var axesConfig=PTC.charting._getChartAxes(chartConfig,axisLabelFont,axisLabelTitleFont,axisTitleFont);Ext.apply(chartItem,axesConfig);var seriesConfig=PTC.charting._getChartSeries(chartConfig,dataStore,colorPalette,dataLabelFont);Ext.apply(chartItem,seriesConfig);if((chartConfig.chartType=="pie"||chartConfig.chartType=="columnstacked"||chartConfig.chartType=="barstacked"||chartConfig.chartType==
"columnclustered")&&chartConfig.showLegend){var legendConfig={legend:{position:"right",visible:true,labelFont:legendFont,itemSpacing:2,padding:1}};Ext.apply(chartItem,legendConfig)}return chartItem};
PTC.charting._getChartSeries=function(chartConfig,dataStore,colorPalette,dataLabelFont){var seriesConfig=null;var highlightFillColor="#a2b5ca";var displayFields=null;if(chartConfig.chartType=="pie"){seriesConfig={series:[{type:"pie",field:"yData",showInLegend:chartConfig.showLegend,highlight:{segment:{margin:8},lineWidth:3,stroke:"#000"},listeners:{itemmousedown:function(item){PTC.charting._selectTableRows(chartConfig.tableId,item.storeItem.get("xData"),chartConfig.yField)}}}]};if(chartConfig.showPieAsDonut){var donutConfig=
{donut:30};Ext.apply(seriesConfig.series[0],donutConfig)}}else if(chartConfig.chartType=="column")seriesConfig={series:[{type:"column",column:true,xField:"xData",yField:"yData",xPadding:0,yPadding:1,highlight:true,highlightCfg:{lineWidth:3,stroke:"#000"},renderer:function(sprite,storeItem,barAttr,i,store){barAttr.fill=colorPalette[i%colorPalette.length];return barAttr},listeners:{itemmousedown:function(item){PTC.charting._selectTableRows(chartConfig.tableId,item.storeItem.get("xData"),chartConfig.yField)}}}]};
else if(chartConfig.chartType=="histogram")seriesConfig={series:[{type:"column",column:true,xField:"xData",yField:"yData",gutter:3,xPadding:25,yPadding:1,highlight:true,highlightCfg:{lineWidth:3,stroke:"#000"},renderer:function(sprite,storeItem,barAttr,i,store){barAttr.fill=colorPalette[i%colorPalette.length];return barAttr}}]};else if(chartConfig.chartType=="histogram_horz")seriesConfig={series:[{type:"bar",axis:"bottom",column:false,xField:"xData",yField:["yData"],gutter:4,xPadding:0,yPadding:25,
highlight:true,highlightCfg:{lineWidth:3,stroke:"#000"},renderer:function(sprite,storeItem,barAttr,i,store){barAttr.fill=colorPalette[i%colorPalette.length];return barAttr}}]};else if(chartConfig.chartType=="bar")seriesConfig={series:[{type:"bar",axis:"bottom",column:false,xField:"xData",yField:["yData"],xPadding:1,yPadding:0,highlight:true,highlightCfg:{lineWidth:3,stroke:"#000"},renderer:function(sprite,storeItem,barAttr,i,store){barAttr.fill=colorPalette[i%colorPalette.length];return barAttr},
listeners:{itemmousedown:function(item){PTC.charting._selectTableRows(chartConfig.tableId,item.storeItem.get("xData"),chartConfig.yField)}}}]};else if(chartConfig.chartType=="pareto")seriesConfig={series:[{type:"column",column:true,xField:"xData",yField:"yData",gutter:3,xPadding:0,yPadding:1,highlight:true,highlightCfg:{lineWidth:3,stroke:"#000"},renderer:function(sprite,storeItem,barAttr,i,store){barAttr.fill=colorPalette[i%colorPalette.length];return barAttr},listeners:{itemmousedown:function(item){PTC.charting._selectTableRows(chartConfig.tableId,
item.storeItem.get("xData"),chartConfig.yField)}}},{type:"line",axis:"left",smooth:true,xField:"xData",yField:"yData2",markerConfig:{type:"circle",size:4}}]};else if(chartConfig.chartType=="line")seriesConfig={series:[{type:chartConfig.chartType,xField:"xData",yField:"yData",axis:"left",fill:true,markerCfg:{type:"circle",size:3,radius:3,"stroke-width":0},listeners:{itemmousedown:function(item){PTC.charting._selectTableRows(chartConfig.tableId,item.storeItem.get("xData"),chartConfig.yField)}}}]};else if(chartConfig.chartType==
"columnstacked"||chartConfig.chartType=="barstacked"||chartConfig.chartType=="columnclustered"){displayFields=PTC.charting._getFieldsFromChartData(Ext.util.JSON.decode(chartConfig.chartData),false);var series_colors=new Array(displayFields.length);var type="column";var stacked=true;if(chartConfig.chartType=="barstacked")type="bar";else if(chartConfig.chartType=="columnclustered")stacked=false;seriesConfig={series:[{type:type,axis:"left",xField:"xData",yField:displayFields,showInLegend:chartConfig.showLegend,
stacked:stacked,listeners:{afterrender:function(){for(var i=0,l=displayFields.length;i<=l;i++)series_colors[i]=this.getLegendColor(i)},itemmousedown:function(item){var index=PTC.charting._findIndex(series_colors,item.attr.fill);PTC.charting._selectTableRows(chartConfig.tableId,displayFields[index],chartConfig.yField)}},highlightCfg:{lineWidth:3,stroke:"#000"}}]}}if(chartConfig.showTooltips===true){var tooltipConfig=null;if(chartConfig.chartType=="pie"||chartConfig.chartType=="column"||chartConfig.chartType==
"histogram"||chartConfig.chartType=="histogram_horz"||chartConfig.chartType=="bar"||chartConfig.chartType=="line")tooltipConfig={tips:{trackMouse:true,anchorToTarget:true,hideDelay:0,showDelay:0,width:500,height:40,border:"0",renderer:function(storeItem,item){var total=0;dataStore.each(function(rec){total+=rec.get("yData")});this.setTitle(Math.round(storeItem.get("yData")/total*100)+"% "+" "+storeItem.get("xData"))}}};else if(chartConfig.chartType=="pareto")tooltipConfig={tips:{trackMouse:true,anchorToTarget:true,
hideDelay:0,showDelay:0,width:500,height:20,renderer:function(storeItem,item){this.setTitle(Math.round(storeItem.get("yData")*100)+"% "+" "+storeItem.get("xData"))}}};else if(chartConfig.chartType=="columnstacked"||chartConfig.chartType=="barstacked"||chartConfig.chartType=="columnclustered")tooltipConfig={tips:{trackMouse:true,anchorToTarget:true,hideDelay:0,showDelay:0,width:500,height:20,renderer:function(storeItem,item){var index=PTC.charting._findIndex(series_colors,item.attr.fill);this.update("<b>"+
displayFields[index]+"</b> - "+String(item.value[1]))}}};Ext.apply(seriesConfig.series[0],tooltipConfig)}if(chartConfig.showDataLabels===true){var labelConfig=null;var labelDisplay="outside";var labelField="yData";var labelContrast=false;var renderer=function(v){return v};if(chartConfig.chartType=="column"||chartConfig.chartType=="histogram"||chartConfig.chartType=="histogram_horz"||chartConfig.chartType=="bar")renderer=Ext.util.Format.numberRenderer("0");else if(chartConfig.chartType=="pie"){labelDisplay=
"rotate";labelField="xData";labelContrast=true;renderer=function(v){return PTC.charting._stringLabelRenderer(v)}}else if(chartConfig.chartType=="pareto")renderer=function(v){return Math.round(v*100)+"% "};else if(chartConfig.chartType=="columnstacked"||chartConfig.chartType=="barstacked"||chartConfig.chartType=="columnclustered"){labelField=displayFields;labelDisplay="middle";if(chartConfig.chartType=="columnclustered")labelDisplay="outside";renderer=function(v){if(!v||v<1)return"";else return v}}labelConfig=
{label:{field:labelField,minMargin:10,contrast:labelContrast,font:dataLabelFont,renderer:renderer,display:labelDisplay,orientation:"horizontal","text-anchor":"middle"}};Ext.apply(seriesConfig.series[0],labelConfig)}else if(chartConfig.showLegend&&(chartConfig.chartType=="pie"||chartConfig.chartType=="columnstacked"||chartConfig.chartType=="barstacked"||chartConfig.chartType=="columnclustered")){renderer=function(v){return PTC.charting._stringLabelRenderer(v)};if(chartConfig.chartType=="pie")labelField=
"xData";else labelField=displayFields;labelConfig={label:{field:labelField,renderer:renderer,display:"none"}};Ext.apply(seriesConfig.series[0],labelConfig)}return seriesConfig};
PTC.charting._getChartAxes=function(chartConfig,axisLabelFont,axisLabelTitleFont,axisTitleFont){var axesConfig=null;var rotateLabelDegrees=270;if(chartConfig.horizontalAxisLabels)rotateLabelDegrees=0;var numericField=["yData"];var numericPosition="left";var numericTitle=chartConfig.yFieldLabel;var numericGrid=chartConfig.showYAxisGrid;var numberFormat="0,0";var categoryField="xData";var categoryPosition="bottom";var categoryTitle=chartConfig.xFieldLabel;var categoryGrid=chartConfig.showXAxisGrid;
var labelFillColor="#FFFFFF";var labelStrokeColor="#FFFFFF";if(chartConfig.showBackground){labelFillColor="#F2F2F2";labelStrokeColor="#F2F2F2"}if(chartConfig.chartType=="bar"||chartConfig.chartType=="histogram_horz"||chartConfig.chartType=="barstacked"){rotateLabelDegrees=0;numericPosition="bottom";categoryPosition="left";if(chartConfig.chartType=="barstacked")numericField=PTC.charting._getFieldsFromChartData(Ext.util.JSON.decode(chartConfig.chartData),false)}else if(chartConfig.chartType=="pareto")numberFormat=
"0.00";else if(chartConfig.chartType=="columnstacked"||chartConfig.chartType=="barstacked"||chartConfig.chartType=="columnclustered")numericField=PTC.charting._getFieldsFromChartData(Ext.util.JSON.decode(chartConfig.chartData),false);if((chartConfig.chartTitle===null||chartConfig.showChartInline==="true")&&chartConfig.chartType!="pie")axesConfig={axes:[{type:"Numeric",minimum:0,position:numericPosition,fields:numericField,title:numericTitle,grid:numericGrid,labelTitle:{font:axisLabelTitleFont},label:{font:axisLabelFont,
renderer:Ext.util.Format.numberRenderer(numberFormat)}},{type:"Category",position:categoryPosition,fields:[categoryField],grid:categoryGrid,title:categoryTitle,calculateCategoryCount:false,labelTitle:{font:axisLabelTitleFont},label:{font:axisLabelFont,rotate:{degrees:rotateLabelDegrees},renderer:function(v){return PTC.charting._stringLabelRenderer(v)}}}]};else if(chartConfig.chartType!="pie")axesConfig={axes:[{type:"Numeric",minimum:0,position:numericPosition,fields:numericField,title:numericTitle,
grid:numericGrid,labelTitle:{font:axisLabelTitleFont},label:{font:axisLabelFont,renderer:Ext.util.Format.numberRenderer(numberFormat)}},{type:"Category",position:categoryPosition,fields:[categoryField],grid:categoryGrid,title:categoryTitle,calculateCategoryCount:false,labelTitle:{font:axisLabelTitleFont},label:{font:axisLabelFont,rotate:{degrees:rotateLabelDegrees},renderer:function(v){return PTC.charting._stringLabelRenderer(v)}}},{type:"Numeric",position:"top",fields:numericField,title:chartConfig.chartTitle,
dashSize:0,labelTitle:{font:axisTitleFont},label:{fill:labelFillColor,stroke:labelFillColor,font:"7px Arial"},axisStyle:{fill:labelFillColor,stroke:labelFillColor}}]};else if(chartConfig.showChartInline=="false")axesConfig={axes:[{type:"Numeric",position:"top",fields:["yData"],title:chartConfig.chartTitle,dashSize:0,labelTitle:{font:axisTitleFont},label:{fill:labelFillColor,stroke:labelFillColor,font:"7px Arial"},axisStyle:{fill:labelFillColor,stroke:labelFillColor}}]};if(chartConfig.chartType!="pie"&&
chartConfig.chartType!="pareto"){var maxNumericValue=PTC.charting._getMaxValue(chartConfig.chartData,numericField);var axisConfigAddition;if(maxNumericValue>0&&maxNumericValue<11){axisConfigAddition={majorTickSteps:maxNumericValue-1,maximum:maxNumericValue};Ext.apply(axesConfig.axes[0],axisConfigAddition)}if(chartConfig.chartType=="histogram"){axisConfigAddition={dashSize:0};Ext.apply(axesConfig.axes[1],axisConfigAddition)}else if(chartConfig.chartType=="histogram_horz"){axisConfigAddition={dashSize:0};
Ext.apply(axesConfig.axes[1],axisConfigAddition)}}return axesConfig};function getClipboardItemsHelper(choice){var url;if(choice==="latest")url="netmarkets/jsp/object/getLatestClipboardItems.jsp";else if(choice==="selected")url="netmarkets/jsp/object/getSelectedClipboardItems.jsp";else url="netmarkets/jsp/object/getClipboardItems.jsp";var options={asynchronous:false,parameters:"oid="};var transport=requestHandler.doRequest(url,options);return transport.responseText}
function getClipboardItems(){return getClipboardItemsHelper("")}function getLatestClipboardItems(){return getClipboardItemsHelper("latest")}function getSelectedClipboardItems(){return getClipboardItemsHelper("selected")}PTC.copyPageAction={};
function copyObjectMainAll(fe,copyurl,copyelements,isDCA,alertMessage,noneSelectMessage,skipCount,unselectwhendone,dontDecode,skipValidation){var soid=[];if(!copyelements)copyelements=getSelectedItems();var alength=copyelements.length;for(var i=0;i<alength;i++){var copyelement=copyelements[i];if(copyelement.checked&&copyelement.name.indexOf("select_all")<0&&copyelement.value!="select_all"&&copyelement.name!="checkbox3"){var param=new P;param.n="soid";if(isDCA)param.v=requestHandler.processDCAInputValue(copyelement);
else param.v=copyelement.value;soid.push(param)}}paramurl=buildStringParam(soid);if(copyurl.indexOf("soid")<=0&&paramurl.length<1)if(noneSelectMessage)wfalert(noneSelectMessage);else wfalert("Nothing Selected.");else{var evt;if(isIE)evt=event;else evt=null;if(skipValidation||callAJAXValidation("copy"))postToUrl(fe,copyurl,paramurl,false,alertMessage,skipCount,noneSelectMessage,isDCA,unselectwhendone,dontDecode)}}
PTC.copyPageAction.onclick=function(url,event){var copyMessage=bundleHandler.get("com.ptc.netmarkets.util.utilResource.COPY_PAGE_MESSAGE");var pageUrl=window.location.href;url=getBaseHref()+url;var params=[];var dTitle=document.title;if(!dTitle||dTitle.length<=0)dTitle="Windchill";else dTitle=getUnescapedText(dTitle);params.push("title",dTitle);var soidValue;var mform=getMainForm();if(mform&&mform.sv_current_name){var svParams=[mform.sv_current_name.value,mform.sv_current_value.value];soidValue=requestHandler.addURIParams(pageUrl,
svParams,true)}else soidValue=pageUrl;params.push("soid",soidValue);var tlnType=mform.tlnType;var tlnAction=mform.tlnAction;if(tlnType&&tlnAction){params.push("tlnType",tlnType.value);params.push("tlnAction",tlnAction.value)}var copyurl=requestHandler.addURIParams(url,params,true);var skipValidation=true;copyObjectMainAll(mform,copyurl,null,false,copyMessage,null,true,true,true,skipValidation);Event.stop(event);return false};
function multiSelectObjects(mform){var baseurl=document.getElementsByTagName("base")[0].href;var copyurl=baseurl+"netmarkets/jsp/object/list_copy.jsp?multiSelect=true";if(!mform)mform=getMainForm();copyObjectMainAll(mform,copyurl,getSelectedItems(),false,null,null,true,false,false,true)}function copyObjectMain(fe,copyurl,alertMessage){copyObjectMainAll(fe,copyurl,fe.elements,true,alertMessage,false,true,false)}
function getSelectedObjectsExternal(copyelements){var result=[];if(!copyelements)copyelements=getSelectedItems();if(copyelements){var alength=copyelements.length;for(var i=0;i<alength;i++){var copyelement=copyelements[i];if(copyelement.checked&&copyelement.name.indexOf("select_all")<0&&copyelement.value!="select_all"&&copyelement.name!="checkbox3"&&(copyelement.type=="checkbox"||copyelement.type=="radio")){var param=new P;param.n="soid";param.v=copyelement.value;result.push(param)}}}return result}
function isRBEntryKey(alertMessage){var isKey=false;if(alertMessage){var alertText=alertMessage.trim();if(!alertText.startsWith("[")&&alertMessage.indexOf(".")>0&&!alertText.endsWith("."))isKey=true}return isKey}
function showCBMess(showCBMessage,alertMessage,num,skipCount,noneMessage){if(skipCount||skipCount===false)if(num<=0)num=1;if(skipCount===true)num="";if(showCBMessage&&alertMessage)if(isRBEntryKey(alertMessage)){var myarr=[];myarr[0]=num;var message=bundleHandler.getBundleStringAndInserts(alertMessage,myarr);var messageTitle="";if(alertMessage.indexOf(".COPY_SUCCESS_MSG")>0)messageTitle=bundleHandler.get("com.ptc.netmarkets.util.utilResource.COPY_SUCCESS_MSG_TITLE");else if(alertMessage.indexOf(".CUT_SUCCESS_MSG")>
0)messageTitle=bundleHandler.get("com.ptc.netmarkets.util.utilResource.CUT_SUCCESS_MSG_TITLE");var msgObject=[{MessageTitle:messageTitle,Messages:[message],MessageType:"SUCCESS"}];PTC.messaging.showInlineMessage(msgObject)}else{if(!skipCount||skipCount===false)alertMessage=alertMessage.replace("{0}",num);wfalert_gen(alertMessage)}}var is_ie=Ext.isIE;var is_nav=!is_ie;function launchUtilityWindow(linkText,winName,props){wfWindowOpen(linkText,winName,props)}
function getSearchResult(ufid){var mform=getMainForm();JCAappendFormHiddenInput(mform,"url_oid",ufid);PTC.navigation.submitForm()}function doCut(evt){var retValue=onClickValidation(evt,"list_cut");if(retValue){var tableid=tableUtils.findTableID(evt);var sels=getJCASelectedTableItems(tableid);var sels_length=sels.length;for(var i=0;i<sels_length;i++)tableUtils.addRowStyle(tableid,sels[i].value,"cp_cut")}return retValue}
function doCutAction(evt){var retValue=onClickValidation(evt,"cut");if(retValue){var mform=getMainForm();var contextString=getCurrentActionContextString();var tableid=tableUtils.findTableID(evt);tableUtils.addRowStyle(tableid,contextString,"cp_cut")}return retValue}function highlightInputByOid(oid){if(!oid)oid=extractParamValue(document.location.href,"oid");oid=unescape(oid);highlightTreeRow(oid)}
jsca.columns.comboBoxRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);var oid=data.oid||getRowItem(row).oid;if(data.enabled){if(typeof row.get==="function"){var jsca_column=row.get(column.id);if(jsca_column)jsca_column.updateCellValue=jsca.columns.comboBoxRenderer.updateCellValue}result="<select ";if(data.id)result+=jsca.columns.idStr(data.id);if(data.multiSelect)result+="multiple ";if(data.size)result+=jsca.columns.sizeStr(data.size);result+=jsca.columns.nameStr(data.name)+
(data.disabled?"disabled ":"");if(data.tooltip)result+=jsca.columns.tooltipStr(data.tooltip);result+=jsca.columns.jsActionsStr(data.jsActions);result+=data.styleClasses;result+="/>";var i=0;var size=0;if(data&&data.options&&data.options.length)size=data.options.length;for(i=0;i<size;i++){result+="<option "+jsca.columns.idStr(data.options[i].id);if(data.options[i].selected)result+="selected ";result+='value="'+data.options[i].intVal+'">'+data.options[i].dispVal+"</option>"}result+="</select>";for(i=
0;i<size;i++)if(data.options[i].selected)result+='<input type="hidden" '+jsca.columns.idStr(data.id+jsca.columns.OLDSTR)+jsca.columns.nameStr(data.name+jsca.columns.OLDSTR)+jsca.columns.valueStr(data.options[i].intVal)+"/>"}else for(i=0;i<size;i++)if(data.options[i].selected)result+=data.options[i].dispVal+"<br />";result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};
jsca.columns.comboBoxRenderer.updateCellValue=function(cell,value){if(cell.gui&&cell.gui.options){var select_options_length=cell.gui.options.length;for(var i=0;i<select_options_length;i++)if(cell.gui.options[i].intVal===value){cell.gui.options[i].selected=true;cell.gui.comparable=value}else cell.gui.options[i].selected=false}};jsca.columns.comboBoxRenderer.searchFunc=function(table,column,row){return PTC.util.unescapeHTML(jsca.columns.comboBoxRenderer.exportRenderer(table,column,row))};
jsca.columns.comboBoxRenderer.exportRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);var optionsCount=data.options.length;for(i=0;i<optionsCount;i++)if(data.options[i].selected)result+=data.options[i].dispVal+" ";return result};Ext.ns("PTC.console");PTC.console.setConsoleInterval=function(ccurl){ccurl=getBaseHref()+PTC.navigation.getTokenFromUrl(ccurl);PTC.console.url=ccurl;PTC.console.consoleIntervalId=setInterval(PTC.console.checkConsole,3E5)};
PTC.console.clearInterval=function(id){clearInterval(id)};PTC.console.checkConsole=function(){var ccurl=PTC.console.url;var options={method:"get",onSuccess:function(transport){var response=transport.responseText;if(response.length===1&&response==="0")PTC.console.clearInterval(PTC.console.consoleIntervalId);else if(response.length>2)eval(response)},onException:function(){PTC.console.clearInterval(PTC.console.consoleIntervalId)}};requestHandler.doRequest(ccurl,options)};
PTC.console.checkConsolePeriodically=function(){PTC.console.checkConsole.defer(4E3);PTC.console.setConsoleInterval(PTC.console.url)};PTC.console.launchConsole=function(){window.open(getBaseHref()+"servlet/WindchillAuthGW/wt.enterprise.URLProcessor/URLTemplateAction?u8&action=EventConsole","console","resizable=yes,scrollbars=yes,menubar=no,toolbar=no,location=no,status=no,width=900,height=600")};
PTC.console.checkForOpenConsole=function(formResult){if(formResult&&formResult.extraData&&formResult.extraData.launchConsole)PTC.console.launchConsole();return true};PTC.console.registerConsoleMainListeners=function(){PTC.action.on("objectsaffected",PTC.console.checkForOpenConsole)};PTC.navigation.on("afterLoadMainShell",PTC.console.registerConsoleMainListeners);Ext.namespace("PTC.search");Ext.namespace("PTC.search.ContexPickerData");PTC.search.log=log4javascript.getLogger("PTC.search.advanceSearch.contextPicker");
PTC.search.recentlyUsedContexts=new Ext.util.MixedCollection;
PTC.search.checkListenerFavContext=function(){var favContexts=Ext.getCmp("myFavContext");var myFavChecked=favContexts.checked;var isOnlyFolder=PTC.search.isContainsOnlyFolders();var contextCount=PTC.search.recentlyUsedContexts.getCount()-1;for(var j=0;j<PTC.search.recentlyUsedContexts.getCount();j++){var item=Ext.getCmp(PTC.search.recentlyUsedContexts.itemAt(j).id);if(item.id=="all_contexts")if(myFavChecked){item.suspendEvents();item.setValue(false);item.resumeEvents()}else{if(PTC.search.ContexPickerData.allContextsCheckedIndex<=
0){item.suspendEvents();item.setValue(true);item.resumeEvents()}}else if(myFavChecked){if(isOnlyFolder&&contextCount>1){PTC.search.showMessageForMultiFolder();favContexts.suspendEvents();favContexts.setValue(false);favContexts.resumeEvents()}if(item.id.indexOf("folder")==-1){var cb=new Ext.getCmp(item.id);cb.suspendEvents();cb.setValue(true);cb.resumeEvents()}else if(isOnlyFolder){if(contextCount==1){var cb=new Ext.getCmp(item.id);cb.suspendEvents();cb.setValue(true);cb.resumeEvents()}}else{var cb=
new Ext.getCmp(item.id);cb.suspendEvents();cb.setValue(false);cb.resumeEvents()}}else{var cb=new Ext.getCmp(item.id);cb.suspendEvents();cb.setValue(false);cb.resumeEvents()}}PTC.search.HiddenContextPicker.setStatusFromUserSelection()};
PTC.search.showMessageForMultiFolder=function(){PTC.search.log.debug("PTC.search.checkListenerFavContext","Detecting  Multiple folders");var msg=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.MULTIPLE_FOLDER_SELECTION_MSG");var title=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.MULTIPLE_FOLDER_SELECTION_HEADING");PTC.search.showBannerMessage(title,[msg],"WARNING")};
PTC.search.isContainsOnlyFolders=function(){var onlyFolders=false;for(var j=0;j<PTC.search.recentlyUsedContexts.getCount();j++){var id=PTC.search.recentlyUsedContexts.itemAt(j).id;if(id=="all_contexts")continue;if(id.indexOf("folder")==-1){onlyFolders=false;break}else onlyFolders=true}PTC.search.log.debug("PTC.search.isContainsOnlyFolders = "+onlyFolders);return onlyFolders};
PTC.search.showFavContextCheckBox=function(displayName,addContextLabel){var myFavContext=new Ext.form.Checkbox({name:"myFavContext",id:"myFavContext",checked:false,boxLabel:'<img src="netmarkets/jsp/search/small_blank_value.gif">'+displayName+'<a href="javascript:PTC.search.showAddContextLink()" id="contextOptionsMenuAnchor"> &nbsp; &nbsp;'+addContextLabel+"</a>",renderTo:"myFavContextDiv",listeners:{check:PTC.search.checkListenerFavContext}})};
PTC.search.renderRecentlyUsedContexts=function(){PTC.search.log.debug("PTC.search.renderRecentlyUsedContexts ",PTC.search.recentlyUsedContexts);var contextRow=$("chkGroupContextPicker");for(var i=0,l=contextRow.childNodes.length;i<l;i++){var comp=Ext.getCmp(contextRow.childNodes[0].firstChild.id);comp.destroy()}PTC.search.recentlyUsedContexts.each(function(item,index,length){if(item.id.indexOf("folder")==-1)if(item.id=="all_contexts")var cb=new Ext.form.Checkbox(item);else{item.renderTo="chkGroupContextPicker";
var cb=new PTC.search.RemovableCheckbox(item);cb.wrap.addClass("chk-same-line");cb.wrap.addClass("removableCheckBoxItem")}});PTC.search.recentlyUsedContexts.each(function(item,index,length){if(item.id.indexOf("folder")!=-1){item.renderTo="chkGroupContextPicker";var cb=new PTC.search.RemovableCheckbox(item);cb.wrap.addClass("chk-same-line");cb.wrap.addClass("removableCheckBoxItem")}})};PTC.search.setMyFavAndAllContextStatus=function(){PTC.search.checkAllContextChecked();PTC.search.checkAllFavSelected()};
PTC.search.checkAllFavSelected=function(){PTC.search.log.debug("PTC.search.checkAllFavSelected ");var allContexts=Ext.getCmp("all_contexts");var favState=true;if(allContexts.checked){var favContexts=Ext.getCmp("myFavContext");favContexts.suspendEvents();favContexts.setValue(false);favContexts.resumeEvents();favState=false}else{for(var i=0;i<PTC.search.recentlyUsedContexts.getCount();i++){var item=PTC.search.recentlyUsedContexts.itemAt(i);var cb=Ext.getCmp(item.id);if(item.id!="all_contexts"&&item.id.indexOf("folder")==
-1)if(!cb.checked){favState=false;break}}if(PTC.search.isContainsOnlyFolders())if(PTC.search.recentlyUsedContexts.getCount()>2)favState=false;else{var item=PTC.search.recentlyUsedContexts.itemAt(1);var cb=Ext.getCmp(item.id);if(!cb.checked)favState=false}if(favState&&PTC.search.recentlyUsedContexts.getCount()==1)favState=false;var favContexts=Ext.getCmp("myFavContext");favContexts.suspendEvents();favContexts.setValue(favState);favContexts.resumeEvents()}if(favState){$("memberOfContainer").checked=
false;$("searchInUserOrg").checked=false;PTC.search.updateMemberShipMessage()}};
PTC.search.checkAllContextChecked=function(){PTC.search.log.debug("PTC.search.checkAllContextChecked ",PTC.search.recentlyUsedContexts);var allContxtSetStatus=true;for(var i=0;i<PTC.search.recentlyUsedContexts.getCount();i++){var item=PTC.search.recentlyUsedContexts.itemAt(i);var cb=Ext.getCmp(item.id);if(item.id!="all_contexts"&&cb.checked){allContxtSetStatus=false;break}}var cb=Ext.getCmp("all_contexts");if(allContxtSetStatus&&PTC.search.ContexPickerData.allContextsCheckedIndex<=0){cb.suspendEvents();
cb.setValue(true);cb.resumeEvents();PTC.search.ContexPickerData.allContextsCheckedStatus=1}else{cb.suspendEvents();cb.setValue(false);cb.resumeEvents();PTC.search.ContexPickerData.allContextsCheckedStatus=0}};PTC.search.sortRecentlyUsedContexts=function(){PTC.search.recentlyUsedContexts.sort("ASC",function(a,b){if(a.id.indexOf("folder")==-1||b.id.indexOf("folder")==-1)if(a.label>b.label)return 1;else if(a.label<b.label)return-1;else return 0})};
PTC.search.renderRecentlyUsedContextCheckBox=function(){PTC.search.log.debug("PTC.search.renderRecentlyUsedContextCheckBox: PTC.search.ContexPickerData ",PTC.search.ContexPickerData);var pickerId=PTC.search.ContexPickerData.pickerId;var displayValues=PTC.search.ContexPickerData.displayValues;var InternalValues=PTC.search.ContexPickerData.InternalValues;var imageValues=PTC.search.ContexPickerData.imageValues;var contextDispLength=PTC.search.ContexPickerData.contextDispLength;var allContextsSelectedName=
PTC.search.ContexPickerData.allContextsSelectedName;var allContextsCheckedIndex=PTC.search.ContexPickerData.allContextsCheckedIndex;var allContextsCheckedStatus=PTC.search.ContexPickerData.allContextsCheckedStatus;var displayNameArr=null;if(displayValues.length>0)displayNameArr=displayValues.split("~~COMMA~~");var internalNameArr=null;if(InternalValues.length>0)internalNameArr=InternalValues.split(",");var imageValuesArr=null;if(imageValues.length>0)imageValuesArr=imageValues.split(",");var contextCombo=
$(pickerId+"$label$");var allContextsChecked=allContextsCheckedStatus==1?true:false;allContextsCheckedIndex=allContextsCheckedIndex==-1?0:allContextsCheckedIndex;var allContextsLabel=contextCombo.options[allContextsCheckedIndex].text;var allContexts=Ext.getCmp("all_contexts");if(allContexts!=null)allContexts.destroy();allContexts={boxLabel:'<img src="netmarkets/jsp/search/small_blank_value.gif" />'+allContextsLabel,name:"all_contexts",id:"all_contexts",checked:allContextsChecked,disabled:false,listeners:{check:PTC.search.changeListener},
renderTo:"allContextTD",label:allContextsLabel};PTC.search.recentlyUsedContexts.add(allContexts);if(displayNameArr!=null&&displayNameArr.length>0&&internalNameArr!=null)for(var i=0;i<displayNameArr.length;i++){var internalNameFromArr=internalNameArr[i];var dispName=displayNameArr[i];if(displayNameArr[i].length>contextDispLength)dispName=displayNameArr[i].substring(0,contextDispLength-3)+"...";var imageStr=imageValuesArr[i];var newItem={boxLabel:'<div class="removableCheckBoxLabel"><img src="'+imageStr+
'" /> '+dispName+"</div>",name:""+internalNameFromArr,id:""+internalNameFromArr,checked:false,disabled:false,qtip:""+displayNameArr[i],listeners:{check:PTC.search.changeListener},onRemoveFunction:PTC.search.RemoveContextCheckbox,renderTo:"chkGroupContextPicker",label:dispName};PTC.search.recentlyUsedContexts.add(newItem)}PTC.search.sortRecentlyUsedContexts();PTC.search.log.debug("PTC.search.renderRecentlyUsedContextCheckBox",PTC.search.recentlyUsedContexts);PTC.search.renderRecentlyUsedContexts();
var otherContextChecked=false;var checkboxesCheckedBeforeSearch=$(pickerId).value;var arrCheckBoxesCheckedBeforeSearch=checkboxesCheckedBeforeSearch.split(",");for(var i=0;i<arrCheckBoxesCheckedBeforeSearch.length;i++){var optionInternalVal=arrCheckBoxesCheckedBeforeSearch[i];if(optionInternalVal.startsWith("OR:")||optionInternalVal.startsWith("VR:"))optionInternalVal=optionInternalVal.substring(3);for(var j=0;j<PTC.search.recentlyUsedContexts.getCount();j++){var item=Ext.getCmp(PTC.search.recentlyUsedContexts.itemAt(j).id);
var itemName=item.getName();if(itemName.startsWith("OR:")||itemName.startsWith("VR:"))itemName=itemName.substring(3);if(itemName==optionInternalVal){item.suspendEvents();item.setValue(true);item.resumeEvents();otherContextChecked=true}}}if(!otherContextChecked){if(allContextsSelectedName==""){if(allContextsCheckedStatus!="1"){var favContexts=Ext.getCmp("myFavContext");favContexts.suspendEvents();favContexts.setValue(false);favContexts.resumeEvents();var allContextsItem=Ext.getCmp("all_contexts");
allContextsItem.suspendEvents();allContextsItem.setValue(true);allContextsItem.resumeEvents();PTC.search.callUpdateAllContextOnServer("updateallContextsSelectedItem","##1");allContextsCheckedStatus=1}allContextsChecked=true}}else{disableMemberOfCheckBoxes();var allContextsItem=Ext.getCmp("all_contexts");allContextsItem.suspendEvents();allContextsItem.setValue(false);allContextsItem.resumeEvents();allContextsChecked=false}if(Ext.getCmp("all_contexts").getValue()==true){var favContexts=Ext.getCmp("myFavContext");
favContexts.suspendEvents();favContexts.setValue(false);favContexts.resumeEvents()}if(allContextsChecked)contextCombo.selectedIndex=allContextsCheckedIndex;else{allContextsCheckedIndex=PTC.search.getIndexOfOptionFromValue(contextCombo,"FIND_CONTEXT");contextCombo.selectedIndex=allContextsCheckedIndex}allContexts.currentContainer=allContextsCheckedIndex;PTC.search.setMyFavAndAllContextStatus();PTC.search.updateMemberShipMessage();PTC.search.ContexPickerData.otherContextChecked=otherContextChecked};
PTC.search.changeListener=function(node){var picID=PTC.search.ContexPickerData.pickerId;var all_contexts=Ext.getCmp("all_contexts");var currentContainer=all_contexts.currentContainer;var allContextsChecked=false;if(node.getName()=="all_contexts")if(node.getValue()==true){var favContexts=Ext.getCmp("myFavContext");favContexts.suspendEvents();favContexts.setValue(false);favContexts.resumeEvents();allContextsChecked=true;if(PTC.search.ContexPickerData.allContextsCheckedStatus!=1)PTC.search.ContexPickerData.allContextsCheckedStatus=
1}else{allContextsChecked=false;if(PTC.search.ContexPickerData.allContextsCheckedStatus!=0)PTC.search.ContexPickerData.allContextsCheckedStatus=0}for(var i=0;i<PTC.search.recentlyUsedContexts.getCount();i++){var item=Ext.getCmp(PTC.search.recentlyUsedContexts.itemAt(i).id);item.enable();if(allContextsChecked&&item.getName()!="all_contexts"){item.suspendEvents();item.setValue(false);item.resumeEvents()}}if(node.getName()!="all_contexts"&&node.getValue()==true)if(node.getId().indexOf("folder")!=-1)for(var i=
0;i<PTC.search.recentlyUsedContexts.getCount();i++){var item=Ext.getCmp(PTC.search.recentlyUsedContexts.itemAt(i).id);item.enable();if(node.getName()!=item.getName()){item.suspendEvents();item.setValue(false);item.resumeEvents()}}else for(var i=0;i<PTC.search.recentlyUsedContexts.getCount();i++){var item=Ext.getCmp(PTC.search.recentlyUsedContexts.itemAt(i).id);item.enable();var isFolderItem=false;var isAllContextItem=false;if(item.getName()=="all_contexts")isAllContextItem=true;if(item.getId().indexOf("folder")!=
-1)isFolderItem=true;if(node.getName()!=item.getName()&&(isFolderItem||isAllContextItem)){item.suspendEvents();item.setValue(false);item.resumeEvents()}}PTC.search.HiddenContextPicker.setStatusFromUserSelection();if(node.getName()!="all_contexts")PTC.search.setMyFavAndAllContextStatus()};
PTC.search.renderContextPickerData=function(myFavContextLabel,addContextLabel,pickerID,displayValues,internalValues,imagesValues,contextDispLength,allContextsSelectedName,allContextsCheckedIndex,allContextsSelectedChecked){PTC.search.recentlyUsedContexts=new Ext.util.MixedCollection;PTC.search.showFavContextCheckBox(myFavContextLabel,addContextLabel);PTC.search.ContexPickerData.pickerId=pickerID;PTC.search.ContexPickerData.displayValues=displayValues;PTC.search.ContexPickerData.InternalValues=internalValues;
PTC.search.ContexPickerData.imageValues=imagesValues;PTC.search.ContexPickerData.contextDispLength=contextDispLength;PTC.search.ContexPickerData.allContextsSelectedName=allContextsSelectedName;PTC.search.ContexPickerData.allContextsCheckedIndex=allContextsCheckedIndex;PTC.search.ContexPickerData.allContextsCheckedStatus=allContextsSelectedChecked;PTC.search.renderRecentlyUsedContextCheckBox();if(!PTC.search.ContexPickerData.otherContextChecked&&allContextsSelectedChecked==1){PTC.search.log.debug("PTC.search.renderContextPickerData",
"Setting all_context status first time");var allContextsCb=Ext.getCmp("all_contexts");allContextsCb.suspendEvents();allContextsCb.setValue(true);allContextsCb.resumeEvents();var favContexts=Ext.getCmp("myFavContext");favContexts.suspendEvents();favContexts.setValue(false);favContexts.resumeEvents()}};PTC.csm={};PTC.csm.clfAdminWin=null;
PTC.csm.launchCSMWindow=function(){var options={asynchronous:true,method:"POST",evalScripts:true,parameters:null,onSuccess:function(response){var _response=Ext.util.JSON.decode(response.responseText);var clfAdminURL=_response.clfAdminURL;if(PTC.csm.clfAdminWin==null||PTC.csm.clfAdminWin.closed)PTC.csm.clfAdminWin=window.open(clfAdminURL,"clfAdminWin");PTC.csm.clfAdminWin.focus()}};var transport=requestHandler.doRequest("ptc1/csmAdminWindow",options)};
PTC.csm.postUserRemove=function(object){if(PTC.isDefined(object.deletedUsers)){var oids=object.deletedUsers;for(var i=0;i<oids.length;i++)PTC.jca.table.Utils.removeRow("clfAdmin.listAdmins",oids[i].oid)}if(PTC.isDefined(object.failedUsers)){var fullMessage=bundleHandler.get("com.ptc.windchill.csm.client.csmClientResource.WARNING_USER_NOT_REMOVED");+"<BR/>";var userNames=object.failedUsers;var messages=new Array(userNames.length);for(var i=0;i<userNames.length;i++)messages[i]=userNames[i].uname;var msgObjects=
new Array(1);msgObjects[0]={MessageTitle:fullMessage,Messages:messages,MessageType:"WARNING"};PTC.messaging.showInlineMessage(msgObjects)}};
PTC.csm.postUserRowRemove=function(object){if(PTC.isDefined(object.oid))PTC.jca.table.Utils.removeRow("clfAdmin.listAdmins",object.oid);if(PTC.isDefined(object.uname)){var fullMessage=bundleHandler.get("com.ptc.windchill.csm.client.csmClientResource.WARNING_USER_NOT_REMOVED");+"<BR/>";var messages=new Array(1);messages[0]=object.uname;var msgObjects=new Array(1);msgObjects[0]={MessageTitle:fullMessage,Messages:messages,MessageType:"WARNING"};PTC.messaging.showInlineMessage(msgObjects)}};
PTC.csm.exportClassificationStructure=function(fileType,nameSpace){var params="exportFileType="+fileType+"&exportTreeNameSpace="+nameSpace;goProgress();var options={asynchronous:true,method:"POST",evalScripts:true,parameters:params,onSuccess:function(response){var _response=Ext.util.JSON.decode(response.responseText);var href=_response.url;exportListUtilities.getOpener().open(href);stopProgress();closePopup()},onFailure:function(response,error){alert(response.responseText.stripTags());stopProgress();
closePopup()}};requestHandler.doRequest("ptc1/exportClassification",options)};PTC.csm.selectRequiredAndConfirmation=function(event,target,table,message){if(table&&target.ownerCt.id!=="gridRowContextMenu"){var objectsSelected=validateSelected(true,table.id);if(!objectsSelected)return false}return JCAConfirm(event,message)};
PTC.util.tableDataManager=function(){var TABLE_DATA_MANAGER_DIV="table_data_manager_div";var TABLE_DATA_MANAGER_STORE="table_data_manager_store";var isRegistered=false;var tableDataMap=new Ext.util.MixedCollection;var isSerialized=false;var tableDataStr="";function getMap(map,key){if(!map.containsKey(key))map.add(key,new Ext.util.MixedCollection);return map.get(key)}function getOidMap(tableId){return getMap(tableDataMap,tableId)}function getDataMap(tableId,oid){var oidMap=getOidMap(tableId);return getMap(oidMap,
oid)}function updateMap(map,key,value){if(map.containsKey(key))map.removeKey(key);map.add(key,value)}function simplifyMap(){var map={};tableDataMap.eachKey(function(tableId,oids){map[tableId]={};oids.eachKey(function(oid,dataMap){map[tableId][oid]={};dataMap.eachKey(function(dataId,data){map[tableId][oid][dataId]=data})})});return map}function serializeTableData(){var input=Ext.getDom(TABLE_DATA_MANAGER_STORE);if(isSerialized)return tableDataStr;if(input===null||input===undefined){var form=getMainForm();
if(form){appendFormHiddenInput(form,TABLE_DATA_MANAGER_STORE,"");input=Ext.getDom(TABLE_DATA_MANAGER_STORE)}}var s=simplifyMap();tableDataStr=Ext.util.JSON.encode(s);if(input){input.value=tableDataStr;isSerialized=true}return tableDataStr}function cloneOidMap(map){var clonedOidMap=new Ext.util.MixedCollection;map.eachKey(function(oid,dataMap){var clonedDataMap=new Ext.util.MixedCollection;dataMap.eachKey(function(dataId,data){var cloneData=data;if(typeof data!=="string"){cloneData={};Ext.apply(cloneData,
data)}clonedDataMap.add(dataId,cloneData)});clonedOidMap.add(oid,clonedDataMap)});return clonedOidMap}return{put:function(tableId,oid,key,value){var valueMap=new Ext.util.MixedCollection;valueMap.add(key,value);this.putAll(tableId,oid,valueMap);isSerialized=false},putAll:function(tableId,oid,valueMap){var dataMap=getDataMap(tableId,oid);valueMap.eachKey(function(key,value){updateMap(dataMap,key,value)});isSerialized=false},get:function(tableId,oid,key){var dataMap=getDataMap(tableId,oid);return dataMap.containsKey(key)?
dataMap.get(key):null},getOids:function(tableId){return getOidMap(tableId)},remove:function(tableId,oids){if(tableId===null||oids===null)return;oids.each(function(oid){if(oid!==null)getOidMap(tableId).removeKey(oid)});isSerialized=false},removeAll:function(tableId){if(tableId===null)return;tableDataMap.removeKey(tableId).isSerialized=false},contains:function(tableId,oid,key){var dataMap=getDataMap(tableId,oid);return dataMap.containsKey(key)},handleSubmit:function(){serializeTableData()},getFormData:function(original,
form,options){serializeTableData();return original(form,options)},getSerializedParams:function(){return{table_data_manager_store:serializeTableData()}},clearData:function(original){original();tableDataMap=new Ext.util.MixedCollection;isSerialized=false},cloneTableData:function(){var clonedTableDataMap=new Ext.util.MixedCollection;tableDataMap.eachKey(function(tableId,oids){clonedTableDataMap.add(tableId,cloneOidMap(oids))});return clonedTableDataMap},copyOidMap:function(tableId,newId){if(tableDataMap.containsKey(tableId)){if(tableDataMap.containsKey(newId))tableDataMap.removeKey(newId);
var oidMap=getMap(tableDataMap,tableId);tableDataMap.add(newId,cloneOidMap(oidMap));isSerialized=false}},replaceTableData:function(newTableDataMap){if(newTableDataMap!==null)tableDataMap=newTableDataMap},registerTableListener:function(tableId){if(tableId===null)return;if(isRegistered===false){setUserSubmitFunction(PTC.util.tableDataManager.handleSubmit);Form.serialize=Form.serialize.wrap(PTC.util.tableDataManager.getFormData);Ext.lib.Ajax.serializeForm=Ext.lib.Ajax.serializeForm.wrap(PTC.util.tableDataManager.getFormData);
isRegistered=true;markDownstreamNonPreloadedWizStepsDirty=markDownstreamNonPreloadedWizStepsDirty.wrap(PTC.util.tableDataManager.clearData)}getMap(tableDataMap,tableId)}}}();
PTC.debug={isJCADebug:function(){var win=getWindow();if(win&&"location"in win&&"href"in win.location){try{var href=win.location.href;var result=extractParamValue(win.location.href,"jcaDebug")}catch(e){result=""}if(result==="")return false;Ext.apply(Ext.QuickTips.getQuickTip(),{maxWidth:1E3,closable:true,autoHide:false,collapsible:true,hideDelay:15E3});return true}return false},isJsDebug:FALSE_FUNC,getJCADebugHTML:function(config){if(config&&config.jcaDebugInfo&&this.isJCADebug())return'&nbsp;&nbsp;<img src="'+
this.LADYBUG+'" ext:qtipencode=false ext:qtip="'+config.jcaDebugInfo+'"/>';return""},getJCADebugButtonConfig:function(config){if(config&&config.jcaDebugInfo&&this.isJCADebug())return new Ext.Button({icon:this.LADYBUG,tooltip:config.jcaDebugInfo});return null},LADYBUG:"netmarkets/images/ladybug.png"};function tf(nameact,oidstr,urlshortcut,constring,level,expandOnly,legacy){treeHandler.toggle(nameact,oidstr,urlshortcut,constring,level,expandOnly,legacy)}
function addRows(oidList,tableID,refresh,doAjaxUpdate,preventDuplicates,iframeForm){var params={refresh:refresh,doAjaxUpdate:doAjaxUpdate,addDone:false,preventDuplicates:preventDuplicates,iframeForm:iframeForm};rowHandler.addRows(oidList,tableID,null,params)}function removeRows(item){return rowHandler.removeRowsFromParentTable(item)}function removeRowsFromSpecifiedTable(rows,tableID,visuallyRemove){rowHandler.removeRows(rows,tableID,visuallyRemove)}
function newHttp(){var xmlhttp=false;if(window.XMLHttpRequest)xmlhttp=new XMLHttpRequest;else if(window.ActiveXObject)try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP.5.0")}catch(e){try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP.4.0")}catch(e2){try{xmlhttp=new ActiveXObject("Msxml2.XMLHTTP")}catch(e3){try{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}catch(e4){}}}}return xmlhttp}
function setHeaders(xmlhttp){xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");xmlhttp.setRequestHeader("X-Referer",window.location)}
function handleDynamicAction(mform,compContext,elemAddress,actionClass,actionMethod,executeLocation,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,executed,popupUrl,isAjaxEnabled,ajaxClass,tableID,disableSelected,addRows,refreshOnNoOp,iframeForm,preProcessor,isAction){PTC.getMainWindow().PTC.performance.restartTimer();PTC.getMainWindow().PTC.performance.startComponentTimer("WizardSubmit","Wizard Action Completed");
var params={mform:mform,compContext:compContext,elemAddress:elemAddress,actionClass:actionClass,actionMethod:actionMethod,executeLocation:executeLocation,executed:executed,popupUrl:popupUrl,isAjaxEnabled:isAjaxEnabled,ajaxClass:ajaxClass,disableSelected:disableSelected,addRows:addRows,refreshOnNoOp:refreshOnNoOp,iframeForm:iframeForm,preProcessor:preProcessor,actionTarget:tableID,anonymousParams:requestHandler.parseAnonymousParams(6,arguments),actionName:executeLocation};return requestHandler.handleRequest(tableID,
params,isAction)}
function getNewUrl(mform,url,params0,params1,params2,params3,params4,params5,params6,params7,params8,params9,params10,params11,params12,params13,params14,params15,params16,params17,isNoContent,isDCA,doXMLHTTP,isAjaxEnabled,ajaxClass,actionClass,actionMethod,tableID,actionName){var params={mform:mform,isNoContent:isNoContent,isDCA:isDCA,doXMLHTTP:doXMLHTTP,isAjaxEnabled:isAjaxEnabled,ajaxClass:ajaxClass,actionClass:actionClass,actionMethod:actionMethod,tableID:tableID,actionName:actionName,anonymousParams:requestHandler.parseAnonymousParams(2,
arguments)};params=requestHandler.getParamString(params);if(url.indexOf("?")==-1)url+="?";else url+="&";url+=params;if(mform&&mform.CSRF_NONCE&&url.indexOf("#")<0){var value=mform.CSRF_NONCE.value;if(!value&&mform.CSRF_NONCE[0]&&mform.CSRF_NONCE[0].value)value=mform.CSRF_NONCE[0].value;url=url+"&CSRF_NONCE="+encodeURIComponent(value)}return url}Ext.namespace("PTC.domainAdmin");
PTC.dd=function(){var globalDDGroupId="globalDDGroup";return{createDDProxy:function(proxyConfig,ProxyConstructor){if(proxyConfig.id){if(!proxyConfig.sGroup)proxyConfig.sGroup=this.globalDDGroupId;Ext.get(proxyConfig.id).dd=new ProxyConstructor(proxyConfig.id,proxyConfig.sGroup,proxyConfig.config)}},createDropZone:function(dropZoneConfig){if(dropZoneConfig.id){if(!dropZoneConfig.sGroup)dropZoneConfig.sGroup=this.globalDDGroupId;new Ext.dd.DropZone(dropZoneConfig.id,{ddGroup:dropZoneConfig.sGroup})}}}}();
PTC.dd.DDProxy=function(id,sGroup,config,isDragAfter){this.isDragAfter=isDragAfter;PTC.dd.DDProxy.superclass.constructor.call(this,id,sGroup,config);this.addInvalidHandleClass("x-grid3-scroller");this.addInvalidHandleClass("attributePanelSpan");this.addInvalidHandleClass("invalidDrag")};
Ext.extend(PTC.dd.DDProxy,Ext.dd.DDProxy,{reset:function(){if(this.lastTarget){this.lastTarget.removeClass("dragDrop-over");this.lastTarget=null}},startDrag:function(x,y){var dragEl=Ext.get(this.getDragEl());var el=Ext.get(this.getEl());this.startX=x;this.startY=y;el.addClass("dragDrop-fade");dragEl.applyStyles({border:"","z-index":2E3});dragEl.addClass(el.dom.className);dragEl.update(el.dom.innerHTML)},onDragEnter:function(e,targetId){this.onDragOver(e,targetId)},onDragOver:function(e,targetId){this.reset();
if(targetId!==this.getEl().id){var target=Ext.get(targetId);target.addClass("dragDrop-over");var dragEl=Ext.get(this.getDragEl());dragEl.removeClass("dragDrop-noDrop");this.lastTarget=target;this.insertAfter=this.isDragAfter(e);this.startX=e.getPageX();this.startY=e.getPageY()}},onDragOut:function(){var dragEl=Ext.get(this.getDragEl());dragEl.addClass("dragDrop-noDrop");this.reset()},endDrag:function(){var el=Ext.get(this.getEl());var dragEl=Ext.get(this.getDragEl());dragEl.removeClass(el.dom.className);
el.removeClass("dragDrop-fade");dragEl.update("");this.reset()}});PTC.dd.DDProxy.isDragDown=function(e){return this.startY<e.getPageY()};PTC.dd.DDProxy.isDragRight=function(e){return this.startX<e.getPageX()};PTC.dd.DropZoneTableContainer=function(containerConfig,group){Ext.applyIf(containerConfig,{autoScroll:true,border:false});if(containerConfig.id&&group){PTC.dd.DropZoneTableContainer.superclass.constructor.call(this,containerConfig);this.ddGroup=group}this.tabId=containerConfig.tabId};
Ext.extend(PTC.dd.DropZoneTableContainer,Ext.Panel,{tables:{},addTable:function(config){config.sGroup=this.ddGroup;var tableId=config.id;config.tabId=this.tabId;var dropZone=new PTC.dd.DropZoneTable(config);this.tables[tableId]=dropZone.id;this.insert(0,dropZone);return dropZone},addWidget:function(config){config.sGroup=this.ddGroup;var tableId=config.id;config.tabId=this.tabId;var settingsHandler=function(e,target,panel){Ext.Msg.alert("Message","The Settings tool was clicked.")};var WIDGET_ID_PREFIX=
"widget_";var closeHandler=function(e,target,panel){var menuItemId=panel.id.substring(WIDGET_ID_PREFIX.length);var menuItem=Ext.getCmp(menuItemId);if(menuItem){menuItem.checkHandler(menuItem,false);PTC.infoPage.myTab.setSelection(menuItem,false,true)}};var dropZoneWidget=new Ext.Panel({items:[{id:"dropZone_"+tableId,xtype:"portal",items:[{columnWidth:1,items:[{title:config.actionText,id:WIDGET_ID_PREFIX+config.id,tools:[{id:"gear",handler:settingsHandler},{id:"close",handler:closeHandler}],items:new PTC.dd.DropZoneTable(config)}]}]}]});
this.tables[tableId]=dropZoneWidget.id;this.insert(0,dropZoneWidget);return dropZoneWidget},removeTable:function(itemId){requestHandler.abort(PTC.dd.inProgressAddRequests[itemId]);var dropZoneId=this.tables[itemId];var tables=PTC.jca.table.Utils.getExtTables(dropZoneId);var length=tables.length;for(var i=0;i<length;i++){tables[i].getEl().parent().contentAreaPanel=null;PTC.jca.table.stickiness.clearTableStickiness(tables[i].id)}var dropZone=Ext.getCmp(dropZoneId);PTC.navigation.removeIframes(Ext.getDom(dropZoneId),
true);this.remove(dropZone,true);PTC.infoPageTableMgr.removeRenderedTable(dropZoneId,this.tabId);delete this.tables[itemId]},insertTableBefore:function(movedItemId,targetItemId){var movedTable=Ext.get(this.tables[movedItemId]);var targetTable=Ext.get(this.tables[targetItemId]);movedTable.insertBefore(targetTable);var iMoved=this.items.indexOfKey(movedItemId);var iTarget=this.items.indexOfKey(targetItemId);if(!(iMoved+1==iTarget))this.insert(iTarget,this.tables[movedItemId])},insertTableAfter:function(movedItemId,
targetItemId){var movedTable=Ext.get(this.tables[movedItemId]);var targetTable=Ext.get(this.tables[targetItemId]);movedTable.insertAfter(targetTable);var iMoved=this.items.indexOfKey(movedItemId);var iTarget=this.items.indexOfKey(targetItemId);if(!(iMoved-1==iTarget))this.insert(iTarget,this.tables[movedItemId])},scrollTo:function(itemId){var tablePanel=Ext.getCmp(this.tables[itemId]);var tablePosition=tablePanel.getPosition(false);var centerPosition=this.getPosition(false);this.body.scrollTo("top",
tablePosition[1]-(centerPosition[1]-this.body.dom.scrollTop),true)},clearTableStickinessInTab:function(itemId){if(itemId){var tables=PTC.jca.table.Utils.getExtTables(this.tables[itemId]);for(var i=0,length=tables.length;i<length;i++)PTC.jca.table.stickiness.clearTableStickiness(tables[i].id)}}});PTC.dd.inProgressAddRequests={};
PTC.dd.DropZoneTable=function(dropZoneConfig){this.itemId=dropZoneConfig.id;dropZoneConfig.id="wrap_"+this.itemId;Ext.applyIf(dropZoneConfig,{html:'<div id="'+this.itemId+'_loading" style="height: 100px">&nbsp;</div>'});PTC.navigation.startProgressTask(this.itemId+"_loading");PTC.dd.DropZoneTable.superclass.constructor.call(this,dropZoneConfig);this.tabId=dropZoneConfig.tabId;var compCtx="$"+dropZoneConfig.actionType+"$"+dropZoneConfig.actionName+"$"+extractParamValue(dropZoneConfig.actionURL,"oid")+
"$";setActionFormData(compCtx,null,null,null,null,getMainForm());PTC.dd.inProgressAddRequests[this.itemId]=getElementHtml(Form.serialize(getMainForm()),this.id,true,dropZoneConfig.actionURL,false);clearActionFormData();PTC.infoPageTableMgr.addRenderedTable(dropZoneConfig.actionID,this.id,this.tabId)};Ext.extend(PTC.dd.DropZoneTable,Ext.Panel);Ext.apply(PTC.driverAttributes,new Ext.util.Observable);PTC.driverAttributes.addEvents("afterRefresh","beforeRefresh");
PTC.driverAttributes.refreshDriverAttributes=function(url){PTC.driverAttributes.log.trace("Entered PTC.driverAttributes.refreshDriverAttributes");disableOkButton();PTC.driverAttributes.fireEvent("beforeRefresh");var objectHandle=PTC.wizard.getCurrentObjectHandle();var driverAttributesElement=Ext.getDom(objectHandle+"driverAttributes");var driverAttributesErrorElement=Ext.getDom(objectHandle+"driverAttributesErrorDiv");if(driverAttributesElement.tagName=="DIV"){refreshElement(driverAttributesElement.id,
url);resetOkButton()}else if(driverAttributesElement.tagName=="TBODY"){if(driverAttributesErrorElement){PTC.util.purge(driverAttributesErrorElement,true);driverAttributesErrorElement.innerHTML=""}var tbody=driverAttributesElement;if(tbody){PTC.util.purge(tbody,true);while(tbody.rows.length>0)tbody.deleteRow(0);if(PTC.driverAttributes._ajaxRequest)try{PTC.driverAttributes._ajaxRequest.abort()}catch(e){PTC.driverAttributes.log.debug("Abort ajax request failed in PTC.driverAttributes")}var formData=
Ext.lib.Ajax.serializeForm(getMainForm())+"&portlet=component";var soupedUpUrl=getPageUrl(url,"foo");var options={asynchronous:true,parameters:formData,on501:PTC.driverAttributes.driverAttributesOnSuccess,onSuccess:PTC.driverAttributes.driverAttributesOnSuccess};PTC.driverAttributes._ajaxRequest=requestHandler.doRequest(soupedUpUrl,options)}}};
PTC.driverAttributes.driverAttributesOnSuccess=function(transport){PTC.driverAttributes.log.trace("Entered PTC.driverAttributes.driverAttributesOnSuccess");delete PTC.driverAttributes._ajaxRequest;var objectHandle=PTC.wizard.getCurrentObjectHandle();var driverAttributesId=objectHandle+"driverAttributes";var driverAttributesErrorId=objectHandle+"driverAttributesErrorDiv";var tbody=$(driverAttributesId);var response=transport.responseText;var html=asyncResponseHandler.stripText(response,"",false);if(html.indexOf("</tr>")>=
0){var rows=PTC.driverAttributes.getTRStringArray(html);rows.each(function(rowHTML){if(rowHTML){var newRow=tbody.insertRow(-1);if(newRow)if(is_ie)insertNewRowHTMLForIE(newRow,rowHTML);else newRow.innerHTML=rowHTML}})}else{if(!$(driverAttributesErrorId)){var parent=getParentNodeByTag(tbody,"DIV");var errorDiv=document.createElement("div");errorDiv.id=driverAttributesErrorId;parent.appendChild(errorDiv)}$(driverAttributesErrorId).innerHTML=html}PTC.navigation.evalPageScripts(response);PTC.driverAttributes.setupJavascriptForDriverAttributes();
resetOkButton();PTC.driverAttributes.fireEvent("afterRefresh")};PTC.driverAttributes.getTRStringArray=function(html){html="</tr>"+html.substring(html.indexOf("<tr>"))+"<tr>";var rows=html.split("</tr><tr>").without("");return rows};
PTC.driverAttributes.setupJavascriptForDriverAttributes=function(){PTC.driverAttributes.log.trace("Entered PTC.driverAttributes.setupJavascriptForDriverAttributes");var driverAttributesId=PTC.wizard.getCurrentObjectHandle()+"driverAttributes";var driverAttributes=$(driverAttributesId);if(driverAttributes){var inputs=driverAttributes.getElementsByTagName("input");PTC.driverAttributes.addOnChangeEventsToApplicableItemsInArray(inputs);var selects=driverAttributes.getElementsByTagName("select");PTC.driverAttributes.addOnChangeEventsToApplicableItemsInArray(selects);
var textareas=driverAttributes.getElementsByTagName("textarea");PTC.driverAttributes.addOnChangeEventsToApplicableItemsInArray(textareas)}else PTC.driverAttributes.log.debug("Dom element not found for driver attribute ",driverAttributesId)};
PTC.driverAttributes.onChangeHandler=function(){PTC.driverAttributes.log.trace("Called PTC.driverAttributes.onChangeHandler");markDownstreamNonPreloadedWizStepsDirty();deleteDownstreamFormContent();PTC.driverAttributes.log.trace("Calling PTC.wizard.attributePanelLoader.reloadAttributesTable to reload attributes table");PTC.wizard.attributePanelLoader.reloadAttributesTable()};
PTC.driverAttributes.addOnChangeEventsToApplicableItemsInArray=function(componentArray){if(componentArray){var length=componentArray.length;if(length>0)PTC.driverAttributes.log.debug("performing addOnChangeEventsToApplicableItemsInArray for ",length,componentArray[0].nodeName," elements");var registerExtListeners=function(){this.on("select",PTC.driverAttributes.onChangeHandler);this.on("click",PTC.driverAttributes.onChangeHandler);this.on("blur",function(){if(this.getValue()==="")PTC.driverAttributes.onChangeHandler()})};
for(var i=0;i<length;i++){var component=componentArray[i];if(component.type!=="hidden")if(PTC.autosuggest.suggestBoxHandler.isAutoSuggest(component.id))Ext.ComponentMgr.onAvailable(component.id,registerExtListeners);else Event.observe(component,"change",PTC.driverAttributes.onChangeHandler)}}};refreshDriverAttributes=PTC.driverAttributes.refreshDriverAttributes;PTC.onReady(function(){PTC.driverAttributes.log=log4javascript.getLogger("PTC.driverAttributes")});PTC.dynamicRefresh={};
PTC.dynamicRefresh.log=log4javascript.getLogger("PTC.dynamicRefresh");postTableRefreshHandler=function(){};
function getTableHtml(params,divID,doAsynch){var url=PTC.util.getFormAction(getMainForm());if((currentStepStrName||currentStepStrName==="")&&wizardSteps&&(wizardSteps[currentStepStrName]||wizardSteps[currentStepStrName]===""))url=getPageUrl(wizardSteps[currentStepStrName].url,currentStepStrName);var table=PTC.jca.table.Utils.getTable(divID);if(table)if(table.fireEvent("beforeComponentRefresh",divID,params)===false)return false;if(tableUtils.getTableUrl(table)){url=tableUtils.getTableUrl(table);params=
tableUtils.addTableRefreshParams(table,params)}else if(params.indexOf("leftPaneOnly")>0)url=window.location.href;else if(window.TLN_CONTENT_URL&&$("tlnContentArea")&&hasParentById($(divID),"tlnContentArea"))url=window.TLN_CONTENT_URL;return getElementHtml(params,divID,doAsynch,url,true)}
function refreshCurrentElement(div,doAsynch,doFade){var params=getFormData()+"&refreshTable="+div;var divNode=$(div);if(hasParentById(divNode,"twoPanes_LEFTPANE"))params+="&leftPaneOnly=true";else if(hasParentById(divNode,"twoPanes_RIGHTPANE"))params+="&rightPaneOnly=true";getTableHtml(params,div,doAsynch)}function refreshCurrentElementID(id){refreshCurrentElement(id,!PTC.isOldGecko(),true)}
function getIDFromResponse(input,tableidstart){var indexid=input.indexOf(tableidstart);var tableId=null;if(indexid>0)tableId=input.substring(indexid+tableidstart.length,input.indexOf(":",indexid+tableidstart.length+1));return tableId}function handleViewUpdate(oid,name,tableID){PTC.jca.clearMultiColumnSortAndGroupingString(tableID);PTC.jca.table.stickiness.clearLockingStickiness(tableID);refreshCurrentElementID("table__"+tableID+"_TABLE")}
function getWizardStepIDFromResponse(input){return getIDFromResponse(input,"WIZARD_ID:")}PTC.dynamicRefresh.doFadeOut=function(divId){try{Ext.get(divId).fadeOut({duration:0.1,endOpacity:0.4})}catch(e){PTC.dynamicRefresh.log.error("Unable to fade out the ext component: ",divId,e)}};PTC.dynamicRefresh.doFadeIn=function(divId){try{Ext.get(divId).fadeIn({duration:0.2})}catch(e){PTC.dynamicRefresh.log.error("Unable to fade in the ext component: ",divId,e)}};
var responseProcessor=function(){var alreadyEvaledStart=-1;var alreadyEvaledEnd=-1;function runHandlers(xmlhttpWiz,divID,doFade){var responseText=xmlhttpWiz.responseText;if(responseText.indexOf("CLOSE_POPUP")>=0)closePopupAndRefreshOpener();var responseID=getTableIDFromResponse(responseText);if(!responseID||responseID==="")responseID=getWizardStepIDFromResponse(responseText);if(!responseID||responseID===""||responseID==="null")responseID=divID;var responseDiv=Ext.getDom(responseID);if(responseDiv){if(wizardSteps&&
wizardSteps[responseID]&&setStepComplete)setStepComplete(responseID);var target={responseText:responseText,responseDiv:responseDiv,alreadyEvaledEnd:this.alreadyEvaledEnd,alreadyEvaledStart:this.alreadyEvaledStart};var handlers_length=handlers.length;for(var i=0;i<handlers_length;i++)handlers[i].call(target);if(doFade)try{PTC.dynamicRefresh.doFadeIn(responseDiv);var cookieData=readCookie("rememberScrollPosition_"+tableUtils.getUnformattedTableId(divID));if(divID&&cookieData){var tID=tableUtils.getUnformattedTableId(divID);
var lastSelectedRowNumber=0;var leftScroll=0;var values=cookieData.split("#");if(values.length>0){leftScroll=values[0];lastSelectedRowNumber=values[1]}setTimeout('JSCAmoveToSelectedRow("'+tID+'","'+lastSelectedRowNumber+'","'+leftScroll+'");',250);eraseCookie("rememberScrollPosition_"+tableUtils.getUnformattedTableId(divID))}}catch(e){}}else{var mform=getMainForm();if(mform.executeLocation)mform.executeLocation.value="";PTC.navigation.submitForm()}}var handlers=[function(){var responseDiv=this.responseDiv;
var responseID=responseDiv.id;var tableId=getTableIDFromResponse(this.responseText);if(!tableId)tableId=responseID;tableId=tableUtils.getUnformattedTableId(tableId);var newtext=asyncResponseHandler.stripText(this.responseText,responseID,true);if(newtext==="")newtext=this.responseText;PTC.navigation.overwrite(responseDiv,newtext);initSelects(responseDiv);try{this.alreadyEvaledStart=this.responseText.indexOf(newtext);this.alreadyEvaledEnd=this.alreadyEvaledStart+newtext.length;PTC.navigation.evalPageScripts(newtext)}catch(e){jsca.error("could not evaluate the response",
e)}try{postTableRefreshHandler(tableId)}catch(exception){}}];return{process:function(xmlhttpWiz,divID,doFade){if(xmlhttpWiz.readyState==4)if(xmlhttpWiz.status==404)wfalert("404: page not found using Ajax");else if(xmlhttpWiz.status==200||xmlhttpWiz.status===0)runHandlers(xmlhttpWiz,divID,doFade)},addHandler:function(handler){if(typeof handler!=="function")throw"Expected function, but was: "+typeof handler;handlers.push(handler)},containsHandler:function(handler){return handlers.indexOf(handler)>-1},
removeHandler:function(handler){handlers=handlers.without(handler)}}}();
getElementHtml=function(params,divID,doAsynch,url,doFade,successFunc,failFunc,options){if(!divID){PTC.log.error('Given divID "'+divID+'" is null or not defined so aborting getElementHtml() call. ',arguments);return}if(doFade)PTC.dynamicRefresh.doFadeOut(divID);url=PTC.navigation.getTokenFromUrl(url);if(!url){Ext.DomHelper.overwrite(divID,"URL was undefined. getElementHtml() unable to make a request.");return null}if(url.indexOf("http")<0)url=getBaseHref()+url;if(!params)params="";if(isIE&&url.length>
2E3){params=params+"&"+url.substring(url.indexOf("?")+1);url=url.substring(0,url.indexOf("?"))}if(options===undefined)options={parameters:params,asynchronous:doAsynch};if(typeof failFunc==="function")options.onFailure=failFunc;else options.onFailure=function(transport){Ext.DomHelper.overwrite(divID,transport.responseText);PTC.dynamicRefresh.doFadeIn(divID)};options.onSuccess=function(transport){if(typeof successFunc==="function")successFunc.call(this,transport);responseProcessor.process(transport,
divID,doFade)};var transport=requestHandler.doRequest(url,options);return transport};
responseProcessor.addHandler(function(){var formResultText=asyncResponseHandler.stripText(this.responseText,"",true,"<!-- FORM_RESULT --\>","<!-- END_FORM_RESULT --\>");if(formResultText&&formResultText.length>10){var startidx=this.responseText.indexOf(formResultText);if(startidx===0&&this.alreadyEvaledStart>0&&formResultText.length==this.responseText.length)return;if(this.alreadyEvaledStart<0||startidx<this.alreadyEvaledStart||startidx>this.alreadyEvaledEnd||startidx+formResultText.length>this.alreadyEvaledEnd)try{PTC.navigation.evalPageScripts(formResultText)}catch(e){jsca.error("could not evaluate the response",
e)}}});handleElementResponse=responseProcessor.process;function registerRefreshForEvent(id,eventTarget,url,eventStr){if(!eventStr)eventStr="change";var fobject=$(eventTarget);if(!fobject)fobject=document.getElementsByName(eventTarget)[0];try{Event.observe(fobject,eventStr,function(){refreshElement(id,url,true)})}catch(e){}}function refreshDivTag(id,eventTarget,url,eventStr){try{Event.observe(window,"load",function(){registerRefreshForEvent(id,eventTarget,url,eventStr)})}catch(e){}}
refreshElement=function(id,url,doFade,doAsync,successFunc){doAsync=doAsync||false;if(doFade===null||doFade===undefined)doFade=true;var formData=Ext.lib.Ajax.serializeForm(getMainForm());var ContextDropDownURL=getPageUrl(url,id);getElementHtml(formData+"&portlet=component",id,doAsync,ContextDropDownURL,doFade,successFunc)};getTableIDFromResponse=function(input){return getIDFromResponse(input,"TABLE_ID:")};
function processPref(){if(this.req.readyState==4)if(this.req.status==200)var message=this.req.responseText}function confirmUndoFulfillChangeAction(event){if(JCAConfirm(event,"com.ptc.windchill.enterprise.effectivity.effectivityResource.UNDO_CHANGE_ACTION_CONFIRM_SIMPLE"))return true;else return false}
jsca.columns.enumeratedTypeRenderer=function(table,column,row){var data=jsca.columns.getCellValue(column,row);var result="undefined";if(data&&data.currentValue!==undefined){result=data.currentValue;if(data.allValues){result="";for(var i=0,l=data.allValues.keys.length;i<l;i++){var value=data.allValues.values[i];var key=data.allValues.keys[i];if(result.length>0)result=result+data.separator;if(key===data.rawValue){var title=data.activePrefix+" "+data.label;value='<img src="netmarkets/images/sp.gif" alt="'+
title+'" title="'+title+'" height="1" width="1"/><b>'+value+"</b>"}result=result+value}}if(data.id)result="<span id='"+data.id+"'>"+result+"</span>"}data.value=result;result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};jsca.columns.enumeratedTypeRenderer.searchFunc=function(table,column,row){var data=jsca.columns.getCellValue(column,row);var result=data.value;if(!result)result=jsca.columns.enumeratedTypeRenderer(table,column,row);return getUnescapedText(result)};
function hideInfoPageAttributesPanel(bool){if(bool=="true")$("attributesPanelWrapper").onload=$("attributesPanelWrapper").style.display="none"}
expandCollapse={init:function(collapsed,expandTT,collapseTT,id,object){object.collapsed=collapsed;object.expand.tooltip=expandTT;object.collapse.tooltip=collapseTT;object.id=id;expandCollapse.setHtml(object)},setHtml:function(object){if($(object.id)){var state=object.collapsed?object.expand:object.collapse;var tooltip='title="'+state.tooltip+'" alt="'+state.tooltip+'" ';var imgHtml='<img src="'+state.img+'" '+tooltip+"/>";var onclick="expandCollapse.slideIt(expandCollapse."+object.name+");Event.stop(event);";
var linkHtml='<a href="#" onclick="'+onclick+'" '+tooltip+">"+imgHtml+"</a>";$(object.id).innerHTML=linkHtml}},slideIt:function(it){if(it.collapsed)expandCollapse.show(it.divIds,0.4);else expandCollapse.hide(it.divIds,0.4);it.collapsed=!it.collapsed;expandCollapse.setHtml(it);var options={asynchronous:false};var url="netmarkets/jsp/components/setCollapseHeaderInfo.jsp?"+it.name+"="+it.collapsed;this.req=requestHandler.doRequest(url,options);if(typeof wsJSTableResize==="function")setTimeout(wsJSTableResize,
400)}};expandCollapse.Header={name:"Header",expand:{img:"netmarkets/images/expand_header.gif"},collapse:{img:"netmarkets/images/collapse_header.gif"},divIds:["pageHeader","footer"]};expandCollapse.AttributesPanel={name:"AttributesPanel",expand:{img:"netmarkets/images/expand_header.gif"},collapse:{img:"netmarkets/images/collapse_header.gif"},divIds:["attributesPanelWrapper"]};
function initHeader(collapsed,expandTT,collapseTT,id){expandCollapse.init(collapsed,expandTT,collapseTT,id,expandCollapse.Header)}function initAttributesPanel(collapsed,expandTT,collapseTT,id){expandCollapse.init(collapsed,expandTT,collapseTT,id,expandCollapse.AttributesPanel)}expandCollapse.hide=function(ids,duration){for(var i=0,l=ids.length;i<l;i++)if($(ids[i]))$(ids[i]).style.display="none"};
expandCollapse.show=function(ids,duration){for(var i=0,l=ids.length;i<l;i++)if($(ids[i]))$(ids[i]).style.display="block"};expandCollapse.hideWorkspaceMenuLabels=function(){$("wsmenubar").style.visibility="hidden"};expandCollapse.displayWorkspaceMenuLabels=function(){$("wsmenubar").style.visibility="visible"};
PTC.jca.expandCollapse=function(tableID){if(!tableID||!Ext.isString(tableID))tableID=this.initialConfig.tableid;var wTable=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableID));var gridPanel=wTable.gridPanel;var expandCollapseButton=Ext.getCmp(tableID+"_toggle");if(gridPanel!==undefined){var panels=[gridPanel.body,gridPanel.bbar,wTable.toolBar,gridPanel.menuBar,gridPanel.footer];if(gridPanel.jcaCollapsed){gridPanel.el.removeClass(this.collapsedCls);panels.each(function(panel){if(panel!==undefined)if(panel.dom)panel.dom.style.display=
"block";else panel.show()});gridPanel.jcaCollapsed=false;expandCollapseButton.setIconClass("expandCollapse_collapsed");expandCollapseButton.setTooltip(bundleHandler.get("com.ptc.netmarkets.util.utilResource.COLLAPSE_TABLE"))}else{panels.each(function(panel){if(panel!==undefined)if(panel.dom)panel.dom.style.display="none";else panel.hide()});gridPanel.jcaCollapsed=true;expandCollapseButton.setIconClass("expandCollapse_expanded");expandCollapseButton.setTooltip(bundleHandler.get("com.ptc.netmarkets.util.utilResource.EXPAND_TABLE"))}gridPanel.fireEvent("afterExpandCollapse")}};
var exportListUtilities=function(){return{resetExportTableFile:function(){var inputFilePath=document.getElementById("exportTableFile");if(!inputFilePath){jsca.error("No 'exportTableFile' element is defined in the DOM.  Verify that"+" an input field with this id is included in the export client jsp flie. ");return}var strValue=inputFilePath.value;if(!strValue){strValue=exportListUtilities.getTableName();inputFilePath.value=strValue}},remapFormatDate:function(){if(typeof formatDate==="undefined"&&opener&&
typeof opener.formatDate!=="undefined")formatDate=opener.formatDate},getOpenerTable:function(){var tableId=getWindow().location.href.parseQuery().tableID;tableId=tableUtils.getUnformattedTableId(tableId);return opener.tableUtils.getTable(tableId)},getTableName:function(){var tableName=null;var paraTableID=getWindow().location.href.parseQuery().tableID;var tableComp=exportListUtilities.getOpener().Ext.getCmp(tableUtils.getUnformattedTableId(paraTableID)+"_WTablePanel");if(tableComp){tableName=tableComp.initialConfig.tableName;
if(!tableName)tableName=tableComp.initialConfig.tableID}return exportListUtilities.getGeneratedFileName(tableName)},getNonExportableColumns:function(){var nonExportableColumnsList=bundleHandler.get("com.ptc.core.ui.tableRB.NON_EXPORTABLE_COLUMNS");var nonExportableColumns={};if(nonExportableColumnsList.length)nonExportableColumnsList.split(/\s*\,\s*/).each(function(column_name){if(column_name.length)nonExportableColumns[column_name]=true});return nonExportableColumns},getJSTableName:function(){var filelist=
opener.document.getElementById("fileList");if(!filelist)return"";var html=filelist.innerHTML.toLowerCase();var tableName=html.substring(0,html.indexOf("<span"));return exportListUtilities.getGeneratedFileName(tableName)},defaultExportRenderer:function(table,col,row,getRowFunc,getCellFunc){var text="";var gui=jsca.columns.getCellValue(col,row);text=getJSCASearchTextForCell(gui);return text},getGeneratedFileName:function(tableName){var strFileNameDelimiter="~";if(fileNameDelimiter)strFileNameDelimiter=
fileNameDelimiter;var tableNameTrim=tableName.replace(/\s/g,"");return tableNameTrim+strFileNameDelimiter+userID+strFileNameDelimiter+timeStamp},getOpener:function(){if(opener)return opener;else if(top.opener)return top.opener;return window},appendFormatTypeIfNeeded:function(formattype){if(formattype=="xml"||formattype=="xls"||formattype=="suma.xls")$("exportTableFile").value+="."+formattype},getReportExport:function(){var opener=exportListUtilities.getOpener();if(opener&&opener.part&&opener.part.report)return opener.part.report;
return null},finishServerExport:function(href){PTC.exportTable.log.trace("Entering exportListUtilities.finishServerExport ()");PTC.exportTable.log.debug("href for redirection:",href);var reportExport=this.getReportExport();if(reportExport)reportExport.closeReportSession();if(!isWf())exportListUtilities.downloadFunc(href);else{exportListUtilities.getOpener().location.href=href;WaitAndClose()}},downloadFunc:function(href){if(Ext.isChrome)exportListUtilities.getOpener().top.location.href=href;else{exportListUtilities.getOpener().open(href);
WaitAndClose()}return true},isViewSelectedOnly:function(table){if(table&&table.getTopToolbar()){var selectedOnlyMenu=table.getTopToolbar().findById(table.getId()+"_WTablePanel_selectedOnlyMenu");if(selectedOnlyMenu)return selectedOnlyMenu.menu.items.items[0].checked}return false},getTableColumnServerParameters:function(table){var parametersStr="";var visibleColumns=PTC.jca.table.Utils.getTableVisibleColumnsServerIds(table);parametersStr+="visibleColumns="+encodeURI(visibleColumns)+"&";var sortInfo=
PTC.jca.table.Utils.getTableSortInfo(table);for(var i=0;i<sortInfo.length;i++){var colIndex=i===0?"":i+1;parametersStr+=table.id+"sc"+colIndex+"="+escape(sortInfo[i].columnID)+"&";parametersStr+=table.id+"sd"+colIndex+"="+escape(sortInfo[i].sortDirection)+"&"}return parametersStr},legacyExportViewOnlyMessage:function(event){var tableId=tableUtils.findTableID(event);if(exportListUtilities.isViewSelectedOnly(window.tableUtils.getTable(tableId)))return JCAConfirm(event,"com.ptc.core.ui.confirmationMessagesRB.LEGACY_EXPORT_TABLE_CONFIRMATION");
return true}}}();Ext.namespace("PTC.exportTable");PTC.exportTable.log=log4javascript.getLogger("PTC.exportTable");PTC.exportTable.exportTableSuccessListener=function(formResult){PTC.exportTable.log.trace("Entering PTC.exportTable.exportTableSuccessListener ()");var downloadNow=formResult.extraData.downloadNow;if(downloadNow){var url=formResult.extraData.url;exportListUtilities.finishServerExport(url)}else top.finishServerSideExport();return false};
var exportListOperation=function(){this.isJCADebug=false;this.totalPages=null;this.DELIM="|$|";this.ROW_DELIM="|$%$|";this.FIRST_INDEX="fi";this.cachedExporter=null};
exportListOperation.prototype.getExporter=function(){PTC.exportTable.log.trace("Entering exportListOperation.prototype.getExporter ()");if(!this.cachedExporter){var Exporter=Class.create({allRowData:"",DELIM:"",ROW_DELIM:"",form:"",initialize:function(){var o=new exportListOperation;this.DELIM=o.DELIM;this.ROW_DELIM=o.ROW_DELIM;this.form=getMainForm()},appendColumnHeadersToForm:function(data){PTC.exportTable.log.debug("Appending 'fileHeaders' hidden input to form");var elem=new JCAnewHiddenInputElement("fileHeaders",
data,this.form);this.form.appendChild(elem)},appendOidsToForm:function(data){PTC.exportTable.log.debug("Appending 'oidsToExport' hidden input to form");var elem=new JCAnewHiddenInputElement("oidsToExport",data,this.form);this.form.appendChild(elem)},appendRowsToForm:function(allRows){PTC.exportTable.log.debug("Appending Delimiters to all Rows");var rows=[];for(var i=0,rowsLength=allRows.length;i<rowsLength;i++)rows.push(allRows[i].join(this.DELIM));this.allRowData=rows.join(this.ROW_DELIM)},submitForm:function(){PTC.exportTable.log.debug("Adding fileContent and Delimiters to form.");
var elem=new JCAnewHiddenInputElement("fileContent",this.allRowData,this.form);PTC.exportTable.log.debug("fileContent: ",elem.value);this.form.appendChild(elem);this.form.appendChild(new JCAnewHiddenInputElement("delim",this.DELIM,this.form));this.form.appendChild(new JCAnewHiddenInputElement("row_delim",this.ROW_DELIM,this.form));PTC.exportTable.log.debug("Delimiter: ",this.DELIM,"Row Delimiter: ",this.ROW_DELIM);PTC.wizard.submitWizard({skipAllValidation:true,successFunc:PTC.exportTable.exportTableSuccessListener})}});
this.cachedExporter=new Exporter}return this.cachedExporter};exportListOperation.prototype.getFileType=function(){return getWindow().location.href.parseQuery().fileType};exportListOperation.prototype.getTableId=function(){var tableId=getWindow().location.href.parseQuery().tableID;tableId=tableUtils.getUnformattedTableId(tableId);return tableId};
exportListOperation.prototype.getHeaders=function(exportColumns){PTC.exportTable.log.trace("Entering exportListOperation.prototype.getHeaders ()");var headers=[];var exportColumns_length=exportColumns.length;for(var i=0,colWritten=0;i<exportColumns_length;i++){var header=tableUtils.getHeaderLabel(exportColumns[i]);if(!header)header=" ";headers[colWritten++]=header}PTC.exportTable.log.debug("Headers: ",headers.toString());return headers};
exportListOperation.prototype.getAllExportRows=function(table,exportColumns){PTC.exportTable.log.trace("Entering exportListOperation.prototype.getAllExportRows ()");var colLen=exportColumns.length;var rowData=tableUtils.getFilteredRowData(table);var exportFunc=this.getSingleRowExportArray;var exportArrayFunc=this.getExportValue;var getRowFunc=getRowItem;var getCellFunc=jsca.columns.getCellValue;var allRows=[];var allOids=[];var isTree=table.tree;rowData.each(function(row,index){allOids.push(row.data.oid);
row.item=row;var isVisible=true;if(typeof row.isHideNotSel=="function")isVisible=!row.isHideNotSel();else if(isTree===true){var store=table.store;if(store&&typeof store.isVisibleNode=="function")isVisible=store.isVisibleNode(row,index)}if(isVisible)allRows.push(exportFunc(table,row,colLen,exportColumns,exportArrayFunc,getRowFunc,getCellFunc))});allRows.exportOids=allOids;if(PTC.exportTable.log.isDebugEnabled())allRows.each(function(row,index){PTC.exportTable.log.debug("Export Row Number:",index+1,
"Row Data:",row.toJSON(),"Row Oid:",allRows.exportOids[index])});return allRows};
exportListOperation.prototype.getSingleRowExportArray=function(table,row,colLen,exportColumns,exportFunc,getRowFunc,getCellFunc){var rowOut=[];for(var k=0;k<colLen;k++){var col=exportColumns[k];var efunc=col.efunc;if(typeof efunc==="undefined"&&typeof col.jscaRenderer!=="undefined"){col.jscaRenderer=PTC.util.convertStringToFunc(col.jscaRenderer);efunc=col.jscaRenderer.exportRenderer}if(typeof efunc==="undefined")efunc=jsca.columns.simpleExportRenderer;col=tableUtils.getColumnObject(col);var retObj=
exportFunc(table,col,row,efunc,getRowFunc,getCellFunc);if(retObj==="")retObj=" ";rowOut.push(retObj)}return rowOut};
exportListOperation.prototype.getExportColumns=function(table){PTC.exportTable.log.trace("Entering exportListOperation.prototype.getExportColumns ()");var exportColumnsTemp=PTC.jca.ColumnUtils.getVisibleColumns(table.getColumnModel());PTC.exportTable.log.debug("Number of Visible Columns in Table: ",exportColumnsTemp.length);var exportColumns=[];for(var i=0,l=exportColumnsTemp.length;i<l;i++){var columnTemp=exportColumnsTemp[i];if(this.isExportable(columnTemp))exportColumns.push(PTC.jca._getJscaCol(columnTemp));
else if(columnTemp.id!==null)PTC.exportTable.log.debug(columnTemp.id,"column is Visible, but NOT exportable")}return exportColumns};exportListOperation.prototype.isExportable=function(column){var exportable=true;var nonExportableColumns=exportListUtilities.getNonExportableColumns();if(nonExportableColumns[column.id]||column.grid||column.id.startsWith("infoPageActionReporting"))exportable=false;return exportable};
exportListOperation.prototype.exportDataToFile=function(table){PTC.exportTable.log.trace("Entering exportListOperation.prototype.exportDataToFile ()");var allRows=null;if(!table)table=this.getTable();var exportColumns=this.getExportColumns(table);PTC.exportTable.log.debug("Number of Columns being Exported: ",exportColumns.length);allRows=this.getAllExportRows(table,exportColumns);PTC.exportTable.log.debug("Number of Rows being Exported: ",allRows.length);allRows.headers=this.getHeaders(exportColumns);
return allRows};exportListOperation.prototype.getExportValue=function(table,column,row,efunc,getRowFunc,getCellFunc){var text=" ";if(efunc){text=efunc(table,column,row,getRowFunc,getCellFunc);if(text===null)text=" ";text=getUnescapedText(text)}else jsca.error("No efunc defined for column. "+"Need to add this column to the list of non-exportable columns or we need to add an efunc."+"Column: "+column);return text};
exportListOperation.prototype.showExportProgressInOpener=function(){PTC.exportTable.log.trace("Entering exportListOperation.prototype.showExportProgressInOpener ()");try{if(isIE)this.setSelectsVisibleState("none");if(this.isJCADebug)return;goProgress()}catch(e){jsca.error("error in show export progress",e)}};exportListOperation.prototype.hideExportProgressInOpener=function(){var exportDiv=$("exportProgressDiv");if(exportDiv)exportDiv.style.display="none";if(isIE)this.setSelectsVisibleState("inline")};
exportListOperation.prototype.setSelectsVisibleState=function(state){var selects=document.getElementsByTagName("select");for(var i=0,l=selects.length;i<l;i++)selects[i].style.display=state};exportListOperation.prototype.getTable=function(){PTC.exportTable.log.trace("Entering exportListOperation.prototype.getTable ()");var tableId=this.getTableId();var table=this.getTableWindow().tableUtils.getTable(tableId);if(table&&table.tabled)table=table.tabled;return table};
exportListOperation.prototype.getTableWindow=function(){return opener};
exportListOperation.prototype.isTablePaged=function(aWindow){PTC.exportTable.log.trace("Entering exportListOperation.prototype.isTablePaged ()");if(!aWindow){aWindow=opener;if(!aWindow)aWindow=window}var tableId=this.getTableId();tableId=tableUtils.getUnformattedTableId(tableId);var table=aWindow.tableUtils.getTable(tableId);if(exportListUtilities.isViewSelectedOnly(table)){PTC.exportTable.log.debug("Table is NOT Paged - is 'View Selected Object Only'");return false}var nextLink=aWindow.Ext.getCmp("nextResultSet_"+
tableId);var prevLink=aWindow.Ext.getCmp("previousResultSet_"+tableId);if(nextLink||prevLink){PTC.exportTable.log.debug("Table is Paged - Contains Next or Prev Link");return true}else{PTC.exportTable.log.debug("Table is NOT Paged - does NOT Contain next or Prev Link");return false}};
exportListOperation.prototype.isTree=function(){var table=this.getTable();var config=table.jcaTableConfig;if(config&&config.tree){PTC.exportTable.log.debug("Table is a tree structure");return true}else{PTC.exportTable.log.debug("Table is NOT a tree structure");return false}};
exportListOperation.prototype.endExportAndClose=function(exportData){PTC.exportTable.log.trace("Entering exportListOperation.prototype.endExportAndClose ()");if(!exportData){PTC.exportTable.log.debug("No export data passed in - using window.JSCA_EXPORT_DATA");exportData=window.JSCA_EXPORT_DATA}var exporter=this.getExporter();if(exporter){if(exportData.headers)exporter.appendColumnHeadersToForm(exportData.headers.join(this.DELIM));if(exportData.exportOids)exporter.appendOidsToForm(exportData.exportOids.join(this.DELIM));
exporter.appendRowsToForm(exportData);exporter.submitForm()}};exportListOperation.prototype.doExport=function(table){PTC.exportTable.log.trace("Entering exportListOperation.prototype.doExport ()");if(!table)table=this.getTable();var exportData=this.exportDataToFile(table);return exportData};IframeExportOperation=function(){exportListOperation.call(this)};IframeExportOperation.prototype=new exportListOperation;
IframeExportOperation.prototype.getIframeLocation=function(){PTC.exportTable.log.trace("Entering IframeExportOperation.prototype.getIframeLocation ()");var tableID=this.getTableId();var href=opener.PTC.jca.table.Utils.getTableUrl(tableID);href=URL_utils.removeAnchor(href);var sessionkey=(new Date).getTime();href+="&"+tableID+"lmt=-1&"+tableID+"fi=0&noSession=true&format="+this.getFileType()+"&exportSessionKey="+sessionkey+"&refreshTable="+tableID+"&portlet=poppedup";var mainform=getMainForm();mainform.appendChild(new JCAnewHiddenInputElement("exportSessionKey",
sessionkey,mainform));top.finishServerSideExport=function(){PTC.exportTable.log.trace("Entering top.finishServerSideExport ()");var opener=exportListUtilities.getOpener();var table=opener.tableUtils.getTable(tableID);var parametersStr=exportListUtilities.getTableColumnServerParameters(table);parametersStr+=opener.getSerializedMainForm();removeParamFromString(parametersStr,"refreshTable");var options={method:"post",onSuccess:function(transport){asyncResponseHandler.handleResponse(transport.responseText,
{})},onFailure:handleExportError,onException:handleExportError};options.parameters=parametersStr;requestHandler.doRequest(href,options)};function handleExportError(transport){Ext.MessageBox.show({title:"",msg:transport.responseText,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR});WaitAndClose()}};
exportListUtilities.jcaExportDataToFile=function(){PTC.exportTable.log.trace("Entering exportListUtilities.jcaExportDataToFile ()");var exportObj=new exportListOperation;var formattype=exportObj.getFileType();PTC.exportTable.log.debug("File Type: ",formattype);var table=exportObj.getTable();if(exportObj.isTree()||!PTC.jca.table.Utils.isAllDataLoaded(table)){exportObj=new IframeExportOperation;exportObj.getIframeLocation();PTC.wizard.submitWizard({skipAllValidation:true,successFunc:PTC.exportTable.exportTableSuccessListener});
stopProgress=function(){};setTimeout(goProgress,100);return false}else{var exportData=exportListUtilities.getOpener().exportListUtilities.jcaExportData(table);exportObj.showExportProgressInOpener();exportObj.endExportAndClose(exportData);return true}};exportListUtilities.jcaExportData=function(table){PTC.exportTable.log.trace("Entering exportListUtilities.jcaExportData ()");var exportObj=new exportListOperation;return exportObj.doExport(table)};
exportListUtilities.jcaExport=function(clickedButton){PTC.exportTable.log.trace("Entering exportListUtilities.jcaExport ()");if(clickedButton)clickedButton.disable();exportListUtilities.resetExportTableFile();exportListUtilities.jcaExportDataToFile()};
PTC.jca.ColumnUtils={log:log4javascript.getLogger("PTC.jca.ColumnUtils"),columnSizeCache:function(){return{getTableColumnCache:function(){var all=PTC.attributeHelper.get("columnSizeCache");if(!all){all={};PTC.attributeHelper.set("columnSizeCache",all)}return all},set:function(gridId,columnId,size){var all=this.getTableColumnCache(),gridColSizes=all[gridId];if(!gridColSizes)gridColSizes=all[gridId]={};gridColSizes[columnId]=size},get:function(gridId,columnId){var all=this.getTableColumnCache();var gridColSizes=
all[gridId];var colSize=null;if(gridColSizes&&gridColSizes[columnId])colSize=gridColSizes[columnId];return colSize}}}(),applySavedColumnWidthValues:function(gridId,colModel){var cachedWidth,col;var colModelConfigArray=colModel.config;if(!colModelConfigArray)return colModel;for(var i=0,l=colModelConfigArray.length;i<l;i++){col=colModelConfigArray[i];cachedWidth=this.columnSizeCache.get(gridId,col.id);if(cachedWidth!==null)col.width=cachedWidth;else if(l===1)col.width=200}return colModel},isVisibleDataColumn:function(column){return column.id!=
PTC.jca.table._STRETCHER_ID&&!column.hidden},getLastVisibleColumnIndex:function(columnModel){var count=columnModel.getColumnCount();for(var index=count-1;index>-1;index--)if(PTC.jca.ColumnUtils.isVisibleDataColumn(columnModel.config[index]))break;return index},isCheckerColumn:function(colModel,colIndex){return colModel&&colModel.getColumnId(colIndex)==="checker"},resizeAllColumns:function(grid,width,height,resizeLastColumn){PTC.performance.startComponentActionTimer("Column Resized",grid.id);var colModel=
grid.getColumnModel();var stickyConfig=grid.getStickyConfig();if(colModel){var colCount=colModel.getColumnCount();var columnResized=false;for(var c=0;c<colCount;c++)if(PTC.jca.ColumnUtils.isVisibleDataColumn(colModel.config[c]))if(colModel.isResizable(c)){if(this.resizeColumn(grid,c,false,stickyConfig)&&!columnResized)columnResized=true}else if(!PTC.jca.ColumnUtils.isCheckerColumn(colModel,c)&&colModel.getColumnWidth(c)<PTC.jca.ColumnUtils.MIN_COL_WIDTH){colModel.setColumnWidth(c,PTC.jca.ColumnUtils.MIN_COL_WIDTH);
PTC.jca.ColumnUtils.log.debug("resizeColumn-setWidth:",c," newWidth: ",PTC.jca.ColumnUtils.MIN_COL_WIDTH)}if(!resizeLastColumn)this.resizeLastColumn(grid,null,height)}if(columnResized===true)grid.fireEvent("columnConfigChange",grid);PTC.performance.stopComponentTimer(grid.id,null,"tableResized")},resizeLastColumn:function(grid,width,height){var colModel=grid.getColumnModel();var lastColIndx=colModel.getIndexById(PTC.jca.table._STRETCHER_ID);var lastColWidth=1;var cachedVal=null;var totalColWidth=
colModel.getTotalWidth(false)-colModel.getColumnWidth(lastColIndx)+lastColWidth;if(!width)width=grid.getInnerWidth();if(totalColWidth<width){var extraSpace=parseInt(width-totalColWidth,10);if(extraSpace>0){var newWidth=lastColWidth+extraSpace;var totalRowHeight;var wTable=Ext.getCmp(PTC.jca.table.getWTablePanelID(grid.id));var defaultTableHeight=PTC.jca.table.scroll.getDefaultTableHeight(wTable);if(grid.view.cumulativeRowHeight)totalRowHeight=grid.view.cumulativeRowHeight+defaultTableHeight;else{var rHeight=
typeof grid.view.getCalculatedRowHeight==="function"?grid.view.getCalculatedRowHeight():grid.view.rowHeight;var noRows=grid.store.getCount();totalRowHeight=rHeight*noRows+defaultTableHeight}if(!height)height=grid.getHeight();if(!grid.jcaCollapsed&&totalRowHeight>height)newWidth=newWidth-Ext.getScrollBarWidth();PTC.jca.ColumnUtils.log.debug("resizeLastColumn-setwidth:",grid.id," ",lastColIndx," ",lastColWidth," ",colModel.getColumnWidth(lastColIndx)," ",newWidth);colModel.setColumnWidth(lastColIndx,
newWidth-4)}}else if(grid.view.isLocked)grid.view.updateLockedWidth();else colModel.setColumnWidth(lastColIndx,lastColWidth)},resizeColumn:function(grid,index,canReduce,stickyConfig){var view=grid.getView();var colModel=grid.getColumnModel();var colId=colModel.getColumnId(index);var cachedVal=null;if(stickyConfig&&stickyConfig[index])cachedVal=stickyConfig[index].width;var column=grid.getColumnModel().getColumnAt(index);if(!canReduce&&PTC.isDefined(cachedVal)||column.columnResizeProperty&&column.columnResizeProperty.indexOf(PTC.jca.ColumnUtils.DO_NOT_CALCULATE)>
-1)return false;var origWidth=colModel.getColumnWidth(index);var newWidth=this.getCalculatedColumnWidth(grid,canReduce,index);if(canReduce||newWidth>origWidth&&Math.abs(newWidth-origWidth)>10||column.modifiable||column.useExact){PTC.jca.ColumnUtils.log.debug("resizeColumn-setWidth:",index," ",origWidth," ",newWidth);colModel.setColumnWidth(index,newWidth);return true}return false},getCalculatedColumnWidth:function(grid,canReduce,index){var l1=(new Date).getTime();try{var view=grid.getView();var colModel=
grid.getColumnModel();var newWidth=0,first=0,last=0;if(typeof view.getVisibleRowCount==="function"){var visibleRows=view.getVisibleRows();first=visibleRows.first;last=visibleRows.last}else{last=grid.getStore().getCount();last=last>15?15:last}newWidth=this.getColumnHeaderWidth(grid,index);var cell;var column=grid.getColumnModel().getColumnAt(index);if(column.columnResizeProperty&&column.columnResizeProperty.indexOf(PTC.jca.ColumnUtils.USE_EXACT)>-1)column.useExact=true;var isTree=grid.tree&&column.id===
grid.master_column_id;var longestString="";var dom;var cellPadding=0;for(var r=first;r<=last;r++){if(view.mainBody&&view.getRow(r))cell=view.getCell(r,index);var cellWidth=0;if(typeof cell==="undefined")break;if(isTree)cell=cell.firstChild.lastChild?cell.firstChild.lastChild:cell.firstChild;else cell=cell.firstChild;if(typeof cell==="undefined"||cell===null)break;if(canReduce||!cell.jcaScrollWidth){if(this.hasEditableChild(cell))column.useExact=true;var cellString;if(!canReduce)if(column.modifiable===
true||column.useExact)column.useExact=true;else{cellString=this.getCellString(cell);if(cellString&&cellString.length>longestString.length){longestString=cellString;dom=cell}}if(typeof column.getCellWidth==="function")cellWidth=column.getCellWidth(cell,grid,column);else if(column.useExact)cellWidth=this.getCellWidth(cell,cellString,grid,column.useExact);else cellWidth=this.getCellWidth(cell,cellString,grid,canReduce)}if(r===first){if(!cellPadding)cellPadding=this.getCellPadding(cell);cellWidth+=cellPadding}if(isTree){var rec=
grid.getStore().getAt(r);if(rec){var level=rec.get("_level");if(Ext.isNumber(level))cellWidth+=16*level+5}}newWidth=Math.max(newWidth,cellWidth,cell.jcaScrollWidth?cell.jcaScrollWidth:0)}if(dom){var tm=Ext.util.TextMetrics.createInstance(dom);if(longestString&&!column.useExact){var longestStringWidth=tm.getWidth(longestString)+cellPadding+2;newWidth=Math.max(newWidth,longestStringWidth)}}return newWidth}finally{var l2=(new Date).getTime();PTC.jca.ColumnUtils.log.debug("getCalculatedColumnWidth took: ",
l2-l1,grid.id,index)}},getCellString:function(cell){if(!cell)return cell;var text=isIE?cell.innerText:cell.textContent;if(Ext.isString(cell))return cell;else if(cell.innerHTML&&cell.innerHTML.indexOf("<")<0)return cell.innerHTML;else if(cell.childNodes&&cell.childNodes.length==1&&cell.firstChild.tagName==="A")return cell.firstChild.innerHTML;else if(text&&!text.blank())return text;return null},getExactCellWidth:function(cell){var cellWidth=0;cell.style.width="0px";cell.jcaScrollWidth=cell.scrollWidth+
5;cell.style.width="auto";cellWidth=cell.jcaScrollWidth;return cellWidth},hasEditableChild:function(cell){var returnVal=false;if(cell.hasChildNodes())for(var i=0;i<cell.childNodes.length;i++)if(cell.childNodes[i].type&&cell.childNodes[i].type!=="hidden"){returnVal=true;break}return returnVal},getCellWidth:function(cell,cellString,grid,useExact){var cellWidth=0;if(!useExact&&cellString)cellWidth=PTC.jca.ColumnUtils.getStringWidth(cellString,grid,cell);if(!useExact&&cell&&cell.childNodes&&cell.childNodes.length===
1&&cell.firstChild.firstChild&&cell.firstChild.firstChild.tagName==="IMG")cellWidth=Ext.fly(cell.firstChild).getWidth()+5;else if(!useExact&&cell&&cell.childNodes&&cell.childNodes.length===1&&cell.firstChild.tagName==="A")cellWidth=PTC.jca.ColumnUtils.getStringWidth(cell.firstChild.innerHTML,grid,cell)+10;else if(cell&&useExact)cellWidth=this.getExactCellWidth(cell);return cellWidth},getColumnHeaderWidth:function(grid,index){var headerWidth=0;var view=grid.getView();var headerCell=view.getHeaderCell(index);
if(headerCell&&headerCell.firstChild){if(headerCell.innerText==="")headerCell.innerText=" ";if(headerCell.textContent==="")headerCell.textContent=" ";var ele=headerCell.innerText||headerCell.textContent;return this.getCellWidth(null,this.getCellString(ele),grid)+5}return 0},getVisibleColumns:function(columnModel){var visibleColumns=columnModel.getColumnsBy(PTC.jca.ColumnUtils.isVisibleDataColumn);return visibleColumns},getVisibleColumnIds:function(columnModel){var count=columnModel.getColumnCount(),
visibleColumnIds=[],colConfigs=columnModel.config;for(var index=0;index<count;index++)if(PTC.jca.ColumnUtils.isVisibleDataColumn(colConfigs[index]))visibleColumnIds.push(colConfigs[index].id);return visibleColumnIds}};
PTC.jca.ColumnUtils.getStringWidth=function(text,grid,dom){if(text){var maxCellWidth=PTC.jca.ColumnUtils.getAverageCharacterPixelWidth(text,grid,dom)*150+10;var cellWidth=text.length*PTC.jca.ColumnUtils.getAverageCharacterPixelWidth(text,grid,dom)+10;return maxCellWidth<cellWidth?maxCellWidth:cellWidth}return 0};
PTC.jca.ColumnUtils.getAverageCharacterPixelWidth=function(text,grid,dom){if(!dom)dom=grid.getEl().dom;var tm=Ext.util.TextMetrics.createInstance(dom);var TABLE_TEXT=bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_TEXT");var avgSize=tm.getWidth(TABLE_TEXT)/TABLE_TEXT.length;PTC.jca.ColumnUtils.getAverageCharacterPixelWidth=function(){return avgSize};return avgSize};
PTC.jca.ColumnUtils.getCellPadding=function(cell){var newWidth=0;var leftPadding=0;var rightPadding=0;if(cell.currentStyle){leftPadding=parseInt(cell.currentStyle.paddingLeft,10);rightPadding=parseInt(cell.currentStyle.paddingRight,10)}else{var currentStyle=document.defaultView.getComputedStyle(cell,null);leftPadding=parseInt(currentStyle.getPropertyValue("padding-left"),10);rightPadding=parseInt(currentStyle.getPropertyValue("padding-right"),10)}if(!isNaN(leftPadding))newWidth+=leftPadding;if(!isNaN(rightPadding))newWidth+=
rightPadding;PTC.jca.ColumnUtils.getCellPadding=function(){return newWidth};return newWidth};PTC.jca.ColumnUtils.USE_EXACT="USE_EXACT";PTC.jca.ColumnUtils.AUTO_SIZE="AUTO_SIZE";PTC.jca.ColumnUtils.DO_NOT_CALCULATE="DO_NOT_CALCULATE";PTC.jca.ColumnUtils.MIN_COL_WIDTH=32;PTC.jca.SORT_DELIMITER="$";PTC.jca.VERSION_COLUMN_NAME=["version","iteration","revision"];PTC.jca.BACKING_VERSION_COLUMN_NAME="backingVersionOid";
PTC.jca.getClientSortProvider=function(){if(PTC.jca.clientSortProvider===undefined)PTC.jca.clientSortProvider=new PTC.jca.state.ClientStateProvider({domstorage:"local"});return PTC.jca.clientSortProvider};Ext.onReady(PTC.jca.getClientSortProvider);
Ext.override(Ext.data.Store,{load:function(options){options=Ext.apply({},options);this.storeOptions(options);if(this.sortInfo&&this.remoteSort){var pn=this.paramNames;options.params=Ext.apply({},options.params);if(this.jsca_table!==undefined&&this.jsca_table.jcaTableConfig.tree!==undefined){var activeNodeParams={};activeNodeParams[this.paramNames.active_node]=this.active_node?this.active_node.id:null;Ext.applyIf(options.params,activeNodeParams);if(options.params[this.paramNames.active_node]!==null)options.add=
true}var dir=this.sortInfo.direction;var col=this.columnId;if(dir&&dir=="DESC")dir="d";else dir="u";this.sortInfo.dir=dir;if(typeof this.columnId!=="undefined")this.sortInfo.columnId=this.columnId;if(this.remoteSort){options.params.acquire="row";var multiSortString=PTC.jca.getMultiColumnSortString(this.jscaTableID);if(multiSortString!==null){var multiSortArray=multiSortString.split(PTC.jca.SORT_DELIMITER);var tableCmp=Ext.getCmp(this.jscaTableID);for(var i=0;i<multiSortArray.length-1&&i<6;i+=2)if(i===
0){options.params[this.jscaTableID+"sc"]=PTC.jca.getServerIdFromJSColumnId(tableCmp,multiSortArray[i]);options.params[this.jscaTableID+"sd"]=multiSortArray[i+1]}else if(i===2){options.params[this.jscaTableID+"sc2"]=PTC.jca.getServerIdFromJSColumnId(tableCmp,multiSortArray[i]);options.params[this.jscaTableID+"sd2"]=multiSortArray[i+1]}else if(i===4){options.params[this.jscaTableID+"sc3"]=PTC.jca.getServerIdFromJSColumnId(tableCmp,multiSortArray[i]);options.params[this.jscaTableID+"sd3"]=multiSortArray[i+
1]}}}}try{return this.execute("read",null,options)}catch(e){this.handleException(e);return false}}});
Ext.override(Ext.data.GroupingStore,{applySort:function(){if((this.sortInfo||this.multiSortInfo)&&!this.remoteSort)return this.sortData()},isGroupingActionClicked:function(){return this.jsca_table&&this.jsca_table.getView().groupingAction},updateViewAfterSort:function(grid,orderChanged){if(orderChanged||grid.tree)if(this.dataChangeTask!==undefined)this.dataChangeTask.delay(this.dataChangeTask.delay_time,null,this,[this]);else{PTC.jca.table.scroll.resetRowHeightCache(grid);if(grid.rendered&&(grid.tree||
grid.getView().ds&&grid.getView().canGroup&&grid.getView().canGroup()))grid.getView().refresh();else grid.getView().doPartialDataChange(true);grid.getView().updateHeaderSortState()}else grid.getView().updateHeaderSortState()},sort:function(fieldName,dir){var grouping=false;if(typeof fieldName==="object"&&this.groupField){fieldName=this.groupField;dir=this.groupDir;grouping=true}var f=this.fields.get(fieldName);if(!f){PTC.jca.clearGroupingString(this.jscaTableID);return false}if(!dir)if(this.sortInfo&&
this.sortInfo.field==f.name)dir=(this.sortToggle[f.name]||"ASC").toggle("ASC","DESC");else dir=f.sortDir;var st=this.sortToggle?this.sortToggle[f.name]:null;var si=this.sortInfo?this.sortInfo:null;this.sortToggle[f.name]=dir;this.sortInfo={field:f.name,direction:dir};if(fieldName===this.groupField)this.groupDir=dir;if(this.shiftKeyOn||!grouping&&this.groupField){PTC.jca.updateTableSortInfoString(this.jscaTableID,this.sortInfo.field,this.sortInfo.direction,this.shiftKeyOn,this.groupField,this.groupDir,
true);this.shiftKeyOn=false}else if(!this.groupField||this.groupField&&this.isGroupingActionClicked())PTC.jca.updateTableSortInfoString(this.jscaTableID,this.sortInfo.field,this.sortInfo.direction,false,this.groupField,this.groupDir,false);var grid=PTC.jca.table.Utils.getTable(this.jscaTableID);this.remoteSort=PTC.jca.isRemoteSort(this,grid);if(!this.remoteSort&&PTC.jca.isVersionField(this.sortInfo.field))return;if(!this.remoteSort){var orderChanged=this.applySort();this.updateViewAfterSort(grid,
orderChanged)}else{this.lastOptions=this.lastOptions||{};this.lastOptions.params=this.lastOptions.params||{};this.lastOptions.params.executeLocation="sort";PTC.jca.sortVersion(this)}},removeAll:function(silent){if(this.removeMutex===true)return;this.removeMutex=true;try{var items=[];this.each(function(rec){items.push(rec)});this.clearData();if(this.snapshot)this.snapshot.clear();if(this.pruneModifiedRecords)this.modified=[];if(silent!==true)this.fireEvent("clear",this,items);this.removeMutex=false}finally{this.removeMutex=
false}}});PTC.jca.isLCGrid=function(store){if(store&&store.jsca_table&&store.jsca_table.jcaTableConfig.jsttd)return true;return false};PTC.jca.setLCvindex=function(store,dir){if(store){var t=store.jsca_table;if(t&&t.jcaTableConfig.jsttd)try{var vi=0;if(dir==="ASC")vi=store.getCount()+1;var vp=PTC.jca.BACKING_VERSION_COLUMN_NAME;var vf=function(record){if(!record.data.hasOwnProperty(vp))record.vindex=vi};store.each(vf)}catch(e){PTC.jca.table.log.debug("Exception:"+e+" in JST version sorting in function PTC.jca.setLCvindex")}}};
PTC.jca.sortVersion=function(store){if(!store.data)store=this.store;var tableId=store.jscaTableID;var multiColumnSortString=PTC.jca.getMultiColumnSortString(tableId);var multiSortArray=multiColumnSortString.split(PTC.jca.SORT_DELIMITER);var options;var url,grid,oids;if(multiSortArray.length>3&&!PTC.jca.isVersionField(multiSortArray[0])){var oidjson={oidarray:[]};url=getBaseHref()+PTC.jca.requestPath+"/vmultisort";if(store.jsca_table&&store.jsca_table.tree)jsca.EXT_SORT_DATA.call(store,"","",store.multiSortFn,
true,PTC.jca.tree.updateOidMap,oidjson);else jsca.EXT_SORT_DATA.call(store,"","",store.multiSortFn,true,PTC.jca.table.updateOidMap,oidjson);if(oidjson.oidarray.length>0)options={asynchronous:false,parameters:{cmpid:tableId,direction:store.sortInfo.direction,jsonSupport:PTC.jca.jsonSupport,oidjson:Ext.encode(oidjson)},method:"post",onSuccess:function(response){PTC.jca.handleVersionSortResponse(response)}};else PTC.jca.handleVersionSortForNoRequest(tableId)}else{url=getBaseHref()+PTC.jca.requestPath+
"/vsort";if(tableId)oids=PTC.jca.getBackingOids(tableId);var lcg=PTC.jca.isLCGrid(store);if(lcg)PTC.jca.setLCvindex(store,store.sortInfo.direction);if(oids.size()===0&&!lcg)oids=oidUtils.getTableOids(tableId);if(oids.size()>0)options={asynchronous:false,parameters:{oids:oids,cmpid:tableId,direction:store.sortInfo.direction,jsonSupport:PTC.jca.jsonSupport},method:"post",onSuccess:function(response){PTC.jca.handleVersionSortResponse(response)}};else PTC.jca.handleVersionSortForNoRequest(tableId)}if(PTC.isDefined(options))requestHandler.doRequest(url,
options)};PTC.jca.getBackingOids=function(tableID,oids){var oidList=[];var rows=tableUtils.getTableRows(tableID);if(rows&&rows.items){var items=rows.items;for(var i=0,len=items.length;i<len;i++)if(items[i].data[PTC.jca.BACKING_VERSION_COLUMN_NAME])oidList.push(items[i].data[PTC.jca.BACKING_VERSION_COLUMN_NAME])}return oidList};
PTC.jca.handleVersionSortResponse=function(response){var text=response.responseText;var versionSortResponse=null;PTC.jca.table.tieOidPrimary=new Ext.util.MixedCollection;if(PTC.isDefined(text))try{if(PTC.jca.jsonSupport)versionSortResponse=JSON.parse(text);else versionSortResponse=eval(text)}catch(e){}if(PTC.isDefined(versionSortResponse)){var mapped=PTC.jca.mapBackingOidtoOid(versionSortResponse);PTC.jca.updateTableSingleSort(versionSortResponse,mapped)}};
PTC.jca.handleVersionSortForNoRequest=function(tableId){grid=tableUtils.getTable(tableId);grid.getView().updateHeaderSortState();grid.getView().doPartialDataChange(true)};
PTC.jca.mapBackingOidtoOid=function(versionSortResponse){var sortedOids={};var backingOid=false;var tableId=versionSortResponse.cmpId;var store;if(PTC.isDefined(tableId))store=tableUtils.getTable(tableId).store;if(PTC.jca.isLCGrid(store))backingOid=true;else{var record=store.getAt(0);if(record.data[PTC.jca.BACKING_VERSION_COLUMN_NAME]!==undefined)backingOid=true}if(backingOid){sortedOids=versionSortResponse.sortedOids;if(sortedOids)for(var key in sortedOids)if(typeof key==="string"||typeof key===
"number"){var index=sortedOids[key];var records=store.query(PTC.jca.BACKING_VERSION_COLUMN_NAME,key);var j=records.length;while(j--)records.get(j).vindex=index}}return backingOid};
PTC.jca.updateTableSingleSort=function(sortResponse,mapped){var tableId=sortResponse.cmpId;var store;var table;if(PTC.isDefined(tableId)){table=Ext.getCmp(tableId);store=table.store}var sortedOids={};if(!mapped){sortedOids=sortResponse.sortedOids;var indexFunc=function(rec){return rec.get("oid")===this.currentKey};for(var key in sortedOids)if(typeof key==="string"||typeof key==="number"){var index=sortedOids[key];if(table.jcaTableConfig.generateRowId||table.jcaTableConfig.tree){var records=store.queryExact("oid",
key);var i=records.length;while(i--)records.get(i).vindex=index}else{var recordindex=store.findExact("oid",key);var record;if(recordindex===-1&&store.snapshot){store.snapshot.currentKey=key;recordindex=store.snapshot.findIndexBy(indexFunc,store.snapshot,0);record=store.snapshot.get(recordindex);record.vindex=index;store.snapshot.currentKey=null}else if(recordindex>=0){record=store.getAt(recordindex);record.vindex=index}}}}if(PTC.isDefined(sortedOids)){var orderChanged=jsca.EXT_SORT_DATA.call(store,
"","",store.multiSortFn,"","","");if(store.jsca_table.tree)store.applyTreeSort();if(orderChanged)store.fireEvent("datachanged",store)}};PTC.jca.updateTieOidPrimary=function(tieOidsMap){for(var key in tieOidsMap)if(typeof key==="string"||typeof key==="number"){var index=tieOidsMap[key];PTC.jca.table.tieOidPrimary.add(key,index)}};Ext.data.Store.prototype.sort=Ext.data.Store.prototype.sort.wrap(function(proceed){try{return proceed.apply(this,$A(arguments).slice(1))}finally{this.fireEvent("sort",this)}});
Ext.override(Ext.grid.GridView,{updateSortIcon:function(col,dir){var sc=["x-grid3-sort-asc1","x-grid3-sort-asc2","x-grid3-sort-asc3","x-grid3-sort-desc1","x-grid3-sort-desc2","x-grid3-sort-desc3"];var noHeaderStyles=["sort-asc-noHeader","sort-desc-noHeader"];var mainHdTd=this.mainHd.select("td");var hds=mainHdTd.removeClass(sc);var lmainHdTd,lhds,llen,lockedUpdate,width,columnId,len;if(this.lockedHd&&this.isLocked){lmainHdTd=this.lockedHd.select("td");lhds=lmainHdTd.removeClass(sc);llen=this.cm.getLockedCount();
lockedUpdate=col<llen;lhds=lmainHdTd.removeClass(noHeaderStyles);len=col-llen;if(lockedUpdate){width=lhds.item(col).getComputedWidth();columnId=this.grid.getColumnModel().getColumnId(col)}else{width=hds.item(len).getComputedWidth();columnId=this.grid.getColumnModel().getColumnId(col-llen)}}else{lockedUpdate=false;len=col;columnId=this.grid.getColumnModel().getColumnId(col)}hds=mainHdTd.removeClass(noHeaderStyles);var styleIndex=dir=="DESC"?3:0;var multiSortStr=PTC.jca.getMultiColumnSortString(this.grid.id);
if(multiSortStr!==null){var multiSortArray=multiSortStr.split(PTC.jca.SORT_DELIMITER);for(var i=0,j=0;i<multiSortArray.length-1;i+=2,j++){styleIndex=multiSortArray[i+1]=="d"?3:0;var columnIndex=this.grid.getColumnModel().getIndexById(multiSortArray[i]);if(columnIndex>=0)if(llen)if(columnIndex<llen)lhds.item(columnIndex).addClass(sc[styleIndex+j]);else hds.item(columnIndex-llen).addClass(sc[styleIndex+j]);else hds.item(columnIndex).addClass(sc[styleIndex+j])}}else{if(lockedUpdate)lhds.item(col).addClass(sc[styleIndex]);
else hds.item(len).addClass(sc[styleIndex]);var sortDir=dir=="DESC"?"d":"u";var multiSortInfoStr=columnId+PTC.jca.SORT_DELIMITER+sortDir+PTC.jca.SORT_DELIMITER;PTC.jca.setMultiColumnSortString(this.grid.id,multiSortInfoStr)}},onHeaderClick:function(g,index,e){if(this.headersDisabled||!this.cm.isSortable(index))return;g.stopEditing(true);g.store.columnId=g.getColumnModel().getColumnId(index);if(e.shiftKey)g.store.shiftKeyOn=true;else g.store.shiftKeyOn=false;PTC.jca.handleSortOnHdClick(g);g.store.sort(this.cm.getDataIndex(index))},
handleHdMenuClick:function(item,e){var index=this.hdCtxIndex,cm=this.cm,ds=this.ds,id=item.getItemId();if(PTC.trail.isTrailEnabled())PTC.trail.hmenuItem.listener(item.itemId,this.grid.id);ds.columnId=cm.getColumnId(index);if(e&&e.shiftKey){e.stopEvent();ds.shiftKeyOn=true}else ds.shiftKeyOn=false;if(id=="asc"||id=="desc")PTC.jca.handleSortOnHdClick(this.grid);switch(id){case "asc":ds.sort(cm.getDataIndex(index),"ASC");break;case "desc":ds.sort(cm.getDataIndex(index),"DESC");break;case "wrapContent":PTC.jca.table.Utils.wrapContent(this.grid,
index);break;default:index=cm.getIndexById(id.substr(4));if(index!=-1){if(item.checked&&this.isRemoveColumn()){this.onDenyColumnHide();return false}cm.setHidden(index,item.checked)}}return true},isRemoveColumn:function(){var cm=this.cm,grid=this.grid,MIN_COLUMNS=2;if(grid&&grid.wtableRef&&grid.wtableRef.selectable!==false)MIN_COLUMNS++;return cm.getColumnsBy(this.isHideableColumn,this).length<=MIN_COLUMNS}});
PTC.jca.handleSortOnHdClick=function(grid){var gridView=grid.getView();var ds=grid.getStore();if(grid.tree&&gridView.clearVisibleCaches)gridView.clearVisibleCaches();if(ds.moreData===true)PTC.jca.DataSourceRegistry.showIncompleteDataWarning("com.ptc.netmarkets.util.utilResource.SORTING_WHEN_MAX_LIMIT_REACHED_WARNING","com.ptc.netmarkets.util.utilResource.SORTING_WHEN_MAX_LIMIT_REACHED_DETAILED_MESSAGE")};
PTC.jca.isRemoteSort=function(rowStore,table){var sortInfo=PTC.jca.table.Utils.getTableSortInfo(table);if(sortInfo!==undefined)for(var i=0;i<sortInfo.size();i++)if(PTC.jca.isVersionField(sortInfo[i].columnID)&&PTC.jca.isVersionField(rowStore.sortInfo.field))return true;return false};PTC.jca.isVersionField=function(field){return PTC.jca.VERSION_COLUMN_NAME.indexOf(field)>=0?true:false};
PTC.jca.isSortedByVersion=function(multiSortInfo){var columnIdsAndDirection=multiSortInfo.split(PTC.jca.SORT_DELIMITER);var len=columnIdsAndDirection.length;for(var i=0;i<len;i+=2){var id=columnIdsAndDirection[i];if(PTC.jca.isVersionField(id))return true}return false};
PTC.jca.updateTableSortInfoString=function(tableId,sortColumn,sortDirection,append,grouping,groupingDir,updateGrouping){var dir=sortDirection==="DESC"?"d":"u";groupingDir=groupingDir==="DESC"?"d":"u";var groupingString=grouping?grouping+PTC.jca.SORT_DELIMITER+groupingDir+PTC.jca.SORT_DELIMITER:null;var multiSortStr=PTC.jca.getMultiColumnSortString(tableId);if(!append)if(updateGrouping&&groupingString!==null&&!PTC.jca.isSingleSortAndGroup(sortColumn,grouping))multiSortStr=groupingString+sortColumn+
PTC.jca.SORT_DELIMITER+dir+PTC.jca.SORT_DELIMITER;else multiSortStr=sortColumn+PTC.jca.SORT_DELIMITER+dir+PTC.jca.SORT_DELIMITER;else{var multiSortStrModified="";if(multiSortStr!==null){var multiSortArray=multiSortStr.split(PTC.jca.SORT_DELIMITER);var columnAlreadyPresent=false;for(var i=0;i<multiSortArray.length-1&&i<6;i+=2)if(sortColumn!==multiSortArray[i])if(i===0)multiSortStrModified=multiSortArray[i]+PTC.jca.SORT_DELIMITER+multiSortArray[i+1]+PTC.jca.SORT_DELIMITER;else multiSortStrModified=
multiSortStrModified+multiSortArray[i]+PTC.jca.SORT_DELIMITER+multiSortArray[i+1]+PTC.jca.SORT_DELIMITER;else{multiSortStrModified=multiSortStrModified+multiSortArray[i]+PTC.jca.SORT_DELIMITER+dir+PTC.jca.SORT_DELIMITER;columnAlreadyPresent=true}multiSortStr=multiSortStrModified;if(i<6&&!columnAlreadyPresent)multiSortStr=multiSortStr+sortColumn+PTC.jca.SORT_DELIMITER+dir+PTC.jca.SORT_DELIMITER}else multiSortStr=sortColumn+PTC.jca.SORT_DELIMITER+dir+PTC.jca.SORT_DELIMITER}PTC.jca.setMultiColumnSortString(tableId,
multiSortStr);PTC.jca.setSortChangedByClient(tableId);if(groupingString!==null)PTC.jca.setGroupingString(tableId,groupingString)};PTC.jca.getMultiColumnSortString=function(tableId){var multiColumnStr=PTC.jca.getClientSortProvider().get(tableId+"_Sorting_Column_Info","noValue");if(typeof multiColumnStr!=="undefined"&&multiColumnStr!=="noValue"&&multiColumnStr.indexOf("undefined")==-1)return multiColumnStr;return null};
PTC.jca.getGroupingString=function(tableId){var groupingStr=PTC.jca.getClientSortProvider().get(tableId+"_Grouping_Column_Info","noValue");if(typeof groupingStr!=="undefined"&&groupingStr!=="noValue"&&groupingStr.indexOf("undefined")==-1)return groupingStr;return null};PTC.jca.setMultiColumnSortString=function(tableId,multiColumnSortInfoString){PTC.jca.getClientSortProvider().set(tableId+"_Sorting_Column_Info",multiColumnSortInfoString)};
PTC.jca.setGroupingString=function(tableId,groupingString){PTC.jca.getClientSortProvider().set(tableId+"_Grouping_Column_Info",groupingString)};PTC.jca.setSortChangedByClient=function(tableId){PTC.jca.getClientSortProvider().set(tableId+"_clientSortUpdated",true)};PTC.jca.setGroupingChangedByClient=function(tableId){PTC.jca.getClientSortProvider().set(tableId+"_clientGroupingUpdated",true)};
PTC.jca.isSortChangedByClient=function(tableId){var isClientSortUpdated=PTC.jca.getClientSortProvider().get(tableId+"_clientSortUpdated",false);if(isClientSortUpdated===true)return isClientSortUpdated;return false};PTC.jca.isGroupingChangedByClient=function(tableId){var isClientGroupingUpdated=PTC.jca.getClientSortProvider().get(tableId+"_clientGroupingUpdated",false);if(isClientGroupingUpdated===true)return isClientGroupingUpdated;return false};
PTC.jca.clearMultiColumnSortString=function(tableId){PTC.jca.getClientSortProvider().clear(tableId+"_Sorting_Column_Info");PTC.jca.getClientSortProvider().clear(tableId+"_clientSortUpdated")};PTC.jca.clearGroupingChangedByClient=function(tableId){PTC.jca.getClientSortProvider().clear(tableId+"_clientGroupingUpdated")};PTC.jca.clearMultiColumnSortAndGroupingString=function(tableId){PTC.jca.clearMultiColumnSortString(tableId);PTC.jca.clearGroupingString(tableId)};
PTC.jca.clearGroupingString=function(tableId){PTC.jca.getClientSortProvider().clear(tableId+"_Grouping_Column_Info")};PTC.jca.calculateGroupByField=function(jcaTableConfig,colModel){var stickyGroup=PTC.jca.getGroupingString(jcaTableConfig.tableID);var stickyGroupString=stickyGroup?PTC.jca.getGroupingArray(stickyGroup)[0]:null;return PTC.jca._findRelevantGroupByField(jcaTableConfig.groupBy,stickyGroupString,PTC.jca.isGroupingChangedByClient(jcaTableConfig.tableID),colModel)};
PTC.jca._findRelevantGroupByField=function(serverGroupString,stickyGroupString,groupingChangedByClient,colModel){var groupBy=serverGroupString;if(PTC.isDefined(serverGroupString)&&groupingChangedByClient)groupBy=undefined;if(PTC.isDefinedAndNotEmptyString(stickyGroupString))groupBy=stickyGroupString;if(PTC.isDefined(groupBy)){var visible_columnId_Arr=PTC.jca.ColumnUtils.getVisibleColumnIds(colModel);var grpColumn=groupBy.split(PTC.jca.SORT_DELIMITER)[0];if(PTC.isDefinedAndNotEmptyString(grpColumn)&&
visible_columnId_Arr.indexOf(grpColumn)===-1)if(grpColumn!==serverGroupString&&PTC.isDefinedAndNotEmptyString(serverGroupString)&&visible_columnId_Arr.indexOf(serverGroupString)!==-1)groupBy=serverGroupString;else groupBy=undefined}return groupBy};
PTC.jca._isResetClientSortInfo=function(initialClientSortInfo,columnModel){var reset_clientSortInfo=false;if(PTC.isDefined(initialClientSortInfo)){var visible_columnId_Arr=PTC.jca.ColumnUtils.getVisibleColumnIds(columnModel);var multiSortArray=initialClientSortInfo.split(PTC.jca.SORT_DELIMITER);for(var i=0;i<multiSortArray.length-1;i+=2)if(PTC.isDefinedAndNotEmptyString(multiSortArray[i]))if(visible_columnId_Arr.indexOf(multiSortArray[i])===-1){reset_clientSortInfo=true;break}}return reset_clientSortInfo};
PTC.jca.initializeSortInfo=function(jcaTableConfig,tablePanel){var initialClientSortInfo=PTC.jca.getMultiColumnSortString(jcaTableConfig.tableID);var go_with_serverSortInfo=false;if(initialClientSortInfo===null)go_with_serverSortInfo=true;else if(PTC.jca._isResetClientSortInfo(initialClientSortInfo,tablePanel.getColumnModel())){PTC.jca.clearMultiColumnSortAndGroupingString(jcaTableConfig.tableID);go_with_serverSortInfo=true}if(go_with_serverSortInfo){if(jcaTableConfig.serverSortInfo){var clientSortInfo=
PTC.jca.getClientMultiSortInfoString(tablePanel,jcaTableConfig.serverSortInfo);PTC.jca.setMultiColumnSortString(jcaTableConfig.tableID,clientSortInfo);initialClientSortInfo=clientSortInfo;if(clientSortInfo&&PTC.jca.isSortedByVersion(clientSortInfo))PTC.jca.registerVersionSort(tablePanel);else tablePanel.gridPanel.store.clientSortRequired=true}}else if(initialClientSortInfo&&PTC.jca.isSortedByVersion(initialClientSortInfo))PTC.jca.registerVersionSort(tablePanel);else if(!tablePanel.gridPanel.store.clientSortRequired)tablePanel.gridPanel.store.clientSortRequired=
PTC.jca.isSortChangedByClient(jcaTableConfig.tableID);PTC.jca.syncStoreSortInfo(tablePanel.gridPanel.store,initialClientSortInfo)};PTC.jca.syncStoreSortInfo=function(store,multiSortString){if(multiSortString!==null){var multiSortArray=multiSortString.split(PTC.jca.SORT_DELIMITER);var sortDir=multiSortArray[multiSortArray.length-2]==="u"?"ASC":"DESC";store.sortInfo={field:multiSortArray[multiSortArray.length-3],direction:sortDir}}};
PTC.jca.registerVersionSort=function(tablePanel){var store=tablePanel.gridPanel.store;if(store.chunkEnabled)tablePanel.gridPanel.on("datarendered",PTC.jca.sortVersion);else tablePanel.gridPanel.on("renderTableEnd",PTC.jca.sortVersion)};PTC.jca.getServerIdFromJSColumnId=function(grid,jsColumnId){var columnConfig=grid.getColumnModel().config;var len=grid.selectable?columnConfig.length-1:columnConfig.length;for(var i=0;i<len;i++)if(columnConfig[i].id===jsColumnId)return columnConfig[i].origId;return jsColumnId};
PTC.jca.getJSColumnIdFromServerId=function(grid,serverColumnId){var columnConfig=grid.getColumnModel().config;var len=grid.selectable?columnConfig.length-1:columnConfig.length;for(var i=0;i<len;i++)if(columnConfig[i].origId===serverColumnId)return columnConfig[i].id;return serverColumnId};
PTC.jca.getClientMultiSortInfoString=function(grid,serverSortString){var multiSortArray=serverSortString.split(PTC.jca.SORT_DELIMITER);var clientSortString="";for(var i=0;i<multiSortArray.length-1;i+=2)clientSortString+=PTC.jca.getJSColumnIdFromServerId(grid,multiSortArray[i])+PTC.jca.SORT_DELIMITER+multiSortArray[i+1]+PTC.jca.SORT_DELIMITER;return clientSortString};
PTC.jca.getGroupingArray=function(groupingString){var groupingArray=groupingString.split(PTC.jca.SORT_DELIMITER);if(groupingArray.length<2)groupingArray.push("d");return groupingArray};PTC.jca.isSingleSortAndGroup=function(sortString,groupingString){return sortString===groupingString};
PTC.jca.groupingRenderer=function(val,metadata,record,rowIndex,colIndex,store){var groupText="";if(colIndex>=0&&record!==undefined){var jsca_table=store.jsca_table;if(jsca_table===undefined)jsca_table=tableUtils.getTable(store.jscaTableID);var column=jsca_table.getColumnModel().config[colIndex];if(column&&column.renderer&&typeof column.renderer.groupFunc==="function"){var result=column.renderer.groupFunc(jsca_table,column,record);if(Ext.isString(result)){groupText=getUnescapedText(result.strip());
return groupText}}groupText=jsca.columns.getJSCASearchText(jsca_table,column,record)}return groupText};PTC.jca.versionGroupingRenderer=function(val,metadata,record,rowIndex,colIndex,store){if(val&&val.gui&&val.gui.html)return val.gui.html;else return""};
jsca.EXT_SORT_DATA=function(field,direction,tempSort,calculateOidMap,updateOidMapFn,oidjson){var multiColumnSortString=PTC.jca.getMultiColumnSortString(this.jscaTableID);var multipleSortInfo=[];var st=[];if(tempSort===true){multipleSortInfo.push({field:field,direction:direction,comparableFunc:jsca.folderCompare,isVersion:PTC.jca.isVersionField(field)});st.push(this.fields.get(field).sortType)}if(tempSort!==true&&typeof multiColumnSortString!=="undefined"&&multiColumnSortString!==null){PTC.jca.setSortChangedByClient(this.jscaTableID);
var multiSortArray=multiColumnSortString.split(PTC.jca.SORT_DELIMITER);var columnModel=null;if(this.jsca_table===undefined)this.jsca_table=tableUtils.getTable(this.jscaTableID);if(this.jsca_table){columnModel=this.jsca_table.getColumnModel();PTC.jca.table.Utils.unfocusRow(this.jsca_table,true)}for(var i=0,sortCount=0;i<multiSortArray.length-1;i+=2){var columnIndex;if(this.selectable)columnIndex=parseInt(multiSortArray[i],10)-1;else columnIndex=parseInt(multiSortArray[i],10);var sortFieldObj=this.fields.get(multiSortArray[i]);
if(sortFieldObj){multipleSortInfo.push({field:sortFieldObj.name,direction:multiSortArray[i+1]==="u"?"ASC":"DESC",isVersion:PTC.jca.isVersionField(sortFieldObj.name)});if(columnModel){var config=columnModel.getColumnById(sortFieldObj.name);var customCompareFunc;if(config)customCompareFunc=config.compareJsFunction;if(customCompareFunc&&typeof customCompareFunc==="string"){var sortFunction=PTC.util.convertStringToFunc(customCompareFunc);if(typeof sortFunction==="function")multipleSortInfo[sortCount].comparableFunc=
sortFunction}}if(multipleSortInfo[sortCount].isVersion&&!calculateOidMap)multipleSortInfo[sortCount].comparableFunc=jsca.versionCompare;if(typeof multipleSortInfo[sortCount].comparableFunc!=="function")multipleSortInfo[sortCount].comparableFunc=jsca.folderCompare;st.push(sortFieldObj.sortType);sortCount++}}}if(sortCount===undefined)return;if(calculateOidMap===true&&typeof updateOidMapFn!="function")return;var hasVersionMulti=this.hasVersionMultiSort(multipleSortInfo);var calculatedTrue=calculateOidMap===
true;if(sortCount==1&&multipleSortInfo[0].comparableFunc===jsca.folderCompare){var orderChanged=PTC.jca.table.singleColumnSort(multipleSortInfo,this,this.sortSnapShotData);delete this.sortSnapShotData;return orderChanged}else{this.multiSortFn=function(r1,r2){var result=false;for(var i=0,mlength=multipleSortInfo.length;i<mlength;i++){var currentSortInfo=multipleSortInfo[i];var field=currentSortInfo.field;var v1=st[i](r1.data[field]);var v2=st[i](r2.data[field]);if(currentSortInfo.isVersion&&calculateOidMap)break;
else result=currentSortInfo.comparableFunc(v1,v2,r1,r2);if(currentSortInfo.direction==="DESC")result=-1*result;if(result)return result}if(calculatedTrue&&result===0){var v1oid=r1.data.oid;var v2oid=r2.data.oid;updateOidMapFn(v1,v1oid,v2oid,r1,r2,oidjson)}return result};if(PTC.isDefined(this.data))this.data.sort("ASC",this.multiSortFn);if(this.snapshot&&this.snapshot!=this.data)this.snapshot.sort("ASC",this.multiSortFn);return true}};
PTC.jca.table.updateOidMap=function(v1,v1oid,v2oid,r1,r2,oidjson){if(oidjson!==undefined)if(r1.data[PTC.jca.BACKING_VERSION_COLUMN_NAME]&&r2.data[PTC.jca.BACKING_VERSION_COLUMN_NAME])PTC.jca.table.pushOidsinMap(r1.data[PTC.jca.BACKING_VERSION_COLUMN_NAME],r2.data[PTC.jca.BACKING_VERSION_COLUMN_NAME],oidjson);else PTC.jca.table.pushOidsinMap(v1oid,v2oid,oidjson)};
PTC.jca.table.pushOidsinMap=function(v1oid,v2oid,oidjson){if(oidjson.oidarray.indexOf(v1oid)===-1)oidjson.oidarray.push(v1oid);if(oidjson.oidarray.indexOf(v2oid)===-1)oidjson.oidarray.push(v2oid)};Ext.data.Store.prototype.hasVersionMultiSort=function(multipleSortInfo){for(var i=0,mlen=multipleSortInfo.length;i<mlen;i++)if(PTC.jca.isVersionField(multipleSortInfo[i].field))return true;return false};
PTC.jca.table.singleColumnSort=function(multipleSortInfo,store,snapShotData){var sorta=[];var sdata;if(snapShotData&&snapShotData.items)sdata=snapShotData;else sdata=store.data;var field=multipleSortInfo[0].field;for(var i=0,l=sdata.items.length;i<l;i++){var rec=sdata.items[i];var obj={};obj.cmp=jsca.getComparable(rec.data[field]);obj.isFolder=jsca.isFolderRow(rec);obj.key=sdata.keys[i];obj.rec=rec;obj.index=i;sorta.push(obj)}jsca.setDirection(multipleSortInfo[0].direction);var sortOrderChanged=false;
sorta.sort(jsca.optimizedCompare);for(i=0,l=sorta.length;i<l;i++)if(sdata.keys[i]!==sorta[i].key){sortOrderChanged=true;sdata.items[i]=sorta[i].rec;sdata.keys[i]=sorta[i].key}if(snapShotData===true)PTC.jca.table.singleColumnSort(multipleSortInfo,store,store.snapshot);if(sortOrderChanged)sdata.fireEvent("sort",sdata);return sortOrderChanged};
PTC.jca.WJsonReader=function(configs,recordType){if(configs.dotsAsId)this.dotsAsId=true;PTC.jca.WJsonReader.superclass.constructor.call(this,configs,recordType);this.BEGIN_FLAG="<!-- BEGIN PURE JSON --\>";this.END_FLAG="<!-- END PURE JSON --\>"};
Ext.extend(PTC.jca.WJsonReader,Ext.data.JsonReader,{createAccessor:function(){var re=/[\[\.]/;return function(expr){if(Ext.isEmpty(expr))return Ext.emptyFn;if(Ext.isFunction(expr))return expr;if(!this.dotsAsId){var i=String(expr).search(re);if(i>=0)return new Function("obj","return obj"+(i>0?".":"")+expr)}return function(obj){return obj[expr]}}}(),read:function(response){var jsonText=response.responseText;var iBegin=jsonText.indexOf(this.BEGIN_FLAG);if(iBegin>=0){iBegin+=this.BEGIN_FLAG.length;var iEnd=
jsonText.indexOf(this.END_FLAG,iBegin);jsonText=jsonText.substring(iBegin,iEnd);response.responseText=jsonText}else response.responseText="";return PTC.jca.WJsonReader.superclass.read.apply(this,[response])}});
PTC.jca.TableGrid=function(config){config.view=new PTC.jca.TableGrid.GroupingView;if(config.jcaTableConfig){config.view.enableGroupingMenu=config.jcaTableConfig.enableGroupingMenu==="true"?true:false;config.view.enableGrouping=config.jcaTableConfig.LockColIndex<=0&&config.jcaTableConfig.groupBy!==null&&config.jcaTableConfig.groupBy!==undefined;if(config.jcaTableConfig.groupBy!==null&&config.jcaTableConfig.groupBy!==undefined&&config.jcaTableConfig.LockColIndex>=0)PTC.jca.table.log.debug("Giving preference to locking on top of grouping.")}PTC.jca.TableGrid.superclass.constructor.call(this,
config);PTC.jca.TableFactory.addEvents(this)};Ext.extend(PTC.jca.TableGrid,Ext.ux.grid.LockingGridPanel);Ext.ComponentMgr.registerType("jcagrid",PTC.jca.TableGrid);
PTC.jca.TableGrid.prototype.onAfterAction=function(formResult){try{if(formResult){this._handleUpdateObjects(formResult);this._handleDeleteObjects(formResult);this._handleAddObjects(formResult);formResult.afterActionHandled=[];formResult.afterActionHandled[this.id]=true;if((formResult.actionName==="saveAsView"||formResult.actionName==="saveView")&&formResult.extraData){var viewName=formResult.extraData.viewName;if(viewName){PTC.jca.table.saveAsViewResponseHandler(this.id,viewName,formResult.extraData.viewOid);
if(formResult.actionName==="saveView")return false}}return!formResult.hasAnyOids()}}catch(e){PTC.jca.table.log.error(e)}finally{jsca.unSelectHiddenCheckboxes(this.id)}return true};PTC.jca.TableGrid.nonSelectableRow=function(rec,idx,rowParams,store){if(!PTC.jca.table.isRowSelectable(rec,store))return"nonselectable-record";return undefined};
PTC.jca.TableGrid.GroupingView=function(){PTC.jca.TableGrid.GroupingView.superclass.constructor.call(this,{forceFit:false,enableGroupingMenu:false,cellSelectorDepth:8,rowSelectorDepth:15,getRowClass:PTC.jca.TableGrid.nonSelectableRow,groupTextTpl:'{text} ({[values.rs.length]} {[values.rs.length > 1 ? bundleHandler.get("com.ptc.core.ui.tableRB.GROUP_TEXT_TPL_ITEMS") : bundleHandler.get("com.ptc.core.ui.tableRB.GROUP_TEXT_TPL_ITEM")]})'})};
Ext.extend(PTC.jca.TableGrid.GroupingView,Ext.ux.grid.LockingGridView,{handleHdOver:function(e,t){var hd=this.findHeaderCell(t);if(PTC.isDefined(hd)&&(!PTC.isDefined(this.headersDisabled)||this.headersDisabled!==true)){this.activeHdRef=t;this.activeHdIndex=this.getCellIndex(hd);var fly=this.fly(hd);this.activeHdRegion=fly.getRegion();if(!this.cm.isMenuDisabled(this.activeHdIndex)){fly.addClass("x-grid3-hd-over");this.activeHdBtn=fly.child(".x-grid3-hd-btn");if(PTC.isDefined(this.activeHdBtn)){this.activeHdBtn.dom.style.height=
hd.firstChild.offsetHeight-1+"px";if(this.activeHdBtn.hasQuickTip!==true){this.activeHdBtn.hasQuickTip=true;Ext.QuickTips.register({target:this.activeHdBtn,text:Ext.isIE?hd.innerText:hd.textContent})}}}}},setSize:function(width,height,animate){return Ext.ux.grid.LockingGridView.superclass.setSize.call(this,"auto",height,animate)},handleHdMove:function(e,t){if(this.grid&&this.grid.enableColumnResize!==false&&!this.headersDisabled){var hd=this.findHeaderCell(this.activeHdRef);if(hd&&!this.headersDisabled){var hw=
this.splitHandleWidth||5,r=this.activeHdRegion,x=e.getPageX(),ss=hd.style,cur="";if(this.grid.enableColumnResize!==false)if(x-r.left<=hw&&this.cm.isResizable(this.activeHdIndex-1))cur=Ext.isAir?"move":Ext.isWebKit?"e-resize":"col-resize";else if(r.right-x<=(!this.activeHdBtn?hw:2)&&this.cm.isResizable(this.activeHdIndex))cur=Ext.isAir?"move":Ext.isWebKit?"w-resize":"col-resize";ss.cursor=cur}}},updateSortIcon:function(col,dir){Ext.ux.grid.LockingGridView.superclass.updateSortIcon.call(this,col,dir)}});
PTC.jca.TableFactory={createPagingBar:function(jcaTableConfig,rowStore){var pageSize=jcaTableConfig.pageSize<1?12:jcaTableConfig.pageSize;var pagingConfig={tableID:jcaTableConfig.tableID,pageSize:pageSize,store:rowStore,displayInfo:false,bufferResize:false,autoWidth:true,isFooter:true};return new PTC.jca.WTablePagingBar(pagingConfig,jcaTableConfig.chunk,jcaTableConfig.tree)},getPlugins:function(jcaTableConfig){var plugins=[];if(PTC.isDefined(Ext.ux.PanelResizer))plugins=plugins.concat(new Ext.ux.PanelResizer({minHeight:110,
tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.PANEL_RESIZER_TOOLTIP")}));if(jcaTableConfig.ptype)plugins=plugins.concat(jcaTableConfig.ptype);return plugins},createGrid:function(jcaTableConfig,colModel,selModel,rowStore,pagingBar,tbar){var config={deferRowRender:false,header:false,id:jcaTableConfig.tableID,layout:"auto",colModel:colModel,selModel:selModel,autoScroll:true,store:rowStore,bbar:pagingBar,bufferResize:false,border:false,stripeRows:true,minColumnWidth:11,tbar:tbar,autoWidth:true,
disableSelection:selModel===undefined,xtype:jcaTableConfig.xtype,jcaTableConfig:jcaTableConfig,plugins:this.getPlugins(jcaTableConfig),viewConfig:{markDirty:false}};if(jcaTableConfig.renderTo){var renderTo=Ext.getCmp(jcaTableConfig.renderTo);if(renderTo)config.renderTo=renderTo.body.id;else config.renderTo=jcaTableConfig.renderTo}var gridPanel;if(selModel!==undefined&&typeof selModel.getCount==="function"&&selModel.getCount()<1){var selectedRowsDiv=getWindow().document.getElementById("checkboxesFor_"+
jcaTableConfig.tableID);if(selectedRowsDiv)Element.remove(selectedRowsDiv)}if(jcaTableConfig.tree){config.treeColumn=colModel.config[jcaTableConfig.treeColumn].id;gridPanel=Ext.ComponentMgr.create(config,"jcatreegrid")}else gridPanel=Ext.ComponentMgr.create(config,"jcagrid");if(PTC.jca.table.scroll.SCROLL_TO_TABLE===gridPanel.id){gridPanel.on("datarendered",tableUtils.scrollToChangedTable,gridPanel,{single:true});PTC.jca.table.scroll.SCROLL_TO_TABLE=""}var view=gridPanel.getView();if(Ext.isFunction(view.setVariableRowHeight))view.setVariableRowHeight(jcaTableConfig.variableRowHeight);
view.rowHeight=jcaTableConfig.rowHeight||view.rowHeight;view.syncHeaderScroll=PTC.util.delayAllCalls(view.syncHeaderScroll,20);if(view!==undefined)view.on("refresh",PTC.jca.table.stickiness.applyTableStickiness);Ext.applyIf(gridPanel.getView(),{focusedRowClass:"ptc-grid-row-focus",focusedRowCheckerClass:"ptc-grid-row-checker-focus",removefocusedRowClasses:PTC.jca.table.removeRowClasses});Ext.apply(view,{sortAscText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMN_SORT_ASCENDING_TEXT"),sortDescText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMN_SORT_DESCENDING_TEXT"),
columnsText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMNS_TEXT"),groupByText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMN_GROUP_BY_TEXT"),showGroupsText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMN_SHOW_IN_GROUPS_TEXT"),lockText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMN_LOCK_TEXT"),unlockText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMN_UNLOCK_TEXT"),wrapText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMN_WRAP_TEXT"),unWrapText:bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_COLUMN_UNWRAP_TEXT")});
if(selModel!==undefined&&view!==undefined)view.on("selectrange",PTC.jca.table.stopTextHighlight);return gridPanel}};PTC.jca.table.removeRowClasses=function(focusedRowIndex){this.removeRowClass(focusedRowIndex,this.focusedRowClass);this.removeRowClass(focusedRowIndex,this.focusedRowCheckerClass)};PTC.jca.TableFactory.addEvents=function(grid){grid.addEvents("beforeComponentRefresh","beforeRowRefresh","afterRowRefresh","renderTableEnd","renderTableStart","datarendered","domchange","submit","afterExpandCollapse")};
PTC.jca.WTablePanel=function(jcaTableConfig){PTC.jca.WTablePanel.superclass.constructor.call(this,Ext.applyIf({layout:"auto",id:PTC.jca.table.getWTablePanelID(jcaTableConfig.tableID)},jcaTableConfig));this.selectable=jcaTableConfig.selectable;this.rowHeight=jcaTableConfig.rowHeight;if(this.rowHeight===undefined||this.rowHeight<1)this.rowHeight=24;this.minWidth=jcaTableConfig.minWidth;if(this.minWidth===undefined||this.minWidth<1)this.minWidth=480;this.tableName=jcaTableConfig.tableName;this.displayedMessage=
null;this.displayedLoadCompleteMessage=null;this.displayedMoreMessage=null;if(jcaTableConfig.displayedMessage===undefined)this.displayedMessage=bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_DISPLAYED_MESSAGE");else this.displayedMessage=jcaTableConfig.displayedMessage;this.displayedMessage=' <span class="tableCount">( '+this.displayedMessage+" )</span> ";if(jcaTableConfig.displayedLoadCompleteMessage===undefined)this.displayedLoadCompleteMessage=bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_DISPLAYED_LOAD_COMPLETE_MESSAGE");
else this.displayedLoadCompleteMessage=jcaTableConfig.displayedLoadCompleteMessage;this.displayedLoadCompleteMessage=' <span class="tableCount">( '+this.displayedLoadCompleteMessage+" )</span> ";if(jcaTableConfig.displayedMoreMessage===undefined)this.displayedMoreMessage=bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_DISPLAYED_MORE_MESSAGE");else this.displayedMoreMessage=jcaTableConfig.displayedMoreMessage;this.displayedMoreMessage=' <span class="tableCount">( '+this.displayedMoreMessage+" )</span> ";
var selectedMessage;if(jcaTableConfig.selectedMessage===undefined)selectedMessage=bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_SELECTED_MESSAGE");else selectedMessage=jcaTableConfig.selectedMessage;jcaTableConfig.selectedMessageTemplate=new Template(' <span class="tableCount">( '+selectedMessage+" )</span> ");PTC.jca.table._initializeColumnHeaderLabels(jcaTableConfig.currentColumnModel.gridColumnModel);var selectionModel=this._createColumnSelectionModel(jcaTableConfig);var colModel=this._createColumnModel(jcaTableConfig,
selectionModel);var rowStore=this._createRowStore(jcaTableConfig,colModel);var pagingBar=PTC.jca.TableFactory.createPagingBar(jcaTableConfig,rowStore);this.pagingBar=pagingBar;this.pageSize=pagingBar.pageSize;this.viewsCombo=null;if(jcaTableConfig.pickView){var comboConfig=PTC.jca.ActionModelToComboBox(jcaTableConfig.pickView);comboConfig.id=jcaTableConfig.tableID+"filterSelect";comboConfig.activeViewOid=jcaTableConfig.pickView.activeViewOid;this.viewsCombo=new PTC.jca.ViewCombo(comboConfig,this)}this.appFiltersCombo=
null;if(jcaTableConfig.jstfilters){var appFiltersConfig=PTC.jca.ActionModelToComboBox(jcaTableConfig.jstfilters);appFiltersConfig.id=jcaTableConfig.tableID+"appfilterSelect";appFiltersConfig.lazyInit=false;var appFiltersCombo=new Ext.form.ComboBox(appFiltersConfig);appFiltersCombo.setSize=PTC.jca.ViewCombo.prototype.setSize;this.appFiltersCombo=appFiltersCombo}var titleBar=new PTC.jca.TitleBar({store:rowStore,tableID:jcaTableConfig.tableID,tableName:jcaTableConfig.tableName,viewsCombo:this.viewsCombo,
appFiltersCombo:this.appFiltersCombo,singleSelectView:jcaTableConfig.singleSelectView,chunk:jcaTableConfig.chunk,jcaDebugInfo:jcaTableConfig.jcaDebugInfo,autoWidth:true,activeViewEditable:jcaTableConfig.activeViewEditable});this.titleBar=titleBar;if(!jcaTableConfig.showHeader)titleBar.setVisible(false);this.gridPanel=PTC.jca.TableFactory.createGrid(jcaTableConfig,colModel,selectionModel,rowStore,pagingBar,titleBar);if(this.gridPanel.selModel.grid===undefined)this.gridPanel.selModel.grid=this.gridPanel;
this.gridPanel.wtableRef=this;this.gridPanel.restoreState(PTC.jca.getClientSortProvider());var gridPanel=this.gridPanel;PTC.jca.table.scroll.handleScrollingGrids(this,rowStore);gridPanel.on("rowcontextmenu",PTC.menu.onContextMenu);gridPanel.on("rowmousedown",gridPanel.jcaRowMouseDown);if(!Ext.isWebKit){var verticalScrollTip=new PTC.jca.verticalScrollTip({gridPanel:gridPanel});gridPanel.on("bodyscroll",verticalScrollTip.updateVerticalScrollTip,verticalScrollTip)}gridPanel.on("afterrender",PTC.jca.table.Utils.applyColumnLock);
colModel.on("columnlockchange",gridPanel.setColumnLockState,gridPanel);gridPanel.on({columnresize:gridPanel.jcaColumnResize,headerclick:gridPanel.jcaHeaderClick,headerdblclick:gridPanel.jcaHeaderDBClick,sortchange:gridPanel.jcaSortChange});this.firstLoad=true;if(selectionModel){selectionModel.on("rowselect",gridPanel.jcaOnRowSelect);selectionModel.on("rowdeselect",gridPanel.jcaOnRowDeSelect);selectionModel.on("rowmassdeselection",gridPanel.jcaOnRowMassDeselection);selectionModel.on("rowmassselection",
gridPanel.jcaOnRowMassSelection);if(jcaTableConfig.singleSelect)gridPanel.on("datarendered",gridPanel.jcaSingleRowPreSelect)}if(window===PTC.getMainWindow())PTC.navigation.setPageTitle(this.tableName);this.updateTitle=PTC.util.delayAllCalls(this.updateTitle);rowStore.on("datachanged",this.updateTitle);rowStore.on("load",this.updateTitle);rowStore.on("add",this.updateTitle);rowStore.on("remove",this.updateTitle);if(jcaTableConfig.chunk){rowStore.on("DSLoadingInterupted",this.updateTitle);rowStore.on("DSLoadingInterupted",
this.addFooterMessage);rowStore.on("DSLoadingInteruptedTree",this.handleTreeResultLimit);rowStore.on("reload",this.updateTitle);rowStore.on("dataSourceComplete",this.updateTitle)}rowStore.on("ServerError",this.addFooterMessage);rowStore.on("beforeload",rowStore.PTC_OnBeforeLoadState);if(!jcaTableConfig.chunk)rowStore.on("load",rowStore.PTC_OnLoadState);if(rowStore.initiallySelectedPlugin===undefined)rowStore.on("dataSourceComplete",PTC.jca.table.Utils.updateInitialRows.createCallback(gridPanel.id));
if(jcaTableConfig.strikeThroughColumn)gridPanel.on("viewready",PTC.jca.table.rowStrikeThrough.setRowClass);if(jcaTableConfig.preSelectableColumn){if(selectionModel){selectionModel.on("rowdeselect",PTC.jca.table.removePreSelection);selectionModel.on("rowmassdeselection",PTC.jca.table.removePreSelections)}if(!jcaTableConfig.chunk)rowStore.on("load",PTC.jca.table.preSelectRecords)}rowStore.on("dataSourceComplete",PTC.jca.table.handleHiddenRowsEvent.createDelegate(this,[this]));if(rowStore.tree===undefined||
rowStore.tree===false){gridPanel.mon(rowStore,"dataSourceComplete",rowStore.handleResultLimitActions);gridPanel.mon(PTC.jca.dataSource,"dscancelforced",rowStore.handleResultLimitActions)}rowStore.on("expandnode",this.updateTitle);rowStore.on("collapsenode",this.updateTitle);gridPanel.on("render",this.renderToolbars);gridPanel.on("render",this.renderPickerToolbar);if(Ext.isIE&&jcaTableConfig.selectable)gridPanel.on("viewready",PTC.jca.registerSelectStart);PTC.jca.createListeners(gridPanel,gridPanel.store);
gridPanel.on("renderTableEnd",gridPanel.getPreSelectionsConfig);if(jcaTableConfig.jsunit===undefined)if(!jcaTableConfig.chunk&&this.initialRows&&this.initialRows.length>=0){gridPanel.initialLoad=PTC.jca.loadTable;gridPanel.on("render",gridPanel.initPagingBar)}else{var initPageSize=jcaTableConfig.allMode?1E4:this.pageSize;var formData={};formData.start=0;formData.limit=initPageSize;formData.acquire="row";var loadConfig={params:formData};if(!jcaTableConfig.chunk)loadConfig.callback=gridPanel.initPagingBar;
else this.gridPanel.on("render",gridPanel.initPagingBar);if(jcaTableConfig.chunk&&jcaTableConfig.chunk.transmissionState==="COMPLETED"&&jcaTableConfig.chunk.fromIndex>0)rowStore.dataChangeTask=new Ext.util.DelayedTask(this.updateTitle,this.gridPanel.getStore());rowStore.load(loadConfig)}};PTC.jca.table.preSelectRecordInDS=function(grid,selectedRecords){grid.getSelectionModel().selectRecords(selectedRecords,true)};
PTC.jca.table.removePreSelection=function(selModel,rowIndex,record){var table=selModel.grid;PTC.jca.table._removePreSelectionValue(table,record)};PTC.jca.table._removePreSelectionValue=function(table,record){if(table.jcaTableConfig.preSelectableColumn){var rawValue=record.get(table.jcaTableConfig.preSelectableColumn);if(rawValue&&rawValue.gui&&rawValue.gui.comparable)rawValue.gui.comparable=false;else rawValue=false}};
PTC.jca.table.removePreSelections=function(selectionModel,records){if(!records||records.length<1)return;var table=selectionModel.grid;for(var i=0,l=records.length;i<l;i++)PTC.jca.table._removePreSelectionValue(table,records[i]);return true};
PTC.jca.table.preSelectRecords=function(store,records,options){if(!records||records.length<1)return;var preSelectableColumn=store.jsca_table.jcaTableConfig.preSelectableColumn,nonSelectRowColumn=store.jsca_table.jcaTableConfig.nonSelectRowColumn,selectedRecords=[];for(var i=0,l=records.length;i<l;i++)if(PTC.jca.table.getColumnBooleanStringValue(records[i],preSelectableColumn,"false")==="true")if(!nonSelectRowColumn||PTC.jca.table.getColumnBooleanStringValue(records[i],nonSelectRowColumn,"false")===
"false")selectedRecords.push(records[i]);if(selectedRecords.length>0)store.jsca_table.getSelectionModel().selectRecords(selectedRecords,true)};PTC.jca.table.selectStartListener=function(e){if(e.shiftKey&&!e.target.isContentEditable){e.stopEvent();e.preventDefault();return false}else return true};
PTC.jca.registerSelectStart=function(grid){var viewEl=grid.getView().mainBody;var lockedViewEl=grid.getView().lockedBody;if(viewEl)viewEl.on("selectstart",PTC.jca.table.selectStartListener);if(lockedViewEl)lockedViewEl.on("selectstart",PTC.jca.table.selectStartListener)};
PTC.jca.CancelDataLoadButton=function(buttonConfig){Ext.apply(buttonConfig,{cls:"cancelButton",iconCls:"cancelButtonIcon",handler:this.cancelButtonHandler,itemId:buttonConfig.id,tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.STOP_LOADING")});PTC.jca.CancelDataLoadButton.superclass.constructor.call(this,buttonConfig)};
Ext.extend(PTC.jca.CancelDataLoadButton,Ext.Button,{cancelButtonHandler:function(){var tid=this.initialConfig.tableid;var grid=PTC.jca.table.Utils.getTable(tid);var jcaTableConfig=grid.jcaTableConfig;var dsId=jcaTableConfig.chunk.id;var store=grid.getStore();var warningMsgBtn=grid.getBottomToolbar().findById(store.jscaTableID+"_tablelvlmesg");if(warningMsgBtn)warningMsgBtn.destroy();store.cancelBtnClicked=true;if(store.showPopUp)store.showPopUp=undefined;PTC.jca.DataSourceRegistry.killDataSource(store,
[dsId])}});
PTC.jca.TitleBar=function(barConfig){var tableID=barConfig.tableID;var expandButton=new Ext.Button({id:tableID+"_toggle",tableid:tableID,cls:"tableToggle",iconCls:"expandCollapse_collapsed",tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.COLLAPSE_TABLE"),handler:PTC.jca.expandCollapse});var items=[expandButton,{xtype:"tbtext",text:barConfig.tableName}];var jcaDebugButton=PTC.debug.getJCADebugButtonConfig(barConfig);if(jcaDebugButton)items.push(jcaDebugButton);if(barConfig.appFiltersCombo){var appFiltersComboPanel=new Ext.Panel({bodyBorder:false,
frame:false,border:false,autoHeight:true,layout:"fit",hideMode:"offsets"});appFiltersComboPanel.add(barConfig.appFiltersCombo);items.push(" ");items.push(appFiltersComboPanel)}if(barConfig.viewsCombo){if(!barConfig.appFiltersCombo)items.push(" ");if(barConfig.singleSelectView){var singleViewButton=new Ext.Button({icon:getBaseHref()+"netmarkets/images/customize_tablebutton.gif",handler:barConfig.viewsCombo.items.last().handler,itemId:"singleViewButton",tooltip:barConfig.viewsCombo.items.last().tooltip});
items.push(singleViewButton)}else{var viewComboConfig={bodyBorder:false,frame:false,border:false,autoHeight:true,layout:"fit",hideMode:"offsets",items:barConfig.viewsCombo,viewsComboWidthHandler:PTC.jca.ViewCombo.viewsComboWidthHandler};if(isWizardWindow())Ext.apply(viewComboConfig,{listeners:{afterrender:viewComboConfig.viewsComboWidthHandler,resize:viewComboConfig.viewsComboWidthHandler}});var viewsComboPanel=new Ext.Panel(viewComboConfig);items.push(viewsComboPanel);var saveViewButton=new Ext.Button({id:tableID+
"_saveView",tableID:tableID,cls:"saveView",iconCls:"saveView",tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.SAVE_VIEW"),handler:PTC.jca.ViewCombo.saveViewHandler,hidden:!barConfig.activeViewEditable});items.push(saveViewButton)}}if(barConfig.chunk){Ext.apply(this,new PTC.jca.DataSourceToolbar(barConfig));this.mask.on("render",this.dsMaskListener,this);items.push(this.mask);items.push(this.cancelButton)}items.push("->");items.push({itemId:"titleMessageCount",xtype:"tbtext"});Ext.apply(barConfig,
{id:tableID+".titleBar",items:items});PTC.jca.TitleBar.superclass.constructor.call(this,barConfig)};Ext.extend(PTC.jca.TitleBar,Ext.Toolbar);var ViewCombo_WIDTH=200;
PTC.jca.ViewCombo=function(comboConfig,tablePanel){Ext.apply(comboConfig,{lazyInit:false,enableKeyEvents:true,width:ViewCombo_WIDTH,listWidth:ViewCombo_WIDTH,lastQuery:"",onKeyUp:PTC.jca.table.onKeyUpOverride,setValue:PTC.jca.table.setValueOverride});PTC.jca.ViewCombo.superclass.constructor.call(this,comboConfig);this.store.filterBy(function(record,id){var isHidden=record.get("hidden");if(isHidden===true)return false;return true});this.on("beforeselect",PTC.jca.ConfirmViewChange,tablePanel);this.on("beforeselect",
PTC.jca.ViewCombo.changeViewHandler,tablePanel);this.on("keypress",PTC.jca.table.viewChangeValidate,tablePanel)};PTC.jca.table.onKeyUpOverride=function(e){if(e.getKey()===229){this.fireEvent("click",this,e);return}PTC.jca.ViewCombo.superclass.onKeyUp.call(this,e)};PTC.jca.table.setValueOverride=function(v){PTC.jca.ViewCombo.superclass.setValue.call(this,PTC.util.unescapeHTML(v))};
PTC.jca.ViewCombo.viewsComboWidthHandler=function(){var comboWidth=this.getWidth();if(comboWidth<ViewCombo_WIDTH){comboWidth=ViewCombo_WIDTH;this.setWidth(comboWidth)}};PTC.jca.ViewCombo.saveViewHandler=function(saveViewButton){PTC.jca.previousMultiColumnSortString=PTC.jca.getMultiColumnSortString(saveViewButton.tableID);PTC.jca.table.saveCurrentView(saveViewButton.tableID,true)};
PTC.jca.ViewCombo.changeViewHandler=function(viewComboBox){var table=this.gridPanel;if(table.container&&table.container.contentAreaPanel){var contentAreaPanel=Ext.getCmp(table.container.contentAreaPanel.id);if(contentAreaPanel){var xyScroll=contentAreaPanel.body.getScroll();PTC.jca.table.scroll.SCROLL_TO_TABLE=table.id;PTC.jca.table.scroll.SCROLL_TO_OFFSET=xyScroll}}};Ext.extend(PTC.jca.ViewCombo,Ext.form.ComboBox);
PTC.jca.ViewCombo.prototype.setSize=function(w,h){if(Ext.isIE){if(typeof w==="object"){h=w.height;w=w.width}var cw=this.getWidth();if(w<ViewCombo_WIDTH)w=ViewCombo_WIDTH;else if(Math.abs(cw-w)<=1)return}return PTC.jca.ViewCombo.superclass.setSize.call(this,w,h)};
PTC.jca.loadTable=function(){var store=this.getStore();var eventsSuspendedAlready=store.eventsSuspended;if(this.tree)store.suspendEvents();var jsttd=this.jcaTableConfig.jsttd;var viewFilter=jsttd&&jsttd.active_filter&&jsttd.filters&&!jsttd.filteredAtDataSource&&jsttd.filters[jsttd.active_filter].jsexpr?true:false;if(viewFilter)store.suspendEvents(false);store.loadData({total:this.jcaTableConfig.totalRows,rows:this.jcaTableConfig.initialRows});if(viewFilter){store.resumeEvents();jstExecJSTableFilter(jsttd,
jsttd.filters[jsttd.active_filter],false,this.wtableRef)}if(this.tree){store.enableChildNodeCache();try{store.each(PTC.jca.expandRowIfAuto)}finally{store.disableChildNodeCache()}if(!eventsSuspendedAlready){store.resumeEvents();store.fireEvent("datachanged",store)}}store.isLoading=FALSE_FUNC;this.getStore().PTC_OnLoadState()};PTC.jca.table.onSortChange=function(){this._sortChanged=true};
PTC.jca.table.rowCountWrapper=function(proceed){if(typeof this.isLoading==="function"&&this.isLoading()===true&&PTC.jca.table.findInTable.isTableFilteredOnClient(this.jsca_table)!==true)return Math.max(this._loadingCount,proceed.call(this));return proceed.call(this)};Ext.grid.GridPanel.prototype.setColumnLockState=function(cm,colIndex,value){var columnId=cm.getColumnId(colIndex);if(value===true)PTC.jca.table.stickiness.setLockedColumnId(this.id,columnId);else PTC.jca.table.stickiness.clearLockingStickiness(this.id)};
PTC.jca.table._addRecordsToTreeStore=function(addRows,rowStore){var needRefresh=false;if(addRows.length<100)for(var count=0;count<addRows.length;count++)rowStore.addSorted(addRows[count]);else{rowStore.add(addRows);if(rowStore.jsca_table.view&&typeof rowStore.jsca_table.view.clearVisibleCaches==="function")rowStore.jsca_table.view.clearVisibleCaches();rowStore.applySort();needRefresh=true}return needRefresh};PTC.jca.table._STRETCHER_ID="stretcher";
Ext.extend(PTC.jca.WTablePanel,Ext.Component,{calculateGroupByField:function(jcaTableConfig,colModel){jcaTableConfig.groupBy=PTC.jca.calculateGroupByField(jcaTableConfig,colModel)},_createRowStore:function(jcaTableConfig,colModel){var storeFields=jcaTableConfig.currentColumnModel.storeFields;this.rowRecord=Ext.data.Record.create(storeFields);var sortStr=PTC.jca.getMultiColumnSortString(jcaTableConfig.tableID);var groupBy=jcaTableConfig.groupBy;if(groupBy!==null&&groupBy!==undefined&&(sortStr===null||
sortStr===""))jcaTableConfig.currentColumnModel.sortInfo={field:groupBy,direction:"ASC"};jcaTableConfig.storeURL.url=getBaseHref()+jcaTableConfig.storeURL.url;var rowStore=null;if(jcaTableConfig.chunk){if(jcaTableConfig.tree)rowStore=this._createChunkDataTreeStore(jcaTableConfig);else{rowStore=this._createChunkDataStore(jcaTableConfig,colModel);rowStore.selectable=this.selectable}rowStore.chunkEnabled=true}else{var storeConfig=this._createStoreConfig(jcaTableConfig,colModel);if(jcaTableConfig.tree){if(jcaTableConfig.uniqueCompKey!==
undefined)storeConfig.baseParams.uniqueCompKey=jcaTableConfig.uniqueCompKey;storeConfig.disableAction=jcaTableConfig.disableAction;rowStore=this._createAdjacencyListStore(storeConfig);if(PTC.jca.isSortChangedByClient(jcaTableConfig.tableID))rowStore.isLoading=FALSE_FUNC;else rowStore.isLoading=TRUE_FUNC}else{rowStore=this._createGroupingStore(storeConfig);rowStore.selectable=this.selectable}if(!rowStore.isLoading)rowStore.isLoading=TRUE_FUNC}if(jcaTableConfig.tree)rowStore.on("beforeexpandnode",PTC.jca.tree.expandLoadMask);
rowStore.addEvents("sort");rowStore.on("sort",PTC.jca.table.onSortChange);rowStore.getCount=rowStore.getCount.wrap(PTC.jca.table.rowCountWrapper);rowStore._loadingCount=0;rowStore.jscaTableID=jcaTableConfig.tableID;return rowStore},_createJsonRowReader:function(jcaTableConfig){var jsonRowReaderConfig=[];if(!jcaTableConfig.generateRowId||jcaTableConfig.tree){jsonRowReaderConfig.id="jsca_context";jsonRowReaderConfig.idProperty="oid"}if(!jcaTableConfig.chunk){jsonRowReaderConfig.totalProperty="total";
jsonRowReaderConfig.root="rows"}if(jcaTableConfig.jsttd)jsonRowReaderConfig.dotsAsId=true;return new PTC.jca.WJsonReader(jsonRowReaderConfig,this.rowRecord)},_createChunkDataStore:function(jcaTableConfig,colModel){this.calculateGroupByField(jcaTableConfig,colModel);var store=this._createGroupingStore({reader:this._createJsonRowReader(jcaTableConfig),chunk:jcaTableConfig.chunk,baseParams:jcaTableConfig.storeURL.params,sortInfo:jcaTableConfig.currentColumnModel.sortInfo,remoteSort:true,jscaSort:true,
moreData:false,offSet:0,groupField:jcaTableConfig.LockColIndex<=0&&jcaTableConfig.groupBy?jcaTableConfig.groupBy:false,groupOnSort:false});this.proxy=store.proxy;this.proxy.setApi("read",jcaTableConfig.storeURL);this.proxy.url=jcaTableConfig.storeURL.url;return store},_createChunkDataTreeStore:function(jcaTableConfig,colModel){var bparams=jcaTableConfig.storeURL.params;if(jcaTableConfig.uniqueCompKey!==undefined)bparams.uniqueCompKey=jcaTableConfig.uniqueCompKey;var store=PTC.jca.DataSourceRegistry.newTreeStore({reader:this._createJsonRowReader(jcaTableConfig),
chunk:jcaTableConfig.chunk,baseParams:bparams,tree:jcaTableConfig.tree,resultLimitReached:false,resultLimit:jcaTableConfig.resultLimit,disableAction:jcaTableConfig.disableAction,jscaSort:true});this.proxy=store.proxy;this.proxy.setApi("read",jcaTableConfig.storeURL);store.sortData=function(f,direction){jsca.EXT_SORT_DATA.call(this,f,direction);this.applyTreeSort()};store.handleOidBasedProcessing=function(params,isExpand){params.oidToPopulate=null;return false};return store},_createStoreConfig:function(jcaTableConfig,
colModel){this.proxy=new Ext.data.HttpProxy(jcaTableConfig.storeURL);var params=jcaTableConfig.storeURL.params;PTC.util.addFormParam("operation",params);this.calculateGroupByField(jcaTableConfig,colModel);return{baseParams:params,reader:this._createJsonRowReader(jcaTableConfig),sortInfo:jcaTableConfig.currentColumnModel.sortInfo,proxy:this.proxy,remoteSort:true,groupField:jcaTableConfig.LockColIndex===0&&jcaTableConfig.groupBy?jcaTableConfig.groupBy:false,groupOnSort:false}},_createAdjacencyListStore:function(storeConfig){var aListStore=
new Ext.ux.maximgb.tg.AdjacencyListStore(storeConfig);aListStore.sortData=function(f,direction){jsca.EXT_SORT_DATA.call(this,f,direction);this.applyTreeSort()};return aListStore},_createGroupingStore:function(storeConfig){var groupStore=PTC.jca.DataSourceRegistry.newStore(storeConfig);groupStore.sortData=jsca.EXT_SORT_DATA;return groupStore},_createColumnSelectionModel:function(jcaTableConfig){var selectionModel;if(this.selectable){if(jcaTableConfig.singleSelect)selectionModel=new PTC.jca.table.RadioSelectionModel;
else selectionModel=new PTC.jca.table.CheckboxSelectionModel;selectionModel.getSelectAll=function(){var selectAll;var view=selectionModel.grid.getView();if(view&&Ext.fly(view.innerHd)){selectAll=Ext.fly(view.innerHd).child("div.x-grid3-hd-checker");var lockedHd=Ext.fly(view.lockedInnerHd);if(lockedHd!==null&&(selectAll===undefined||selectAll===null))selectAll=lockedHd.child("div.x-grid3-hd-checker")}return selectAll}}return selectionModel},_createColumnModel:function(jcaTableConfig,checkBoxes){var colConfigs=
null;var currentColumnModel=jcaTableConfig.currentColumnModel.gridColumnModel;if(this.selectable){colConfigs=[checkBoxes];if(jcaTableConfig.singleSelect)colConfigs[0].hideable=false;colConfigs=colConfigs.concat(currentColumnModel)}else if(currentColumnModel!==null&&currentColumnModel!==undefined)colConfigs=currentColumnModel.slice();var i=colConfigs.length;while(i--)if(typeof colConfigs[i].renderer==="string")colConfigs[i].renderer=PTC.util.convertStringToFunc(colConfigs[i].renderer);var stretcherColumn=
[{dataIndex:"",header:"",width:1,id:PTC.jca.table._STRETCHER_ID,renderer:function(){},sortable:false,resizable:false,menuDisabled:true,hideable:false,groupable:false,editable:false}];colConfigs=colConfigs.concat(stretcherColumn);var colModel=new Ext.ux.grid.LockingColumnModel(colConfigs);colModel.on("columnmoved",PTC.jca.table.columnMovedListener);return colModel},getGridPanel:function(){return this.gridPanel},getTableName:function(){return this.tableName},getRecordType:function(){return this.rowRecord},
getSelectionModel:function(){return this.gridPanel.getSelectionModel()},getColumnModel:function(){return this.gridPanel.colModel},getSortState:function(){return this.gridPanel.store.getSortState()},getViewsCombo:function(){return this.viewsCombo},getColumnModelConfigData:function(){var cmConfig=this.gridPanel.colModel.config;var justData={};for(var colix=0;colix<cmConfig.length;colix++){var colData={};colData.colIndex=colix;colData.id=cmConfig[colix].id;colData.width=cmConfig[colix].width;colData.hidden=
cmConfig[colix].hidden;justData[colix]=colData}return justData},deleteRowsByOids:function(oids){if(typeof oids!=="undefined"&&oids.length!==undefined)rowHandler.removeRows(oids,this.initialConfig.tableID,true)},updateData:function(data){var previous,location,ir,rowsLength,oid,updated,jscaContext,focusAddedRows,fireDataChanged,fullRefresh,focusRow=[],resizeTable,rowStore,addRows=[],addOids=[],expandNodes=[];var isTree=this.tree===true;if(data!==undefined&&data.rows!==undefined&&data.rows.length!==
undefined){rowStore=this.gridPanel.store;var newRowsOnly=data.hasOwnProperty("newRowsOnly")&&data.newRowsOnly;fullRefresh=data.hasOwnProperty("fullRefresh")&&data.fullRefresh;focusAddedRows=data.focusAddedRows===false?false:true;resizeTable=data.resizeTable===false?false:true;fireDataChanged=data.fireDataChange===false?false:true;var sortInfo=PTC.jca.getMultiColumnSortString(this.gridPanel.id);if(data.addSorted===undefined&&(isTree===true||sortInfo&&sortInfo!==""))data.addSorted=true;var jcaTableConfig=
this.gridPanel.jcaTableConfig;if(!PTC.isDefined(jcaTableConfig.jsttd)&&this.gridPanel.store.getCount()<1)this.gridPanel.clearStickyConfigWidth();for(ir=0,rowsLength=data.rows.length;ir<rowsLength;ir++){var preIndex=-1;var rowData=data.rows[ir];if(rowData!==undefined&&rowData.oid!==undefined){var isUpdate=PTC.jca.table.isUpdateRow(data,rowData,rowStore,isTree);location=rowData.dynamicLocation;oid=rowData.oid;if(location===undefined)location=oid;if(!newRowsOnly||isUpdate){preIndex=rowStore.find("jsca_context",
rowData.jsca_context);if(preIndex<0)preIndex=rowStore.find("oid",rowData.oid);if(isUpdate&&preIndex<0)preIndex=rowStore.find("oid",location);if(isUpdate&&preIndex<0)preIndex=rowStore.find("jsca_context",location)}updated=PTC.jca.table.createRecord(this,rowData);if(preIndex>=0){previous=rowStore.getAt(preIndex);var previousId=previous.id;if(isTree){rowStore.setNodeExpanded(updated,rowStore.isExpandedNode(previous));rowStore.setNodeLoaded(updated,false);updated.ux_maximgb_treegrid_offset=previous.ux_maximgb_treegrid_offset;
jscaContext=previous.get("jsca_context");updated.id=jscaContext;updated.data.id=jscaContext;updated.data.jsca_context=jscaContext;updated.data._is_leaf=previous.data._is_leaf;updated.data._parent=previous.data._parent;updated.data._level=previous.data._level}if(previousId!==updated.id){var idx=rowStore.indexOf(previous);updated=Ext.apply(previous,updated);rowStore._updateInProgress=true;rowStore.remove(previous);rowStore.insert(idx,updated);rowStore._updateInProgress=undefined}else updated=Ext.apply(previous,
updated);var gridScrollIndex=this.gridPanel.scrollIndex;if(PTC.isDefined(gridScrollIndex)&&PTC.isDefined(rowData.dynamicLocation)&&gridScrollIndex.indexOf(rowData.dynamicLocation)>-1){PTC.jca.table.Utils.unfocusRow(this.gridPanel);this.gridPanel.scrollIndex=PTC.jca.table.Utils.getRowUniqueIdentifier(updated.id)}this.gridPanel.view.skipSelect=true;if(!fullRefresh)if(rowsLength<5)this.gridPanel.view.refreshRow(preIndex);else fullRefresh=true;focusRow.push(updated)}else if(isTree){var parentIndex=-1;
var parentNode=null;if(Ext.isString(data.parentOid))parentIndex=rowStore.findExact("oid",data.parentOid);else if(rowData.oid!==location){parentIndex=rowStore.find("oid",location);if(parentIndex<0)parentIndex=rowStore.find("jsca_context",location)}if(parentIndex>-1)parentNode=rowStore.getAt(parentIndex);if(parentNode===null){updated.data._level=1;focusRow.push(updated);addRows.push(updated)}else{expandNodes.push(parentNode);if(rowStore.isLoadedNode(parentNode)){updated.data._level=parentNode.get("_level");
if(isUpdate){updated.data._parent=parentNode.get("_parent");jscaContext=parentNode.get("jsca_context")}else{var parentJscaContext=parentNode.get("jsca_context");updated.data._parent=parentJscaContext;jscaContext=parentJscaContext.split("!*")[0]+"^"+updated.get("oid")+"!*";updated.data._level+=1;updated.data._is_leaf=true}updated.id=jscaContext;updated.data.id=jscaContext;updated.data.jsca_context=jscaContext;parentNode.data._is_leaf=false;parentNode.ux_maximgb_tg_loaded=true;if(!fullRefresh)this.gridPanel.view.refreshRow(parentIndex);
focusRow.push(updated);addRows.push(updated)}else focusRow.push(parentNode)}}else{if(preIndex<0)addOids.push(oid);addRows.push(updated);focusRow.push(updated)}}}if(addOids.length>0)rowHandler.addRows(addOids,this.initialConfig.tableID,null,{refresh:false,doAjaxUpdate:false});if(addRows.length>0)if(isTree){var needRefresh=PTC.jca.table._addRecordsToTreeStore(addRows,rowStore);if(needRefresh)fullRefresh=true}else{var dataFiltered=PTC.jca.table.findInTable.isTableFiltered(this.gridPanel)&&Ext.isFunction(rowStore.searchInListFilterByFunc);
if(dataFiltered)PTC.jca.table.addRowsToFilteredData(rowStore,addRows);else rowStore.add(addRows)}if(isTree&&expandNodes.length>0){var expandNodeCalled=false;expandNodes.each(function(parent){var oldParent=null;while(parent!==undefined&&parent!==null&&parent!==oldParent){if(rowStore.isExpandedNode(parent)===false){rowStore.expandNode(parent);expandNodeCalled=true}oldParent=parent;parent=rowStore.getNodeParent(parent)}});if(!expandNodeCalled)rowStore.fireEvent("addtreecount",rowStore,addRows)}}if(data.addSorted===
true)rowStore.applySort();if(focusRow.size()>0&&focusAddedRows)PTC.jca.table.handleFocusRow(focusRow,this.gridPanel);if(this.gridPanel.view.canGroup())fullRefresh=true;if(fireDataChanged)if(fullRefresh)this.gridPanel.getStore().fireEvent("datachanged",this.gridPanel.getStore());else this.gridPanel.view.doPartialDataChange(true);PTC.jca.table.handleHiddenRows(this);if(resizeTable)PTC.jca.table.scroll.updateTableSize.defer(50,PTC.jca.table.scroll,[this.initialConfig.tableID]);focusRow.each(function(row){row.cachedMenuResponse=
""});if(rowsLength>0)this.gridPanel.fireEvent("afterRowRefresh",this.gridPanel.id,data)},addData:function(data){data.newRowsOnly=true;this.updateData(data)},getOptionsButton:function(){if(!this.tree&&this.selectable&&this.gridPanel.enableSelectedOnly!==false){var selectedOnlyLabel=bundleHandler.get("com.ptc.core.ui.tableRB.VIEW_SELECTED_OBJECTS_ONLY");var selectedOnlyItem=new Ext.menu.CheckItem({text:selectedOnlyLabel,checked:false,disabled:!this.selectable,id:this.id+".selectedOnlyViewItem"});selectedOnlyItem.on("applySelectOnlyView",
PTC.jca.table.viewSelectedOnlyListener,this);selectedOnlyItem.on("checkchange",PTC.jca.table.viewSelectedOnlyListener,this);return new Ext.Button({id:this.getId()+"_selectedOnlyMenu",iconCls:"optionsButton",tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.DISPLAY_OPTION_TOOLTIP"),menu:new Ext.menu.Menu({items:[selectedOnlyItem]})})}return null}});
PTC.jca.table.columnMovedListener=function(colModel,oldIndex,newIndex){var stretcherIndex=colModel.getIndexById(PTC.jca.table._STRETCHER_ID);var lastIndex=colModel.getColumnCount()-1;if(stretcherIndex!=lastIndex)colModel.moveColumn(stretcherIndex,lastIndex)};
PTC.jca.table.viewSelectedOnlyListener=function(selectedOnlyItem,bChecked){var gridPanel=this.gridPanel;if(bChecked)if(!PTC.jca.table.findInTable.isTableFiltered(gridPanel)||JCAConfirm("com.ptc.netmarkets.util.misc.miscResource.CLEAR_SEARCH_CONFIRM_ON_VIEWSELECTED")){if(PTC.jca.table.findInTable.isTableFiltered(gridPanel))gridPanel.searchInListTextBox.onTrigger1Click();gridPanel.selectedOnlyChecked=true;var selectedOnlyOn=function(recordBody,recordId){return gridPanel.selModel.isIdSelected(recordId)};
gridPanel.store.filterBy(selectedOnlyOn,gridPanel);gridPanel.view.doUpdate(true);PTC.jca.table.scroll.updateTableSize(gridPanel.id);var isPopup=(PTC.lightbox.isLightbox(window)||isWizardWindow())&&!PTC.automation.isAutomationTest();if(!isPopup)PTC.jca.table.setObjectToSession(gridPanel.id,selectedOnlyItem.id,PTC.jca.table.createViewSelectedOnlyItemsCacheValue(gridPanel));PTC.jca.table.setVisibleNxtPrevLink(gridPanel,false)}else selectedOnlyItem.setChecked(false);else{gridPanel.selectedOnlyChecked=
false;if(PTC.jca.table.findInTable.isTableFilteredOnClient(gridPanel)){gridPanel.store.clearFilter(true);gridPanel.fireEvent("applySearchInList",gridPanel)}else{gridPanel.store.clearFilter(false);PTC.jca.table.scroll.updateTableSize(gridPanel.id)}PTC.jca.table.clearObjectFromSession(gridPanel.id,selectedOnlyItem.id);PTC.jca.table.setVisibleNxtPrevLink(gridPanel,true)}PTC.jca.table.handleSelectAllCheckbox(gridPanel.selModel)};function timeLogStart(startTime,log){log.time(startTime)}
function timeLogEnd(endTime,log){log.timeEnd(endTime);PTC.log.sendAllMessages()}PTC.jca.table.destroyContainedTables=function(){var containerDom=PTC.util.getDom(this);if(containerDom)PTC.jca.table.Utils.cleanUp(containerDom)};PTC.jca.table.resizeContainedTables=function(comp,adjWidth,adjHeight,rawWidth,rawHeight){var root=PTC.util.getDom(this);var tables=tableUtils.getExtTables(root);PTC.jca.table.resizeTables(adjWidth,tables);PTC.jca.table.resizeTablesFromIframes(adjWidth)};
PTC.jca.table.resizeTables=function(adjWidth,tables,frame){var scrollbarWidth=0;var adjustGridWidth=0;for(var i=0,l=tables.length;i<l;i++){if(!scrollbarWidth){scrollbarWidth=PTC.jca.table.scroll.getWindowScrollbarWidth(PTC.jca.table.scroll.getContentArea(tables[i].getEl()));adjustGridWidth=adjWidth-scrollbarWidth}if(frame){frame.PTC.jca.table.scroll.getContentArea(tables[i].getEl());frame.PTC.jca.table.scroll.updateTableSize(tables[i].id,false,adjustGridWidth)}else{PTC.jca.table.scroll.getContentArea(tables[i].getEl());
PTC.jca.table.scroll.updateTableSize(tables[i].id,false,adjustGridWidth)}}};PTC.jca.table.resizeTablesFromIframes=function(adjWidth){var frames=PTC.util.getAllPTCIframes();for(var i=0,l=frames.length;i<l;i++){var tables=frames[i].PTC.jca.table.Utils.getExtTables();PTC.jca.table.resizeTables(adjWidth,tables,frames[i])}};PTC.jca.table.selectedOnlyOn=function(recordBody,recordId){return recordBody.store.jsca_table.selModel.isIdSelected(recordId)};
PTC.jca.table.TableContainer=function(config){PTC.jca.table.TableContainer.superclass.constructor.call(this,config);this.on("bodyresize",PTC.jca.table.resizeContainedTables);this.on("destroy",PTC.jca.table.destroyContainedTables);this.tablePanelContainer=true};Ext.extend(PTC.jca.table.TableContainer,Ext.Panel,{});
PTC.jca.table._initializeColumnHeaderLabels=function(columns){for(var i=0,li=columns.length;i<li;i++){if(!columns[i].displayHeaderLabel)columns[i].header='<span class="hiddenHeader">'+columns[i].header+"</span>";if(PTC.jca.isVersionField(columns[i].id))columns[i].groupRenderer=PTC.jca.versionGroupingRenderer;else if(columns[i].groupRenderer===undefined)columns[i].groupRenderer=PTC.jca.groupingRenderer}};
PTC.jca.table._getUniqueViewName=function(namesArray){return bundleHandler.getUniqueName("com.ptc.core.ui.tableRB.DEFAULT_TABLE_VIEW_NAME",namesArray)};
PTC.jca.jscaCellRenderer=function(val,metadata,record,rowIndex,colIndex,store){if(val===undefined)return"";var jsca_value=val;var jsca_table=store.jsca_table;if(jsca_table===undefined){var grid=tableUtils.getTable(store.jscaTableID);jsca_table=grid;store.jsca_table=grid}var colConfig=this;var jsca_col=PTC.jca._getJscaCol(colConfig);var jsca_row=record;jsca_row.item=record.data;var jsca_renderer=colConfig.jscaRenderer;if(typeof jsca_renderer==="string"){colConfig.jscaRenderer=PTC.util.convertStringToFunc(colConfig.jscaRenderer);
jsca_renderer=colConfig.jscaRenderer}if(typeof jsca_renderer==="function")jsca_value=jsca_renderer(jsca_table,jsca_col,jsca_row);if((colConfig.resizable!==false||colConfig.initialResizable!==false)&&jsca_value!==""&&typeof jsca_value.indexOf==="function"&&jsca_value.indexOf("qtip")<0){if(jsca_table.view.variableRowHeight!==true&&jsca_value.indexOf("<br>")!==-1)if(Ext.isFunction(jsca_table.view.setVariableRowHeight))jsca_table.view.setVariableRowHeight(true);if(colConfig.modifiable!==true||jsca_value.indexOf("<")<
0)jsca_table._buildQTipForValue(jsca_value,metadata,false,true)}return jsca_value};PTC.jca._getJscaCol=function(colConfig){var jsca_col=colConfig.jsca_col;if(jsca_col===undefined){jsca_col=Object.clone(colConfig);jsca_col.renderer=undefined;colConfig.jsca_col=jsca_col}return jsca_col};
PTC.jca.jscaCellRenderer.searchFunc=function(table,column,row){var jsca_col=PTC.jca._getJscaCol(column);row.item=row.data;if(column.jscaRenderer&&typeof column.jscaRenderer.searchFunc==="function")return column.jscaRenderer.searchFunc(table,jsca_col,row);else return null};
PTC.jca.jscaCellRenderer.groupFunc=function(table,column,row){var jsca_col=PTC.jca._getJscaCol(column);row.item=row.data;if(column.jscaRenderer&&typeof column.jscaRenderer.groupFunc==="function")return column.jscaRenderer.groupFunc(table,jsca_col,row);else return null};
Ext.grid.GridPanel.prototype._buildQTipForValue=function(val,metadata,noEncoding,escape){var value;if(!escape)value=val;else value=getUnescapedText(val);if(value){value=value.trim();if(value!==""&&value!=="&nbsp;"){if(!noEncoding)value=Ext.util.Format.htmlEncode(value);if(metadata.dom)metadata.dom.setAttribute("ext:qtip",value);else metadata.attr='ext:qtip="'+value+'"'}}};PTC.jca.reRenderRowsIfVariableRowHeight=function(){if(!this.jcaTableConfig.variableRowHeight&&this.getView().variableRowHeight)this.getView().doPartialDataChange()};
PTC.jca.renderTable=function(jcaTableConfig){if(typeof jcaTableConfig==="undefined")return;PTC.onReady(function(){var componentTimerBean=PTC.performance.startComponentTimer(jcaTableConfig.tableID);var tableId=tableUtils.getFormattedTableId(jcaTableConfig.tableID);var g=new PTC.jca.WTablePanel(jcaTableConfig);PTC.jca.renderTable.log=log4javascript.getLogger("PTC.jca.renderTable");g.gridPanel.on("renderTableStart",timeLogStart,"renderTable");g.gridPanel.on("renderTableEnd",timeLogEnd,"renderTable");
g.gridPanel.on("renderTableEnd",PTC.jca.reRenderRowsIfVariableRowHeight);g.gridPanel.fireEvent("renderTableStart",tableId,PTC.jca.renderTable.log);PTC.jca.initializeSortInfo(jcaTableConfig,g);PTC.jca.table.registerHiddenRowsHandler(g,this);var tableEle=null;if(g.getEl())tableEle=g.getEl();else tableEle=Ext.get(tableId);var ca,caSize=g.gridPanel.getCachedTableHeight();if(!caSize)if(tableEle){tableEle.contentAreaPanel=null;ca=PTC.jca.table.scroll.getContentArea(tableEle);if(ca&&typeof ca.getInnerHeight===
"function")caSize=ca.getInnerHeight()-20;else if(ca&&ca.dom&&typeof ca.getHeight==="function")caSize=ca.getHeight()-28;else caSize=400}else caSize=400;g.gridPanel.render(tableId);g.gridPanel.setHeight(caSize);PTC.jca.table.scroll.setContentArea(ca,g.gridPanel.getEl());if(typeof g.gridPanel.initialLoad==="function")g.gridPanel.initialLoad();g.gridPanel.store.remoteSort=false;g.gridPanel.fireEvent("renderTableEnd",tableId,PTC.jca.renderTable.log);PTC.performance.stopComponentTimer(tableId,componentTimerBean,
"emptyTable");jcaTableConfig=null})};PTC.jca.processDelete=function(response){if(response.dynamicText.indexOf("Delete_Flag:::")===-1&&response.ajaxClass!=="NONE")return false;if(response.selectedItems&&response.tableID){var tid=tableUtils.getUnformattedTableId(response.tableID);var wTableId=PTC.jca.table.getWTablePanelID(tid);var wTable=Ext.getCmp(wTableId);var oids=[];for(var oid in response.selectedItems.data)if(typeof oid==="string")oids.push(oid);wTable.deleteRowsByOids(oids);jsca.unSelectHiddenCheckboxes(tid)}return true};
PTC.jca.processUpdate=function(response){if(response.dynamicText.indexOf("PURE JSON")===-1)return false;if(response.tableID){var tid=tableUtils.getUnformattedTableId(response.tableID);var wTableId=PTC.jca.table.getWTablePanelID(tid);var wTable=Ext.getCmp(wTableId);if(wTable){var BEGIN_FLAG="<!-- BEGIN PURE JSON --\>";var END_FLAG="<!-- END PURE JSON --\>";var jsonText=response.dynamicText;var iBegin=jsonText.indexOf(BEGIN_FLAG)+BEGIN_FLAG.length;var iEnd=jsonText.indexOf(END_FLAG,iBegin);jsonText=
jsonText.substring(iBegin,iEnd);var theData;try{theData=Ext.util.JSON.decode(jsonText)}catch(e){var re=/\n/g;jsonText=jsonText.replace(re,"\\n");re=/\r/g;jsonText=jsonText.replace(re,"\\r");theData=Ext.util.JSON.decode(jsonText)}theData.parentOid=response.parentOid;theData.addSorted=response.addSorted;theData.newRowsOnly=response.addRows;jsca.unSelectHiddenCheckboxes(tid);wTable.updateData(theData)}}return true};PTC.jca.createListeners=function(g,store){};
PTC.jca.table.getWTablePanelID=function(tableID){return tableID+"_WTablePanel"};
PTC.jca.table._handleSelectAllCheckbox=function(selModel){var checkerOnClass="x-grid3-hd-checker-on",grid=selModel.grid,selectAll=selModel.getSelectAll&&selModel.getSelectAll();if(!selectAll)return;var store=grid.getStore(),collapsedRecordCount=0;if(grid.tree&&grid.deselectRowsOnCollapse===true){var rec,allRenderable=grid.view.getAllRenderableRows(),allRenderableMap={};selModel.un("selectionchange",PTC.jca.table.handleSelectAllCheckbox);for(var m=0,len1=allRenderable.length;m<len1;m++)allRenderableMap[allRenderable[m]]=
true;for(var n=0,len2=store.getCount();n<len2;n++){rec=store.getAt(n);if(allRenderableMap[rec._index]!==true){selModel.deselectRow(undefined,false,rec);if(PTC.jca.table.isRowSelectable(rec,store))collapsedRecordCount++}}selModel.on("selectionchange",PTC.jca.table.handleSelectAllCheckbox)}var nonSelectableRowCount=store.nonSelectableRowCount>0?store.nonSelectableRowCount:0;if(!selModel.hasSelection()||selModel.getCount()<store.getCount()-nonSelectableRowCount-collapsedRecordCount)selectAll.removeClass(checkerOnClass);
else selectAll.addClass(checkerOnClass)};PTC.jca.table.handleSelectAllCheckbox=function(selModel){if(!PTC.isDefined(selModel))return;if(selModel._handleSelectAllCheckboxTask===undefined)selModel._handleSelectAllCheckboxTask=new Ext.util.DelayedTask(PTC.jca.table._handleSelectAllCheckbox);selModel._handleSelectAllCheckboxTask.delay(100,null,null,[selModel])};
PTC.jca.table.isUpdateRow=function(data,rowData,rowStore,isTree){var isUpdate=false;if(rowData.dynamicAction==="U")isUpdate=true;else if(rowData.dynamicAction==="A"||rowData.dynamicAction===undefined||rowData.dynamicAction===null){isUpdate=false;if(isTree===true){var existingRowIndex=rowStore.findBy(function(record,id){if(rowData.oid===record.data.oid&&rowData.dynamicLocation===record.data._parent)return true});isUpdate=existingRowIndex>=0;if(isUpdate===false)if(data.parentOid===undefined&&rowData._parent!==
undefined)isUpdate=rowData.oid===rowData.dynamicLocation;else isUpdate=rowData.oid===data.parentOid}else if(rowStore.data.map[rowData.jsca_context]||rowStore.data.map[rowData.oid])isUpdate=true}return isUpdate};PTC.jca.table.createRecord=function(tableGrid,rowData){var updated;if(tableGrid.gridPanel.jcaTableConfig.generateRowId!==true)updated=new tableGrid.rowRecord(rowData,rowData.jsca_context);else updated=new tableGrid.rowRecord(rowData);return updated};
PTC.jca.table.handleFocusRow=function(updatedRecords,grid){var totalUpdated=updatedRecords.length;var firstRowIndex=-1;var rowStore=grid.getStore();var isTree=grid.tree===true;if(isTree)firstRowIndex=rowStore.findBy(function(record,id){var rowOid=record.data.oid;var rowContext=record.data.jsca_context;for(var i=0;i<totalUpdated;i++)if(updatedRecords[i].data.oid===rowOid&&updatedRecords[i].data.jsca_context===rowContext)return true});else firstRowIndex=rowStore.findBy(function(record,id){var rowOid=
record.data.oid;for(var i=0;i<totalUpdated;i++)if(updatedRecords[i].data.oid===rowOid)return true});if(grid.scrollIndex){var fRowIndex=PTC.jca.table.Utils.getRowByUniqueIdentifier(grid.getStore(),grid.scrollIndex);if(fRowIndex>-1){PTC.jca.table.Utils.focusRow(grid,fRowIndex,false,true);if(firstRowIndex===-1)firstRowIndex=fRowIndex}}if(firstRowIndex>-1){grid.getView().ensureVisible(firstRowIndex,0,false);grid.alreadyScrolled=true}};
PTC.jca.table.addRowsToFilteredData=function(rowStore,addRows){var addToData=[];var addToSnapShot=[];for(var i=0,len=addRows.length;i<len;i++){var fitsFilter=rowStore.searchInListFilterByFunc(addRows[i]);if(fitsFilter===true)addToData.push(addRows[i]);else addToSnapShot.push(addRows[i])}if(addToData.length>0)rowStore.add(addToData);if(addToSnapShot.length>0){rowStore.add(addToSnapShot,true);rowStore.sortSnapShotData=true}};
Ext.grid.GridPanel.prototype.updateSelCountMsg=function(){var iSelNum=PTC.jca.table.Utils.getTableSelectedRowsCountById(this.id);var inserts={selected:iSelNum};if(this.isDestroyed||!this.initialConfig.jcaTableConfig||!this.initialConfig.jcaTableConfig.selectedMessageTemplate)return;var selMsg=this.initialConfig.jcaTableConfig.selectedMessageTemplate.evaluate(inserts);var pagingBar=this.getBottomToolbar();var tbSelectionCount=pagingBar.getComponent("selectionMessageCount");if(tbSelectionCount!==undefined&&
tbSelectionCount.getEl()&&tbSelectionCount.getEl().dom&&tbSelectionCount.last_update_value!==iSelNum){tbSelectionCount.last_update_value=iSelNum;tbSelectionCount.setText(selMsg)}};PTC.jca.table.addSelectedListener=function(selModel){selModel.grid.updateSelCountMsg()};PTC.jca.table.nonSelectablesListener=function(sm,rowIndex,keep,rec){return PTC.jca.table.isRowSelectable(rec,sm.grid.getStore())};
PTC.jca.table.removeSelectionListener=function(selModel,rowIndex,record){selModel.grid.updateSelCountMsg();var view=selModel.grid.getView();view.removeRowClass(rowIndex,view.focusedRowCheckerClass)};
Ext.grid.GridPanel.prototype.registerSelCount=function(){var gridPanel=this;var selectionModel=gridPanel.getSelectionModel();if(selectionModel){gridPanel.updateSelCountMsg=PTC.util.delayAllCalls(gridPanel.updateSelCountMsg);selectionModel.on("beforerowselect",PTC.jca.table.nonSelectablesListener);selectionModel.on("rowselect",PTC.jca.table.addSelectedListener);selectionModel.on("rowdeselect",PTC.jca.table.removeSelectionListener);var rowStore=gridPanel.getStore();if(rowStore){rowStore.on("datachanged",
gridPanel.updateSelCountMsg,gridPanel);rowStore.on("add",gridPanel.updateSelCountMsg,gridPanel);rowStore.on("remove",gridPanel.updateSelCountMsg,gridPanel)}gridPanel.on("afterrender",gridPanel.updateSelCountMsg,gridPanel)}};
PTC.jca.TableGrid.prototype.initComponent=function(){PTC.jca.TableGrid.superclass.initComponent.apply(this,arguments);if(isWizardWindow()){this.domChangeEventListener=PTC.wizard.saveTableData.domChangeEventListener;this.on("renderTableEnd",PTC.wizard.saveTableData.registerDomChangeEvents)}this.registerSelCount();this.on("afteraction",this.onAfterAction);this.mon(PTC.action,"objectsaffected",this.onObjectsAffected,this)};
PTC.jca.TableGrid.prototype.setHeight=function(newHeight){if(newHeight!==this.jcaHeight){PTC.jca.TableGrid.superclass.setHeight.apply(this,arguments);this.jcaHeight=newHeight}};PTC.jca.TableGrid.prototype.getToolbar=function(){return Ext.getCmp(this.id+".toolBar")};
PTC.jca.TableGrid.prototype.getToolbarItem=function(name,type){var actionFilter=function(item){return item.actionName===name&&item.actionType===type};var items=this.getToolbar().findBy(actionFilter);if(items&&items.length>=0)return items[0];actionFilter=null;return null};
Ext.data.Store.prototype.filterBySelections=function(checked,gridPanel){if(checked){var selections=this.gridPanel.getSelectionModel().getSelections();var selectedCollection=new Ext.util.MixedCollection;selectedCollection.addAll(selections);this.currentData=this.data;this.data=selectedCollection;var gridView=gridPanel.getView();this.fireEvent("datachanged",this);var selectedCount=selectedCollection.getCount();for(var i=0;i<selectedCount;i++)gridView.addRowClass(i,gridView.selectedRowClass)}else{if(this.currentData)this.data=
this.currentData;this.fireEvent("datachanged",this)}};
Ext.grid.GridPanel.prototype.initPagingBar=function(){var gridPanel=this;var store=gridPanel.getStore();var pagingBar=gridPanel.getBottomToolbar();var tableSelectable=gridPanel.jcaTableConfig.selectable;var jcaTableConfig=gridPanel.jcaTableConfig;if(tableSelectable){var selCountMsg=pagingBar.getComponent("selectionMessageCount");if(selCountMsg===undefined){selCountMsg=new Ext.Toolbar.TextItem({itemId:"selectionMessageCount",text:"          ",xtype:"tbtext"});pagingBar.insert(0,selCountMsg)}}if(store.DATA_RENDERED===
true&&!jcaTableConfig.chunk&&store.tree===undefined||store.tree===false)store.handleResultLimitActions();pagingBar.show()};Ext.grid.GridPanel.prototype.jcaRowMouseDown=function(g,rowIndex,e){if(e.shiftKey)e.preventDefault();var selectionModel=g.getSelectionModel();var isSelected=g.jcaTableConfig.selectable&&selectionModel.isSelected(rowIndex);PTC.jca.table.Utils.focusRow(g,rowIndex,isSelected)};
Ext.grid.GridPanel.prototype.jcaColumnResize=function(i,nw){var gridPanel=this;var columnModel=gridPanel.colModel;var gridView=gridPanel.getView();PTC.jca.ColumnUtils.resizeLastColumn(gridPanel);if(gridView.variableRowHeight===true&&columnModel.getColumnAt(i).isWrapped)gridView.doUpdate(true)};Ext.grid.GridPanel.prototype.jcaHeaderClick=function(grid,columnIndex,e){var h=grid.getView().getHeaderCell(columnIndex);if(h.style.cursor==="col-resize"){e.stopEvent();return false}};
Ext.grid.GridPanel.prototype.jcaHeaderResize=function(grid,columnIndex){if(grid.colModel.isResizable(columnIndex)){var columnResized=PTC.jca.ColumnUtils.resizeColumn(grid,columnIndex,true);if(columnResized===true)grid.jcaColumnResize(columnIndex,grid.colModel.getColumnWidth(columnIndex))}grid.fireEvent("columnConfigChange",grid)};
Ext.grid.GridPanel.prototype.jcaHeaderDBClick=function(grid,columnIndex,e){var h=grid.getView().getHeaderCell(columnIndex);if(h.style.cursor!=="col-resize")return;grid.jcaHeaderResize(grid,columnIndex)};
Ext.grid.GridPanel.prototype.jcaSortChange=function(grid,sortInfo){if(grid.store.remoteSort)grid.store.remoteSort=false;var view=grid.getView();var rowIndex=PTC.jca.table.Utils.getRowByUniqueIdentifier(grid.getStore(),grid.scrollIndex);if(typeof rowIndex==="number"&&rowIndex>-1){view.ensureVisible(rowIndex,0,false);PTC.jca.table.Utils.focusRow(grid,rowIndex,grid.getSelectionModel().isSelected(rowIndex))}else{var selectionModel=grid.getSelectionModel();var record=selectionModel.getSelections();if(record.length>
0)view.ensureVisible(grid.getStore().indexOf(record[record.length-1]),0,false);else view.scrollToTop()}};Ext.grid.GridPanel.prototype.jcaOnRowSelect=function(selectionModel,rowIndex,record){jsca.rowSelectionHandler(selectionModel.grid.id,null,record,true,selectionModel.grid);return true};Ext.grid.GridPanel.prototype.jcaOnRowDeSelect=function(selectionModel,rowIndex,record){jsca.rowSelectionHandler(selectionModel.grid.id,null,record,false,selectionModel.grid);return true};
Ext.grid.GridPanel.prototype.jcaOnRowMassDeselection=function(selectionModel,records){jsca.rowSelectionHandler(selectionModel.grid.id,records,null,false,selectionModel.grid,true);selectionModel.grid.updateSelCountMsg();selectionModel.fireEvent("selectionchange",selectionModel);return true};
Ext.grid.GridPanel.prototype.jcaOnRowMassSelection=function(selectionModel,records){jsca.rowSelectionHandler(selectionModel.grid.id,records,null,true,selectionModel.grid,true);selectionModel.grid.updateSelCountMsg();selectionModel.fireEvent("selectionchange",selectionModel);return true};
Ext.grid.GridPanel.prototype.jcaSingleRowPreSelect=function(grid){var store=grid.store;var count=store.getCount();if(count===1&&grid.singleRowPreSelected!==true){var selectionModel=grid.getSelectionModel();selectionModel.selectRow(0);grid.singleRowPreSelected=true}return true};
PTC.jca.handleFooterButtons=function(){function getPagingBar(tableId){return PTC.jca.table.Utils.getTable(tableId).getBottomToolbar()}function doLayout(tableId,pagingBar){if(pagingBar)pagingBar.doLayout(true,true);else getPagingBar(tableId).doLayout(true,true)}return{showMsgButton:function(msgBtn,message,tableId){if(!msgBtn.isVisible()){msgBtn.show();msgBtn.setTooltip(message);doLayout(tableId)}},createMsgButton:function(id,tooltip,itemId,iconCls){return new Ext.Toolbar.Button({id:id,tooltip:tooltip,
itemId:itemId,iconCls:iconCls,disabled:true,disabledClass:""})},insertButton:function(index,button,tableId){var pagingBar=getPagingBar(tableId);pagingBar.insertButton(index,button);doLayout(tableId,pagingBar)},findButton:function(tableId,buttonId){return getPagingBar(tableId).findById(buttonId)}}}();
PTC.jca.WTablePanel.prototype.addFooterMessage=function(message,feedbackType){var btnId=this.jscaTableID+"_tablelvlmesg";var msgBtn=null;if("1"===feedbackType){btnId=btnId+"_Err";msgBtn=PTC.jca.handleFooterButtons.findButton(this.jscaTableID,btnId);if(msgBtn)PTC.jca.handleFooterButtons.showMsgButton(msgBtn,message,this.jscaTableID);else{var tableLvlMsgButtonErr=PTC.jca.handleFooterButtons.createMsgButton(btnId,message,"tableLevelMessageBtnErr","table-level-error-message");PTC.jca.handleFooterButtons.insertButton(1,
tableLvlMsgButtonErr,this.jscaTableID)}}else{msgBtn=PTC.jca.handleFooterButtons.findButton(this.jscaTableID,btnId);if(msgBtn)PTC.jca.handleFooterButtons.showMsgButton(msgBtn,message,this.jscaTableID);else{var tableLvlMsgButton=PTC.jca.handleFooterButtons.createMsgButton(btnId,message,"tableLevelMessageBtn","table-level-message");PTC.jca.handleFooterButtons.insertButton(0,tableLvlMsgButton,this.jscaTableID)}}};
PTC.jca.WTablePanel.prototype.updateTitle=function(){var rowStore=this;var grid=PTC.jca.table.Utils.getTable(rowStore.jscaTableID);if(!PTC.isDefined(grid)||!PTC.isDefined(rowStore.data))return;var jcaTableConfig=grid.jcaTableConfig;var displayedRows;if(jcaTableConfig.tree)displayedRows=grid.getView().getAllRenderableRows().length;else displayedRows=rowStore.getCount();var totalRows=jcaTableConfig.totalRows;var fills={total:displayedRows};var pageOffset=jcaTableConfig.pageOffset;var wTable=Ext.getCmp(PTC.jca.table.getWTablePanelID(grid.id));
var titleMessageTemplate=new Template(wTable.displayedLoadCompleteMessage);if(jcaTableConfig.chunk&&!jcaTableConfig.tree){var titleDisplayMsgTemplate=new Template(wTable.displayedMessage);var titleDisplayMoreMsgTemplate=new Template(wTable.displayedMoreMessage);var rowsUptoPage=displayedRows;if(pageOffset>0)rowsUptoPage=rowsUptoPage+pageOffset;var moreData=rowStore.moreData;if(rowStore.load_complete===true)if(totalRows<=0)if(moreData===true){titleMessageTemplate=titleDisplayMoreMsgTemplate;fills=
{displayed:displayedRows,total:rowsUptoPage}}else{if(moreData===false&&pageOffset>0){titleMessageTemplate=titleDisplayMsgTemplate;fills={displayed:displayedRows,total:rowsUptoPage}}}else{if(moreData===true||pageOffset>0){titleMessageTemplate=titleDisplayMsgTemplate;fills={displayed:displayedRows,total:totalRows}}}else if(totalRows<=0){titleMessageTemplate=titleDisplayMoreMsgTemplate;fills={displayed:displayedRows,total:rowsUptoPage}}else{titleMessageTemplate=titleDisplayMsgTemplate;fills={displayed:displayedRows,
total:totalRows}}}var titleStatusCmp=grid.getTopToolbar();if(titleStatusCmp){var titleMessage=titleMessageTemplate.evaluate(fills);var tbTitleCount=titleStatusCmp.getComponent("titleMessageCount");if(tbTitleCount!==undefined)tbTitleCount.setText(titleMessage)}};
PTC.jca.WTablePanel.prototype.renderToolbars=function(gridPanel){var jcaTableConfig=gridPanel.jcaTableConfig;if(jcaTableConfig.selectable)gridPanel.removeListener("rowmousedown",gridPanel.getSelectionModel().handleMouseDown,gridPanel.getSelectionModel());var wid=PTC.jca.table.getWTablePanelID(gridPanel.id);var wTable=Ext.getCmp(wid);if(jcaTableConfig.menubar)if(!PTC.isDefined(wTable.menuBar)){var menubarConfig=PTC.jca.ActionModelToMenubar(jcaTableConfig.menubar,gridPanel);wTable.menuBar=new Ext.Toolbar({id:gridPanel.id+
".menuBar",renderTo:gridPanel.tbar,anchor:"100%",items:menubarConfig.items});PTC.jca.setIgnoreParentClick(wTable.menuBar)}if(!PTC.isDefined(wTable.toolBar)){var toolbarConfigItems=[];var tableId=jcaTableConfig.tableID;var actionsBarConfig=wTable.createtoolbarToShortcutbarMultiSelectbarConfig(jcaTableConfig.toolbar,tableId);var shortcutItemsConfig=[];if(actionsBarConfig){shortcutItemsConfig=actionsBarConfig[0];jcaTableConfig.shortcutbar=shortcutItemsConfig;jcaTableConfig.multiSelectbar=actionsBarConfig[1]}if(Ext.isEmpty(shortcutItemsConfig))toolbarConfigItems.push(PTC.jca.table.getActionsMenuConfig(gridPanel));
else{toolbarConfigItems.push(shortcutItemsConfig.items);if(shortcutItemsConfig.allShortcutItems===false){toolbarConfigItems.push(new Ext.Toolbar.Separator);toolbarConfigItems.push(PTC.jca.table.getActionsMenuConfig(gridPanel))}}toolbarConfigItems.push("->");if(!jcaTableConfig.tree&&jcaTableConfig.findInTableMode!==FindInTableMode.DISABLED){var searchInListComponents=PTC.jca.table.findInTable(tableId);toolbarConfigItems=toolbarConfigItems.concat(searchInListComponents);this.on("clearSearchInList",
PTC.jca.table.findInTable.clearSearchInListHandler,this);this.on("applySearchInList",PTC.jca.table.findInTable.applySearchInListHandler,this)}if(!jcaTableConfig.tree&&jcaTableConfig.findInTableMode===FindInTableMode.CLIENT_ONLY){this.on("clearSearchInList",PTC.jca.table.showNxtPrevLink,this);this.on("applySearchInList",PTC.jca.table.hideNxtPrevLink,this)}this.optionsButton=wTable.getOptionsButton();if(this.optionsButton!==null)toolbarConfigItems.push(this.optionsButton);this.helpButton=PTC.help.getHelpButtonConfig(jcaTableConfig.help);
if(this.helpButton!==null)toolbarConfigItems.push(this.helpButton);var toolbarLayout=new PTC.jca.table.ToolbarLayout({tableId:tableId,triggerWidth:40});wTable.toolBar=new Ext.Toolbar({id:gridPanel.id+".toolBar",renderTo:gridPanel.tbar,anchor:"100%",autoWidth:true,cls:"ecaToolbar",items:toolbarConfigItems,layout:toolbarLayout,enableOverflow:true});this.actionsToolBar=wTable.toolBar;PTC.jca.setIgnoreParentClick(wTable.toolBar)}if(jcaTableConfig.tree&&jcaTableConfig.findInTableMode&&jcaTableConfig.findInTableMode!==
FindInTableMode.DISABLED)PTC.jca.table.installFindInTreeFeature(gridPanel)};
PTC.jca.WTablePanel.prototype.getBarsItemsConfig=function(toolbarConfig,tableId,shortcutItems,multiSelectItems){if(!toolbarConfig||!toolbarConfig.items)return;var toolbarItems=toolbarConfig.items;var toolbarItemsCount=toolbarItems.length;var allShortcutItems=true;for(var count=0;count<toolbarItemsCount;count++){var toolbarItem=toolbarItems[count];if(toolbarItem.selectRequired&&toolbarItem.multiSelect){var multiSelectItem=JCAClone(toolbarItem);if(multiSelectItem.id!==undefined)multiSelectItem.id=tableId+
multiSelectItem.id+"_mbar";multiSelectItems.push(multiSelectItem)}var isPanel=toolbarItem.xtype==="panel";if(toolbarItem.items&&isPanel===false)allShortcutItems=this.getBarsItemsConfig(toolbarItem,tableId,shortcutItems,multiSelectItems)&&allShortcutItems;else{var shortCutOnly=false;if(isPanel){toolbarItems.splice(count,1);count--;toolbarItemsCount--;toolbarItem.shortCut=true;shortCutOnly=true}if(toolbarItem.shortCut===true)if(shortCutOnly)shortcutItems.push(toolbarItem);else{var shortcutItem=JCAClone(toolbarItem);
if(shortcutItem.id!==undefined)shortcutItem.id=tableId+shortcutItem.id+"_shortcutbar";shortcutItems.push(shortcutItem)}else if(toolbarItem!=="-")allShortcutItems=false}}return allShortcutItems};
PTC.jca.WTablePanel.prototype.createtoolbarToShortcutbarMultiSelectbarConfig=function(toolbarConfig,tableId){var shortcutItems=[];var multiSelectItems=[];var allShortcutItems=this.getBarsItemsConfig(toolbarConfig,tableId,shortcutItems,multiSelectItems);var shortcutItemsCount=shortcutItems.length;var shortcutbarActionsConfig=null;var actionsBarConfig=[];if(shortcutItemsCount>0){var shortcutActions={};shortcutActions.actionsId=tableId+"_shortcutActions";shortcutActions.defaultActionName="";shortcutActions.items=
shortcutItems;shortcutbarActionsConfig=PTC.jca.ActionModelToToolbar(shortcutActions,this.gridPanel);shortcutbarActionsConfig.allShortcutItems=allShortcutItems;actionsBarConfig[0]=shortcutbarActionsConfig}var multiSelectbarActionsConfig=null;if(multiSelectItems&&multiSelectItems.length>0){var multiSelectActions={};multiSelectActions.actionsId=tableId+"multiSelectActions";multiSelectActions.defaultActionName="";multiSelectActions.items=multiSelectItems;multiSelectbarActionsConfig=PTC.jca.ActionModelToToolbar(multiSelectActions,
this.gridPanel,true);actionsBarConfig[1]=multiSelectbarActionsConfig}return actionsBarConfig};
PTC.jca.table.setVisibleNxtPrevLink=function(grid,visible){var jcaTableConfig=grid.jcaTableConfig;var previousLinkID=PTC.jca.nextPreviousActions.getPreviousLinkId(jcaTableConfig.tableID);var nextLinkID=PTC.jca.nextPreviousActions.getNextLinkId(jcaTableConfig.tableID);var warningMsgID=jcaTableConfig.tableID+"_tablelvlmesg";var pagingBar=grid.getBottomToolbar();var nxtLink=pagingBar.getComponent(nextLinkID);var prevLink=pagingBar.getComponent(previousLinkID);var warningMsg=pagingBar.findById(warningMsgID);
if(nxtLink)nxtLink.setVisible(visible);if(prevLink)prevLink.setVisible(visible);if(warningMsg)warningMsg.setVisible(visible);pagingBar.doLayout()};PTC.jca.table.hideNxtPrevLink=function(grid){PTC.jca.table.setVisibleNxtPrevLink(grid,false)};PTC.jca.table.showNxtPrevLink=function(grid){PTC.jca.table.setVisibleNxtPrevLink(grid,true)};
Ext.data.Store.prototype.handleResultLimitActions=function(store){if(!store)store=this;var grid=PTC.jca.table.Utils.getTable(store.jscaTableID);var pagingBar=grid.getBottomToolbar();var jcaTableConfig=grid.jcaTableConfig;var doLayout=false;var previousLinkID=PTC.jca.nextPreviousActions.getPreviousLinkId(jcaTableConfig.tableID);var nextLinkID=PTC.jca.nextPreviousActions.getNextLinkId(jcaTableConfig.tableID);var linkSpacerID=PTC.jca.nextPreviousActions.getLinkeSpacerId(jcaTableConfig.tableID);if(jcaTableConfig.pageOffset!==
0){if(!pagingBar.getComponent(previousLinkID)){pagingBar.remove(nextLinkID);pagingBar.remove(linkSpacerID);pagingBar.add(PTC.jca.table.Utils.makeExtPagingLink({text:bundleHandler.get("com.ptc.netmarkets.util.utilResource.PREVIOUS_PAGE"),id:previousLinkID,tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.PREVIOUS_RESULT_TOOLTIP"),handler:store.nextPreviousResultSetOnClickHandler.createCallback(store,previousLinkID)}));doLayout=true}}else{pagingBar.remove(previousLinkID);pagingBar.remove(linkSpacerID)}if(store.moreData){if(!pagingBar.getComponent(nextLinkID)){if(pagingBar.getComponent(previousLinkID)&&
!pagingBar.getComponent(linkSpacerID))pagingBar.add({xtype:"tbspacer",width:12,id:linkSpacerID});pagingBar.add(PTC.jca.table.Utils.makeExtPagingLink({text:bundleHandler.get("com.ptc.netmarkets.util.utilResource.NEXT_PAGE"),id:nextLinkID,tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.MORE_RESULTS_TOOLTIP"),handler:store.nextPreviousResultSetOnClickHandler.createCallback(store,nextLinkID)}));doLayout=true}}else{pagingBar.remove(linkSpacerID);pagingBar.remove(nextLinkID)}if(doLayout)pagingBar.doLayout()};
Ext.data.Store.prototype.PTC_OnBeforeLoadState=function(){this.DATA_RENDERED=false};Ext.data.Store.prototype.PTC_OnLoadState=function(){this.DATA_RENDERED=true};
PTC.jca.nextPreviousActions=function(){var nextLinkSuffix="nextResultSet_";var previousLinkSuffix="previousResultSet_";var nextPreviousLinkSpacer="nextPrevLinkSpacer_";return{validate:function(tableId){if(PTC.jca.table.Utils.getTableSelectedRowsCountById(tableId)>0){if(!JCAConfirm(null,"com.ptc.netmarkets.util.utilResource.NXT_PRE_WARNING_MSG"))return false;jsca.unSelectHiddenCheckboxes(tableId);PTC.jca.table.Utils.clearSelectAllCheckbox(PTC.jca.table.Utils.getTable(tableId))}return true},getNextLinkId:function(tableId){return nextLinkSuffix+
tableId},getPreviousLinkId:function(tableId){return previousLinkSuffix+tableId},getLinkeSpacerId:function(tableId){return nextPreviousLinkSpacer+tableId}}}();
Ext.data.Store.prototype.nextPreviousResultSetOnClickHandler=function(store,id,params){PTC.performance.startTimeGauge(store.jscaTableID);var grid=PTC.jca.table.Utils.getTable(store.jscaTableID);var jcaTableConfig=grid.jcaTableConfig;if(!PTC.jca.nextPreviousActions.validate(store.jscaTableID))return;var pagingBar=grid.getBottomToolbar();var warningMsg=grid.getBottomToolbar().findById(store.jscaTableID+"_tablelvlmesg");if(warningMsg!==null)warningMsg.hide();var errorMsg=grid.getBottomToolbar().findById(store.jscaTableID+
"_tablelvlmesg_Err");if(errorMsg!==null)errorMsg.hide();var fire=true;var offset=0;var nxtLinkId=PTC.jca.nextPreviousActions.getNextLinkId(jcaTableConfig.tableID);if(id===nxtLinkId){if(jcaTableConfig.pageOffset===undefined){var titleBar=grid.getTopToolbar();titleBar.getComponent(grid.cancelBtnId).hide();offset=jcaTableConfig.pageSize}else if(store.moreData)offset=jcaTableConfig.pageOffset+jcaTableConfig.pageLimit;else fire=false;pagingBar.items.items[1].show()}else if(jcaTableConfig.pageOffset===
undefined||jcaTableConfig.pageOffset===0)fire=false;else offset=jcaTableConfig.pageOffset-jcaTableConfig.pageLimit;if(fire){store.baseParams.offset=offset;store.baseParams.tableId=jcaTableConfig.tableID;if(store.pagingSessionId!==undefined)store.baseParams.PAGING_SESSION_ID=store.pagingSessionId;store.moreData=false;store.load_complete=false;params=params||{};params=Ext.applyIf(params,grid.initRequestParams);PTC.jca.table.Utils.reload(jcaTableConfig.tableID,params,true)}PTC.performance.stopTimeGauge(store.jscaTableID,
"Empty Table Displayed",true,1)};
PTC.jca.table.getActionsMenuConfig=function(gridPanel){var toolbarActionsMenu={};var menuItems=gridPanel.jcaTableConfig.toolbar;if(!menuItems)return[];toolbarActionsMenu.actionsId=gridPanel.getId()+"_toolbarActionsMenu";toolbarActionsMenu.defaultActionName="";toolbarActionsMenu.items=[menuItems];toolbarActionsMenu.items[0].text=bundleHandler.get("com.ptc.core.ui.componentRB.ACTIONS");toolbarActionsMenu.items[0].cls="actions-menu";var toolbarActionsMenuConfig=PTC.jca.ActionModelToMenubar(toolbarActionsMenu,gridPanel);
if(Ext.getCmp(toolbarActionsMenu.items[0].id))Ext.getCmp(toolbarActionsMenu.items[0].id).destroy();return toolbarActionsMenuConfig.items};
Ext.grid.GridPanel.prototype.getPreSelectionsConfig=function(){if(typeof this.populatePreSelectionsConfig==="function"){var preSelecionObj={oids:[],comparableFn:"PTC.jca.table.Utils.compareOid"};this.populatePreSelectionsConfig.call(this,preSelecionObj);var oids=preSelecionObj.oids;var customCompareFunc=preSelecionObj.comparableFn;var store=this.store;if(this.jcaTableConfig.tree&&!PTC.jca.isAsync(store))store.on("load",store.selectPreSelectOids);else store.on("datachanged",store.selectPreSelectOids);
store.on("datachanged",store.selectPreSelectOids);var tableId=this.id;var matchedOids=[];if(typeof customCompareFunc==="string"){var cmpFunction=PTC.util.convertStringToFunc(customCompareFunc);if(typeof cmpFunction==="function"){preSelecionObj.comparableFn=cmpFunction;store.preSelecionObj=preSelecionObj;var rows=tableUtils.getTableRows(tableId);var selModel=this.getSelectionModel();if(rows&&rows.items){var items=rows.items;for(var i=0,l=items.length;i<l;i++){var j=oids.length;while(j--)if(store.selectPreselctedItem(items[i],
oids[j],cmpFunction,selModel,i))matchedOids.push(oids[j])}}}}if(matchedOids&&matchedOids.length>0){var notMatched=PTC.jca.table.Utils.getNotMatchedOids(matchedOids,oids);PTC.jca.addSelectionCheckbox(notMatched,tableId)}else PTC.jca.addSelectionCheckbox(oids,tableId)}};
Ext.data.Store.prototype._selectPreSelectOids=function(){var tableId=this.jscaTableID;var rows=tableUtils.getTableRows(tableId);var oids=this.preSelecionObj.oids;var cmpFunction=this.preSelecionObj.comparableFn;var grid=PTC.jca.table.Utils.getTable(tableId);var selModel=grid.getSelectionModel();if(rows&&rows.items){var items=rows.items;for(var i=0,l=items.length;i<l;i++){var j=oids.length;while(j--)if(this.selectPreselctedItem(items[i],oids[j],cmpFunction,selModel,i)){var cbox=Ext.fly(oids[j]);if(cbox)cbox.remove()}}}};
Ext.data.Store.prototype.selectPreSelectOids=PTC.util.delayAllCalls(Ext.data.Store.prototype._selectPreSelectOids,200);Ext.data.Store.prototype.selectPreselctedItem=function(item,oid,cmpFunction,selModel,rowIndex){if(!item||!oid||!cmpFunction||!selModel||rowIndex<0)return false;if(item.preSelected!==true&&cmpFunction.call(this,item,oid)){selModel.selectRow(rowIndex,true);item.preSelected=true;return true}else return false};
PTC.jca.WTablePanel.prototype.renderPickerToolbar=function(gridPanel){var tableSuggestPickerConfig,toolbar;if(gridPanel.jcaTableConfig.tableSuggestPickerConfig){tableSuggestPickerConfig=gridPanel.jcaTableConfig.tableSuggestPickerConfig;toolbar=new PTC.autosuggest.toolbar.SuggestToolbar(tableSuggestPickerConfig)}};
PTC.jca.table.registerHiddenRowsHandler=function(tablePanel,listenerScope){var loadListeners=tablePanel.gridPanel.store.events.load.listeners;tablePanel.gridPanel.store.events.load.listeners=[{options:{},fireFn:function(){PTC.jca.table.handleHiddenRows(tablePanel)},fn:function(){PTC.jca.table.handleHiddenRows(tablePanel)},scope:listenerScope}].concat(loadListeners)};
PTC.jca.table.handleHiddenRows=function(tablePanel){var HIDDEN_ROW_DIV="PTC.jca.table.hiddenRowDiv_";var div=$(HIDDEN_ROW_DIV+tablePanel.id);if(div)div.innerHTML="";var someRowsHidden=false;if(!tablePanel.gridPanel)return true;var tableStore=tablePanel.gridPanel.store;if(!tableStore)return true;if(tableStore.findExact("rowHidden",true)<0)return false;if(!div){div=document.createElement("div");div.id=HIDDEN_ROW_DIV+tablePanel.id;div.style.display="none";getMainForm().appendChild(div)}var hiddenHTML=
[];tableStore.filterBy(function(record,id){if(record.get("rowHidden")==="undefined")return true;else if(record.get("rowHidden")===true){hiddenHTML.push(PTC.jca.table.handleHiddenRowRenderer(tablePanel,record));someRowsHidden=true;return false}else return true});if(someRowsHidden){div.innerHTML=hiddenHTML;if(tablePanel.selectable){tablePanel.updateTitle();if(typeof tablePanel.gridPanel.updateSelCountMsg==="function")tablePanel.gridPanel.updateSelCountMsg()}}return someRowsHidden};
PTC.jca.table.handleHiddenRowsEvent=function(t){PTC.jca.table.handleHiddenRows(t)};
PTC.jca.table.handleHiddenRowRenderer=function(table,record){var html=[];if(record&&record.data&&record.fields&&record.fields.keys){var keys=record.fields.keys;keys.each(function(key){var data=record.get(key);if(data&&data.gui&&data.renderer&&typeof data.renderer==="function"){var gui=data.gui;var renderer=data.renderer;if(gui.name)html.push(renderer(table,{id:key},record));else if(gui.hiddenData&&gui.hiddenData.hiddenFields)html.push(renderer(table,{id:key},record))}})}return html};
PTC.jca.WTablePagingBar=function(pagingConfig,chunkingEnabled,isTree){var pSize=isTree?5E3:pagingConfig.pageSize;if(chunkingEnabled){Ext.apply(pagingConfig,new PTC.jca.DataSourceToolbar(pagingConfig));pagingConfig.mask.on("render",pagingConfig.dsMaskListener,this);Ext.apply(pagingConfig,{pageSize:pSize,displayInfo:false,items:[pagingConfig.mask,pagingConfig.cancelButton]})}PTC.jca.WTablePagingBar.superclass.constructor.call(this,pagingConfig)};
PTC.onReady(function(){Ext.apply(Ext.Toolbar.prototype,bundleHandler.get("Ext_PagingToolbar_strings"))});Ext.extend(PTC.jca.WTablePagingBar,Ext.Toolbar,PTC.jca.PagingBarFunctions);
PTC.jca.ActionToButton=function(actionConfig,table,actionsMenuRequest){if(actionConfig){if(actionConfig.html){actionConfig.html=actionConfig.html.replace(/__SCRIPT__/g,"<script>");actionConfig.html=actionConfig.html.replace(/__CLOSE_SCRIPT__/g,"<\/script>");actionConfig.html.evalScripts.defer(100,actionConfig.html)}if(actionConfig.icon){if(actionConfig.text)if(actionConfig.toolBarDesc)actionConfig.iconAlign="top";else{actionConfig.label=actionConfig.text;if(!actionsMenuRequest)actionConfig.text=null}actionConfig.iconCls=
"blist"}if(actionConfig.handler!==undefined)PTC.jca.setActionHandler(actionConfig,table)}return actionConfig};PTC.jca.ActionModelToToolbar=function(actionModel,table,actionsMenuRequest){var buttonsFunc=function(item){item=PTC.jca.ActionToButton(item,table,actionsMenuRequest);item.tooltip={text:item.tooltip,cls:"wctip"};PTC.action.fixIconForSSL(item)};PTC.actionModel.walkActionModelAndApply(actionModel,buttonsFunc);buttonsFunc=null;return actionModel};
PTC.jca.ActionModelToMenubar=function(actionModel,table){PTC.menu.ActionModelToMenu(actionModel);if(actionModel.items&&actionModel.items[0])actionModel.items[0].id+="__"+table.id;var buttonMenuFunc=function(item){PTC.jca.setActionHandler(item,table)};var idfunc=function(item){if(item.id)item.id+="__"+table.id;else if(item.actionID)item.id=item.actionID+"__"+table.id;PTC.action.fixIconForSSL(item)};PTC.actionModel.walkActionModelAndApply(actionModel,buttonMenuFunc);if(table.jcaTableConfig&&!table.jcaTableConfig.jsttd)PTC.actionModel.walkActionModelAndApplyToAll(actionModel,
idfunc);buttonMenuFunc=null;idfunc=null;return actionModel};PTC.jca.setActionHandler=function(item,container){item._handler=item.handler;item.handler=function(target,event){event.jcacontainer=container;target.jcacontainer=container;return item._handler(target,event,container)}};PTC.jca.setIgnoreParentClick=function(toolBar){try{var size=toolBar.items.items.size();for(var i=0;i<size;i++){var theItem=toolBar.items.items[i];if(theItem.menu)theItem.menu.ignoreParentClicks=true}}catch(e){}};
PTC.jca.ComboActionHandler=function(theCombo,viewRecord,viewIndex){var viewAction=viewRecord.get("handler");if(typeof viewAction==="function")viewAction()};
PTC.jca.clearStickyFromSession=function(tableId){var gridPanel=Ext.getCmp(tableId);var selectedOnlyItem=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId)+".selectedOnlyViewItem");if(selectedOnlyItem&&gridPanel.selectedOnlyChecked){selectedOnlyItem.setChecked(false);gridPanel.store.clearFilter(false);gridPanel.selectedOnlyChecked=false;PTC.jca.table.clearObjectFromSession(tableId,selectedOnlyItem.id)}var searchField=Ext.getCmp(PTC.jca.table.findInTable.getSearchInListTextBoxName(tableId));if(searchField)PTC.jca.table.clearObjectFromSession(tableId,
"searchInListTextBox")};PTC.jca.ConfirmViewChangeIgnoreSelections=false;
PTC.jca.ConfirmViewChange=function(theCombo,viewRecord,viewIndex){if(viewRecord.id===PTC.action.SEPARATOR_KEY)return false;else if(viewRecord.id==="Customize"){var gridManager=this.gridPanel.getStateManager();var state=gridManager.getState();if(!state.activeViewInfo){var activeViewInfo_config=PTC.jca.table.getActiveViewInfo(this.gridPanel);if(activeViewInfo_config){state.activeViewInfo=activeViewInfo_config;gridManager.storeState(state)}}theCombo.collapse();theCombo.fireEvent("select",theCombo,viewRecord,
viewIndex);return false}var isTableFiltered=PTC.jca.table.findInTable.isTableFiltered(this.gridPanel);var confirmMessage=null;if(PTC.jca.ConfirmViewChangeIgnoreSelections===false&&tableUtils.getTableSelectedRowsCountById(this.gridPanel.getId())>0)confirmMessage=isTableFiltered?"com.ptc.netmarkets.util.utilResource.CONFIRM_VIEW_CHANGE_WITH_SELECTIONS_FILTER":"com.ptc.netmarkets.util.utilResource.CONFIRM_VIEW_CHANGE";else if(isTableFiltered)confirmMessage="com.ptc.netmarkets.util.utilResource.CONFIRM_VIEW_CHANGE_WITH_FILTER";
if(confirmMessage!==null)if(!JCAConfirm(null,confirmMessage)){theCombo.collapse();return false}var tableId=this.gridPanel.getId();PTC.jca.clearStickyFromSession(tableId);delete this.gridPanel.getStore().sortInfo;this.gridPanel.fireEvent("sortchange",this.gridPanel);this.gridPanel.fireEvent("clearSearchInList",this.gridPanel,true);PTC.jca.previousMultiColumnSortString=PTC.jca.getMultiColumnSortString(tableId);PTC.jca.clearMultiColumnSortAndGroupingString(tableId);PTC.jca.clearGroupingChangedByClient(tableId);
PTC.jca.table.stickiness.clearTableStickiness(tableId);this.gridPanel.clearStickyConfig();if(PTC.jca.ConfirmViewChangeIgnoreSelections===false)jsca.unSelectHiddenCheckboxes(tableId);return true};
PTC.jca.table.viewChangeValidate=function(textField,e){var keyValue=e.getKey();if(keyValue===e.ENTER){var changedView=textField.isDirty();if(changedView===true){var views=textField.getStore();var validViewValue=false;var currentValue=textField.getRawValue();var noOfViews=views.getCount();for(var ia=0;ia<noOfViews;ia++){var record=views.getAt(ia);var viewName=record.get("text");if(viewName===currentValue){validViewValue=true;break}}if(validViewValue!==true){var currentValueArr=[];currentValueArr.push(currentValue);
var defaultActionName=textField.initialConfig.defaultActionName;if(defaultActionName)textField.setValue(defaultActionName);e.preventDefault();JCAAlert("com.ptc.netmarkets.util.utilResource.VIEW_NOT_FOUND_ALERT",null,currentValueArr)}}else e.preventDefault()}};
PTC.jca.ActionModelToComboBox=function(actionModel){var cbStore;if(!actionModel||!actionModel.items)cbStore=new Ext.data.JsonStore({});else cbStore=new Ext.data.JsonStore({fields:["text","handler","tooltip"],autoLoad:true,data:actionModel,root:"items"});if(actionModel.tooltip)actionModel.title=actionModel.tooltip;actionModel.store=cbStore;actionModel.displayField="text";actionModel.typeAhead=true;actionModel.mode="local";actionModel.triggerAction="all";actionModel.selectOnFocus=true;actionModel.resizable=
true;actionModel.forceSelection=true;actionModel.valueNotFoundText="Not Found";if(actionModel.defaultActionName)actionModel.value=actionModel.defaultActionName;actionModel.listeners={select:PTC.jca.ComboActionHandler};actionModel.tpl=new Ext.XTemplate(['<tpl for=".">','<div ext:qtip="{tooltip}" class="x-combo-list-item">{text}</div>',"</tpl>"]);return actionModel};
PTC.jca.PagingBarFunctions={doLoad:function(start){var domEl;if(this.getEl&&this.getEl())domEl=this.getEl.dom;var o=Form.serialize(getMainForm(domEl),true);o.acquire="row";var pn=this.getParams();o.tableID=this.store.jscaTableID;o[pn.start]=start;o[pn.limit]=this.pageSize;var table;if(o.tableID)table=tableUtils.getTable(o.tableID);this.store.remoteSort=PTC.jca.isRemoteSort(this.store,table);if(this.fireEvent("beforechange",this,o)!==false)this.store.load({params:o})},showSelCountMsgOnly:function(){var extItems=
this.items.items;for(var iti=0;iti<extItems.length;iti++)extItems[iti].hide();this.getComponent("selectionMessageCount").show()},showPagingBar:function(){var extItems=this.items.items;for(var iti=0;iti<extItems.length-1;iti++)extItems[iti].show()}};
PTC.jca.table.confirmAdhocView=function(tableID){var tPanel=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableID));var windowId="saveAsViewWindow";var OKButtonText=bundleHandler.get("com.ptc.core.ui.navigationRB.okDialogButton");var duplicateErrorMessage=bundleHandler.get("com.ptc.core.ui.navigationRB.SAVE_AS_VIEW_DUPLICATE_NAME");var viewNames=[];var views=tPanel.getViewsCombo().store;for(var ia=0;ia<views.getCount();ia++){var record=views.getAt(ia);viewNames.push(record.get("text"))}var OKButton=new Ext.Button({text:OKButtonText,
formBind:true,handler:function(button,event){var nameField=Ext.getCmp("newName");var val=PTC.util.unescapeHTML(nameField.getValue().strip());var dupFound=false;viewNames.each(function(item){if(item.toLowerCase()===val.toLowerCase()){dupFound=true;return false}return true});if(dupFound)nameField.markInvalid(duplicateErrorMessage);else{PTC.jca.table.saveAsViewCallback(tableID,val);Ext.getCmp(windowId).close()}}});var cancelButtonText=bundleHandler.get("com.ptc.core.ui.navigationRB.cancelDialogButton");
var cancelButton=new Ext.Button({text:cancelButtonText,handler:function(button,event){PTC.jca.table.resetToDefaultView(tPanel);Ext.getCmp(windowId).close()}});var preKey="SAVE_AS_VIEW";var formId="saveAsViewForm";var defaultFieldValue=getUnescapedText(PTC.jca.table._getUniqueViewName(viewNames));var win=PTC.lightbox.createSimpleLightBoxWindowAndForm(windowId,formId,defaultFieldValue,preKey,OKButton,cancelButton);win.show()};
PTC.jca.table.saveCurrentView=function(tableID,saveButtonClicked){var activeView,tPanel=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableID));var viewsCombo=tPanel.getViewsCombo();if(saveButtonClicked===true)activeView=viewsCombo.value||viewsCombo.startValue||viewsCombo.originalValue;else activeView=viewsCombo.startValue||viewsCombo.originalValue;PTC.jca.table.saveAsViewCallback(tableID,activeView,true)};
PTC.jca.table.resetToDefaultView=function(tPanel){var defaultActionName=tPanel.getViewsCombo().initialConfig.defaultActionName;if(defaultActionName)tPanel.getViewsCombo().setValue(defaultActionName)};PTC.jca.table._saveAsViewCallback_handleSL=function(table){var columnAttributes;if(table.jcaTableConfig.aslcV===true){JCAAlert("com.ptc.core.security.securityResource.JCA_TABLE_VIEW_MANAGER_SECURITY_LABELS_ALTERED");columnAttributes={origId:"ALL_SECURITY_LABELS",width:0,hidden:false}}return columnAttributes};
PTC.jca.table.saveAsViewCallback=function(tableID,newViewName,modifyCurrentView){var tPanel=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableID));var table=PTC.jca.table.Utils.getTable(tableID);if(PTC.jca.isVersionField(table.store.groupField))table.firedDataRenderedEvent=false;var viewsCombo=tPanel.getViewsCombo();var activeViewOid=viewsCombo.activeViewOid;var mform=getMainForm(tableID);var elemsToRemove=[];try{elemsToRemove.push(appendFormHiddenInput(mform,"groupBy",table.store.groupField));elemsToRemove.push(appendFormHiddenInput(mform,
"vName",newViewName));elemsToRemove.push(appendFormHiddenInput(mform,"vOid",activeViewOid));var colModel=tPanel.getColumnModel();var sCols=[];var sColsIndex=0;var cmConfig=colModel.config;var lockedColumnIndex=-1;for(var colix=0;colix<cmConfig.length;colix++){var columnConfig=cmConfig[colix];if(columnConfig.id!="checker"&&columnConfig.id!="stretcher"){var columnAttributes={origId:columnConfig.origId,width:columnConfig.width,hidden:colModel.isHidden(colix)};sCols[sColsIndex]={ColumnObject:columnAttributes};
if(columnConfig.locked===true)lockedColumnIndex=colix;sColsIndex++}}var slColumnAttributes=PTC.jca.table._saveAsViewCallback_handleSL(table);if(slColumnAttributes!==undefined){sCols[sColsIndex]={ColumnObject:slColumnAttributes};sColsIndex++}elemsToRemove.push(appendFormHiddenInput(mform,"columns_set","true"));elemsToRemove.push(appendFormHiddenInput(mform,"columnConfigInformation",Ext.util.JSON.encode(sCols)));if(PTC.jca.previousMultiColumnSortString){var sort_info=PTC.jca.previousMultiColumnSortString;
if(PTC.isDefinedAndNotEmptyString(sort_info)){var sort_info_array=sort_info.split(PTC.jca.SORT_DELIMITER);var clientSortString_withOrgID="";for(var i=0;i<sort_info_array.length-1;i+=2){var sinfo=sort_info_array[i];if(PTC.isDefinedAndNotEmptyString(sinfo))clientSortString_withOrgID+=PTC.jca.getServerIdFromJSColumnId(table,sinfo)+PTC.jca.SORT_DELIMITER+sort_info_array[i+1]+PTC.jca.SORT_DELIMITER}elemsToRemove.push(appendFormHiddenInput(mform,"sortInfo",clientSortString_withOrgID))}}elemsToRemove.push(appendFormHiddenInput(mform,
"freezeColumn",lockedColumnIndex));var viewJavascriptUrl;if(modifyCurrentView===true)viewJavascriptUrl=document.getElementById("saveViewJavascriptUrl_"+tableUtils.getFormattedTableId(tableID));else viewJavascriptUrl=document.getElementById("saveAsViewJavascriptUrl_"+tableUtils.getFormattedTableId(tableID));if(viewJavascriptUrl)PTC.jslint.foundEvalReservedWord(viewJavascriptUrl.value)}finally{removeFormElements(elemsToRemove)}};
PTC.jca.table.saveAsViewResponseHandler=function(tableId,viewName,viewOid){var viewsCombo=PTC.jca.table.Utils.getTableViewComboBox(tableId);var currentView=viewsCombo.startValue||viewsCombo.originalValue||viewsCombo.value;if(currentView!==viewName){var adhocViewRecord=new Ext.data.Record({text:viewName,tooltip:viewName});PTC.jca.table.insertRecordIntoViewsCombo(adhocViewRecord,viewsCombo);if(viewsCombo.store.isFiltered()){viewsCombo.store.clearFilter();var saveButton=Ext.getCmp(tableId+"_saveView");
if(!saveButton.isVisible())saveButton.setVisible(true)}}viewsCombo.setValue(viewName);viewsCombo.startValue=viewName;if(viewOid&&currentView!==viewName)viewsCombo.activeViewOid=viewOid};PTC.jca.table.insertRecordIntoViewsCombo=function(record,viewsCombo){var store=viewsCombo.getStore();store.add(record)};
PTC.jca.table.ToolbarLayout=Ext.extend(Ext.layout.ToolbarLayout,{_registerRunToolbarLayout:function(table){this._runToolbarLayout=PTC.util.delayAllCalls(this._runToolbarLayout,10);var _runToolbarLayoutDelegate=this._runToolbarLayout.createDelegate(this,[this]);table.on("resize",_runToolbarLayoutDelegate);if(table.colModel)table.colModel.on("widthchange",_runToolbarLayoutDelegate)},_runToolbarLayout:function(toobarLayout){toobarLayout.runLayout()},constructor:function(config){config=config||{};PTC.jca.table.ToolbarLayout.superclass.constructor.call(this,
config);this.tableId=config.tableId;var table=Ext.getCmp(config.tableId);if(table)this._registerRunToolbarLayout(table);else Ext.ComponentMgr.onAvailable(this.tableId,function(table){this._registerRunToolbarLayout(table)})},initMore:function(){if(!this.moreBtn){if(Ext.isEmpty(this.table))this.table=Ext.getCmp(this.tableId);this.moreToolbar=new Ext.Toolbar({id:this.tableId+".moreToolbar",hidden:true,renderTo:this.table.tbar});var len=this.hiddenItems.length;var maxChildHeight=0;for(var i=len-1;i>=
0;i--){var item=this.hiddenItems[i];this.container.remove(item,false);this.moreToolbar.insert(0,item);this.unhideItem(item);maxChildHeight=Ext.max([maxChildHeight,item.getHeight()])}this.moreToolbar.insert(0,"->");this.moreToolbar.setHeight(maxChildHeight+5);this.moreBtn=new Ext.Button({iconCls:"x-toolbar-more-icon",cls:"x-toolbar-more",handler:this.moreButtonHandler,ownerCt:this.container,table:this.table,moreToolbar:this.moreToolbar});var position=this.extrasTr.childNodes?this.extrasTr.childNodes.length:
0;var td=this.insertCell(this.moreBtn,this.extrasTr,position);this.moreBtn.render(td);this.table.on("beforedestroy",this.destroyMoreToolbar);var resizeFn=this.syncSize,toolbarLayout=this;if(!resizeFn)resizeFn=function(){if(!toolbarLayout._resizeMoreTask)toolbarLayout._resizeMoreTask=new Ext.util.DelayedTask(toolbarLayout.moreToolbarResizeListener);toolbarLayout._resizeMoreTask.delay(10,null,null,[toolbarLayout])};this.table.on("resize",resizeFn);if(this.table.colModel)this.table.colModel.on("widthchange",
resizeFn)}else if(this.hiddenItems){var hLen=this.hiddenItems.length;for(var j=hLen-1;j>=0;j--){var hitem=this.hiddenItems[j];this.moreToolbar.insert(0,hitem);if(this.remove)this.remove(hitem,false);else this.container.remove(hitem,false)}while(this.hiddenItems.length>0)this.unhideItem(this.hiddenItems[this.hiddenItems.length-1])}},moreToolbarResizeListener:function(toolbarLayout){var toolbar=toolbarLayout.container;var moreToolbar=toolbarLayout.moreToolbar;var moreToolbarItems=moreToolbar.items.items||
[];toolbarLayout.hiddenItems=(toolbar.items.items||[]).concat(moreToolbarItems);toolbar.items.addAll(moreToolbarItems);moreToolbar.items.clear();Ext.fly(moreToolbar.id).removeClass("x-hide-display");var layoutTarget=toolbar.getLayoutTarget();var len=toolbarLayout.hiddenItems.length,item,triggerWidth=toolbarLayout.triggerWidth||0;var loopWidth=0,clipWidth=layoutTarget.dom.clientWidth-triggerWidth;var searchInListId=toolbarLayout.tableId+".searchInListLoadingWheel";var selectedOnlyId=toolbarLayout.tableId+
"_WTablePanel_selectedOnlyMenu";var fillInserted=false;for(var i=0;i<len;i++){item=toolbarLayout.hiddenItems[i];if(!item.isFill){if(!fillInserted&&(item.id===searchInListId||item.id===selectedOnlyId||item.iconCls==="helpButton")){toolbar.add("->");fillInserted=true}loopWidth+=toolbarLayout.getItemWidth(item);if(loopWidth>clipWidth){moreToolbar.insert(moreToolbar.items.length,item);toolbar.remove(item,false)}if(fillInserted){var c=toolbar.items.remove(item);if(c)toolbar.items.add(item)}}else toolbar.remove(item,
false)}Ext.fly(moreToolbar.id).addClass("x-hide-display");toolbarLayout.hiddenItems=[];var hasHidden=moreToolbar.items.length!==0;moreToolbar.insert(0,"->");if(hasHidden)toolbarLayout.moreBtn.show();else toolbarLayout.moreBtn.hide();toolbarLayout.runLayout();moreToolbar.layout.layout()},moreButtonHandler:function(button,e){var moreToolbar=button.moreToolbar;var csize=this.table.getGridEl().getSize(true);var hdHeight=this.table.view.mainHd.getHeight();if(moreToolbar.hidden){moreToolbar.show();hdHeight=
hdHeight+moreToolbar.getHeight()}else moreToolbar.hide()},destroyMoreToolbar:function(){this.table=undefined;Ext.destroy(this.moreToolbar,this.more)}});PTC.jca.tree={};Ext.apply(PTC.jca.tree,new Ext.util.Observable);PTC.jca.tree.addEvents("beforeexpandnodeserver");
PTC.jca.tree.updateOidMap=function(v1,v1oid,v2oid,r1,r2,oidjson){if(oidjson!==undefined)if(r1.data[PTC.jca.BACKING_VERSION_COLUMN_NAME]&&r2.data[PTC.jca.BACKING_VERSION_COLUMN_NAME])PTC.jca.table.pushOidsinMap(r1.data._parent,r1.data[PTC.jca.BACKING_VERSION_COLUMN_NAME],r2.data[PTC.jca.BACKING_VERSION_COLUMN_NAME],oidjson);else PTC.jca.table.pushOidsinMap(r1.data._parent,v1oid,v2oid,oidjson)};PTC.jca.tree.rowSelectionFunc=function(rec,idx,rowParams,store){if(!PTC.jca.table.isRowSelectable(rec,store))return"nonselectable-record"};
PTC.jca.TreeGrid=function(rowConfig){Ext.apply(rowConfig,{tree:true});PTC.jca.TreeGrid.superclass.constructor.call(this,rowConfig);PTC.jca.TableFactory.addEvents(this);this.master_column_id=rowConfig.treeColumn;var view=this.getView();view.getRowClass=PTC.jca.tree.rowSelectionFunc;view.enableGrouping=false;view.enableGroupingMenu=false;view.onStoreActiveNodeChange=TRUE_FUNC;view.setRootBreadcrumbs=TRUE_FUNC};Ext.ComponentMgr.registerType("jcatreegrid",PTC.jca.TreeGrid);
PTC.jca.tree.expandLoadMask=function(store,rc){var tableCmp=Ext.getCmp(this.baseParams.tableID);if(tableCmp){var view=tableCmp.getView();if(view)try{var rcIndex=this.indexOf(rc);if(rcIndex!==-1){var rowEle=view.getRow(rcIndex);if(rowEle){var maskEle=Ext.fly(rowEle).child(".ux-maximgb-tg-elbow-active");if(maskEle){var treeNodeMask=new Ext.LoadMask(maskEle,{msg:"",msgCls:"treeNodeMask"});treeNodeMask.show();if(this.isLoadedNode(rc))treeNodeMask.hide();else this.on("load",function(store,recs,options){treeNodeMask.hide()},
this,{single:true})}}}}catch(e){jsca.log(e)}}tableCmp=null;view=null;rowEle=null;maskEle=null};Ext.extend(PTC.jca.TreeGrid,Ext.ux.maximgb.tg.GridPanel);
PTC.jca.TreeGrid.prototype.initComponent=function(){PTC.jca.TreeGrid.superclass.initComponent.apply(this,arguments);if(isWizardWindow()){this.domChangeEventListener=PTC.wizard.saveTableData.domChangeEventListener;this.on("renderTableEnd",PTC.wizard.saveTableData.registerDomChangeEvents)}this.on("renderTableEnd",this.expandInitialRootNode);this.registerSelCount();this.on("afteraction",this.onAfterAction);this.mon(PTC.action,"objectsaffected",this.onObjectsAffected,this)};
PTC.jca.TreeGrid.prototype.onAfterAction=function(formResult){if(formResult&&"component"===formResult.ajaxEnabled&&!formResult.js&&!formResult.URL){PTC.jca.table.log.warn("Action used a component refresh",formResult.nextAction,this.id);PTC.jca.table.Utils.reload(this);return false}return PTC.jca.TableGrid.prototype.onAfterAction.call(this,formResult)};
Ext.ux.maximgb.tg.GridPanel.prototype.onTreeGridSelectionChange=function(sm,selection){var record,store;if(sm.getSelected)record=sm.getSelected();else if(Ext.type(selection)=="array"&&selection.length>0){record=store.getAt(selection[0]);this.getStore().setActiveNode(record)}else throw"Unknown selection model applyed to the grid.";};
PTC.jca.expandRowIfAuto=function(record){if(record.get("autoexpand")){var store=record.store;if(store.hasChildNodes(record)){var eventsSuspendedAlready=store.eventsSuspended;store.suspendEvents();store.setNodeLoaded(record,true);record.set("autoexpand",false);if(!eventsSuspendedAlready)store.resumeEvents();store.expandNode(record)}}};
PTC.jca.autoExpandRows=function(store){store.enableChildNodeCache();try{store.each(PTC.jca.expandRowIfAuto)}finally{store.disableChildNodeCache()}PTC.jca.table.scroll.updateTableSize.defer(100,store,[store.jscaTableID])};PTC.jca.expandRows=function(tableid){var g=tableUtils.getTable(tableid);PTC.jca.table.scroll.updateTableSize.defer(100,PTC.jca.table.scroll,[tableid]);PTC.jca.table.Utils.scrollToFocusRow(g)};PTC.jca.collapseRows=function(tableid){PTC.jca.table.scroll.updateTableSize(tableid)};
PTC.jca.isAsync=function(store){return!Ext.isEmpty(store.chunk)};PTC.jca.getQueryStringFromAction=function(g){var formAction=getMainForm(g.getEl().dom).attributes["action"].value;var index=formAction.indexOf("?");var queryString="";if(index>-1)queryString="&"+formAction.substring(formAction.indexOf("?")+1);return queryString};PTC.jca.autoExpandRows=PTC.util.delayAllCalls(PTC.jca.autoExpandRows,200);PTC.jca.expandRows=PTC.util.delayAllCalls(PTC.jca.expandRows,100);
PTC.jca.collapseRows=PTC.util.delayAllCalls(PTC.jca.collapseRows,100);PTC.jca.tree.onCollapse=function(target,node){if(this.collapseAll!==true){var g=tableUtils.getTable(this.jscaTableID);var queryString=PTC.jca.getQueryStringFromAction(g);treeHandler.asyncCollapse(node.data.oid,g.id,node.data.jsca_context,queryString,g.jcaTableConfig.uniqueCompKey)}PTC.jca.collapseRows(this.jscaTableID)};
PTC.jca.tree.onExpand=function(target,node){if(this.norgieClicked===1&&this.isLoadedNode(node)){var g=tableUtils.getTable(this.jscaTableID);var queryString=PTC.jca.getQueryStringFromAction(g);treeHandler.expandNode(node.data.oid,g.id,node.data.jsca_context,queryString,g.jcaTableConfig.uniqueCompKey)}PTC.jca.expandRows(this.jscaTableID)};
PTC.jca.WTablePanel.prototype.handleTreeResultLimit=function(store,records){var isTreeVisible=store.proceed===false?false:tableUtils.isComponentVisible(store);var gridPanel=tableUtils.getTable(store.jscaTableID);var isOidBasedProcessing=store.postCancelHandlerInfo&&store.postCancelHandlerInfo.oid;if(isTreeVisible===false)store.proceed=false;try{var showPopUp=store.showPopUp;if(showPopUp===undefined){var storeCanAbsorb=store.resultLimit-store.data.items.length;if(records.totalRecords>storeCanAbsorb)showPopUp=
true}else showPopUp=false;var belowResultLimit=store.resultLimitCrossed===undefined||store.resultLimitCrossed===false;var singleNodeExpand=store.norgieClicked||store.proceed===false;var proceed=store.showPopUp;if(showPopUp)proceed=JCAConfirm("com.ptc.netmarkets.util.utilResource.UNBOUNDED_LOAD");if(proceed){store.resultLimitCrossed=true;return}if(store.resultLimitReached===true&&isOidBasedProcessing)PTC.jca.tree.postCancelHandler(store,records);var displayWarning=true;if(store.displayWarning!==undefined)displayWarning=
store.displayWarning;if(belowResultLimit&&(proceed===false||store.proceed===false||singleNodeExpand===true))PTC.jca.tree.adjustTreeStoreContents(store,records,gridPanel);var postCancelRecords=store.postCancelRecords?store.postCancelRecords:[];if(!proceed&&showPopup){PTC.jca.tree.adjustTreeStoreContents(store,records,gridPanel);records.records=records.records.concat(postCancelRecords)}else records.records=postCancelRecords}finally{store.postCancelRecords=[];store.showPopUp=undefined}if(gridPanel)gridPanel.getView().refresh();
if(displayWarning&&(belowResultLimit===true||proceed===false)){var msg1=bundleHandler.get("com.ptc.netmarkets.util.utilResource.MAX_DATASOURCE_LIMIT_REACHED_MESSAGE_TREE_LEVEL");var key1="com.ptc.netmarkets.util.utilResource.MAX_DATASOURCE_LIMIT_REACHED_MESSAGE_TREE_LEVEL";var key2="com.ptc.netmarkets.util.utilResource.MAX_DATASOURCE_LIMIT_REACHED_MESSAGE_TREE";PTC.jca.table.Utils.renderPageNcomponentLevelFeedback(store,msg1,key1,key2)}};
PTC.jca.tree.postCancelHandler=function(store,records){var requiredNodes=[];store.postCancelRecords=[];if(!store.postCancelHandlerInfo||!store.postCancelHandlerInfo.oid)return;var length=records.records.length;var requiredNodeObject=null;var oidToPopulate=store.postCancelHandlerInfo.oid;var gridPanel=store.jsca_table?store.jsca_table:tableUtils.getTable(store.jscaTableID);var dsId=gridPanel.jcaTableConfig.chunk.id;if(length===undefined||length===0)return;for(var i=0;i<length;i++)if(records.records[i].data.oid==
oidToPopulate){requiredNodeObject=records.records[i];requiredNodes.push(requiredNodeObject);PTC.jca.DataSourceRegistry.cancelServerDataSources(dsId);break}if(!requiredNodeObject)return;var parent=requiredNodeObject.data._parent;var findParent=function(){for(var i=0;i<length;i++)if(records.records[i].data.jsca_context==parent){records.records[i].ux_maximgb_tg_expanded=true;records.records[i].ux_maximgb_tg_loaded=true;requiredNodes.push(records.records[i]);parent=records.records[i].data._parent;break}if(i>=
length)return false;else return true};while(parent&&findParent());store.postCancelRecords=requiredNodes};
PTC.jca.tree.adjustTreeStoreContents=function(store,records,gridPanel){store.loadContinue=false;var storeItemsLength=store.data.items.length;var ids=store.chunk?[store.chunk.id]:gridPanel?[gridPanel.jcaTableConfig.chunk.id]:[];PTC.jca.DataSourceRegistry.cancelServerDataSources(ids);var resultLimit=store.resultLimit;if(storeItemsLength<resultLimit){var recordPivotPoint=resultLimit-storeItemsLength;records.records.splice(recordPivotPoint,records.records.length)}else{store.data.items.splice(resultLimit,
store.data.items.length);records.records.splice(0,records.records.length)}store.data.length=store.data.items.length};PTC.jca.createTreeListeners=function(proceed,g,store){proceed(g,store);if(g.tree&&g.initialConfig.jcaTableConfig.initialDisplayCollapsed!==true)PTC.jca.enableAutoExpand(g);store.on("collapsenode",PTC.jca.tree.onCollapse);store.on("beforeexpandnode",PTC.jca.tree.onExpand);store.on("after_expand_collapse",PTC.jca.table.handleSelectAllCheckbox)};
PTC.jca.enableAutoExpand=function(table){var store=table.getStore();if(PTC.jca.isAsync(store))store.on("datasourcecomplete",PTC.jca.autoExpandRows);else store.on("datachanged",PTC.jca.autoExpandRows)};PTC.jca.disableAutoExpand=function(table){var store=table.getStore();if(PTC.jca.isAsync(store))store.un("datasourcecomplete",PTC.jca.autoExpandRows);else store.un("datachanged",PTC.jca.autoExpandRows)};PTC.jca.createListeners=PTC.jca.createListeners.wrap(PTC.jca.createTreeListeners);
PTC.jca.collapseAll=function(target,event,table){if(table){var gview=table.getView();var store=table.store;delete store.norgieClicked;var selectedRows=getJCASelectedTableItems(table.id);var formAction=getMainForm(table.getEl().dom).attributes["action"].value;var queryString="";var allSelected=selectedRows.length==store.getCount();var collapseAll=!(event&&event.clearSelections===false);store.enableChildNodeCache();try{if(selectedRows.length>0&&!allSelected&&collapseAll)for(var i=0;i<selectedRows.length;i++){var sel=
selectedRows[i];var rowRecord=tableUtils.getTableRowFromContext(table.id,sel.value);if(rowRecord===null){var oid=getOidFromRowValue(sel.value);rowRecord=tableUtils.getTableRowFromOid(table.id,oid)}store.collapseNode(rowRecord);queryString+="&soid="+oid}else{store.collapseAll=true;try{store.each(store.collapseNode,store)}finally{store.collapseAll=false}queryString="&"+formAction.substring(formAction.indexOf("?")+1)}}finally{store.disableChildNodeCache()}if(collapseAll&&selectedRows.length>0){jsca.unSelectAll(null,
table.id);table.updateViewOnRadioSelect(table)}treeHandler.asyncCollapse("",table.id,"",queryString+"&implode=true",table.jcaTableConfig.uniqueCompKey);return false}else return true};
PTC.jca.expandAll=function(target,event,table){if(table){var store=table.getStore();var i,l,len,sel,oid,rowRecord;var selectedRows=getJCASelectedTableItems(table.id);delete store.norgieClicked;var proceed=PTC.jca.table.Utils.getDataLoadUserConfirmation(store,"com.ptc.netmarkets.util.utilResource.UNBOUNDED_LOAD");if(proceed===false)return;store.expandBeyondLimit=proceed;var allLoaded=true;var scrollToFocusRow=true;var allSelected=selectedRows.length==store.getCount();var expandAll=!(event&&event.clearSelections===
false);if(selectedRows.length<=0||allSelected){i=store.getCount();while(i--){var rec=store.getAt(i);if(!store.isLeafNode(rec)&&!store.hasChildNodes(rec)){allLoaded=false;i=len}}}if(allSelected)selectedRows=PTC.jca.tree._removeLeafNodes(selectedRows,table);if(selectedRows.length>0&&!(allLoaded&&allSelected)&&expandAll){store.expandAllwithSelections=true;if(store.chunkEnabled)PTC.jca.expandNodeListAsync(selectedRows,table);else for(i=0,l=selectedRows.length;i<l;i++){sel=selectedRows[i];if(sel){rowRecord=
tableUtils.getTableRowFromContext(table.id,sel.value);if(rowRecord===null){oid=getOidFromRowValue(sel.value);rowRecord=tableUtils.getTableRowFromOid(table.id,oid)}rowRecord.ux_maximgb_tg_expanded=false;store.norgieClicked=1;store.expandNode(rowRecord)}}}else if(allLoaded)try{store.enableChildNodeCache();for(i=0,len=store.getCount();i<len;i++){rec=store.getAt(i);store.expandNode(rec)}}finally{store.disableChildNodeCache()}else{table.getView().resetCaches();PTC.jca.table.Utils.reload(table.id,{initTree:"true",
explode:"true",acquire:"row"},true);store.DATA_RENDERED=true;scrollToFocusRow=false}if(expandAll&&selectedRows.length>0){jsca.unSelectAll(null,table.id);table.updateViewOnRadioSelect(table)}if(scrollToFocusRow){PTC.jca.table.Utils.scrollToFocusRow(table);table.alreadyScrolled=true}}return!table};
PTC.jca.expandNodeListAsync=function(selectedRows,table){var nodeList=[];var sel,rowRecord,oid,i,l;var store=table.getStore();for(i=0,l=selectedRows.length;i<l;i++){sel=selectedRows[i];if(sel){rowRecord=tableUtils.getTableRowFromContext(table.id,sel.value);if(rowRecord===null){oid=getOidFromRowValue(sel.value);rowRecord=tableUtils.getTableRowFromOid(table.id,oid)}rowRecord.ux_maximgb_tg_expanded=false;store.norgieClicked=1;nodeList.push(rowRecord)}}store.expandNodeList(nodeList)};
PTC.jca.expandNode=function(rowRecord,store){store.performExpand=true;if(typeof store.expandNode==="function")store.expandNode(rowRecord)};
PTC.jca.TreeGrid.prototype.expandInitialRootNode=function(){var gridPanel=this;if(gridPanel.store.getRootNodes().length==1){var oid=extractParamValue(window.location.href,"oid");while(oid.indexOf("%3A")>-1)oid=oid.replace("%3A","_");var key="rootExpanded_"+gridPanel.id+"_"+oid;var provider=new PTC.jca.state.ClientStateProvider;if(!provider.get(key)){var record=gridPanel.store.getAt(0);if(record){gridPanel.store.expandNode(record);provider.set(key,true)}}}};
Ext.override(Ext.ux.maximgb.tg.GridView,{expandRow:function(record,initial,suppress){var ds=this.ds,i,len,row,pmel,children,index,child_index,sm=this.grid.selModel;if(typeof record=="number"){index=record;record=ds.getAt(index)}else index=ds.indexOf(record);row=this.getRow(index);var fly=Ext.fly(row);if(!fly)return;pmel=fly.child(".ux-maximgb-tg-elbow-active");if(pmel)if(ds.hasNextSiblingNode(record)){pmel.removeClass("ux-maximgb-tg-elbow-plus");pmel.removeClass("ux-maximgb-tg-elbow-end-plus");pmel.addClass("ux-maximgb-tg-elbow-minus")}else{pmel.removeClass("ux-maximgb-tg-elbow-plus");
pmel.removeClass("ux-maximgb-tg-elbow-end-plus");pmel.addClass("ux-maximgb-tg-elbow-end-minus")}if(ds.isVisibleNode(record)){children=ds.getNodeChildren(record);len=children.length;for(i=0;i<len;i++){var child_record=ds.indexOf(children[i]);row=this.getRow(child_record);Ext.fly(row).setStyle("display","block");if(ds.isExpandedNode(children[i]))this.expandRow(child_record,undefined,true)}}if(!suppress)ds.fireEvent("after_expand_collapse",sm)},collapseRow:function(record,suppress){var ds=this.ds,i,
len,children,row,index,sm=this.grid.selModel;if(typeof record=="number"){index=record;record=ds.getAt(index)}else index=ds.indexOf(record);row=this.getRow(index);var selectedCount=PTC.jca.table.Utils.getTableSelectedRowsCountById(ds.jscaTableID);var rowCount=ds.data!==null&&ds.data!==undefined?ds.data.length:0;if(ds.resultLimitReached&&ds.chunkEnabled&&selectedCount!==rowCount){ds.suspendEvents();try{ds.not_removed_ids=ds.getNotRemovedIDs(ds);ds.removeNodeDescendants(record)}catch(exception){record.ux_maximgb_tg_loaded=
false;record.ux_maximgb_tg_expanded=false}ds.resumeEvents();record.data._is_leaf=false;record.ux_maximgb_tg_loaded=false;record.ux_maximgb_tg_expanded=false;ds.fireEvent("datachanged",ds);var params={};params.countChanged=true;this.onDataChange(ds,params);index=ds.indexOf(record);row=this.getRow(index);var totalRowCount=ds.data!==null&&ds.data!==undefined?ds.data.length:0;if(totalRowCount<ds.resultLimit){ds.resultLimitReached=false;ds.resultLimitCrossed=false}var pmel=Ext.fly(row).child(".ux-maximgb-tg-elbow-end");
if(!pmel)pmel=Ext.fly(row).child(".ux-maximgb-tg-elbow");if(pmel){PTC.jca.TreeGrid.updateClass(pmel,ds,record);pmel.addClass("ux-maximgb-tg-elbow-active")}if(this.grid.store._delete===undefined)record.ptc_clientsidecollapse=true;if(ds.resultLimitCrossed===false&&this.grid.store._delete){var tableLevMsg=Ext.getCmp(ds.jscaTableID+"_tablelvlmesg");if(PTC.isDefined(tableLevMsg))tableLevMsg.hide();this.grid.store._delete=false}}else{pmel=Ext.fly(row).child(".ux-maximgb-tg-elbow-active");if(pmel)PTC.jca.TreeGrid.updateClass(pmel,
ds,record);children=ds.getNodeChildren(record);len=children.length;for(i=0;i<len;i++){index=ds.indexOf(children[i]);row=this.getRow(index);Ext.fly(row).setStyle("display","none");this.collapseRow(index,true)}}if(!suppress)ds.fireEvent("after_expand_collapse",sm)}});
Ext.override(Ext.ux.maximgb.tg.GridView,{renderCellTreeUI:function(record,store){var tpl=this.templates.treeui,line_tpl=this.templates.elbow_line,tpl_data={},rec,parent,depth=store.getNodeDepth(record),level=store.getNodeDepth(record);tpl_data.wrap_width=(depth+1)*16;if(level>0){tpl_data.elbow_line="";rec=record;var left=0;while(level--){parent=store.getNodeParent(rec);if(parent)if(store.hasNextSiblingNode(parent))tpl_data.elbow_line=line_tpl.apply({left:level*16,cls:"ux-maximgb-tg-elbow-line"})+
tpl_data.elbow_line;else tpl_data.elbow_line=line_tpl.apply({left:level*16,cls:"ux-maximgb-tg-elbow-empty"})+tpl_data.elbow_line;else throw["Tree inconsistency can't get level ",level+1," node(id=",rec.id,") parent."].join("");rec=parent}}if(store.isLeafNode(record))if(store.hasNextSiblingNode(record))tpl_data.cls="ux-maximgb-tg-elbow";else tpl_data.cls="ux-maximgb-tg-elbow-end";else{tpl_data.cls="ux-maximgb-tg-elbow-active ";if(store.isExpandedNode(record))if(store.hasNextSiblingNode(record))tpl_data.cls+=
"ux-maximgb-tg-elbow-minus";else tpl_data.cls+="ux-maximgb-tg-elbow-end-minus";else if(store.hasNextSiblingNode(record))tpl_data.cls+="ux-maximgb-tg-elbow-plus";else tpl_data.cls+="ux-maximgb-tg-elbow-end-plus"}tpl_data.left=1+depth*16;if(store.disableAction)tpl_data.cls="";return tpl.apply(tpl_data)}});
Ext.override(Ext.ux.maximgb.tg.GridPanel,{onClick:function(e){var target=e.getTarget(),view=this.getView(),row=view.findRowIndex(target),store=this.getStore(),sm=this.getSelectionModel(),record,record_id,do_default=true;if(row!==false){if(Ext.fly(target).hasClass("ux-maximgb-tg-elbow-active")){this.fireEvent("rowmousedown",this,row,e);record=store.getAt(row);if(store.isExpandedNode(record))store.collapseNode(record);else if(record.ptc_clientsidecollapse){store.setNodeExpanded(record,true);store.fireEvent("expandnode",
store,record);record.ptc_clientsidecollapse=undefined}else{store.norgieClicked=1;store.expandNode(record)}do_default=false}}else if(Ext.fly(target).hasClass("ux-maximgb-tg-brditem")){record_id=Ext.id(target);record_id=record_id.substr(record_id.lastIndexOf("-")+1);if(record_id){record=store.getById(record_id);row=store.indexOf(record);if(e.hasModifier())if(store.isExpandedNode(record))store.collapseNode(record);else store.expandNode(record);else if(sm.isSelected&&!sm.isSelected(row))sm.selectRow(row)}else sm.clearSelections();
e.preventDefault()}if(do_default)Ext.ux.maximgb.tg.GridPanel.superclass.onClick.call(this,e)}});PTC.jca.TreeGrid.updateClass=function(pmel,ds,record){if(ds.hasNextSiblingNode(record)){pmel.removeClass("ux-maximgb-tg-elbow-minus");pmel.removeClass("ux-maximgb-t-tg-bow-end-minus");pmel.addClass("ux-maximgb-tg-elbow-plus")}else{pmel.removeClass("ux-maximgb-tg-elbow-minus");pmel.removeClass("ux-maximgb-tg-elbow-end-minus");pmel.addClass("ux-maximgb-tg-elbow-end-plus")}};
PTC.jca.TreeGrid.removeNorgie=function(store,record,parentRecord){var parentNode;if(parentRecord)parentNode=parentRecord;else parentNode=store.getNodeParent(record);if(parentNode!==undefined&&parentNode!==null&&store.getNodeChildrenCount(parentNode)===0){parentNode.beginEdit();store.collapseNode(parentNode);parentNode.data._is_leaf=true;parentNode.data.autoexpand=false;parentNode.afterEdit();tableUtils.getTable(store.jscaTableID).getView().update()}};
Ext.override(Ext.ux.maximgb.tg.AbstractTreeStore,{not_removed_ids:null,remove:function(record){if(Ext.isArray(record)){var i=record.length;while(i--)this.remove(record[i]);return}var id=record.id;var j,size;if(PTC.isDefined(this.not_removed_ids))for(j=0,size=this.not_removed_ids.length;j<size;j++)if(this.not_removed_ids[j].id.indexOf(id)>=0){var parent=this.getById(record.data._parent);parent.childselected=true;this.removeNodeDescendants(record);return}this.removeNodeDescendants(record);if(record.childselected){parent=
this.getById(record.data._parent);parent.childselected=true}else{if(record===this.active_node)this.setActiveNode(null);Ext.ux.maximgb.tg.AbstractTreeStore.superclass.remove.call(this,record);PTC.jca.TreeGrid.removeNorgie(this,record);this._delete=true}},getNotRemovedIDs:function(store){return tableUtils.getTableSelectedRowsById(store.jscaTableID)},expandNodeList:function(nodeList){var params={};params.jsonData={};var len=nodeList.length;var rowList=[];var levelList=[];for(var i=0;i<len;i++){var rc=
nodeList[i];if(!this.isExpandedNode(rc)&&this.fireEvent("beforeexpandnode",this,rc)!==false)if(this.isLoadedNode(rc)){this.setNodeExpanded(rc,true);this.fireEvent("expandnode",this,rc)}else{PTC.jca.tree.fireEvent("beforeexpandnodeserver",rc,params,this.jscaTableID);params[this.paramNames.active_node]=rc.id;rowList.push(rc.id);params.actionMethod="expand";params.acquire="row";levelList.push(rc.data._level);Ext.lib.Ajax.headers={Accept:"application/json","Content-Type":"application/x-www-form-urlencoded"}}}params.jsonData["e"]=
rowList;params.jsonData["level"]=levelList;if(0<rowList.length)this.load({add:true,params:params,callback:this.expandNodeCallback,scope:this})}});PTC.jca.tree._removeLeafNodes=function(selectedRows,table){var sel,rec;var i=selectedRows.length;var result=[];var store=table.store;while(i--){sel=selectedRows[i];rec=tableUtils.getTableRowFromContext(table.id,sel.value);if(!store.isLeafNode(rec))result.push(sel)}return result};
PTC.jca.tree.forceServerSideExpand=function(parentRecord,grid,removeExistingChildren,children){if(removeExistingChildren)PTC.jca.tree.removeChildren(parentRecord,grid,children);parentRecord.data._is_leaf=false;parentRecord.ux_maximgb_tg_loaded=false;parentRecord.ux_maximgb_tg_expanded=false;PTC.jca.expandNode(parentRecord,grid.getStore())};
PTC.jca.tree.removeChildren=function(parentRecord,grid,children){if(!children)children=grid.getStore().getNodeChildren(parentRecord);grid.getView().collapseRow(parentRecord);for(var i=0;i<children.length;i++)grid.getStore().removeFromNode(parentRecord,children[i])};Ext.ux.maximgb.tg.GridView.prototype.onRemove=Ext.ux.maximgb.tg.GridView.prototype.onRemove.wrap(function(proceed,ds,record,index,isUpdate){this._allRenderableCache=undefined;proceed.call(this,ds,record,index,isUpdate)});
PTC.jca.TreeGrid.prototype.updateViewOnRadioSelect=function(table){if(table.jcaTableConfig.singleSelect){var v=table.getView();if(v)v.doPartialDataChange(true)}};
PTC.jca.TreeGrid.prototype.handleLoadingIndicator=function(store,record){var index=store.indexOfId(record.id);var row=store.jsca_table.getView().getRow(index);var fly=Ext.fly(row);if(!fly)return;var pmel=fly.child(".ux-maximgb-tg-elbow-active");var maskEle=fly.child(".treeNodeMask");if(maskEle)maskEle.hide();if(pmel){PTC.jca.TreeGrid.updateClass(pmel,store,record);var temp=pmel.child(".ext-el-mask");temp.removeClass("ext-el-mask");pmel.addClass("ux-maximgb-tg-elbow-active")}};
PTC.jca.TreeGrid.prototype._onUpdateIterator=function(oid,value,formResult,rowsToAdd,locations){var grid=this;if(oid&&typeof oid==="string"){var newOid=value[0];var rec=PTC.jca.table.Utils.getTableRowFromOid(grid,newOid,formResult.convertOidReference(oid,formResult));if(rec){var rowOid=rec.data.oid;if(rowOid.indexOf("OR:")!==newOid.indexOf("OR:")&&rowOid.indexOf("VR:")!==newOid.indexOf("VR:")){newOid=formResult.convertOidReference(newOid,formResult);if(!newOid)newOid=value[0]}rowsToAdd.push(newOid);
locations.push(oid)}}};PTC.jca.TreeGrid.prototype._handleUpdateObjects=function(formResult){var rows=[];var locations=[];PTC.util.propertyIterator(formResult.U,this,this._onUpdateIterator,[formResult,rows,locations]);if(rows.length>0){clearActionFormData();this._updateRows(rows,locations)}};
PTC.jca.TreeGrid.prototype._addRows=function(added_new_rows,locations){if(locations.size()>1)tableUtils.reload(this);else{var locationRef=PTC.jca.table.Utils.getTableRowFromOid(this,locations[0]);var location=locations[0];if(locationRef)location=locationRef.get("jsca_context");rowHandler.addRows(added_new_rows,this.id,null,{doAjaxUpdate:true,addSorted:true,parameters:"dynamicLocationContext="+location})}};
PTC.jca.TreeGrid.prototype._updateRows=function(added_new_rows,locations){if(locations.size()>1)tableUtils.reload(this);else rowHandler.updateRows(added_new_rows,this.id,{doAjaxUpdate:true,addSorted:true,parameters:"dynamicLocationContext="+locations[0]})};
PTC.jca.TreeGrid.prototype._handleAddObjects=function(formResult){var iteratorScope={oidsToAdd:[],locations:[]};PTC.util.propertyIterator(formResult.A,iteratorScope,function(property,value){this.oidsToAdd=this.oidsToAdd.concat(PTC.util.extractAllValues(value));this.locations.push(property)},[]);if(iteratorScope.oidsToAdd.length)this._addRows(iteratorScope.oidsToAdd,iteratorScope.locations)};PTC.external={};PTC.external.log=log4javascript.getLogger("PTC.external");PTC.external.externalParams=null;
PTC.external.msgObjects=null;PTC.external.getMessageObjects=function(){var objs=[];var msgObjects=PTC.external.msgObjects;if(msgObjects===null)return objs;var msgObjLength=msgObjects.length;for(var i=0;i<msgObjLength;i++){var oids=msgObjects[i];var objIds=oids.OidIdentity;var objLen=objIds.length;for(var j=0;j<objLen;j++){var oid=objIds[j].oid;PTC.external.log.debug("Adding oid from msgObjects : "+oid);objs.push(oid)}}return objs};
PTC.external.showInlineMessage=function(orig,msgObjects){var externalURL=PTC.external.getExternalURL();PTC.external.msgObjects=msgObjects;if(externalURL!==null){PTC.external.log.debug("Processing msgObjects for generating externalURL.");var msgObjLength=msgObjects.length;var objs=PTC.external.getMessageObjects();var options={asynchronous:false,method:"get",parameters:{oids:objs},onSuccess:PTC.external.handleSuccess};requestHandler.doRequest("ptc1/externalRequestCallBack",options)}orig(msgObjects)};
PTC.external.getRedirectOid=function(){var oid=null;var objOids=PTC.external.getMessageObjects();if(objOids.length===1){PTC.external.log.debug("Using oid from msgObjects for redirect : "+oid);oid=objOids[0]}if(oid===null){var params=location.search.parseQuery();if(typeof params.oid==="string")oid=params.oid;else oid=params.oid[0];PTC.external.log.debug("Using oid from url for redirect : "+oid)}return oid};PTC.external.handleSuccess=function(response){PTC.external.externalParams=response.responseJSON};
PTC.external.getExternalURL=function(){var externalURL=getElementByName("externalURL");var value=null;if(externalURL&&externalURL.value){value=externalURL.value;PTC.external.log.debug("External url : "+value)}return value};
PTC.external.handleWizWindow=function(){if(PTC.external.externalParams!==null){var params=Ext.urlEncode(PTC.external.externalParams);var externalUrl=Ext.urlAppend(PTC.external.getExternalURL(),params);PTC.external.log.debug("Redirecting to external url.");window.location=externalUrl}setTimeout(wfWindowClose1,1E3)};PTC.external.refreshOpenerOnly=function(){};
PTC.external.wfWindowClose=function(orig){orig();if(window.closed===false){PTC.external.log.debug("Unable to close window.");var oid=PTC.external.getRedirectOid();if(oid!==null){var url=PTC.infoPage.getURL(oid);PTC.external.log.debug("Redirecting to : "+url);window.location=url}}};
PTC.external.init=function(){var isExternalRequest=Ext.getDom("isExternalRequest");if(isExternalRequest&&isExternalRequest.value==="true"){PTC.external.log.debug("Initializing window for external request.");getPopupOpenerWindow=function(){return false};refreshOpenerOnly=PTC.external.refreshOpenerOnly;PTC.mainWindow=window;PTC.messaging.showInlineMessage=PTC.messaging.showInlineMessage.wrap(PTC.external.showInlineMessage);wfWindowClose1=wfWindowClose1.wrap(PTC.external.wfWindowClose);handleWizWindow=
PTC.external.handleWizWindow;refreshOpenerOnly=PTC.external.refreshOpenerOnly}};Ext.ns("PTC.fedInfraUI");securityLabelStepVisited=false;
PTC.fedInfraUI.contextMappingPickerCallback=function(objects,pickerID,attr,displayFieldId){PickerInputComponentCallback(objects,pickerID,attr,displayFieldId);PTC.fedInfraUI.saveUpdatedDataToTableStore(displayFieldId);PTC.fedInfraUI.trackModifications();var pickedContextJSON=objects.pickedObject;var pickedContextOID=pickedContextJSON[0].oid;var contextIconField=document.getElementById("mappedContextIcon"+pickerID);var url="netmarkets/jsp/fedInfraUI/fetchContextIcon.jsp";var options={asynchronous:false,
parameters:{pickedContextOID:pickedContextOID}};var transport=requestHandler.doRequest(url,options);contextIconField.src=transport.responseText;document.getElementsByName(displayFieldId)[0].setAttribute("ext:qtip",document.getElementsByName(displayFieldId)[0].value)};
PTC.fedInfraUI.mappingContainerPickerCallback=function(objects,pickerID,attr,displayFieldId){PickerInputComponentCallback(objects,pickerID,attr,displayFieldId);document.getElementsByName(displayFieldId)[0].setAttribute("ext:qtip",document.getElementsByName(displayFieldId)[0].value);var selectedContextOid=objects.pickedObject[0].oid;var newURL=window.location.href;var elementContextParam=decodeURIComponent(extractParamValue(newURL,"context"));var elementContextParamTokens=elementContextParam.split("$");
var contextOid=elementContextParamTokens[elementContextParamTokens.length-2];var newEleContextParam=elementContextParam.replace(contextOid,selectedContextOid);newEleContextParam=encodeURIComponent(newEleContextParam);newURL=PTC.util.replaceURLParamInThisWindow("context",newEleContextParam);var launchedContextParam=extractParamValue(newURL,"launchedContext");if(launchedContextParam.length===0)newURL=newURL+"&launchedContext="+encodeURIComponent(contextOid);PTC.navigation.loadContent(newURL)};
PTC.fedInfraUI.updateStepID=function(){document.getElementById("updatedStepID").value=getCurrentStep()};PTC.fedInfraUI.trackModifications=function(){document.getElementById("contentChanged").value="true";PTC.fedInfraUI.updateStepID()};
PTC.fedInfraUI.fetchLcTemplate=function(internalValue,containerPath){PTC.fedInfraUI.trackModifications();var sourceType=document.getElementById(internalValue+"sourceType").value;var comboBox=document.getElementById(internalValue+"mappedLcTemplate");if(sourceType===""){comboBox.options.length=0;return}var loadingOption=document.createElement("OPTION");loadingOption.text=bundleHandler.get("com.ptc.windchill.fedInfra.mapping.mappingManagerResource.LC_LOADING_TEXT");loadingOption.value=bundleHandler.get("com.ptc.windchill.fedInfra.mapping.mappingManagerResource.LC_LOADING_TEXT");
comboBox.options.add(loadingOption);Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/fedInfraUI/fetchLc.jsp",params:{contextName:containerPath,sourceType:sourceType},success:function(response,options){if(response.responseText.indexOf("INVALID_SOURCE_TYPE")!=-1){comboBox.options.length=0;PTC.fedInfraUI.fetchLcStates(internalValue,containerPath);JCAAlert("com.ptc.windchill.fedInfra.mapping.mappingManagerResource.INVALID_SOURCE_TYPE");return}var responseObject=Ext.util.JSON.decode(response.responseText);
comboBox.options.length=0;for(var key in responseObject)if(responseObject.hasOwnProperty(key)){var oOption=document.createElement("OPTION");oOption.text=oOption.dispVal=responseObject[key];oOption.value=oOption.intVal=key;comboBox.options.add(oOption)}PTC.fedInfraUI.fetchLcStates(internalValue,containerPath);PTC.fedInfraUI.saveUpdatedComboBoxToTableStore(internalValue+"mappedLcTemplate")},mode:"POST"})};function reloadPage(){var sURL=window.location.href;window.location.href=sURL}
PTC.fedInfraUI.fetchLcStates=function(internalValue,containerPath){PTC.fedInfraUI.trackModifications();var lcTemplateCombo=document.getElementById(internalValue+"mappedLcTemplate");var comboBox=document.getElementById(internalValue+"mappedLcState");var selIndex=lcTemplateCombo.selectedIndex;if(selIndex==-1){comboBox.options.length=0;return}var lcTemplate=lcTemplateCombo.options[selIndex].text;if(lcTemplate===""){comboBox.options.length=0;return}var loadingOption=document.createElement("OPTION");loadingOption.text=
bundleHandler.get("com.ptc.windchill.fedInfra.mapping.mappingManagerResource.LC_LOADING_TEXT");loadingOption.value=bundleHandler.get("com.ptc.windchill.fedInfra.mapping.mappingManagerResource.LC_LOADING_TEXT");comboBox.options.add(loadingOption);Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/fedInfraUI/fetchLc.jsp",params:{contextName:containerPath,lcTemplate:lcTemplate},success:function(response,options){var responseObject=Ext.util.JSON.decode(response.responseText);comboBox.options.length=
0;for(var key in responseObject)if(responseObject.hasOwnProperty(key)){var oOption=document.createElement("OPTION");oOption.text=oOption.dispVal=responseObject[key];oOption.value=oOption.intVal=key;comboBox.options.add(oOption)}PTC.fedInfraUI.saveUpdatedComboBoxToTableStore(internalValue+"mappedLcState")},mode:"POST"})};
PTC.fedInfraUI.owningOrgMappingPickerCallback=function(objects,pickerID,attr,displayFieldId){PickerInputComponentCallback(objects,pickerID,attr,displayFieldId);PTC.fedInfraUI.saveUpdatedDataToTableStore(displayFieldId);PTC.fedInfraUI.trackModifications();document.getElementsByName(displayFieldId)[0].setAttribute("ext:qtip",document.getElementsByName(displayFieldId)[0].value)};
PTC.fedInfraUI.lcTemplateMappingPickerCallback=function(objects,pickerID,attr,displayFieldId){PickerInputComponentCallback(objects,pickerID,attr,displayFieldId);PTC.fedInfraUI.trackModifications();document.getElementsByName(displayFieldId)[0].setAttribute("ext:qtip",document.getElementsByName(displayFieldId)[0].value)};
PTC.fedInfraUI.viewMappingPickerCallback=function(objects,pickerID,attr,displayFieldId){PickerInputComponentCallback(objects,pickerID,attr,displayFieldId);PTC.fedInfraUI.saveUpdatedDataToTableStore(displayFieldId);PTC.fedInfraUI.trackModifications();document.getElementsByName(displayFieldId)[0].setAttribute("ext:qtip",document.getElementsByName(displayFieldId)[0].value)};
PTC.fedInfraUI.checkForChangesInCurrentTab=function(stepID){var res=JCAConfirm("com.ptc.windchill.fedInfra.mapping.mappingManagerResource.DEFINE_MAPPING_UNSAVED_DATA_WARNING_MSG");if(res===false){var updatedStepID=document.getElementById("updatedStepID").value;setActiveStep(updatedStepID);return false}else{document.getElementById("contentChanged").value="";PTC.fedInfraUI.refreshStep();setActiveStep(stepID);return false}};
PTC.fedInfraUI.refreshStepAfterApply=function(){stopProgress();enableButtons();PTC.fedInfraUI.refreshStep()};PTC.fedInfraUI.refreshStep=function(){var tableId=PTC.fedInfraUI.getCurrentTableID();var addRows=document.getElementById("addRows_"+tableId);if(addRows)addRows.value="";var rmRows=document.getElementById("rmRows_"+tableId);if(rmRows)rmRows.value="";var initialRows=document.getElementById("initialRows_"+tableId);if(initialRows)initialRows.value="";refreshCurrentStep()};
PTC.fedInfraUI.onTabClick=function(stepID){if(PTC.fedInfraUI.hasTabContentChanged()=="true")PTC.fedInfraUI.checkForChangesInCurrentTab(stepID);else{PTC.fedInfraUI.refreshStep();setActiveStep(stepID)}};PTC.fedInfraUI.onContextTabClick=function(){PTC.fedInfraUI.onTabClick("fedInfraUI.contextStep")};PTC.fedInfraUI.onOwningOrgTabClick=function(){PTC.fedInfraUI.onTabClick("fedInfraUI.owningOrgStep")};PTC.fedInfraUI.onViewTabClick=function(){PTC.fedInfraUI.onTabClick("fedInfraUI.viewStep")};
PTC.fedInfraUI.onFolderTabClick=function(){PTC.fedInfraUI.onTabClick("fedInfraUI.folderStep")};PTC.fedInfraUI.onLifecycleTabClick=function(){PTC.fedInfraUI.onTabClick("fedInfraUI.lifeCycleStep")};PTC.fedInfraUI.onSecurityLabelTabClick=function(){securityLabelStepVisited=true;PTC.fedInfraUI.onTabClick("fedInfraUI.securityLabelMappingStep")};PTC.fedInfraUI.resetDirtyFlag=function(){document.getElementById("contentChanged").value=""};
PTC.fedInfraUI.getCurrentTableID=function(){var currStepID=getCurrentStep();if(currStepID==="fedInfraUI.contextStep")return"netmarkets.fedInfra.mappingFederationContextMapping";if(currStepID==="fedInfraUI.owningOrgStep")return"netmarkets.fedInfra.mappingFederationOwningOrgMapping";if(currStepID==="fedInfraUI.viewStep")return"netmarkets.fedInfra.mappingFederationViewMapping";if(currStepID==="fedInfraUI.folderStep")return"netmarkets.fedInfra.mappingFederationFolderMapping";if(currStepID==="fedInfraUI.lifeCycleStep")return"netmarkets.fedInfra.mappingFederationLifecycleMapping";
if(currStepID==="fedInfraUI.securityLabelMappingStep")return"netmarkets.fedInfra.mappingFederationSecurityLabelMapping"};PTC.fedInfraUI.trackAndRemoveMappings=function(event){var table_id=PTC.fedInfraUI.getCurrentTableID();var noOfRowsSelected=getJCASelectedTableItems(table_id).length;if(noOfRowsSelected!==0)PTC.fedInfraUI.trackModifications();rowHandler.removeRowsFromParentTable(event)};
PTC.fedInfraUI.setCurrentTab=function(){document.getElementById("isApply").setValue(isApply);var stepId=getCurrentStep();document.getElementById("currentStep").setValue(stepId)};PTC.fedInfraUI.attachOnClickEventToMpCtnPicker=function(){var pickerFindBtn=document.getElementById("mappingContainerPicker_FIND_BTN");if(pickerFindBtn!==null)pickerFindBtn.onclick=pickerFindBtn.onclick.wrap(function(proceed,event){if(PTC.fedInfraUI.confirmMappingContextChange(pickerFindBtn)===true)proceed(event)})};
PTC.fedInfraUI.confirmMappingContextChange=function(pickerFindBtn){if(PTC.fedInfraUI.hasTabContentChanged()!="true")return true;var changePickerVal=JCAConfirm("com.ptc.windchill.fedInfra.mapping.mappingManagerResource.DEFINE_MAPPING_UNSAVED_DATA_WARNING_MSG");return changePickerVal};
PTC.fedInfraUI.defineMappingSelection=function(event){var sels=PTC.jca.table.Utils.getSelectedItmesByEvent(event);if(sels.length===0){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");Event.stop(event);return false}if(sels){var alength=sels.length;if(alength!=1){JCAAlert("com.ptc.windchill.fedInfra.mapping.mappingManagerResource.MM_TABLE_MULTI_SELECTED_ALERT");return false}}return true};PTC.fedInfraUI.hasTabContentChanged=function(){return document.getElementById("contentChanged").value};
PTC.fedInfraUI.addMapping=function(count){var params={doAjaxUpdate:true,preventDuplicates:true,addDone:false};var oidList=new Array;for(i=0;i<count;i++){var d=new Date;oidList.push("newRowID"+d.getTime);rowHandler.addRows(oidList,PTC.fedInfraUI.getCurrentTableID(),null,params)}};
PTC.fedInfraUI.saveUpdatedDataToTableStore=function(displayFieldId){var updateDisplayField=document.getElementsByName(displayFieldId)[0];PTC.wizard.saveTableData.domChangeEventListener.call(tableUtils.getTable(PTC.fedInfraUI.getCurrentTableID()),"",$(updateDisplayField))};
PTC.fedInfraUI.saveUpdatedComboBoxToTableStore=function(comboBoxId){var lcTemplateCombo=document.getElementById(comboBoxId);var table=tableUtils.getTable(PTC.fedInfraUI.getCurrentTableID());var view=table.getView();var colIndex=view.findCellIndex(lcTemplateCombo);var rowIndex=view.findRowIndex(lcTemplateCombo);if(colIndex>=0&&rowIndex>=0){var record=table.getStore().getAt(rowIndex);if(record!==undefined){var cell=record.get(table.getColumnModel().config[colIndex].id);if(cell!==undefined&&cell.gui!==
undefined){cell.gui.options=lcTemplateCombo.options;cell.gui.value=lcTemplateCombo.value;PTC.fedInfraUI.doRendering(table,record,rowIndex,colIndex,table.getColumnModel().config,table.getColumnModel(),table.getStore())}}}};PTC.fedInfraUI.doRendering=function(table,rec,rowIndex,colIndex,columnConfigs,cols,store){var col;var p={};var cb=[];col=columnConfigs[colIndex];p.id=col.id;p.attr=p.cellAttr="";col.renderer.call(col.scope,rec.get(columnConfigs[colIndex].id),p,rec,rowIndex,colIndex,store)};
FindInTableMode={DISABLED:"DISABLED",CLIENT_ONLY:"CLIENT_ONLY",CLIENT_AND_SERVER:"CLIENT_AND_SERVER"};
PTC.jca.table.findInTable=function(tableId){var searchInListTextBox=new PTC.jca.table.SearchField({id:PTC.jca.table.findInTable.getSearchInListTextBoxName(tableId),tableId:tableId});var searchStatusText=PTC.jca.table.findInTable.getFindStatusText();var searchIndicator=new Ext.Toolbar.TextItem({id:tableId+".searchInListLoadingWheel",width:30,height:20,xtype:"tbtext"});var searchStatusLabel=new Ext.form.Label({id:tableId+".searchStatusLabel",autoWidth:true,defaultAlign:"tl-bl",cls:"x-tip-header-text",
style:{marginRight:"5px"}});searchStatusLabel.setText=searchStatusLabel.setText.wrap(function(p,t){var result=p.call(this,t);var table=tableUtils.getTable(tableId);if(table){var tb=table.getToolbar();if(tb){var tableWidth=tb.getWidth();var toolbarContentWidth=tb.getEl().first().getWidth();if(toolbarContentWidth>tableWidth)tb.syncSize()}}return result});return[searchIndicator,searchStatusLabel,searchInListTextBox]};
PTC.jca.table.findInTable.showCount=function(table){if(table.searchInListStatusText===undefined)return;if(typeof table.getStore().isLoading==="function"&&table.getStore().isLoading()){table.searchInListStatusText.setText(bundleHandler.get("com.ptc.core.ui.tableRB.SEARCH_IN_PROGRESS"),false);table.getStore().on("datasourcecomplete",PTC.jca.table.findInTable.showCount.createCallback(table),table,{single:true})}else{var count=table.getStore().getCount();if(count>0)if(table.getStore().resultLimitHit===
true)table.searchInListStatusText.setText(bundleHandler.getBundleStringAndInserts("com.ptc.core.ui.tableRB.SEARCH_MATCHES_PAGE_LIMIT_MESSAGE",[count]),false);else{var matchesCountMessage;if(count==1)matchesCountMessage=bundleHandler.getBundleStringAndInserts("com.ptc.core.ui.tableRB.SEARCH_ONE_MATCH_MESSAGE",[count]);else matchesCountMessage=bundleHandler.getBundleStringAndInserts("com.ptc.core.ui.tableRB.SEARCH_MATCHES_MESSAGE",[count]);table.searchInListStatusText.setText(matchesCountMessage,false)}else table.searchInListStatusText.setText(bundleHandler.get("com.ptc.core.ui.tableRB.SEARCH_NO_MATCHES_MESSAGE"),
false);if("wt.fc.Persistable.defaultSearchView"!==table.id){var isPopup=(PTC.lightbox.isLightbox(window)||isWizardWindow())&&!PTC.automation.isAutomationTest();if(!isPopup)PTC.jca.table.setObjectToSession(table.id,"searchInListTextBox",table.searchInListTextBox.getValue())}}};
PTC.jca.table.findInTable.afterSearch=function(table){PTC.jca.table.scroll.updateTableSize(table.store.jscaTableID);table.searchInListLoadingWheel.hide();if(table.searchInString===undefined||table.searchInString===""){table.fireEvent("clearSearchInList",table);return}if(table.isSelectedOnlyItemsFilter){table.isSelectedOnlyItemsFilter=false;return}PTC.jca.table.findInTable.showCount(table)};
PTC.jca.table.findInTable.getFindStatusText=function(){var findStatusText=Ext.getCmp("findStatusText");if(findStatusText===undefined)findStatusText=new PTC.jca.table.FindStatus;return findStatusText};PTC.jca.table.findInTable.isTableFilteredOnClient=function(table){return table&&!PTC.jca.table.findInTable.isTableFilteredOnServer(table)&&table.searchInString&&table.searchInString!==""};
PTC.jca.table.findInTable.isTableFilteredOnServer=function(table){if(table&&PTC.isDefined(table.getStore())&&PTC.isDefined(table.getStore().baseParams))return table.getStore().baseParams.findInTableSearchTerm!==undefined;else return false};PTC.jca.table.findInTable.isTableFiltered=function(table){return PTC.jca.table.findInTable.isTableFilteredOnServer(table)||PTC.jca.table.findInTable.isTableFilteredOnClient(table)};
PTC.jca.table.findInTable.sendSearchRequest=function(table,searchTerm){if(!responseProcessor.containsHandler(PTC.jca.table.findInTable.postTableRefreshHandler))responseProcessor.addHandler(PTC.jca.table.findInTable.postTableRefreshHandler);var store=table.getStore();var params=Ext.lib.Ajax.serializeForm(getMainForm(table.getEl().dom))+"&refreshTable="+table.jcaTableConfig.tableID;store.baseParams.findInTableSearchTerm=[searchTerm];store.baseParams.fitVisibleCols=PTC.jca.table.findInTable.getColumnsToSearch(table);
var url=PTC.jca.table.Utils.getTableUrl(table.jcaTableConfig.tableID);url=PTC.jca.table.findInTable.resetOffsetToZero(url);var divID="table__"+table.jcaTableConfig.tableID+"_TABLE";getElementHtml(params,divID,true,url)};
PTC.jca.table.findInTable.getColumnsToSearch=function(table){var visibleColumns=PTC.jca.table.Utils.getTableVisibleColumnsServerIds(table);var columnsToSearch;if(visibleColumns)columnsToSearch=visibleColumns.split(",");var hiddenColumnsToSearch=table.findInTableHiddenColumns;if(hiddenColumnsToSearch)columnsToSearch=columnsToSearch.concat(hiddenColumnsToSearch);return columnsToSearch.join(",")};
PTC.jca.table.findInTable.getSavedSelectedOidList=function(tableId){var selectedOnlyItem=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId)+".selectedOnlyViewItem");if(!selectedOnlyItem)return null;var savedSelectedOidList=PTC.jca.table.getObjectFromSession(tableId,selectedOnlyItem.id);if(typeof savedSelectedOidList!=="object"||savedSelectedOidList.size()===0)return null;return savedSelectedOidList};
PTC.jca.table.findInTable.postTableRefreshHandler=function(){var responseDiv=this.responseDiv;var responseID=responseDiv.id;var tableId=getTableIDFromResponse(this.responseText);if(!tableId)return;tableId=tableUtils.getUnformattedTableId(tableId);var table=Ext.getCmp(tableId);var store=table.getStore();table.searchInListTextBox=Ext.getCmp(PTC.jca.table.findInTable.getSearchInListTextBoxName(tableId));table.searchInListStatusText=Ext.getCmp(tableId+".searchStatusLabel");table.searchInListTextBox.focus();
if(Ext.isArray(store.baseParams.findInTableSearchTerm)&&store.baseParams.findInTableSearchTerm.length===1){var searchTerm=store.baseParams.findInTableSearchTerm[0];table.searchInListTextBox.setValue(searchTerm);if(searchTerm!==""){table.searchInListTextBox.clearTrigger.show();setTimeout(function(){PTC.jca.table.findInTable.showCount(table)},600)}}};
PTC.jca.table.findInTable.resetOffsetToZero=function(url){var urlParams=url.toQueryParams();if(urlParams.offset&&urlParams.offset!==0){urlParams.offset=0;return Ext.urlAppend(url.substring(0,url.indexOf("?")),Ext.urlEncode(urlParams))}return url};PTC.jca.table.findInTable.clearSearchInList=function(table){if(PTC.jca.table.findInTable.isTableFilteredOnServer(table))PTC.jca.table.findInTable.clearSearchInListServerSide(table);else table.fireEvent("clearSearchInList",table)};
PTC.jca.table.findInTable.clearSearchInListServerSide=function(table){if(!PTC.jca.table.findInTable.clearSelectionConfirmation(table,"com.ptc.netmarkets.util.misc.miscResource.CLEAR_SELECTION_CONFIRM_ON_CLOSE"))return;var store=table.getStore();delete store.baseParams.findInTableSearchTerm;delete store.baseParams.fitVisibleCols;PTC.jca.table.stickiness.clearSearchInListText(table.id);if(table.searchInListStatusText!==undefined)table.searchInListStatusText.setText("");responseProcessor.removeHandler(PTC.jca.table.findInTable.postTableRefreshHandler);
var params=Ext.lib.Ajax.serializeForm(getMainForm(table.getEl().dom))+"&refreshTable="+table.jcaTableConfig.tableID;var url=PTC.jca.table.Utils.getTableUrl(table.jcaTableConfig.tableID);url=PTC.jca.table.findInTable.resetOffsetToZero(url);var divID="table__"+table.jcaTableConfig.tableID+"_TABLE";getElementHtml(params,divID,true,url)};
PTC.jca.table.findInTable.findUniqueKey=function(tableId,elementName){var table=tableUtils.getTable(tableId),uniqueKey=tableId;if(table&&!table.store.baseParams.oid){var urlOid=getOidFromURL(window.top.location.href);if(urlOid.length>0)uniqueKey=uniqueKey+"_"+urlOid;else uniqueKey=uniqueKey+"_"+top.window.location.href.split("&u8=")[0]}else if(table)uniqueKey=uniqueKey+"_"+table.store.baseParams.oid[0].split("~")[0];return uniqueKey+"_"+elementName};
PTC.jca.table.findInTable.dataLoadComplete=function(rowStore){var table=PTC.jca.table.Utils.getTable(rowStore.jscaTableID);var isTableFilteredOnServer=PTC.jca.table.findInTable.isTableFilteredOnServer(table);if(table.jcaTableConfig.chunk&&rowStore.load_complete&&(rowStore.resultLimitHit||isTableFilteredOnServer)||!table.jcaTableConfig.chunk&&rowStore.DATA_RENDERED){if(isTableFilteredOnServer){PTC.jca.table.applyFilterFromSelectedOnlyItemsCache(rowStore);return true}var searchTerm=PTC.jca.table.getObjectFromSession(rowStore.jscaTableID,
"searchInListTextBox");var searchField=Ext.getCmp(PTC.jca.table.findInTable.getSearchInListTextBoxName(rowStore.jscaTableID));if(searchField.cachedSearchTerm===searchField.getValue()||!(searchTerm===null||searchTerm.length===0))if(!PTC.jca.table.findInTable.fireSearchEvent(rowStore))PTC.jca.table.applyFilterFromSelectedOnlyItemsCache(rowStore);else if(!rowStore.resultLimitHit&&!isTableFilteredOnServer){var selectedOnlyItem=Ext.getCmp(PTC.jca.table.getWTablePanelID(rowStore.jscaTableID)+".selectedOnlyViewItem");
if(selectedOnlyItem){var savedSelectedOidList=PTC.jca.table.getObjectFromSession(rowStore.jscaTableID,selectedOnlyItem.id);if(typeof savedSelectedOidList==="object")table.isSelectedOnlyItemsFilter=true}PTC.jca.table.applyFilterFromSelectedOnlyItemsCache(rowStore);searchField.clearTrigger.show()}if(table.jcaTableConfig.chunk)Event.stopObserving(table.store,"datasourcecomplete",PTC.jca.table.findInTable.dataLoadComplete);else Event.stopObserving(table.store,"load",PTC.jca.table.findInTable.dataLoadComplete)}};
PTC.jca.table.createViewSelectedOnlyItemsCacheValue=function(table){var selections=table.getSelectionModel().selections.items;var selectedOnlyItems=[];var dataLength=selections.length;for(var i=0;i<dataLength;i++)selectedOnlyItems.push(selections[i].data.oid);return selectedOnlyItems};
PTC.jca.table.applyFilterFromSelectedOnlyItemsCache=function(rowStore){var table=PTC.jca.table.Utils.getTable(rowStore.jscaTableID);var tableId=table.jcaTableConfig.tableID;var selectedOnlyItem=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId)+".selectedOnlyViewItem");if(!selectedOnlyItem)return false;var savedSelectedOidList=PTC.jca.table.getObjectFromSession(tableId,selectedOnlyItem.id);if(typeof savedSelectedOidList!=="object")return false;PTC.jca.table.setSelectRowStatus(table,savedSelectedOidList,
true);selectedOnlyItem.checked=true;selectedOnlyItem.fireEvent("applySelectOnlyView",selectedOnlyItem,true)};
PTC.jca.table.setSelectRowStatus=function(table,savedSelectedOidList,selectStatus){var savedSelectedOidListSize=savedSelectedOidList.size();var items=table.store.data.items;var rowStoreDataLength=items.length;var m=table.wtableRef.gridPanel.selModel;var tempSavedSelectedOid=null;for(var i=0;i<savedSelectedOidListSize;i++){tempSavedSelectedOid=savedSelectedOidList[i];for(var j=0;j<rowStoreDataLength;j++)if(tempSavedSelectedOid===items[j].data.oid){m.selectRow(j,selectStatus,false);break}}};
PTC.jca.table.findInTable.fireSearchEvent=function(rowStore){var savedSearchTerm=PTC.jca.table.getObjectFromSession(rowStore.jscaTableID,"searchInListTextBox");if(savedSearchTerm.length>0){var table=PTC.jca.table.Utils.getTable(rowStore.jscaTableID);PTC.jca.table.findInTable.filter(table,savedSearchTerm);return true}else return false};
PTC.jca.table.findInTable.clearSelectionConfirmation=function(table,rbInfoEntry){var selModel=table.getSelectionModel();if(selModel.hasSelection()&&PTC.jca.table.Utils.isAllDataLoaded(table)===false)if(JCAConfirm(rbInfoEntry)){selModel.clearSelections();tableUtils.clearSelectAllCheckbox(table);var viewSelectedOnly=Ext.getCmp(table.id+"_WTablePanel.selectedOnlyViewItem");if(viewSelectedOnly)viewSelectedOnly.setChecked(false)}else return false;return true};
PTC.jca.table.findInTable.clearViewSelectedConfirmation=function(table,rbInfoEntry){if(table.selectedOnlyChecked)if(JCAConfirm(rbInfoEntry)){var viewSelectedOnly=Ext.getCmp(table.id+"_WTablePanel.selectedOnlyViewItem");if(viewSelectedOnly){viewSelectedOnly.setChecked(false);viewSelectedOnly.fireEvent("applySelectOnlyView",viewSelectedOnly,false)}}else return false;return true};
PTC.jca.table.FindStatus=Ext.extend(Ext.Tip,{constructor:function(){if(this.id===undefined)this.id="findStatusText";PTC.jca.table.FindStatus.superclass.constructor.call(this)},initComponent:function(){this.defaultAlign="tl-bl";this.closable=true;this.hidden=true;this.autoWidth=true;this.style={position:"fixed"};this.hideDelay=1E4;this.hideTimer=null;PTC.jca.table.FindStatus.superclass.initComponent.call(this)},showBy:function(el,position){PTC.jca.table.FindStatus.superclass.showBy.call(this,el);this.getEl().shadow.hide();
if(this.hideTimer)clearTimeout(this.hideTimer);this.hideTimer=this.hide.defer(this.hideDelay,this)},showMessage:function(table,text){this.setTitle(text);this.showBy(table.searchInListTextBox.getEl())}});
PTC.jca.table.SearchField=Ext.extend(Ext.form.TwinTriggerField,{trigger1Class:"x-form-clear-trigger",trigger2Class:"x-form-search-trigger",hideTrigger1:true,enableKeyEvents:true,cachedSearchTerm:"",listeners:{keypress:function(field,e){var key=0+e.getKey();if(key==e.ENTER){e.preventDefault();field.onTrigger2Click()}},render:function(){this.table=Ext.getCmp(this.tableId);this.clearTrigger=this.getTrigger(0);this.searchTrigger=this.getTrigger(1);this.emptyText=bundleHandler.getBundleStringAndInserts("com.ptc.core.ui.tableRB.SEARCH_IN_TABLE");
PTC.jca.table.findInTable.setSearchFieldFromSession(this);try{this.addTriggerTooltips()}catch(e){PTC.jca.table.log.info("Tooltips could not be added to the search in list triggers.")}if(isWizardWindow())this.table.on("afterlayout",function(table){if(!Ext.isEmpty(table.el)&&!Ext.isEmpty(table.el.dom)&&!Ext.isEmpty(table.el.dom.style)&&typeof table.el.dom.style.display!="undefined"&&table.el.dom.style.display!="none"){var moreToolbar=Ext.fly(table.id+".moreToolbar");if(moreToolbar&&moreToolbar.hasClass("x-hide-display")){moreToolbar.removeClass("x-hide-display");
this.resetWidth(120);moreToolbar.addClass("x-hide-display")}else this.resetWidth(120)}},this)},beforedestroy:function(){this.table=undefined;Ext.destroy(this.searchTrigger,this.clearTrigger)}},resetWidth:function(pix){this.setWidth(0);this.setWidth(pix)},addTriggerTooltips:function(){var clearTriggerDom=this.clearTrigger.dom;Ext.QuickTips.register({target:clearTriggerDom,text:bundleHandler.get("com.ptc.core.ui.tableRB.CLEAR_SEARCH_IN_TABLE")});var searchTriggerDom=this.searchTrigger.dom;Ext.QuickTips.register({target:searchTriggerDom,
text:bundleHandler.get("com.ptc.core.ui.tableRB.SEARCH_IN_TABLE")})},onTrigger1Click:function(){this.clearTrigger.hide();PTC.jca.table.findInTable.clearSearchInList(this.table);PTC.jca.table.clearObjectFromSession(this.tableId.split(".searchInListTextBox")[0],"searchInListTextBox")},onTrigger2Click:function(){var searchTerm=this.getValue();if(searchTerm===""){this.clearTrigger.hide();PTC.jca.table.clearObjectFromSession(this.tableId.split(".searchInListTextBox")[0],"searchInListTextBox")}else this.clearTrigger.show();
PTC.jca.table.findInTable.filter(this.table,searchTerm)}});
PTC.jca.table.findInTable.setSearchFieldFromSession=function(searchField){var tableId=searchField.tableId.split(".searchInListTextBox")[0];var savedSearchTerm=PTC.jca.table.getObjectFromSession(tableId,"searchInListTextBox");var doViewSelectedObjectsOnly=false;var selectedOnlyItem=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId)+".selectedOnlyViewItem");if(selectedOnlyItem){var savedSelectedOidList=PTC.jca.table.getObjectFromSession(tableId,selectedOnlyItem.id);if(typeof savedSelectedOidList===
"object")doViewSelectedObjectsOnly=true}if(savedSearchTerm.length>0||doViewSelectedObjectsOnly){searchField.setValue(savedSearchTerm);searchField.cachedSearchTerm=savedSearchTerm}PTC.jca.table.findInTable.setDataLoadCompleteEvent(tableId)};
PTC.jca.table.findInTable.setDataLoadCompleteEvent=function(tableId){var table=PTC.jca.table.Utils.getTable(tableId);var dataloadComplete=new PTC.jca.table.findInTable.dataLoadComplete(table.store);if(table.jcaTableConfig.chunk)table.store.on("datasourcecomplete",PTC.jca.table.findInTable.dataLoadComplete);else table.store.on("load",PTC.jca.table.findInTable.dataLoadComplete);table.store.on("add",PTC.jca.table.findInTable.changeMatchCnt)};
PTC.jca.table.findInTable.changeMatchCnt=function(){var table=tableUtils.getTable(this.jscaTableID);PTC.jca.table.findInTable.showCount(table)};
PTC.jca.table.findInTable.filter=function(table,searchTerm){if(table.searchInListStatusText!==undefined)table.searchInListStatusText.setText("");if(searchTerm!==null&&searchTerm!==""){if(!PTC.jca.table.findInTable.clearSelectionConfirmation(table,"com.ptc.netmarkets.util.misc.miscResource.CLEAR_SELECTION_CONFIRM_ON_SEARCH"))return;if(!PTC.jca.table.findInTable.clearViewSelectedConfirmation(table,"com.ptc.netmarkets.util.misc.miscResource.CLEAR_VIEW_SELECTED_CONFIRM_ON_FILTER"))return;if(PTC.jca.table.findInTable.isTableFilteredOnClient(table))table.store.clearFilter(true);
PTC.jca.table.stickiness.setSearchInListText(table.id,searchTerm);if(table.jcaTableConfig&&table.jcaTableConfig.findInTableMode===FindInTableMode.CLIENT_AND_SERVER&&(PTC.jca.table.findInTable.isTableFilteredOnServer(table)||!PTC.jca.table.Utils.isAllDataLoaded(table)))PTC.jca.table.findInTable.sendSearchRequest(table,searchTerm);else{table.searchInString=PTC.jca.table.fit.getSafeSearchTerm(searchTerm);table.fireEvent("applySearchInList",table)}}else if(PTC.jca.table.findInTable.isTableFilteredOnClient(table))table.fireEvent("clearSearchInList",
table,false,true);else if(PTC.jca.table.findInTable.isTableFilteredOnServer(table)){if(!PTC.jca.table.findInTable.clearSelectionConfirmation(table,"com.ptc.netmarkets.util.misc.miscResource.CLEAR_SELECTION_CONFIRM_ON_SEARCH"))return;PTC.jca.table.stickiness.setSearchInListText(table.id,"");PTC.jca.table.findInTable.sendSearchRequest(table,"")}};
PTC.jca.table.findInTable.clearSearchInListHandler=function(table,supressEvent,suppressEmptyText){table.searchInString="";var selectedOnlyIsOn=table.selectedOnlyChecked;if(selectedOnlyIsOn){var selectedOnlyItem=Ext.getCmp(PTC.jca.table.getWTablePanelID(table.id)+".selectedOnlyViewItem");table.store.clearFilter(true);selectedOnlyItem.fireEvent("applySelectOnlyView",selectedOnlyItem,true)}else{table.store.clearFilter(supressEvent);PTC.jca.table.findInTable.makeRowHidden(table.store);PTC.jca.table.findInTable.applySelectionSnapshot(table);
PTC.jca.table.handleSelectAllCheckbox(table.selModel)}if(table.searchInListStatusText!==undefined)table.searchInListStatusText.setText("");var searchField=Ext.getCmp(PTC.jca.table.findInTable.getSearchInListTextBoxName(table.store.jscaTableID));if(suppressEmptyText!==true)searchField.setValue(searchField.emptyText);if(!selectedOnlyIsOn&&!supressEvent)PTC.jca.table.scroll.updateTableSize(table.store.jscaTableID);PTC.jca.table.stickiness.clearSearchInListText(table.id)};
PTC.jca.table.findInTable.makeRowHidden=function(tableStore){if(tableStore.data)tableStore.filterBy(function(record,id){if(record.get("rowHidden")===true)return false;return true})};
PTC.jca.table.findInTable.applySearchInListHandler=function(table){var tableId=table.id;if(table.searchInListLoadingWheel===undefined)table.searchInListLoadingWheel=new Ext.LoadMask(Ext.getCmp(tableId+".searchInListLoadingWheel").getEl(),{msg:"",msgCls:"findInTableMask"});if(table.searchInListStatusText===undefined)table.searchInListStatusText=Ext.getCmp(tableId+".searchStatusLabel");if(table.searchInListTextBox===undefined)table.searchInListTextBox=Ext.getCmp(PTC.jca.table.findInTable.getSearchInListTextBoxName(tableId));
if(!table.isSelectedOnlyItemsFilter)table.searchInListStatusText.setText(bundleHandler.get("com.ptc.core.ui.tableRB.SEARCH_IN_PROGRESS"),false);table.searchInListLoadingWheel.show();var extraMaskDiv=getElementsByClassNameAndTag("ext-el-mask",table.searchInListLoadingWheel.el.dom,"div")[0];if(extraMaskDiv)Ext.removeNode(extraMaskDiv);var maskWheelDiv=getElementsByClassNameAndTag("titleBarMask",table.searchInListLoadingWheel.el.dom,"div")[0];if(maskWheelDiv){var maskMsgDiv=maskWheelDiv.childElements()[0];
if(maskMsgDiv)maskMsgDiv.className="titleBarkMaskMsg"}table.visibleColumns=PTC.jca.ColumnUtils.getVisibleColumns(table.getColumnModel());var dataLoading=typeof table.store.isLoading==="function"&&table.store.isLoading();if(table.store.searchInListFilterByFunc===undefined)table.store.searchInListFilterByFunc=function(record,recordId){if(table.selectedOnlyChecked===true)if(table.selModel.isIdSelected(recordId)===false)return false;var filterSearchText=table.searchInString;var visibleColumns=table.visibleColumns;
var totalVisibleCols=visibleColumns.length;var displayString=null;for(var i=0;i<totalVisibleCols;i++)if(record&&record.get("rowHidden")!==true){displayString=jsca.columns.getJSCASearchText(table,visibleColumns[i],record);if(filterSearchText.test(displayString))return true}var hiddenColumnsToSearch=table.findInTableHiddenColumns;if(hiddenColumnsToSearch){var totalHiddenColumnsToSearch=hiddenColumnsToSearch.length;for(var j=0;j<totalHiddenColumnsToSearch;j++)if(record&&record.get("rowHidden")!==true){displayString=
record.get(hiddenColumnsToSearch[j]);if(filterSearchText.test(displayString))return true}}return false};PTC.jca.table.findInTable.takeSelectionSnapshot(table);var eventsSuspendedAlready=table.store.eventsSuspended;table.store.suspendEvents();try{table.store.filterBy(table.store.searchInListFilterByFunc,table.store);if(!dataLoading)PTC.jca.table.findInTable.afterSearch(table)}finally{if(!eventsSuspendedAlready)table.store.resumeEvents()}PTC.jca.table.findInTable.applySelectionSnapshot(table);table.store.fireEvent("datachanged",
table.store)};PTC.jca.table.findInTable.takeSelectionSnapshot=function(table){if(table.selModel.snapshot)table.selModel.snapshot.addAll(table.selModel.selections.items);else table.selModel.snapshot=table.selModel.selections.clone()};
PTC.jca.table.findInTable.applySelectionSnapshot=function(table){if(table.selModel.snapshot){var len=table.selModel.snapshot.getCount();if(len>0){var eventsSuspendedAlready=table.selModel.eventsSuspended;table.selModel.suspendEvents();try{for(var r=len-1;r>=0;r--){var record=table.selModel.snapshot.itemAt(r);var ridx=table.store.indexOf(record);if(ridx>=0){table.selModel.selectRow(ridx,true,null,record,true);table.selModel.snapshot.remove(record)}}}finally{if(!eventsSuspendedAlready)table.selModel.resumeEvents()}}if(table.selModel.snapshot.getCount()===
0)delete table.selModel.snapshot;PTC.jca.table.handleSelectAllCheckbox(table.selModel)}};PTC.jca.table.findInTable.getSearchInListTextBoxName=function(tableName){return tableName+".searchInListTextBox"};PTC.jca.table.fit={};PTC.jca.table.installFindInTreeFeature=function(table){PTC.jca.table.fit._setDefaultState(table);PTC.jca.table.fit._installFitGuiComponents(table)};
PTC.jca.table.fit.showRow=function(rowRecord){var table=Ext.getCmp(rowRecord.store.jscaTableID);table.getView().focusRowCenter(rowRecord,0);tableUtils.focusRow(table,table.getStore().indexOf(rowRecord),true)};
PTC.jca.table.fit.clientOnlySearch=function(table,searchTerm){var store=table.getStore();if(table.fitSafeSearchTermRegEx===null)table.fitSafeSearchTermRegEx=PTC.jca.table.fit.getSafeSearchTerm(searchTerm);var rowRecords=PTC.jca.table.fit.getRowsToSearch(table);var row;for(var i=0;i<rowRecords.length;i++){row=rowRecords[i];if(PTC.jca.table.fit.hasMatchingText(table,row,table.fitSafeSearchTermRegEx)){PTC.jca.table.fit.imitateSearchRequestCallback(table,row,searchTerm);return}}PTC.jca.table.fit.imitateSearchRequestCallback(table,
null,searchTerm)};PTC.jca.table.fit.getSafeSearchTerm=function(searchTerm){searchTerm=searchTerm.trim();var charsToEscapeRegExp=/([\.\+\?\[\^\]\$\(\)\{\}\=\!\:\|\\])/g;var safeSearchTerm=searchTerm.replace(charsToEscapeRegExp,"\\$1");safeSearchTerm=safeSearchTerm.replace(/\*/g,".*");return new RegExp(safeSearchTerm,"i")};
PTC.jca.table.fit.getRowsToSearch=function(table){var store=table.getStore();var indexStartSearchFrom;var focusedRow=PTC.jca.table.Utils.getFocusedRowIndex(table);if(typeof focusedRow==="undefined"||focusedRow<0)indexStartSearchFrom=table.fitIsForwardSearch?0:store.getCount()-1;else indexStartSearchFrom=table.fitIsForwardSearch?focusedRow+1:focusedRow-1;var rowRecords;if(table.fitIsForwardSearch)if(indexStartSearchFrom===0||indexStartSearchFrom===store.getCount())rowRecords=store.getRange();else rowRecords=
store.getRange(indexStartSearchFrom).concat(store.getRange(0,indexStartSearchFrom-1));else if(indexStartSearchFrom===-1||indexStartSearchFrom===store.getCount()-1){rowRecords=store.getRange();rowRecords.reverse()}else{var firstPart=store.getRange(0,indexStartSearchFrom);firstPart.reverse();var secondPart=store.getRange(indexStartSearchFrom+1);secondPart.reverse();rowRecords=firstPart.concat(secondPart)}return rowRecords};
PTC.jca.table.fit.hasMatchingText=function(table,row,searchTermRegEx){var colModel=table.getColumnModel();for(var i=0;i<colModel.getColumnCount();i++){var column=colModel.getColumnAt(i);if(PTC.jca.ColumnUtils.isVisibleDataColumn(column)){var text=jsca.columns.getJSCASearchText(table,column,row);if(text.match(searchTermRegEx))return true}}return false};
PTC.jca.table.fit.imitateSearchRequestCallback=function(table,row,searchTerm){var options={};options.parameters={};options.scope=table.getStore();options.parameters.fitSearchTerm=searchTerm;var pathInfo=PTC.jca.table.fit.getPathInTree(table.id,row);PTC.jca.table.fit.searchRequestCallback(options,pathInfo.oidsInPath,pathInfo.contextsInPath)};
PTC.jca.table.fit.getPathInTree=function(tableId,row){var contextsInPath=[];var oidsInPath=[];var index=0;while(row){oidsInPath[index]=row.get("oid");contextsInPath[index++]=PTC.jca.table.Utils.getRowUniqueIdentifier(row.get("jsca_context"));row=tableUtils.getTableRowFromContext(tableId,row.get("_parent"))}return{oidsInPath:oidsInPath,contextsInPath:contextsInPath}};
PTC.jca.table.fit.didEventExpandParent=function(store,eventData){if(store.fitOidsInMatchPathIndex>=store.fitOidsInMatchPath.length-1)return true;if(!eventData)return false;var parentContext=store.fitContextsInMatchPath[store.fitOidsInMatchPathIndex+1];var data;if(eventData.chunk&&Ext.isArray(eventData.chunk.data))data=eventData.chunk.data;else if(eventData.data&&eventData.data.jsca_context&&store.getNodeChildren(store.getById(eventData.data.jsca_context)).length>0)data=[eventData.data];else return false;
var dataLength=data.length;for(var i=0;i<dataLength;i++)if(PTC.jca.table.Utils.getRowUniqueIdentifier(data[i].jsca_context)===parentContext)return true;return false};
PTC.jca.table.fit.expandNodeCallback=function(store,eventData,parentExpanded){var table=Ext.getCmp(store.jscaTableID);if(store.fitOidsInMatchPathIndex>=0&&store.fitOidsInMatchPathIndex<store.fitOidsInMatchPath.length){var context=store.fitContextsInMatchPath[store.fitOidsInMatchPathIndex];var rowRecord=PTC.jca.table.Utils.getRecordByUniqueIdentifier(store,context);if(!rowRecord&&(parentExpanded===true||PTC.jca.table.fit.didEventExpandParent(store,eventData))){rowRecord=PTC.jca.table.fit.addRowToTree(store,
context);if(rowRecord&&PTC.jca.table.Utils.getRowUniqueIdentifier(rowRecord.id)===store.fitContextsInMatchPath[0]&&store.fitOidsInMatchHasChildren){rowRecord.data._is_leaf=false;table.getView().refresh()}}if(!rowRecord)return;if(store.fitOidsInMatchPathIndex!==0){store.fitOidsInMatchPathIndex--;if(store.isExpandedNode(rowRecord)||store.isLeafNode(rowRecord))PTC.jca.table.fit.expandNodeCallback(store,null,true);else PTC.jca.expandNode(rowRecord,store)}else{PTC.jca.table.fit.showRow(rowRecord);store.un("expandnode",
PTC.jca.table.fit.expandNodeCallback);if(store.chunkEnabled)store.un("datachanged",PTC.jca.table.fit.expandNodeCallback);PTC.jca.enableAutoExpand(table);PTC.jca.table.fit.focusTextField(table);table.fitDone=true}}};
PTC.jca.table.fit.addRowToTree=function(store,context){var params={doAjaxUpdate:true,addSorted:true};if(store.fitOidsInMatchPathIndex<store.fitOidsInMatchPath.length-1)params.parentOid=store.fitOidsInMatchPath[store.fitOidsInMatchPathIndex+1];var oidToAdd=store.fitOidsInMatchPath[store.fitOidsInMatchPathIndex];rowHandler.addRows([oidToAdd],store.jscaTableID,null,params);return PTC.jca.table.Utils.getRecordByUniqueIdentifier(store,context)};
PTC.jca.table.fit.searchRequestCallback=function(origOptions,oidsInMatchPath,contextsInMatchPath,fitOidsInMatchHasChildren){var origSearchTerm=origOptions.parameters.fitSearchTerm;var store=origOptions.scope;var table=Ext.getCmp(store.jscaTableID);if(oidsInMatchPath&&oidsInMatchPath.length>0){store.fitOidsInMatchPath=oidsInMatchPath;store.fitOidsInMatchPathIndex=oidsInMatchPath.length-1;store.fitOidsInMatchHasChildren=fitOidsInMatchHasChildren;table.fitPrevSearchTerm=origSearchTerm;store.fitContextsInMatchPath=
contextsInMatchPath;store.on("expandnode",PTC.jca.table.fit.expandNodeCallback);if(store.chunkEnabled)store.on("datachanged",PTC.jca.table.fit.expandNodeCallback);PTC.jca.table.fit.expandNodeCallback(store);PTC.jca.table.fit.clearSearchStatus(table)}else{table.fitSearchStatusBoxWaitMask.hide();PTC.jca.enableAutoExpand(table);table.fitSearchStatus.setTitle(bundleHandler.getBundleStringAndInserts("com.ptc.netmarkets.util.utilResource.FIT_NO_MATCH",[origSearchTerm.escapeHTML()]));table.fitSearchStatus.showBy(table.fitTextField.getEl());
PTC.jca.table.fit.focusTextField(table);table.fitDone=true}};PTC.jca.table.fit.focusTextField=function(table){var textField=Ext.getCmp(table.id+".fitTextField");textField.focus(true,true)};
PTC.jca.table.fit.performSearch=function(table){table.fitDone=false;if(table.getStore().getCount()<=0)return;table.fitSearchStatusBoxWaitMask.show();table.fitSearchStatus.setTitle(bundleHandler.get("com.ptc.core.ui.tableRB.SEARCH_IN_PROGRESS"));table.fitSearchStatus.showBy(table.fitTextField.getEl());var extraMaskDiv=getElementsByClassNameAndTag("ext-el-mask",table.fitSearchStatusBoxWaitMask.el.dom,"div")[0];if(extraMaskDiv)Ext.removeNode(extraMaskDiv);var maskWheelDiv=getElementsByClassNameAndTag("findInTreeMask",
table.fitSearchStatusBoxWaitMask.el.dom,"div")[0];if(maskWheelDiv){var maskMsgDiv=maskWheelDiv.firstChild;if(maskMsgDiv)maskMsgDiv.className="titleBarkMaskMsg"}if(table.jcaTableConfig.findInTableMode===FindInTableMode.CLIENT_ONLY||PTC.jca.table.Utils.isAllDataLoaded(table))PTC.jca.table.fit.clientOnlySearch(table,table.searchTerm);else PTC.jca.table.fit.sendSearchRequest(table,table.searchTerm)};
PTC.jca.table.fit.sendSearchRequest=function(table,searchTerm,fitParams){if(!fitParams)fitParams={};fitParams.fitSearchTerm=searchTerm;fitParams.fitSearchDirection=table.fitIsForwardSearch?"forward":"backward";fitParams.acquire="row";var focusedRecord=PTC.jca.table.Utils.getFocusedRecord(table);if(focusedRecord){var focuedRowContext=focusedRecord.get("jsca_context");if(focusedRecord.get("oid").indexOf("$")>0){focuedRowContext=PTC.jca.table.Utils.parseRowIdentifierWithDoller(focuedRowContext);focuedRowContext=
focuedRowContext.substring(0,focuedRowContext.length-2);fitParams.fitStartSearchOid=focusedRecord.get("oid")}fitParams.fitStartLocation=focuedRowContext}var columnsAndSort=PTC.jca.table.Utils.getTableColumnServerParameters(table);Ext.apply(fitParams,columnsAndSort);var url=PTC.jca.table.Utils.getTableUrl(table.id);var options={scope:table.getStore(),parameters:fitParams};options.onSuccess=PTC.jca.table.fit.onSuccess;options.onException=PTC.jca.table.fit.onException;requestHandler.doRequest(url,options)};
PTC.jca.table.fit.onSuccess=function(transport){var origOptions=transport.request.options;var begin=transport.responseText.indexOf(FIT_SEARCH_RESULTS_BEGIN);if(begin>=0){var end=transport.responseText.indexOf(FIT_SEARCH_RESULTS_END);var jsonResponse=transport.responseText.slice(begin+FIT_SEARCH_RESULTS_BEGIN.length,end);var fitResponse=Ext.decode(jsonResponse);var contextsInMatchPath=fitResponse.fitContextsInMatchPath;PTC.jca.table.fit.searchRequestCallback(origOptions,fitResponse.fitOidsInMatchPath,
contextsInMatchPath,fitResponse.fitOidsInMatchHasChildren)}else PTC.jca.table.fit.searchRequestCallback(origOptions)};PTC.jca.table.fit.onException=function(transport){var origOptions=transport.options;PTC.jca.table.fit.searchRequestCallback(origOptions)};
PTC.jca.table.fit.getSearchTerm=function(table){var fitTextFieldTag=table.fitTextField.getEl();var searchTerm=fitTextFieldTag.dom.value;var newLineIndex=searchTerm.indexOf("\n");if(newLineIndex>=0)searchTerm=searchTerm.substr(0,newLineIndex);searchTerm=searchTerm.substr(0,100);if(searchTerm!=table.fitPrevSearchTerm)table.fitSafeSearchTermRegEx=null;return searchTerm};PTC.jca.table.fit.clearSearchStatus=function(table){table.fitSearchStatus.hide();table.fitSearchStatus.setTitle("");table.fitSearchStatusBoxWaitMask.hide()};
PTC.jca.table.fit.buttonCB=null;PTC.jca.table.fit._setDefaultState=function(table){FIT_SEARCH_RESULTS_BEGIN="$$$FIT_SEARCH_RESULTS_BEGIN$$$";FIT_SEARCH_RESULTS_END="$$$FIT_SEARCH_RESULTS_END$$$";table.fitSafeSearchTermRegEx=null;table.fitIsForwardSearch=true};
PTC.jca.table.fit._installFitGuiComponents=function(table){var fit_EmptySearchText=bundleHandler.get("com.ptc.netmarkets.util.utilResource.FIT_FIND_IN_PROMPT");PTC.jca.table.fit.buttonCB=function(button,event){var searchTerm=PTC.jca.table.fit.getSearchTerm(button.table);PTC.jca.table.fit.clearSearchStatus(table);if(searchTerm!==""&&searchTerm!==fit_EmptySearchText){button.table.fitIsForwardSearch=button===button.table.fitSearchDownButton;PTC.jca.disableAutoExpand(table);table.searchTerm=searchTerm;
if(button.table.fireEvent("beforePerformSearch",button.table))PTC.jca.table.fit.performSearch(button.table)}};var fitSearchStatusText=PTC.jca.table.findInTable.getFindStatusText();var fitTextFieldWidth=Math.max(Math.min(table.container.getWidth()-90,200),80);if(table.container.getWidth()===0)fitTextFieldWidth=200;var fitTextField=new Ext.form.TextField({width:fitTextFieldWidth,emptyText:getUnescapedText(fit_EmptySearchText),value:"",selectOnFocus:true,id:table.getId()+".fitTextField",tableName:table.getId(),
table:table,enableKeyEvents:true,cls:"invalidDrag",listeners:{specialkey:function(textField,e){var keyValue=0+e.getKey();if(keyValue==e.ESC){textField.reset();PTC.jca.table.fit.clearSearchStatus(textField.table)}},keypress:function(textField,e){PTC.jca.table.fit.clearSearchStatus(textField.table);var keyValue=0+e.getKey();if(keyValue==e.ENTER){e.preventDefault();PTC.jca.table.fit.buttonCB(textField.table.fitSearchDownButton,e)}}}});var fitUpButton=new Ext.Button({icon:"netmarkets/images/upArrow.gif",
tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.FIT_SEARCH_PREV_TOOLTIP"),handler:PTC.jca.table.fit.buttonCB,id:table.getId()+".fitSearchUpButton",table:table});var fitDownButton=new Ext.Button({icon:"netmarkets/images/downArrow.gif",tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.FIT_SEARCH_NEXT_TOOLTIP"),handler:PTC.jca.table.fit.buttonCB,id:table.getId()+".fitSearchDownButton",table:table});var fitSearchStatusElementToMask=new Ext.Toolbar.TextItem({text:"",width:30,
height:20});var fitComponents=[fitSearchStatusElementToMask,fitTextField,fitDownButton,fitUpButton];var fitInstalled=false;if(table.actionsToolBar){var toolBarItemsLen=table.actionsToolBar.items.getCount();for(var i=0;i<toolBarItemsLen;i++)if(table.actionsToolBar.getComponent(i).isFill){PTC.jca.table.fit.insertIntoToolbar(table,fitComponents,i);fitInstalled=true;break}}if(!fitInstalled)table.findInTreeToolBar=new Ext.Toolbar({id:table.getId()+".findInTreeToolBar",renderTo:table.tbar,cls:"ecaToolbar",
items:["->"].concat(fitComponents)});table.fitSearchDownButton=fitDownButton;table.fitSearchUpButton=fitUpButton;table.fitTextField=fitTextField;table.fitSearchStatus=fitSearchStatusText;table.fitSearchStatusBoxWaitMask=new Ext.LoadMask(fitSearchStatusElementToMask.getEl(),{msg:"",msgCls:"findInTreeMask"})};
PTC.jca.table.fit.insertIntoToolbar=function(table,fitComponents,index){var fitComponentLen=fitComponents.length;for(var compIndex=fitComponentLen-1;compIndex>-1;compIndex--)table.actionsToolBar.insert(index+1,fitComponents[compIndex]);table.actionsToolBar.doLayout()};
Ext.grid.GridView.prototype.focusRowCenterCorrectForMultiRowHeight=function(recordIndex){this.doUpdate();if(this.variableRowHeight===true){var y=Ext.get(this.getRow(recordIndex)).getOffsetsTo(this.innerHd)[1];if(y>this.scroller.dom.clientHeight||y<0)this.ensureVisible(recordIndex,0,false)}};
Ext.grid.GridView.prototype.focusRowCenter=function(record,offset){PTC.performance.startComponentActionTimer("row focus",this.grid.id);if(!(this.scroller===undefined||this.scroller===null)&&this.scroller.dom.clientHeight===this.scroller.dom.scrollHeight)return;var store=this.ds;var recordIndex=store.indexOf(record);if(recordIndex>-1){var visiableRowCount=this.getVisibleRowCount();var displacement=Math.floor(visiableRowCount/2);var offsetFromCenter;if(typeof offset==="number")offsetFromCenter=Math.floor(displacement*
offset);else offsetFromCenter=0;var renderableIndexes;if(typeof this.getAllRenderableRows==="function")renderableIndexes=this.getAllRenderableRows();else{renderableIndexes=[];var storeCount=store.getTotalCount();for(var i=0;i<storeCount;i++)renderableIndexes.push(i)}if(this.variableRowHeight===true||renderableIndexes.length>this.scroller.dom.clientHeight/this.getCalculatedRowHeight()){if(store.jsca_table.vtip)store.jsca_table.vtip.verticalScrollTip.disable();var visiableRows=this.getVisibleRows();
var visibleIndexes;if(visiableRows.indexes===null||visiableRows.indexes===undefined)visibleIndexes=renderableIndexes.slice(visiableRows.first,visiableRows.last);else visibleIndexes=this.getVisibleRows().indexes;var middleOfVisibleRows=visibleIndexes[Math.ceil((visiableRowCount-1)/2)-1];var recordIndexInRenderedRows=renderableIndexes.indexOf(recordIndex);if(middleOfVisibleRows===undefined)this.focusRowCenterCorrectForMultiRowHeight(recordIndex);else if(recordIndex<middleOfVisibleRows){var testAbove=
renderableIndexes[recordIndexInRenderedRows-displacement+offsetFromCenter+1];if(testAbove!==undefined&&testAbove!==null&&testAbove>0){this.ensureVisible(testAbove,0,false);this.focusRowCenterCorrectForMultiRowHeight(recordIndex)}else if(this.variableRowHeight===true)this.focusRowCenterCorrectForMultiRowHeight(recordIndex);else this.scrollToTop()}else if(recordIndex>middleOfVisibleRows){var testBelow=renderableIndexes[recordIndexInRenderedRows+displacement+offsetFromCenter];var renderedBottomRow=renderableIndexes[renderableIndexes.length-
1];if(testBelow!==undefined&&testBelow!==null&&testBelow>0)this.ensureVisible(testBelow,0,false);else this.ensureVisible(renderedBottomRow,0,false);this.focusRowCenterCorrectForMultiRowHeight(recordIndex)}else this.focusRowCenterCorrectForMultiRowHeight(recordIndex);if(store.jsca_table.vtip)setTimeout(function(){store.jsca_table.vtip.verticalScrollTip.enable()},20)}}PTC.performance.stopComponentTimer(this.grid.id,null,"rowFocus")};Ext.namespace("PTC.search");Ext.apply(PTC.search,new Ext.util.Observable);
PTC.search.addEvents("searchFired");
PTC.search.createNewItem=function(pickedObject){var optionDisplayVal=pickedObject["containerInfo.name"];var optionInternalVal=pickedObject["oid"];var imageStr=pickedObject["typeIcon"];if(optionInternalVal.startsWith("OR:")||optionInternalVal.startsWith("VR:"))optionInternalVal=optionInternalVal.substring(3);var newItem=null;newItem={boxLabel:'<div class="removableCheckBoxLabel"><img src="'+imageStr+'" /> '+optionDisplayVal+"</div>",name:""+optionInternalVal,id:""+optionInternalVal,checked:false,disabled:false,
qtip:""+optionDisplayVal,listeners:{check:PTC.search.changeListener},onRemoveFunction:PTC.search.RemoveContextCheckbox,label:optionDisplayVal};return newItem};
PTC.search.globalSearch=function(){var optionsMenu;var lblSearch;var toolTipEditHistory;var isSearchValidationEnabled=true;var menuInitialized=false;var twinField;var enableEmptySearch=false;var loadMenu=new Ext.menu.Menu({id:"loadMenu",floating:true,autoWidth:true});function optionsMenuHandler(targetMenuItem,e){var url=targetMenuItem.getItemId();if(url.indexOf("OID:")>-1){var evt=window.event||e;if(!evt.target)evt.target=evt.srcElement;if(evt.target.tagName=="A"||evt.target.tagName=="IMG")return;
else{url=buildExecuteUrl(url.substr(4),true);loadAdvSearchPage("event",url);return}}if(url=="ptc1/search/historySavedSearchDisplay"){loadSearchPage("object_search_navigation","historySavedNavigation",e);optionsMenu.hide()}else if(url=="wtcore/jsp/com/ptc/windchill/search/Search.jsp"){loadAdvSearchPage(e,url);optionsMenu.hide()}else PTC.navigation.loadContent(url)}function displayLinks(response,options){var responseJSON=Ext.util.JSON.decode(response.responseText);var addSeperator=false;for(var key in responseJSON)if(responseJSON.hasOwnProperty(key)){if(responseJSON[key].link.indexOf("OID:")==
-1)optionsMenu.addSeparator();var menuText=responseJSON[key].text;var url=responseJSON[key].link;if(url.indexOf("OID:")>-1)menuText=getMenuText(url.substr(4),menuText,responseJSON[key].toolTip);var menuItem=new Ext.menu.Item({text:menuText,itemId:url,icon:"",tooltip:responseJSON[key].toolTip,handler:optionsMenuHandler});optionsMenu.addItem(menuItem)}}function getMenuText(oid,displayText,toolTip){var executeUrl=buildExecuteUrl(oid,true);var editUrl=buildExecuteUrl(oid,false);var display="<table ><tr><td >";
display+='<div id="'+oid+'" class="x-menu-list-item" style="width:225px;overflow:hidden;text-overflow:ellipsis;"><a ext:qtip="'+toolTip+'"  " href=javascript:loadAdvSearchPage(null,"'+executeUrl+'"); >'+displayText+"</a></div>";display+='</td><td align="right">';display+='<a href=javascript:loadAdvSearchPage(null,"'+editUrl+'"); >'+'<img ext:qtip="'+toolTipEditHistory+'" height="15" width="15" BORDER=1 src="netmarkets/jsp/search/edit_pencil.gif"/></a>';display+="</td></tr></table>";return display}
function buildExecuteUrl(oid,fireSearch){return"netmarkets/jsp/search/search.jsp?fireSearch="+fireSearch+"&selectedHistoryItem="+oid}function loadSearch(obj,event){var typeMenuInitialized=PTC.search.globalTypeSelection.isTypeMenuInitialized();if(!typeMenuInitialized){PTC.search.globalTypeSelection.refreshTypeShowMenu(false);loadSearch.defer(100,this,[obj,event]);return}var addedTypes=PTC.search.getAddedTypes();var selectedTypes=PTC.search.getSelectedTypes();var typeParams="preSelectionItems="+addedTypes+
"&searchType="+selectedTypes;var trigMenu=PTC.search.globalTypeSelection.getTypeTriggerMenu();var typeStore=PTC.search.globalTypeSelection.getTypeMenuStore();var allItems=trigMenu.items;for(var i=0,len=allItems.length;i<len;){var mItem=allItems.get(i);var typeInternalName=mItem.getItemId();var storeRecordIndex=typeStore.find("internalValue",typeInternalName);if(storeRecordIndex>=0){var storeRecord=typeStore.getAt(storeRecordIndex);storeRecord.set("checked",mItem.checked)}i=i+1}var validationResult=
PTC.search.validateSpecialTypes(PTC.search.globalTypeSelection.getTypeMenuStore());if(validationResult==false)return;var multiTypeSelected=selectedTypes.indexOf(",")>-1||selectedTypes.indexOf("wt.fc.Persistable")>-1;var bCheckCriteria=multiTypeSelected==true||!enableEmptySearch;if(isSearchValidationEnabled)if(bCheckCriteria)if(checkCriteria(obj.getValue())){JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.EMPTY_CRITERAI_MESSAGE");return}var url;PTC.search.fireEvent("searchFired",
obj);if(obj.getValue()==""&&bCheckCriteria)url="wtcore/jsp/com/ptc/windchill/search/Search.jsp?globalSearchTextBox=true&"+typeParams;else{var searchString=encodeURIComponent(obj.getValue());url="wtcore/jsp/com/ptc/windchill/search/Search.jsp?globalSearchTextBox=true&currentPage=search&fireSearch=true&search_keyword="+searchString+"&keywordkeywordField_SearchTextBox="+searchString+"&"+encodeURI(typeParams);obj.reset();obj.blur();obj.triggerBlur.defer(50,obj)}loadAdvSearchPage(event,url,obj)}return{getOptionMenu:function(){return optionsMenu},
refreshHistoryRecords:function(){optionsMenu.removeAll(true);var globalLinksUrl="netmarkets/jsp/search/getGlobalLinks.jsp";Ext.Ajax.request({url:getBaseHref()+globalLinksUrl,success:displayLinks});optionsMenu.hide()},fireSearchUsingGlobalTextBox:function(keyword){var event="";PTC.search.globalSearch.getGlobalSearchTextBox().setValue(keyword);loadSearch(PTC.search.globalSearch.getGlobalSearchTextBox(),null)},getGlobalSearchTextBox:function(){return twinField},switchMenu:function(){loadMenu.hide();
optionsMenu.show(twinField.el)},init:function(){lblSearch=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.SEARCH_LABEL");var loadingText=bundleHandler.get("com.ptc.core.ui.navigationRB.LOADING");var loadingItems=new Ext.menu.Item({id:"loading_menu",icon:"netmarkets/javascript/ext/resources/images/default/grid/loading.gif",text:'<div style ="width:125px;">'+loadingText+"</div>"});loadMenu.add(loadingItems);toolTipEditHistory=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.EDIT_CRITERIA_LINK");
isSearchValidationEnabled=PTC.search.isSearchValidationEnabled;enableEmptySearch=PTC.search.enableEmptySearch;optionsMenu=new Ext.menu.Menu({id:"searchHistoryOptionsMenu",floating:true,cls:"x-menu-no-icon",showSeparator:false});twinField=new Ext.form.TwinTriggerField({renderTo:"globalSearch",id:"gloabalSearchField",autoWidth:true,trigger1Class:"global-search-trigger",trigger2Class:"global-arrow-trigger",emptyText:PTC.util.unescapeHTML(lblSearch)+" . . .",scope:this,enableKeyEvents:true,listeners:{keypress:function(GlobalSearch,
e){PTC.wizard.limitCharsOnKeyPress("gloabalSearchField",0,1E3,e);if(e.getKey()==e.ENTER)loadSearch(this,e)}},onTrigger1Click:function(event){loadSearch(this,event)},onTrigger2Click:function(){if(!menuInitialized){loadMenu.show(twinField.el);menuInitialized=true;PTC.search.globalSearch.refreshHistoryRecords();PTC.search.globalSearch.switchMenu.defer(500,this)}else optionsMenu.show(twinField.el)}});Ext.ComponentMgr.register(twinField)}}}();
PTC.search.getAddedTypes=function(){var addedType="";var menuStore=PTC.search.globalTypeSelection.getTypeMenuStore();menuStore.each(function(item){if(addedType!="")addedType=addedType+",";addedType=addedType+item.get("internalValue")});return addedType};
PTC.search.getSelectedTypes=function(){var selectedType="";var trigMenu=PTC.search.globalTypeSelection.getTypeTriggerMenu();var allItems=trigMenu.items;for(var i=0,len=allItems.length;i<len;){var mItem=allItems.get(i);if(mItem.checked){if(selectedType!="")selectedType=selectedType+",";selectedType=selectedType+mItem.getItemId()}i=i+1}if(selectedType=="")selectedType="wt.fc.Persistable";return selectedType};
PTC.search.globalTypeSelection=function(){var maxTypeDisplayCharLimit=24;var lblChooseType;var lblAllType;var trigMenu;var menuStore;var triggerField;var globalTypeUrl="netmarkets/jsp/search/getGlobalTypes.jsp";var triggerRenderDiv="typeChooserTrigger";var fieldWidth=155;var typeSelection="";var typeMenuInitialized=false;function onTypeCheck(item){var enable=false;if(isItemPersistable(item)){if(item.checked)enable=true;manageState(enable)}else handlingNormalTypes(item);updateTriggerField.defer(20,
this,[item])}function handlingNormalTypes(item){var allItems=trigMenu.items;if(item!=null)if(isItemPersistable(item)==false&&item.checked==false)changeAllTypesState(false)}function manageState(enable){if(enable)enableAllMenuItems();else disableAllMenuItems()}function disableAllMenuItems(){var allItems=trigMenu.items;for(var i=0,len=allItems.length;i<len;){var mItem=allItems.get(i);if(isItemPersistable(mItem)==false&&mItem.getXType()=="menucheckitem"){mItem.setChecked(false,false);changeAllTypesState(true)}i=
i+1}}function enableAllMenuItems(){var allItems=trigMenu.items;for(var i=0,len=allItems.length;i<len;){var mItem=allItems.get(i);if(isItemPersistable(mItem)==false&&mItem.getXType()=="menucheckitem")mItem.setDisabled(false);i=i+1}}function isItemPersistable(mItem){var result=false;if(mItem==null)return result;if(mItem.getItemId()=="wt.fc.Persistable")result=true;return result}function onTriggerFocus(obj){PTC.search.globalTypeSelection.refreshTypeShowMenu(true)}function changeAllTypesState(value){var allItems=
trigMenu.items;var allType=allItems.get("wt.fc.Persistable");allType.setChecked(value);allType.setDisabled(value)}function updateTriggerField(item){var allItems=trigMenu.items;var displayString="";var selectedTypes=PTC.search.getSelectedTypes();if(selectedTypes=="wt.fc.Persistable"){changeAllTypesState(true);displayString=PTC.util.unescapeHTML(allItems.get("wt.fc.Persistable").text)}else for(var i=0,len=allItems.length;i<len;){var mItem=allItems.get(i);if(mItem.checked)if(displayString.length>0)displayString=
displayString+", "+PTC.util.unescapeHTML(mItem.text);else displayString=PTC.util.unescapeHTML(mItem.text);i=i+1}var ellipsedDisplay=Ext.util.Format.ellipsis(displayString,maxTypeDisplayCharLimit,false);triggerField.setValue(ellipsedDisplay);Ext.QuickTips.register({target:triggerField,text:displayString});if(item!=null)updatePreferenceAtServer()}function updatePreferenceAtServer(){var addedTypes=PTC.search.getAddedTypes();var selectedTypes=PTC.search.getSelectedTypes();Ext.Ajax.request({url:getBaseHref()+
"netmarkets/jsp/search/updateTypePref.jsp",success:onTypeUpdatePref(),params:{preSelectionItems:addedTypes,searchType:selectedTypes}})}function onTypeUpdatePref(response,options){}function typeStoreLoaded(){populateMenu();onTypeCheck(null)}function populateMenu(){trigMenu.removeAll();var persistableItem=null;menuStore.each(function(item){if(item.get("internalValue")=="wt.fc.Persistable")persistableItem=item;else{var menuItem=new Ext.menu.CheckItem({text:'<div style="overflow:hidden;text-overflow:ellipsis;">'+
item.get("displayValue")+"</div>",handler:onTypeCheck,hideOnClick:false,checked:item.get("checked"),itemId:""+item.get("internalValue")});trigMenu.addItem(menuItem);Ext.QuickTips.register({target:menuItem,text:menuItem.text})}});if(persistableItem!=null){trigMenu.addSeparator();var persistableMenuItem=new Ext.menu.CheckItem({text:'<div style="overflow:hidden;text-overflow:ellipsis;">'+persistableItem.get("displayValue")+"</div>",handler:onTypeCheck,checked:persistableItem.get("checked"),hideOnClick:false,
itemId:""+persistableItem.get("internalValue")});trigMenu.addItem(persistableMenuItem);Ext.QuickTips.register({target:persistableMenuItem,text:persistableMenuItem.text});if(persistableItem.get("checked")==true)manageState(false)}trigMenu.addEvents("globalSearchMenuLoaded");PTC.menu.fireEvent("globalSearchMenuLoaded",trigMenu)}return{init:function(){lblAllType=bundleHandler.getBundleStringAndInserts("com.ptc.windchill.enterprise.search.client.searchClientResource.ALL_TYPE_LABEL");lblChooseType=bundleHandler.getBundleStringAndInserts("com.ptc.windchill.enterprise.search.client.searchClientResource.CHOOSE_TYPE_LABEL");
if(menuStore){menuStore.destroy();trigMenu.removeAll();trigMenu.destroy()}menuStore=new Ext.data.JsonStore({autoDestroy:true,autoLoad:false,url:globalTypeUrl,storeId:"typeStore",idProperty:"internalValue",fields:["internalValue","imagePath","displayValue",{name:"checked",type:"boolean"},"parentType",{name:"allowMultiSelection",type:"boolean"},{name:"attributePanel",type:"boolean"},"callback",{name:"enabled",type:"boolean"},"enableIcon","disableIcon","toolTip"]});menuStore.on("load",typeStoreLoaded,
this);trigMenu=new Ext.menu.Menu({id:"trigMenu",floating:true,minWidth:fieldWidth,width:fieldWidth});triggerField=new Ext.form.TriggerField({renderTo:triggerRenderDiv,blankText:lblChooseType,emptyText:lblChooseType,width:fieldWidth+16,scope:this,editable:false,triggerClass:"global-arrow-trigger",onTriggerClick:function(){PTC.search.globalTypeSelection.refreshTypeShowMenu(true)}});triggerField.on("focus",onTriggerFocus,this);menuStore.load();typeMenuInitialized=true},loadGlobalTypes:function(){menuStore.load()},
getTypeMenuStore:function(){return menuStore},getTypeTriggerMenu:function(){return trigMenu},refreshTypeShowMenu:function(expand){typeMenuInitialized=true;PTC.search.globalTypeSelection.loadGlobalTypes();if(expand==true)trigMenu.show(triggerField.el)},isTypeMenuInitialized:function(){return typeMenuInitialized}}}();
PTC.search.validateSpecialTypes=function(typeStore){var parent;var specialTypeFlag=false;var childFlag=false;var normalType=false;var typeSelected="";var filteredRecords=typeStore.query("checked","true");if(filteredRecords.item("wt.fc.Persistable"))if(filteredRecords.item("wt.fc.Persistable").get("checked")==true)return true;if(filteredRecords.getCount()>1)for(var j=0;j<filteredRecords.getCount();j++)if(filteredRecords.items[j].get("allowMultiSelection")==false)if(specialTypeFlag==false){parent=filteredRecords.items[j].get("parentType");
typeSelected=PTC.search.decodeForHTMLContent(filteredRecords.items[j].get("displayValue"));specialTypeFlag=true}else if(specialTypeFlag==true&&filteredRecords.items[j].get("parentType")!=parent)typeSelected=typeSelected+", "+PTC.search.decodeForHTMLContent(filteredRecords.items[j].get("displayValue"));else{if(specialTypeFlag==true&&filteredRecords.items[j].get("parentType")==parent){typeSelected=typeSelected+", "+PTC.search.decodeForHTMLContent(filteredRecords.items[j].get("displayValue"));childFlag=
true}}else{if(filteredRecords.items[j].get("checked")==true&&filteredRecords.items[j].get("allowMultiSelection")==true)normalType=true}else if(filteredRecords.getCount()<=1)return true;if(specialTypeFlag==true&&childFlag==true&&normalType==false||specialTypeFlag==false&&normalType==true)return true;else{var insertsArr=new Array(typeSelected);JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.INDIVIDUAL_SEARCH_TYPE","",insertsArr);return false}};
PTC.search.cacheManager=function(){return{init:function(){Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/search/updateInfoBeanCache.jsp"})}}}();
PTC.navigation.on("afterHeaderRender",function(){var renderSearch=PTC.search.renderSearch;var renderClassification=PTC.search.renderClassification;if(renderSearch){PTC.search.globalSearch.init();PTC.search.globalTypeSelection.init()}else if(!renderSearch&&renderClassification)var menuButton=new Ext.Button({id:"classificationButton",renderTo:"globalSearch",text:"ClassificationSearch",align:"right",style:"margin:10px 0px 0px 100px",handler:function(){window.location=getBaseHref()+"app/#ptc1/websearch/start"}})});
PTC.search.HiddenContextPicker=new Object;PTC.search.HiddenContextPicker.pickerId="containerTypeList";PTC.search.HiddenContextPicker.setStatus=function(allContextStatus,contextType,selectedContexts){var pickerId=this.pickerId;if(allContextStatus==true){$(pickerId+"$label$").value=contextType;$(pickerId).value=$(pickerId+"$label$").value}else{$(pickerId+"$label$").value="FIND_CONTEXT";$(pickerId).value=selectedContexts;disableMemberOfCheckBoxes();PTC.search.updateMemberShipMessage()}};
PTC.search.HiddenContextPicker.setStatusFromUserSelection=function(){var allContextStatus=Ext.getCmp("all_contexts").checked;var contextType=PTC.search.ContexPickerData.allContextsSelectedName;var selectedContexts="";for(var i=0;i<PTC.search.recentlyUsedContexts.getCount();i++){var item=Ext.getCmp(PTC.search.recentlyUsedContexts.itemAt(i).id);if(item.getValue()==true&&item.id!="all_contexts"){if(selectedContexts!="")selectedContexts=selectedContexts+",";PTC.search.ContexPickerData.allContextsCheckedStatus=
0;selectedContexts=selectedContexts+item.id}}PTC.search.HiddenContextPicker.setStatus(allContextStatus,contextType,selectedContexts);if(selectedContexts!="")PTC.search.callContextChangeListenerOnServer(selectedContexts,true);else PTC.search.callUpdateAllContextOnServer("updateallContextsSelectedItem",contextType+"##"+(allContextStatus?1:0))};Ext.namespace("PTC.homepage");PTC.homepage.HOME_PAGE_ID="homePageTableContainermainInfoPagePanel";
PTC.homepage.createHomePage=function(homepageConfig){var main_form;var title=bundleHandler.get("com.ptc.core.ui.navigationRB.WIN_TITLE_HOME_TAB_WINDCHILL_HOME");title=getUnescapedText(title);PTC.navigation.setPageTitle(title);var cardPanel=Ext.getCmp(PTC.navigation.cardManager);if(!homepageConfig){cardPanel.doLayout();return}main_form=PTC.util.getForm("homepageDivID");if(main_form){PTC.util.removeChildScriptNodes(main_form);var childNodes=main_form.childNodes;var savedChildNodes=[];for(var i=0;i<
childNodes.length;i++)if(childNodes[i].nodeName==="INPUT")savedChildNodes.push(childNodes[i].cloneNode(true))}var cmp=Ext.getCmp(PTC.homepage.HOME_PAGE_ID);if(cmp)PTC.homepage.destroyHomePage.call(cmp);var panel=homepageConfig.items.length>1?PTC.homepage.createAdminHomePage(homepageConfig):PTC.homepage.createNonAdminHomePage(homepageConfig);var homeMainPanel=PTC.infoPage.getMainPanel({id:"homePageTableContainer"},[panel]);homeMainPanel.clearCardContents=PTC.homepage.destroyHomePage;PTC.homepage.HOME_PAGE_ID=
homeMainPanel.getId();cardPanel.add(homeMainPanel);cardPanel.getLayout().setActiveItem(PTC.homepage.HOME_PAGE_ID);PTC.navigation.setActiveContentArea(PTC.homepage.HOME_PAGE_ID);cardPanel.doLayout();if(main_form){Ext.getCmp(PTC.homepage.HOME_PAGE_ID).getEl().dom.appendChild(main_form);PTC.util._setMainFormStartingElement(main_form);if(Number(main_form.children.length)===0)for(var j=0;j<savedChildNodes.length;j++)main_form.appendChild(savedChildNodes[j])}};
PTC.homepage.createNonAdminHomePage=function(homepageConfig){homepageConfig.id="user-homepage";var infoModel=PTC.homepage.buildInfoPageModel(homepageConfig);var defaultTab=infoModel.tabSet.items[0];Ext.apply(infoModel.myTabConfig,{isSiteConfig:defaultTab.isSiteConfig||defaultTab.isPublic});return PTC.infoPage.getTopTabPanel(infoModel)};
PTC.homepage.createAdminHomePage=function(homepageConfig){homepageConfig.id="admin-homepage";var infoModel=PTC.homepage.buildInfoPageModel(homepageConfig);var publicTabConfig=PTC.homepage.getPublicTab(infoModel.tabSet.items);if(publicTabConfig)publicTabConfig.inlineHelpMessage=bundleHandler.get("com.ptc.core.ui.componentRB.SITE_ADMIN_PUBLIC_HOMEPAGE_TAB_INLINE_HELP");return PTC.infoPage.getTopTabPanel(infoModel)};
PTC.homepage.buildInfoPageModel=function(homepageConfig){var infoModel=Ext.apply(Object.clone(homepageConfig),new PTC.infoPage.InfoModel,{myTabConfig:{id:homepageConfig.id||Ext.id(),isHomepageTab:true,isSiteConfig:false,thirdLevelNavModel:homepageConfig.thirdLevelNavModel}});infoModel.tabSet=Ext.apply({},{objectType:"",items:infoModel.items});Ext.each(infoModel.items,function(tab){Ext.apply(tab,{allowContextMenu:false,closable:false,closeAction:""})});return infoModel};
PTC.homepage.getPublicTab=function(tabSet){var publicTab;for(var i=0,l=tabSet.length;i<l;i++)if(tabSet[i].isPublic){publicTab=tabSet[i];break}return publicTab};PTC.homepage.destroyHomePage=function(){this.removeAll(true);Ext.Panel.prototype.clearCardContents.call(this);var cardPanel=Ext.getCmp(PTC.navigation.cardManager);if(cardPanel)cardPanel.remove(this.id,true);this.destroy();Ext.garbageCollect();return true};
jsca.columns.imageRenderer=function(table,column,row){var result="";try{var data=jsca.columns.getCellValue(column,row);if(data&&data.img){result='<img src="'+data.img+'"';if(data.text)result+=' title="'+data.text+'" ';result+=jsca.columns.idStr(data.id);if(data.styleClasses)result+=data.styleClasses+" ";if(data.jsactions){var jsmap=Object.keys(data.jsactions);for(var i=0,l=jsmap.length;i<l;i++){var jsval=data.jsactions[jsmap[i]];if(typeof jsval==="string")result+=jsmap[i]+'="'+jsval+'" '}}result+=
"/>";if(data.url)result='<a href="'+data.url+'">'+result+"</a>"}}catch(e){jsca.log("no data item found for column id "+column.id)}result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};jsca.columns.imageRenderer.exportRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);if(data&&data.text)result=data.text;return result};jsca.columns.imageRenderer.groupFunc=jsca.columns.imageRenderer.exportRenderer;PTC.infoPageTableMgr={};
PTC.infoPageTableMgr.log=log4javascript.getLogger("PTC.infoPageTableMgr");PTC.infoPageTableMgr._renderedTables=new Ext.util.MixedCollection;PTC.infoPageTableMgr.registerTabId=function(tabId){PTC.infoPageTableMgr.log.debug("Register Tab with ID: ",tabId);PTC.infoPageTableMgr._renderedTables.add(tabId,[])};PTC.infoPageTableMgr.cleanUp=function(){PTC.infoPageTableMgr._renderedTables=new Ext.util.MixedCollection};
PTC.infoPageTableMgr._getRenderedTablesForTab=function(tabId){PTC.infoPageTableMgr.log.debug("Render tables for tab id: ",tabId);return PTC.infoPageTableMgr._renderedTables.get(tabId)||[]};
PTC.infoPageTableMgr._getRenderedTablesForOtherTabs=function(id){var result=[];PTC.infoPageTableMgr._renderedTables.eachKey(function(key){if(key!==id){var tables=PTC.infoPageTableMgr._renderedTables.get(key);if(tables)tables.each(function(table){result[result.length]=table})}});PTC.infoPageTableMgr.log.debug("Rendered tables for other tabs: ",result,"Current Tab: ",id);return result};
PTC.infoPageTableMgr._addRenderedTableForTab=function(tabId,TableHolder){var tables=PTC.infoPageTableMgr._renderedTables.get(tabId);if(!tables){PTC.infoPageTableMgr.log.error("ERROR in PTC.infoPageTableMgr._addRenderedTableForTab: ","Trying to add tables to a tab that hasn't been registered. Recovering by registering the tab. tabId: ",tabId);PTC.infoPageTableMgr.registerTabId(tabId);tables=PTC.infoPageTableMgr._renderedTables.get(tabId)}if(tables)tables.push(TableHolder)};
PTC.infoPageTableMgr._TableHolder=function(tableId,containerDiv,tabId){this.id=tableId;this.containerDiv=containerDiv;this.tabId=tabId};
PTC.infoPageTableMgr.addRenderedTable=function(tableId,containerDiv,tabId){PTC.infoPageTableMgr.log.debug("addRenderedTable() table id: ",tableId," Tab Id: ",tabId," ContainerDiv: ",containerDiv);var TableHolder=new PTC.infoPageTableMgr._TableHolder(tableId,containerDiv,tabId);PTC.infoPageTableMgr._addRenderedTableForTab(tabId,TableHolder);var others=PTC.infoPageTableMgr._getRenderedTablesForOtherTabs(tabId);if(others)for(var i=0;i<others.length;i++){var other=others[i];if(tableId===other.id){other.putMeBack=
true;PTC.infoPageTableMgr.log.debug("addRenderedTable() Set 'putMeBack' == true for table: ",other.containerDiv);var containerEl=document.getElementById(other.containerDiv);if(containerEl)PTC.navigation.overwrite(containerEl,"")}}};
PTC.infoPageTableMgr.removeRenderedTable=function(containerDiv,tabId){var tables=PTC.infoPageTableMgr._getRenderedTablesForTab(tabId);var temp=[];for(var i=0;i<tables.length;i++)if(tables[i].containerDiv!==containerDiv)temp.push(tables[i]);PTC.infoPageTableMgr._renderedTables.remove(tabId);PTC.infoPageTableMgr._renderedTables.add(tabId,temp)};
PTC.infoPageTableMgr.handleTabChange=function(tabPanel,newTab,oldTab){if(oldTab&&newTab.id===oldTab.id||tabPanel.docking===true){PTC.infoPageTableMgr.log.debug("handleTabChange() active tab didn't change or just re-docking.");return true}PTC.infoPageTableMgr.log.debug("handleTabChange() oldTab: ",oldTab?oldTab.getId?oldTab.getId():"couldn't get oldTab id":undefined,"newTab: ",newTab.getId()," TabPanel: ",tabPanel);if(!oldTab)return true;var newTables=PTC.infoPageTableMgr._getRenderedTablesForTab(newTab.getId());
if((!newTables||newTables.length===0)&&newTab&&newTab.initialConfig)newTables=newTab.initialConfig.defaultItems;if(!newTables||newTables.length===0)return true;var oldTables=PTC.infoPageTableMgr._getRenderedTablesForOtherTabs(newTab.getId());var tablesToClean=[];var tablesToRefresh=[];for(var i=0;i<newTables.length;i++){for(var ii=0;ii<oldTables.length;ii++)if(newTables[i].id===oldTables[ii].id){oldTables[ii].putMeBack=true;PTC.infoPageTableMgr.log.debug("handleTabChange() Looping Tables - Set 'putMeBack' == true for table: ",
oldTables[ii].containerDiv);tablesToClean.push(oldTables[ii])}if(newTables[i].putMeBack===true){newTables[i].putMeBack=false;PTC.infoPageTableMgr.log.debug("handleTabChange() Looping Tables - Set 'putMeBack' == false for table: ",newTables[i].containerDiv);tablesToRefresh.push(newTables[i])}}var divId,containerDiv;for(var j=0;j<tablesToClean.length;j++){PTC.infoPageTableMgr.log.debug("handleTabChange() Cleaning up table: ",tablesToClean[j].id);divId=tablesToClean[j].containerDiv;if(!divId)return true;
containerDiv=document.getElementById(divId);if(!containerDiv)return true;PTC.navigation.overwrite(containerDiv,"")}for(var k=0;k<tablesToRefresh.length;k++){var table=tablesToRefresh[k];var config=PTC.actionModel.getActionConfig(table.id,PTC.infoPage.myTab.getMyTabConfig(tabPanel).thirdLevelNavModel);PTC.infoPageTableMgr.log.debug("handleTabChange() Putting back table: ",table.id," config: ",config);if(!config||!config.actionURL){PTC.infoPageTableMgr.log.debug("WARNING handleTabChange() Could not find config/url to put back table: ",
table.id);return true}divId=table.containerDiv;if(!divId||!document.getElementById(divId))return true;var dom=document.getElementById(divId);PTC.navigation.overwrite(dom,'<div style="background: url(netmarkets/javascript/ext/resources/images/default/shared/blue-loading.gif) no-repeat center center; height: 100px">&nbsp;</div>');getElementHtml(Ext.lib.Ajax.serializeForm(getMainForm()),divId,true,config.actionURL,false)}return true};
PTC.infoPageTableMgr.setAllRenderedTablesAsDirty=function(){PTC.infoPageTableMgr.log.debug("Setting all tables on infopage as needing to be replaced");PTC.infoPageTableMgr._renderedTables.eachKey(function(key){var tables=PTC.infoPageTableMgr._renderedTables.get(key);if(tables)tables.each(function(table){table.putMeBack=true})})};Ext.namespace("PTC.lifeCycleDiagram");PTC.lifeCycleDiagram.stateDiagramWindowName="stateDiagramWindow";
PTC.lifeCycleDiagram.showLifecycleDiagram=function(config){PTC.lifeCycleDiagram.closeLifecycleDiagram();var loadingLabel=bundleHandler.get("com.ptc.core.ui.navigationRB.LOADING");var win=new Ext.Window({id:PTC.lifeCycleDiagram.stateDiagramWindowName,title:config.title,layout:"table",width:config.width,height:config.height,autoScroll:true,padding:10,items:[{html:'<img src="netmarkets/javascript/ext/ux/statusbar/images/loading.gif"/>'},{html:loadingLabel,cls:"lifeCycleDiagramText"}],layoutConfig:{columns:2}});
win.show();var lifeCycleState=Ext.ComponentMgr.get("infoPageinfoPageTitleBarLifeCycleState");if(lifeCycleState)lifeCycleState.on("beforedestroy",PTC.lifeCycleDiagram.closeLifecycleDiagram);var params={diagramOid:config.oid};var url=getBaseHref()+"ptc1/wnc/commonComponents/lifecycleStateDiagramController";var options={parameters:params,asynchronous:true,onSuccess:PTC.lifeCycleDiagram.renderLifecycleDiagram};requestHandler.doRequest(url,options)};PTC.lifeCycleDiagram.closeLifecycleDiagram=function(){if(Ext.ComponentMgr.get(PTC.lifeCycleDiagram.stateDiagramWindowName))Ext.ComponentMgr.get(PTC.lifeCycleDiagram.stateDiagramWindowName).close()};
PTC.lifeCycleDiagram.renderLifecycleDiagram=function(response){var data=response.responseText;var config=Ext.util.JSON.decode(data);items=PTC.lifeCycleDiagram.createItems(config);var window=Ext.ComponentMgr.get(PTC.lifeCycleDiagram.stateDiagramWindowName);if(window){window.removeAll();window.add(items);window.doLayout()}};
PTC.lifeCycleDiagram.createItems=function(config){var items=[];for(var i=0;i<config.nodes.length;i++){var node=config.nodes[i];items=items.concat(PTC.lifeCycleDiagram.createParentNodeItems(node,config.selected,i===0,i===config.nodes.length-1));if(node.subRecords)for(var j=0;j<node.subRecords.length;j++)items=items.concat(PTC.lifeCycleDiagram.createChildRecordItems(node.subRecords[j],config.selected))}return items};
PTC.lifeCycleDiagram.createParentNodeItems=function(node,parentSelected,first,last){var items=[];var iconItem={html:'<img src="'+node.iconURL+'"/>'};if(parentSelected)iconItem.style="background:#ffebc6";items.push(iconItem);var labelItem={html:node.label,cls:"lifeCycleDiagramText"};if(node.selected)labelItem.style="font-weight: bold";items.push(labelItem);if(!last){var barItem={html:'<img height="9px" width="19px" src="netmarkets/images/lifecyclediagram/step_vertical_line.png"/>'};if(parentSelected)barItem.style=
"background:#ffebc6";items.push(barItem);items.push({})}return items};
PTC.lifeCycleDiagram.createChildRecordItems=function(subRecord,parentSelected){var items=[];var recordBarItemStyleClass="lifeCycleDiagramVerticalConnector";if(parentSelected)recordBarItemStyleClass="lifeCycleDiagramVerticalConnectorSelected";var recordBarItem={cellCls:recordBarItemStyleClass};items.push(recordBarItem);var title={html:subRecord.title+":",cls:"lifeCycleDiagramText lifeCycleDiagramSubRecordTitleText"};if(subRecord.selected)title.cellCls="lifeCycleDiagramSubRecordTitleTextSelected";var recordTableItems=
[title];for(var i=0;i<subRecord.nodes.length;i++)recordTableItems=recordTableItems.concat(PTC.lifeCycleDiagram.createChildRecordNodeItems(subRecord.nodes[i],subRecord.selected,i===0,i==subRecord.nodes.length-1));var recordTable={layout:"table",layoutConfig:{columns:1E3},items:recordTableItems};items.push(recordTable);var barItem={html:'<img height="9px" width="19px" src="netmarkets/images/lifecyclediagram/step_vertical_line.png"/>'};if(parentSelected)barItem.style="background:#ffebc6";items.push(barItem);
items.push({});return items};
PTC.lifeCycleDiagram.createChildRecordNodeItems=function(node,parentSelected,first,last){var nodeHorizontalIconClass="";if(parentSelected)if(last)nodeHorizontalIconClass="lifeCycleDiagramHorizontalIconSelectedNoBar";else nodeHorizontalIconClass="lifeCycleDiagramHorizontalIconSelected";else if(last)nodeHorizontalIconClass="lifeCycleDiagramHorizontalIconNoBar";else nodeHorizontalIconClass="lifeCycleDiagramHorizontalIcon";var items=[];var icon={html:'<img src="'+node.iconURL+'"/>',cellCls:nodeHorizontalIconClass};
items.push(icon);var label={html:node.label,cls:"lifeCycleDiagramSubRecordText",colspan:3};if(parentSelected)label.cellCls="lifeCycleDiagramSubRecordTextSelected";if(node.selected)label.style="font-weight: bold";items.push(label);return{layout:"table",layoutConfig:{columns:1},items:items}};
PTC.lightbox=function(){var that={};var LB_CONTENT_DIV_ID="Div";var LB_CONTENT_IFRAME_ID="lbContentIframe";var LB_CONTENT_MASK_ID="Mask";var EMPTY_HTML="templates/htmlcomp/Empty.html";var ACTIONS_RENDERED_AS_LIGHTBOX=["WFCHECKOUT","WFDOWNLOAD","SETSTATE","MULTIEDITATTR","MULTIRENAME","WFCHECKIN","WFUPLOAD","WFSAVEAS","REVISEITEMS","WSEXPORT","WFCANCELCHECKOUT","REPLACEMISSDEP","EDITATTACHMENTS_X20","EDITATTACHMENTS","EDITASSOCIATION","AUTO_ASSOCIATE","UPDATEWS","WF_CONTENT_COMPARE"];var LIGHTBOX_SUPPORTTESTED_WS_TABLE_ACTION_NAMES=
["WFREMOVE","WFMULTICHECKOUT","SETSTATE","MULTIEDITATTR","MULTIRENAME","WFCHECKIN","WFUPLOAD","WFSAVEAS","REVISEITEMSMULTI","WFIMPORT","WSEXPORT","WFCANCELCHECKOUT","REDIRECTUPDATEWS","EDITASSOCIATION","AUTO_ASSOCIATE","WFCHECKOUT","WFDOWNLOAD"];var ACTIONS_NOT_RENDERED_MAXIMIZED=["CREATE_WS","REPLACEMISSDEP"];var MAXIMIZED_EXT_WINDOW_OPTIONTS={closable:false,resizable:false,draggable:false,maximized:true,header:false,headerAsText:false,hideBorders:true,hideLabel:true,plain:true,preventBodyReset:true,
shim:false,unstyled:true,autoScroll:true};if(Ext.isWebKit){Ext.util.Observable.observeClass(Ext.Window);Ext.Window.on("activate",function(win){var pluginListener=function(){PTC.util.handlePlugins(win)};PTC.util.on("checkplugins",pluginListener);PTC.util.firePluginChecks();win.on("deactivate",function(win){PTC.util.un("checkplugins",pluginListener);PTC.util.firePluginChecks()})})}var _isActionRenderedAsLightbox=function(options,enabledActionNames){var actionName=null;if("actionName"in options)actionName=
options.actionName;else if("actionURL"in options)actionName=PTC.lightbox.getActionNameFromURL(options.actionURL);if(actionName){if(enabledActionNames.indexOf(actionName.toUpperCase())!==-1){that.log.debug("Rendering URL for action ",actionName," as lightbox.");return true}}else that.log.debug("isActionEnabledForRenderingAsLightbox: Action name not specified. Action not rendered as lightbox");return false};var getFormatedSize=function(value){return Ext.util.Format.number(value*0.98,0)};var initDeactivateOptions=
function(){that.deactivateOptions={lbWindow:null,reloadParent:false,loadURL:null,saveContent:false,afterJs:null,cleanUpTables:true}};var resetConfigOptions=function(){that.log.debug("Called PTC.lightbox.resetConfigOptions");that.activateOptions={};initDeactivateOptions();that.resizeOptions={resizeHeightWithWindow:false,resizeWidthWithWindow:false,resizingParentWindow:false};that.initialActivatingWindow=null};var logOptions=function(options,notLoggableOptions){var optionsHash=$H(options);var notLoggableOptionsArray=
$A(notLoggableOptions);var someFunction=function(pair){var value=pair.value;if(notLoggableOptionsArray.indexOf(pair.key)!=-1)try{if(value.name)value=value.name;else value="name not found?"}catch(e){value="name not found?"}that.log.debug("  ",pair.key,": ",value)};optionsHash.each(someFunction,that)};var isMaskLightbox=function(){var maskLightbox=true;if(isWfTrlReplay())maskLightbox=false;that.log.debug("isMaskLightbox: maskLightbox: ",maskLightbox);return maskLightbox};return{log:log4javascript.getLogger("PTC.lightbox"),
lbContentWindow:new Ext.util.MixedCollection,activateOptions:{},deactivateOptions:{},resizeOptions:{resizeHeightWithWindow:false,resizeWidthWithWindow:false,resizingParentWindow:false},initialActivatingWindow:null,init:function(){that=this;return this},getLightboxWindowId:function(){if(typeof this.activateOptions.id!="undefined")return this.activateOptions.id;else return LB_CONTENT_IFRAME_ID},activate:function(options){var activateResult={};var lbContentIframe;this.log.debug("PTC.lightbox.activate options: ");
var notLoggableOptions=["activatingWindow","form"];logOptions(options,notLoggableOptions);if(options)this.setOptions(options);else{this.log.warn("PTC.lightbox.activate() called without specifying options parameter. Options must be specified to use lightbox.");return}initDeactivateOptions();PTC.navigation.log.debug("Registering Lightbox history change event - PTC.lightbox.handleHistoryChange");PTC.navigation.on("historyChange",this.handleHistoryChange,this,{single:true});var activateOptionsValid=this.validateActivateOptions();
if(!activateOptionsValid){this.activateOptions=null;activateResult.activated=false;return activateResult}var activatedWithinLightboxWindow=this.isActivatedWithinLightboxWindow();if(activatedWithinLightboxWindow){if(this.activateOptions.openNewLightbox)this.activateOptions.openNewLightbox=false;if(this.activateOptions.requestMethod==="get"){lbContentIframe=this.getLightboxIframeWindow();if(lbContentIframe){lbContentIframe.location=this.contentIframeSrc;this.log.debug("Loaded requested content href ",
this.contentIframeSrc," into existing lightbox iframe window.")}else this.log.error("Lightbox Iframe Window could not be found to load content for URL: ",this.contentIframeSrc)}}if(!activatedWithinLightboxWindow)this.displayLightbox();if(this.activateOptions.requestMethod==="post"){lbContentIframe=this.getLightboxIframeWindow();if(!lbContentIframe)this.log.debug("PTC.lightbox.activate: No iframe created yet with name: ",this.getLightboxWindowId());var postingFormName=this.activateOptions.postingFormName;
var originalFormTarget=null;var activatingWindow=this.getActivatingWindow();var lbContentIframeId=this.getLightboxWindowId();if(activatingWindow.document.forms[postingFormName]){this.log.debug("PTC.lightbox.activate: Valid form found for postingFormName: ",postingFormName);originalFormTarget=activatingWindow.document.forms[postingFormName].target;this.log.debug("Submit form target temporarily changed from ",originalFormTarget," to ",lbContentIframeId);activatingWindow.document.forms[postingFormName].target=
lbContentIframeId}else if(activatingWindow===self)if("form"in this.activateOptions){var postingForm=this.activateOptions.form;originalFormTarget=postingForm.getAttribute("target");postingForm.setAttribute("target",lbContentIframeId);this.log.debug("Submit form target temporarily changed from ",originalFormTarget," to ",lbContentIframeId)}else this.log.warn("PTC.lightbox.activate: No form could be found to target lightbox content. Current window is same as activating window.");else this.log.warn("PTC.lightbox.activate: No form could be found to target lightbox content. Current window is different from activating window");
if(originalFormTarget)this.activateOptions.postingFormOriginalTarget=originalFormTarget}activateResult.activated=true;this.setDeactivateOptions({lbWindow:this.getLightboxIframeWindow()});return activateResult},getLightboxIframeWindow:function(){var lightboxWin=null;var iframeId=this.getLightboxWindowId();this.log.debug("getLightboxIframeWindow: lightbox window iframe id: ",iframeId);if(this.lbContentWindow.containsKey(iframeId)){var iframeElem=document.getElementById(iframeId);if(iframeElem)lightboxWin=
iframeElem.contentWindow;else this.log.warn("getLightboxIframeWindow: DOM does not have iframe with iframe id ",iframeId,"?");lightboxWin=iframeElem?iframeElem.contentWindow:null}else this.log.debug("getLightboxIframeWindow: lbContentWindow list does not contain item for lightbox window iframe id ",iframeId,"?");return lightboxWin},isActivatedWithinLightboxWindow:function(){this.log.trace("Called PTC.lightbox.isActivatedWithinLightboxWindow");var activatedWithinLightboxWindow=this.isLightbox(this.getActivatingWindow());
this.log.debug("activatedWithinLightboxWindow: ",activatedWithinLightboxWindow);return activatedWithinLightboxWindow},getActivatingWindow:function(){return"activatingWindow"in this.activateOptions?this.activateOptions.activatingWindow:this.getParentWindow()},getLighboxActivateActionURL:function(options){var actionURL=null;var requestMethod="get";if("requestMethod"in options)requestMethod=options.requestMethod;if(requestMethod==="get"){if("contentHref"in options)actionURL=options.contentHref}else if(requestMethod===
"post")if("postingFormName"in options)actionURL=this.getActivatingWindow().document.forms[options.postingFormName].getAttribute("action");if(!actionURL)this.log.error("PTC.lightbox.getLighboxActivateActionURL: action URL could not be found from specified lightbox activate options.");this.log.debug("URL of the action page requested to be launched as lightbox: ",actionURL);return actionURL},setOptions:function(options){if(this.initialActivatingWindow===null&&"activateOptions"in this&&"activatingWindow"in
this.activateOptions)this.initialActivatingWindow=this.activateOptions.activatingWindow;this.activateOptions={id:LB_CONTENT_IFRAME_ID,requestMethod:"get",contentHref:null,postingFormName:null,width:getFormatedSize(getWindowWidth()),height:getFormatedSize(getWindowHeight()),topYPosition:50,positionInCenter:true,title:"",modal:true,layout:"fit",autoScroll:true,openNewLightbox:false,isExistingLightBox:false,closable:true,resizable:true,onBeforeclose:this.onBeforecloseHandler};if(options)Object.extend(this.activateOptions,
options)},getContextAction:function(){var contextAction=null;var contextActionURL=null;var lbIframeWindow=this.getLightboxIframeWindow();if(lbIframeWindow)contextActionURL=lbIframeWindow.location;else this.log.error("Lightbox iframe window with name ",getLightboxWindowId(),"was not found?");if(contextActionURL)contextAction=this.getActionNameFromURL(contextActionURL);return contextAction},masklightbox:function(){if(!isMaskLightbox()){this.log.debug("masklightbox: masking not applicable. masklightbox call ignored");
return}var lightboxParent=null;if(PTC.lightbox.isLightbox(self))lightboxParent=PTC.lightbox.getParentWindow();else lightboxParent=self;var lightboxMaskId=this.getLightboxMaskId();if(lightboxParent.Ext.fly(lightboxMaskId)){lightboxParent.Ext.getDom(lightboxMaskId).style.visibility="visible";this.log.debug("masklightbox: masking lightbox loading with ",lightboxMaskId,"masking element")}else this.log.debug("masklightbox: load masking not done as ",lightboxMaskId," not found")},unmasklightbox:function(){if(!isMaskLightbox()){this.log.debug("unmasklightbox: masking was not in effect. Hence unmasklightbox call ignored");
return}var lightboxParent=null;if(PTC.lightbox.isLightbox(self))lightboxParent=PTC.lightbox.getParentWindow();else lightboxParent=self;var lightboxMaskId=this.getLightboxMaskId();if(lightboxParent.Ext.fly(lightboxMaskId)){lightboxParent.Ext.removeNode(lightboxParent.Ext.getDom(lightboxMaskId));this.log.debug("unmasklightbox: ",lightboxMaskId,"masking element removed from dom")}else this.log.debug("unmasklightbox: unmask not done as",lightboxMaskId," not found")},displayLightbox:function(){this.log.trace("Called PTC.lightbox.displayLightbox");
var lightboxWindowId=this.getLightboxWindowId();if(this.lbContentWindow.containsKey(lightboxWindowId)){this.log.debug("Lightbox already existing.");this.activateOptions.isExistingLightBox=true}else{var contentDivHTML=this.createLbContentDivHTML();this.lbContentWindow.add(lightboxWindowId,this.createContentWindow(contentDivHTML))}if(this.activateOptions.positionInCenter){var onShow=function(component){component.center()};this.lbContentWindow.get(lightboxWindowId).on("show",onShow)}var lightboxExtWindowAfterRender=
function(component){var lightboxIframeOnloadHandler=function(){var contentWindow=this.getLightboxIframeWindow();if(this.activateOptions.id==="fba_relogin"||contentWindow&&contentWindow.document&&contentWindow.document.forms.length===1&&contentWindow.document.forms[0].id==="login"){this.unmasklightbox();return}if(contentWindow.PTC&&"htmlcomp"in contentWindow.PTC&&!("isCadxAction"in contentWindow.PTC.htmlcomp)){this.log.debug("Unmasking lightbox window for this is not cadx action");this.unmasklightbox()}contentWindow=
null};Ext.fly(this.getLightboxWindowId()).on("load",lightboxIframeOnloadHandler,this)};this.lbContentWindow.get(lightboxWindowId).on("afterrender",lightboxExtWindowAfterRender,this);if(this.activateOptions.requestMethod==="get"){var that=this;var f=function(){$(that.getLightboxWindowId()).src=that.contentIframeSrc};f.defer(1)}this.log.debug("displayLightbox: Calling show() method of lightbox window.");this.lbContentWindow.get(lightboxWindowId).show()},getLightboxDivId:function(){return this.getLightboxWindowId()+
LB_CONTENT_DIV_ID},getLightboxMaskId:function(){return this.getLightboxWindowId()+LB_CONTENT_MASK_ID},createLbContentDivHTML:function(){var idHTML="id='"+this.getLightboxDivId()+"' ";var lbContentDivHTML="<div style='height: 100%; width: 100%;'"+idHTML+"> \n";if(isMaskLightbox())lbContentDivHTML+="  "+this.createLbContentMaskHTML()+"\n";else this.log.debug("createLbContentDivHTML: Masking div not created as lightbox masking not needed");var innerDiv="  <div style='height: 100%; width: 100%;'> \n";
lbContentDivHTML+=innerDiv;lbContentDivHTML+="    "+this.createLbContentIframeHTML()+"\n";lbContentDivHTML+="  </div>";lbContentDivHTML+="</div>";this.log.debug("lbContentDivHTML:\n ",lbContentDivHTML);return lbContentDivHTML},createLbContentIframeHTML:function(){var idHTML="id='"+this.getLightboxWindowId()+"' ";var nameHTML="name='"+this.getLightboxWindowId()+"' ";var srcHTML="src=";if(this.contentIframeSrc)srcHTML+="'"+EMPTY_HTML+"'";else{srcHTML+="'"+EMPTY_HTML+"'";this.log.warn("PTC.lightbob.createLbContentIframeHTML: contentIframeSrc is null. No content can be loaded in the lightbox.")}var contentIframeHTML=
"<iframe "+idHTML+nameHTML+" frameborder=0 style='height: 100%; width: 100%;' "+srcHTML+" </iframe>";this.log.debug("contentIframeHTML: ",contentIframeHTML);return contentIframeHTML},createLbContentMaskHTML:function(){var idHTML="id='"+this.getLightboxMaskId()+"' ";var nameHTML="name='"+this.getLightboxMaskId()+"' ";var maskingClass="controls-disabled contentloading";if(PTC.isOldGecko())maskingClass="controls-disabled-unix-browser contentloading";var maskHTML="<div "+idHTML+nameHTML+" class='"+maskingClass+
"' style='width : 100%; height : 100%; visibility : visible;'></div>";this.log.debug("maskHTML: ",maskHTML);return maskHTML},validateActivateOptions:function(){this.activateOptions.requestMethod=this.activateOptions.requestMethod.toLowerCase();if(this.activateOptions.requestMethod==="post"){if(this.activateOptions.postingFormName){this.log.debug("PTC.lightbox.validateActivateOptions: postingFormName is ",this.activateOptions.postingFormName);var postingForm=this.getFormForLightboxTarget();if(!postingForm)this.log.warn("PTC.lightbox.validateActivateOptions: Specified form for post type request does not exist. Lightbox can not be shown.")}else{this.log.warn("PTC.lightbox.validateActivateOptions: No form was specified for a post type request. Lightbox can not be shown.");
return false}this.contentIframeSrc=EMPTY_HTML}else if(this.activateOptions.requestMethod==="get")if(this.activateOptions.contentHref)this.contentIframeSrc=this.activateOptions.contentHref;else{this.log.warn("PTC.lightbox.validateActivateOptions: No content href was specified for a get type request. Lightbox can not be shown.");return false}return true},getFormForLightboxTarget:function(){var postingForm=null;var activatingWindow=this.getActivatingWindow();this.log.debug("PTC.lightbox.getFormForLightboxTarget: activatingWindow is ",
activatingWindow.name);var postingFormName=this.activateOptions.postingFormName;postingForm=activatingWindow.document.forms[postingFormName];if(!postingForm)this.log.warn("PTC.lightbox.getFormForLightboxTarget: No form found for specified form name ",postingFormName);else{this.log.debug("PTC.lightbox.getFormForLightboxTarget: Valid form found for postingFormName ",this.activateOptions.postingFormName);return postingForm}if(activatingWindow===self){this.log.debug("PTC.lightbox.getFormForLightboxTarget: Current window is same as activating window. Getting form directly from activateOptions.form as a work-around.");
return this.activateOptions.form}return postingForm},createContentWindow:function(contentDivHTML){var parentWin=PTC.lightbox.getParentWindow(),extWinOptions={title:this.activateOptions.title,modal:this.activateOptions.modal,layout:this.activateOptions.layout,html:contentDivHTML};var maximizeLbWindow=this.activateOptions.requestMethod==="get"?this.isActionRenderedAsMaximizedLightbox(this.activateOptions.contentHref):this.activateOptions.renderMaximized;if(maximizeLbWindow){this.log.debug("createContentWindow: using Ext.Window options for maximized lightbox");
Ext.applyIf(extWinOptions,MAXIMIZED_EXT_WINDOW_OPTIONTS);this.activateOptions.positionInCenter=false;this.resizeOptions.resizeMaximizedToParentWin=true}else{this.log.debug("createContentWindow: using Ext.Window options for resizable lightbox");Ext.applyIf(extWinOptions,{width:this.activateOptions.width,closable:this.activateOptions.closable,resizable:this.activateOptions.resizable,y:this.activateOptions.topYPosition})}this.resizeWindowToParent();var contentWindow=new Ext.Window(extWinOptions);if(typeof this.activateOptions.height!=
"undefined")contentWindow.height=getFormatedSize(this.activateOptions.height);if(typeof this.activateOptions.onBeforeclose!="undefined")contentWindow.on("beforeclose",this.activateOptions.onBeforeclose,parentWin.PTC.lightbox);contentWindow.on("beforedestroy",this.beforeDestroyHandler,parentWin.PTC.lightbox);contentWindow.on("resize",PTC.lightbox.resizeContent);Ext.EventManager.onWindowResize(PTC.lightbox.resizeParentWindow,parentWin,true);return contentWindow},resizeWindowToParent:function(){var parentWidth=
getWindowWidth();if(parentWidth<=this.activateOptions.width)this.activateOptions.width=getFormatedSize(parentWidth);var parentHeight=getWindowHeight();if(typeof this.activateOptions.height!="undefined"&&parentHeight<=this.activateOptions.height){this.activateOptions.height=getFormatedSize(parentHeight);this.activateOptions.positionInCenter=true}},resizeParentWindow:function(width,height){var parentWin=PTC.lightbox.getParentWindow();var lbWindows=parentWin.PTC.lightbox.lbContentWindow;var lbWindow=
lbWindows.get(PTC.lightbox.getLightboxWindowId());if(lbWindow){var lbSize=lbWindow.getSize(),lbheight=lbSize.height,lbwidth=lbSize.width,newHeight=lbheight,resizeOpts=parentWin.PTC.lightbox.resizeOptions;if(resizeOpts.resizeMaximizedToParentWin)return;if(lbheight>=height||resizeOpts.resizeHeightWithWindow){newHeight=getFormatedSize(height);resizeOpts.resizeHeightWithWindow=true}var newWidth=lbwidth;if(lbwidth>=width||resizeOpts.resizeWidthWithWindow){newWidth=getFormatedSize(width);resizeOpts.resizeWidthWithWindow=
true}resizeOpts.resizingParentWindow=true;lbWindow.setSize(newWidth,newHeight);lbWindow.center()}},resizeLightboxToCompactSize:function(width,height){var lbWindow=this.lbContentWindow.get(this.getLightboxWindowId());if(lbWindow){var oldWidth=lbWindow.getWidth();var oldHeight=lbWindow.getHeight();var newWidth=width>=oldWidth?oldWidth:width;var newHeight=height>=oldHeight?oldHeight:height;if(newWidth!=oldWidth||newHeight!=oldHeight){lbWindow.setSize(newWidth,newHeight);lbWindow.center();this.log.debug("resizeLightboxToCompactSize: Resized lightbox window to width ",
width," and height ",height)}}},resizeContent:function(win,width,height){var parentWin=PTC.lightbox.getParentWindow();if(!parentWin.PTC.lightbox.resizeOptions.resizingParentWindow){parentWin.PTC.lightbox.resizeOptions.resizeHeightWithWindow=false;parentWin.PTC.lightbox.resizeOptions.resizeWidthWithWindow=false}parentWin.PTC.lightbox.resizeOptions.resizingParentWindow=false},setDeactivateOptions:function(options){if(options)Object.extend(this.deactivateOptions,options)},onBeforecloseHandler:function(){this.log.debug("Called PTC.lightbox.onBeforecloseHandler");
this.log.debug("PTC.lightbox.deactivateOptions: ");var notLoggableOptions=["lbWindow"];logOptions(this.deactivateOptions,notLoggableOptions);if(!this.deactivateOptions.lbWindow){this.log.warn("Lightbox deactivate could not be done as lbWindow option was not specified.");return false}if(this.deactivateOptions.saveContent){this.log.debug("onBeforecloseHandler: hiding lightbox window component.");this.lbContentWindow.get(this.getLightboxWindowId()).hide();this.beforeDestroyHandler();return false}else{var lbDiv=
Ext.getDom(this.getLightboxDivId());if(lbDiv){this.deactivateOptions.cleanUpTables=false;PTC.navigation.removeIframes(lbDiv,this.deactivateOptions.cleanUpTables,true)}}},deactivate:function(options){this.log.debug("Called PTC.lightbox.deactivate");this.setDeactivateOptions(options);if(!this.isLightbox(this.deactivateOptions.lbWindow)){this.log.warn("deactivate called when window is not even ligtbox? Call ignored.");return}var lightboxWindowId=this.getLightboxWindowId();if(this.lbContentWindow.containsKey(lightboxWindowId))if(this.deactivateOptions.saveContent===
true)this.onBeforecloseHandler();else{this.log.debug("deactivate: Calling Ext.Window.close() to close lightbox component.");this.lbContentWindow.get(lightboxWindowId).close()}else this.log.debug("deactivate: Lightbox window ",lightboxWindowId," not found in lbContentWindow list? Close operation could not be done.")},beforeDestroyHandler:function(){this.log.debug("Called PTC.lightbox.beforeDestroyHandler");if(this.activateOptions&&this.activateOptions.postingFormName)this.resetPostingFormTarget();
var lightboxWinId=this.getLightboxWindowId();if(this.deactivateOptions.saveContent===false){this.lbContentWindow.removeKey(lightboxWinId);this.log.debug("beforeDestroyHandler: Removed lightbox window entry for ",lightboxWinId," from lbContentWindow map.");var iframeEl=frames[lightboxWinId];if(iframeEl){this.log.debug("beforeDestroyHandler: frame with iframe id ",lightboxWinId," still exists? Remove it again.");iframeEl.src="";Ext.removeNode(iframeEl)}}else this.log.debug("beforeDestroyHandler: saveContent is true. lbContentWindow map entry kept for ",
lightboxWinId);if(this.deactivateOptions.afterJs!==null){this.log.trace("Calling afterJs callback function.");this.deactivateOptions.afterJs()}PTC.log.sendAllMessages();if(this.deactivateOptions&&this.deactivateOptions.reloadParent)this.reloadParent();resetConfigOptions()},resetPostingFormTarget:function(){var activatingWindow=this.getActivatingWindow();var postingFormName=this.activateOptions.postingFormName;try{if(activatingWindow.document&&activatingWindow.document.forms[postingFormName])try{var originalFormTarget=
activatingWindow.document.forms[postingFormName].getAttribute("target");if(originalFormTarget)if("postingFormOriginalTarget"in this.activateOptions)activatingWindow.document.forms[postingFormName].target=this.activateOptions.postingFormOriginalTarget}catch(e){this.log.warn("resetPostingFormTarget: error getting the original form target.")}else this.log.warn("resetPostingFormTarget: postingForm ",postingFormName," could not be found. Form target could not be reset.")}catch(permissionError){if(permissionError.description&&
/permission/i.test(permissionError.description))this.log.warn("permission to activatingWindow.document is denied. window.parent.location was changed");else throw permissionError;}},reload:function(){var lbIframeWindow=this.getLightboxIframeWindow();if(lbIframeWindow)lbIframeWindow.location.reload(true);else this.log.debug("Lightbox iframe window could not be reloaded as this iframe does not exist.")},reloadParent:function(){this.log.debug("Called PTC.lightbox.reloadParent");if(this.deactivateOptions.loadURL){this.log.debug("reloadParent: another URL needs to be loaded. Loading URL: ",
this.deactivateOptions.loadURL);getWindow().PTC.navigation.loadContent(this.deactivateOptions.loadURL);return}var activatingWindow=this.getActivatingWindow();if(activatingWindow)if(activatingWindow.frameElement){this.log.debug("Lightbox was initially activated from a window contained in an iframe. Reloading that window.");if("hardReload"in this.deactivateOptions&&this.deactivateOptions.hardReload===true){this.log.debug("reloadParent: performing hard reload");activatingWindow.location.reload(true)}else{var activatingWindowHref=
activatingWindow.location.href;activatingWindow.location.href=activatingWindowHref}this.log.debug("reloadParent: Reloaded iframe window with URL: ",activatingWindow.location.href)}else{this.log.debug("reloadParent: activated directly from content area in shell. Reloading content area");getWindow().PTC.navigation.reload()}else this.log.warn("Could not reload the window from where this lightbox was activated, as such window could not be identified.")},isLightbox:function(contextWindow){if(contextWindow)try{if(contextWindow.frameElement){var iframeId=
contextWindow.frameElement.getAttribute("name");var parentWin=this.getParentWindow();if(parentWin)if(iframeId&&iframeId===parentWin.PTC.lightbox.getLightboxWindowId())return true;else{this.log.debug("iframe name ",iframeId," does not match standard lightbox iframe name ",this.getLightboxWindowId());return false}}else this.log.debug("PTC.lightbox.isLightbox: No iframe element container found for specified window. Perhaps it is not lightbox window.")}catch(e){this.log.info("PTC.lightbox.isLightbox: Could not get frameElement unable to determine if window is a lightbox.")}return false},
isWsTableActionEnabledForRenderingAsLightbox:function(options){return _isActionRenderedAsLightbox(options,LIGHTBOX_SUPPORTTESTED_WS_TABLE_ACTION_NAMES)},isActionRenderedAsLightbox:function(options){return _isActionRenderedAsLightbox(options,ACTIONS_RENDERED_AS_LIGHTBOX)},isActionRenderedAsMaximizedLightbox:function(url){var res=false,actionName=this.getActionNameFromURL(url);actionName=actionName?actionName.toString().toUpperCase():false;if(actionName&&ACTIONS_NOT_RENDERED_MAXIMIZED.indexOf(actionName)===
-1)if(ACTIONS_RENDERED_AS_LIGHTBOX.indexOf(actionName)!==-1||LIGHTBOX_SUPPORTTESTED_WS_TABLE_ACTION_NAMES.indexOf(actionName)!==-1)res=true;return res},handleHistoryChange:function(){this.log.debug("PTC.lightbox.handleHistoryChange: url changed ",this.getLightboxWindowId());var _lbw=this.getLightboxIframeWindow();if(_lbw&&_lbw.PTC&&"lightbox"in _lbw.PTC)_lbw.PTC.lightbox.deactivate({cancelAction:true,reloadParent:false})},getActionNameFromURL:function(actionURL){var actionName=null;if(!actionURL){this.log.debug("actionURL is null?");
return null}if(actionURL.toLowerCase().indexOf(PTC.jslint.SCRIPT_URL_STRING)!==-1){this.log.debug("actionURL ",actionURL,"is a javascript pseudo URL. Action name could not be found.");return null}this.log.debug("actionURL: ",actionURL.toJSON());var queryParams=actionURL.toLowerCase().toQueryParams();if(queryParams.hasOwnProperty("action")){var actionParamValue=queryParams.action;this.log.debug("PTC.lightbox.getActionNameFromURL: actionParamValue: ",actionParamValue);if(Object.isArray(actionParamValue)){this.log.debug("PTC.lightbox.getActionNameFromURL: actionParamValue is an array: ",
actionParamValue);actionName=actionParamValue[0]}else actionName=actionParamValue}if(!actionName)this.log.debug("PTC.lightbox.getActionNameFromURL: Action name could not be found from specified URL ",actionURL);else this.log.debug("PTC.lightbox.getActionNameFromURL: Action name: ",actionName);return actionName},renderFormActionAsLightbox:function(options){var returnOptions={target:null,submitForm:false};if(!options){this.log.error("PTC.lightbox.renderFormActionAsLightbox: options not specified. Action can not be rendered as lightbox.");
return returnOptions}if(!("form"in options)){this.log.error("PTC.lightbox.renderFormActionAsLightbox: form not specified. Action can not be rendered as lightbox.");return returnOptions}options=this.isActionRenderedAsMaximizedLightbox(options.form.action)?Ext.applyIf(options,{renderMaximized:true}):options;var formName=$(options.form).readAttribute("name");if(!formName){this.log.error("PTC.lightbox.renderFormActionAsLightbox Form name not specified. Action can not be rendered as lightbox.");return returnOptions}this.log.debug("PTC.lightbox.renderFormActionAsLightbox formName: ",
formName);var theOptions={requestMethod:"post",postingFormName:formName};Object.extend(theOptions,options);this.activate(theOptions);returnOptions.target=this.getLightboxWindowId();if(!this.activateOptions.isExistingLightBox)returnOptions.submitForm=true;else this.log.debug("PTC.lightbox.renderFormActionAsLightbox: lightbox pre exists.");this.log.debug("renderFormActionAsLightbox: is submitForm value is ",returnOptions.submitForm);this.log.debug("renderFormActionAsLightbox: form post response targeted to window named ",
returnOptions.target);this.log.debug("Exiting PTC.lightbox.renderFormActionAsLightbox");return returnOptions},getParentWindow:function(){try{if(window.parent.location.href!==window.location.href&&typeof window.parent.PTC!=="undefined"&&typeof window.parent.PTC.navigation!=="undefined")return window.parent.getWindow()}catch(e){}return window},handleSubmitResult:function(originalHandle,status,nextAction,js,URL,dynamicRefreshInfo){var lbWindow=PTC.lightbox.isLightbox(self)?null:PTC.lightbox.getLightboxIframeWindow();
if(lbWindow)lbWindow.handleSubmitResult(status,nextAction,js,URL,dynamicRefreshInfo);else originalHandle(status,nextAction,js,URL,dynamicRefreshInfo)}}}().init();
if("wrap"in Function){var wrappedActivate=function(originalActivate,options){this.log.trace("Called wrapped PTC.lightbox.activate method.");var windchillWin=this.getParentWindow();if(self!=windchillWin){var theOptions={activatingWindow:self};if(options)Object.extend(theOptions,options);return windchillWin.PTC.lightbox.activate(theOptions)}else return originalActivate(options)};PTC.lightbox.activate=PTC.lightbox.activate.wrap(wrappedActivate);var wrappedRenderFormActionAsLightbox=function(proceed,
options){var windchillWin=this.getParentWindow();if(self!=windchillWin){var theOptions={activatingWindow:self};if(options)Object.extend(theOptions,options);return windchillWin.PTC.lightbox.renderFormActionAsLightbox(theOptions)}else return proceed(options)};PTC.lightbox.renderFormActionAsLightbox=PTC.lightbox.renderFormActionAsLightbox.wrap(wrappedRenderFormActionAsLightbox);var wrappedDeactivate=function(proceed,options){this.log.trace("Called wrapped PTC.lightbox.deactivate method.");var windchillWin=
this.getParentWindow();if(typeof options.lbWindow=="undefined")options.lbWindow=self;var lbWindowName=null;if("frameElement"in options.lbWindow&&options.lbWindow.frameElement)lbWindowName=options.lbWindow.frameElement.getAttribute("name");else{this.log.debug("deactivate: window being deactivated does not have frame element?");return}this.log.debug("deactivate: window being deactivated: ",lbWindowName);if(!lbWindowName){this.log.debug("deactivate: lightbox window could not be found? deactivate not done.");
return}options.lbWindow.PTC.jca.table.stickiness.clearAllTablesStickiness();if(self!=windchillWin)return windchillWin.PTC.lightbox.deactivate(options);else return proceed(options)};PTC.lightbox.deactivate=PTC.lightbox.deactivate.wrap(wrappedDeactivate);var wrappedIsLightbox=function(originalIsLightbox,contextWindow){var windchillWin=this.getParentWindow();if(self!=windchillWin&&windchillWin.PTC&&windchillWin.PTC.lightbox)return windchillWin.PTC.lightbox.isLightbox(contextWindow);else return originalIsLightbox(contextWindow)};
PTC.lightbox.isLightbox=PTC.lightbox.isLightbox.wrap(wrappedIsLightbox);var wrappedsetDeactivateOptions=function(proceed,options){var windchillWin=this.getParentWindow();if(self!=windchillWin)return windchillWin.PTC.lightbox.setDeactivateOptions(options);else return proceed(options)};PTC.lightbox.setDeactivateOptions=PTC.lightbox.setDeactivateOptions.wrap(wrappedsetDeactivateOptions);var wrappedResizeLightboxToCompactSize=function(proceed,width,height){var windchillWin=this.getParentWindow();if(self!=
windchillWin)return windchillWin.PTC.lightbox.resizeLightboxToCompactSize(width,height);else return proceed(width,height)};PTC.lightbox.resizeLightboxToCompactSize=PTC.lightbox.resizeLightboxToCompactSize.wrap(wrappedResizeLightboxToCompactSize);var wrappedGetActivatingWindow=function(proceed){var windchillWin=this.getParentWindow();if(self!=windchillWin)if(windchillWin.PTC.lightbox.initialActivatingWindow)return windchillWin.PTC.lightbox.initialActivatingWindow;else return windchillWin.PTC.lightbox.getActivatingWindow();
else return proceed()};PTC.lightbox.getActivatingWindow=PTC.lightbox.getActivatingWindow.wrap(wrappedGetActivatingWindow);var wrappedIsActionRenderedAsMaximizedLightbox=function(proceed,url){var windchillWin=this.getParentWindow();if(self!=windchillWin)return windchillWin.PTC.lightbox.isActionRenderedAsMaximizedLightbox(url);else return proceed(url)};PTC.lightbox.isActionRenderedAsMaximizedLightbox=PTC.lightbox.isActionRenderedAsMaximizedLightbox.wrap(wrappedIsActionRenderedAsMaximizedLightbox);handleSubmitResult=
handleSubmitResult.wrap(PTC.lightbox.handleSubmitResult)}
PTC.lightbox._createSimpleLightBoxForm=function(lightboxConfig){var labelWidth=Math.max(lightboxConfig.maxLabelWidth,Ext.util.TextMetrics.createInstance(document.body).getWidth(lightboxConfig.promptText));if(labelWidth>lightboxConfig.maxLabelWidth){var extraWindowWidth=labelWidth-lightboxConfig.maxLabelWidth;lightboxConfig.windowWidth=lightboxConfig.windowWidth+extraWindowWidth}var form=new Ext.FormPanel({id:lightboxConfig.formId,plain:true,frame:true,defaultType:"textfield",defaults:{width:lightboxConfig.fieldWidth},
monitorValid:true,labelWidth:labelWidth,keys:[{key:[10,13],fn:function(){OKButton.focus();OKButton.fireEvent("click",OKButton)}}],items:[{id:"newName",name:"newName",fieldLabel:lightboxConfig.promptText,labelStyle:"padding-right: 8px;",maxLength:lightboxConfig.maxLengthField,maxLengthText:lightboxConfig.charsExceededMessage,value:lightboxConfig.defaultFieldValue,invalidText:lightboxConfig.blankTextMessage,msgTarget:"under",selectOnFocus:true,validator:function(val){if(!val)return false;if(val.trim()===
"")return false;return true}}],buttons:[lightboxConfig.OKButton,lightboxConfig.cancelButton]});return form};
PTC.lightbox.createSimpleLightBoxWindowAndForm=function(windowId,formId,defaultFieldValue,preKey,OKButton,cancelButton){var lightboxConfig={windowId:windowId,formId:formId,defaultFieldValue:defaultFieldValue,maxLabelWidth:40,fieldWidth:230,windowWidth:310,OKButton:OKButton,cancelButton:cancelButton,promptText:bundleHandler.get("com.ptc.core.ui.navigationRB."+preKey+"_PROMPT_TEXT"),promptTitle:bundleHandler.get("com.ptc.core.ui.navigationRB."+preKey+"_PROMPT_TITLE"),charsExceededMessage:bundleHandler.get("com.ptc.core.ui.navigationRB."+
preKey+"_CHARS_EXCEEDED"),blankTextMessage:bundleHandler.get("com.ptc.core.ui.navigationRB."+preKey+"_NAME_EMPTY"),maxLengthField:bundleHandler.get("com.ptc.core.ui.navigationRB."+preKey+"_MAX_LENGTH_FIELD")};var form=PTC.lightbox._createSimpleLightBoxForm(lightboxConfig);return PTC.lightbox._createSimpleLightBoxWindow(form,lightboxConfig)};
PTC.lightbox.createSimpleLightBoxWindowAndFormFromConfig=function(lightboxConfig){Ext.applyIf(lightboxConfig,{maxLabelWidth:40,fieldWidth:230,windowWidth:310});var form=PTC.lightbox._createSimpleLightBoxForm(lightboxConfig);return PTC.lightbox._createSimpleLightBoxWindow(form,lightboxConfig)};
PTC.lightbox._createSimpleLightBoxWindow=function(form,lightboxConfig){var win=new Ext.Window({id:lightboxConfig.windowId,closable:true,modal:true,resizable:false,width:lightboxConfig.windowWidth,autoHeight:true,minimizable:false,maximizable:false,footer:true,plain:true,title:lightboxConfig.promptTitle,listeners:{show:function(){Ext.getCmp("newName").focus(true,500)}},items:[form]});win.mon(PTC.navigation,"historyChange",win.close,win,{single:true});return win};
jsca.columns.linkRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);var oid=data.oid||getRowItem(row).oid;if(oid){var url=data.url||PTC.attributeHelper.get("InfoPage").url;result='<a id="'+oid+'" href="'+url+"?oid="+encodeURIComponent(oid)+'">';var text=data.text||PTC.attributeHelper.get("InfoPage").title;if(data.img)result+='<img src="'+data.img+'" alt="'+text+'" title="'+text+'" hspace="0" vspace="0" border="0"/>';else result+=text;result+="</a>"}result=
result+jsca.columns.getHiddenInputs(data.hiddenData);return result};undoCheckoutActionListener=function(original,formResult){if(formResult.actionName==="undocheckout"||formResult.actionName==="renameOptionSetWizard"||formResult.actionName==="setState"||formResult.actionName==="reassignLC")PTC.jca.table.Utils.reload("optionset.mvc.listAssignedOptionSet",null,true);return original.call(this,formResult)};addActionListener=function(table){table.onObjectsAffected=table.onObjectsAffected.wrap(undoCheckoutActionListener)};
Ext.ComponentMgr.onAvailable("optionset.mvc.listAssignedOptionSet",addActionListener);PTC.ec={};PTC.ec.loadingSign=null;PTC.ec.loadingMenuItem=null;PTC.ec.currentFilterAction="currentFilterAction";PTC.ec.editFilterAction="editFilterAction";PTC.ec.csPickerAction="csPickerAction";var EDIT_FILTER_DIALOG_HEIGHT="480px";
PTC.ec.loadEditECAdHoc=function(divId){setIFrameHeight();PTC.ec.showLoadingMask();PTC.ec.addWncGWTScriptElem(divId);var checkAndLoadEditECIntervalID=null;function checkAndLoadEditEC(){if(typeof ECComponentPicker_launchEditEC=="function"&&window.top.PTC.ec[divId]===true){if(checkAndLoadEditECIntervalID!==null)clearInterval(checkAndLoadEditECIntervalID);ECComponentPicker_launchEditEC(divId)}else if(checkAndLoadEditECIntervalID===null)checkAndLoadEditECIntervalID=setInterval(checkAndLoadEditEC,500)}
checkAndLoadEditEC()};
PTC.ec.loadCSPickerAdHoc=function(divId,btnId){PTC.ec.showLoadingMenu(btnId);PTC.ec.addWncGWTScriptElem(divId);var checkAndLoadCSPickerIntervalID=null;function checkAndLoadCSPicker(){if(typeof ECComponentPicker_initialize=="function"&&typeof ECComponentPicker_launchCSPicker=="function"&&window.top.PTC.ec["csPickerPopulated"]===true){if(checkAndLoadCSPickerIntervalID!==null)clearInterval(checkAndLoadCSPickerIntervalID);ECComponentPicker_launchCSPicker(divId,btnId)}else if(checkAndLoadCSPickerIntervalID===null)checkAndLoadCSPickerIntervalID=
setInterval(checkAndLoadCSPicker,500)}checkAndLoadCSPicker()};
PTC.ec.loadECMiniInfoAdHoc=function(divId){PTC.ec.showLoadingMask();PTC.ec.addWncGWTScriptElem(divId);var checkAndLoadMiniInfoECIntervalID=null;function checkAndLoadMiniInfoEC(){if(typeof ECComponentPicker_launchMiniInfoEC=="function"&&window.top.PTC.ec[divId]===true){if(checkAndLoadMiniInfoECIntervalID!==null)clearInterval(checkAndLoadMiniInfoECIntervalID);ECComponentPicker_launchMiniInfoEC(divId)}else if(checkAndLoadMiniInfoECIntervalID===null)checkAndLoadMiniInfoECIntervalID=setInterval(checkAndLoadMiniInfoEC,
500)}checkAndLoadMiniInfoEC()};PTC.ec.setParams=function(useExistingECId,divId){PTC.ec.addWncGWTScriptElem(divId);var checkAndLoadSetParamsIntervalID=null;function checkAndLoadSetParams(){if(typeof ECComponentPicker_setParams=="function"){if(checkAndLoadSetParamsIntervalID!==null)clearInterval(checkAndLoadSetParamsIntervalID);ECComponentPicker_setParams(useExistingECId,divId)}else if(checkAndLoadSetParamsIntervalID===null)checkAndLoadSetParamsIntervalID=setInterval(checkAndLoadSetParams,500)}checkAndLoadSetParams()};
PTC.ec.setSelectionCallback=function(ecCB,divId,actionName,btnId){if(actionName!==undefined&&actionName!==null)if(actionName==PTC.ec.csPickerAction&&btnId!==undefined&&btnId!==null)PTC.ec.showLoadingMenu(btnId);else PTC.ec.showLoadingMask();PTC.ec.addWncGWTScriptElem(divId);var checkAndLoadSelectionCallbackIntervalID=null;function checkAndLoadSelectionCallback(){if(typeof ECComponentPicker_setSelectionCallback=="function"){if(checkAndLoadSelectionCallbackIntervalID!==null)clearInterval(checkAndLoadSelectionCallbackIntervalID);
ECComponentPicker_setSelectionCallback(ecCB,divId)}else if(checkAndLoadSelectionCallbackIntervalID===null)checkAndLoadSelectionCallbackIntervalID=setInterval(checkAndLoadSelectionCallback,500)}checkAndLoadSelectionCallback()};
PTC.ec.initializeEC=function(context,ecid,appName,hashKey,centricity,divId,remoteAddr,sessionID){var set_iframe_height=setIFrameHeight();PTC.ec.addWncGWTScriptElem(divId);var checkAndLoadInitializeECIntervalID=null;function checkAndLoadInitializeEC(){if(typeof ECComponentPicker_initialize=="function"){if(checkAndLoadInitializeECIntervalID!==null)clearInterval(checkAndLoadInitializeECIntervalID);ECComponentPicker_initialize(context,ecid,appName,hashKey,centricity,divId,remoteAddr,sessionID,set_iframe_height)}else if(checkAndLoadInitializeECIntervalID===
null)checkAndLoadInitializeECIntervalID=setInterval(checkAndLoadInitializeEC,500)}checkAndLoadInitializeEC()};
PTC.ec.createECUI=function(context,ecid,appName,hashKey,centricity,divId,remoteAddr,sessionID){PTC.ec.addWncGWTScriptElem(divId);var checkAndLoadCreateECUIIntervalID=null;function checkAndLoadCreateECUI(){if(typeof ECComponentPicker_createUI=="function"&&window.top.PTC.ec[divId]===true){if(checkAndLoadCreateECUIIntervalID!==null)clearInterval(checkAndLoadCreateECUIIntervalID);ECComponentPicker_createUI(context,ecid,appName,hashKey,centricity,divId,remoteAddr,sessionID)}else if(checkAndLoadCreateECUIIntervalID===
null)checkAndLoadCreateECUIIntervalID=setInterval(checkAndLoadCreateECUI,500)}checkAndLoadCreateECUI()};
PTC.ec.addWncGWTScriptElem=function(divId){if(window.top.PTC&&window.top.PTC.infoPage)window.top.PTC.infoPage.leftStructureTab=false;var elt=document.getElementById("WncGWTnocacheJS");if(elt===undefined||elt===null){window.top.PTC.ec["csPickerPopulated"]=false;window.top.PTC.ec[divId]=false;var headNode=document.getElementsByTagName("head")[0]||document.body;var script=document.createElement("script");script.type="text/javascript";script.id="WncGWTnocacheJS";script.src="gwt/com.ptc.windchill.wncgwt.WncGWT/com.ptc.windchill.wncgwt.WncGWT.nocache.js";
headNode.appendChild(script)}};PTC.ec.showLoadingMask=function(){window.top.PTC.ec.loadingSign=new Ext.LoadMask(Ext.getBody(),{msg:bundleHandler.get("com.ptc.core.ui.navigationRB.LOADING")});window.top.PTC.ec.loadingSign.show()};
PTC.ec.showLoadingMenu=function(btnId){window.top.PTC.ec.loadingMenuItem=new Ext.menu.Menu({items:{icon:"netmarkets/javascript/ext/resources/images/default/grid/loading.gif",text:bundleHandler.get("com.ptc.core.ui.navigationRB.LOADING")}});var el=Ext.getCmp(btnId).getEl().dom;window.top.PTC.ec.loadingMenuItem.show(el)};function resetIFrameHeight(){var tpIFrame=parent.document.getElementById("the_tpIFrame");if(tpIFrame!=null)tpIFrame.style.height=iFrameHeight}
function setIFrameHeight(){var set_iframe_height="false";var tpIFrame=parent.document.getElementById("the_tpIFrame");if(tpIFrame!=null){iFrameHeight=tpIFrame.style.height;if(tpIFrame.style.height<EDIT_FILTER_DIALOG_HEIGHT){tpIFrame.style.height=EDIT_FILTER_DIALOG_HEIGHT;set_iframe_height="true"}}return set_iframe_height}PTC.menu={};Ext.apply(PTC.menu,new Ext.util.Observable);
if(Ext.isWebKit)PTC.menu.on("dynamicMenuLoad",function(menu){var pluginListener=function(){PTC.util.handlePlugins(menu)};PTC.util.on("checkplugins",pluginListener);PTC.util.firePluginChecks();menu.on("hide",function(menu){PTC.util.un("checkplugins",pluginListener);PTC.util.firePluginChecks()})});PTC.menu.addEvents("dynamicMenuLoad","dynamicMenuShow");
function showDynamicMenu(theURL,id){var menu_link=Ext.get(id);var coords=menu_link.getOffsetsTo(document.body);var link_dim=menu_link.getSize(menu_link);coords[0]+=link_dim.width;coords[1]+=link_dim.height;PTC.menu.showMenu(coords,"",theURL)}
PTC.menu.ActionModelToMenu=function(model,id){PTC.actionModel.walkActionModelAndApplyToChildModels(model,function(submodel){if(submodel.actionID){submodel.id=submodel.actionID;if(id!==null&&id!==undefined&&id!=="")submodel.id+="_"+id}if(submodel.items)submodel.menu={items:submodel.items}})};
PTC.menu.onContextMenu=function(grid,rowIndex,evt){if(!evt.hasModifier()){evt.stopEvent();PTC.util._setMainFormStartingElement(grid.el.id);var row=grid.store.getAt(rowIndex);PTC.jca.table.Utils.focusRow(grid,rowIndex,grid.getSelectionModel().isSelected(rowIndex));var params=PTC.menu._constructParams(row,grid);PTC.menu.showActionsMenu(evt,params,row)}};
PTC.menu._constructParams=function(row,table){var params={};if(table.initialConfig.jcaTableConfig){var actionsColumnId=table.initialConfig.jcaTableConfig.customActionsMenuColumnId;if(!actionsColumnId)actionsColumnId=table.initialConfig.jcaTableConfig.actionsMenuColumnId;if(!actionsColumnId)params.actions=PTC.menu._FAKE_ACTION_MODEL_NAME;else{var cellValue=row.get(actionsColumnId);if(cellValue&&cellValue.params)params=cellValue.params}}Ext.apply(params,{tableID:table.id});Ext.applyIf(params,{context:getRowContext(row),
oid:getRowOid(row),actionName:"actionsMenu"});return params};PTC.menu._FAKE_ACTION_MODEL_NAME="EMPTY_ACTION_MODEL";PTC.menu.showActionsMenu=function(evt,params,row){var xy=[0,0];if(typeof evt.getXY==="function")xy=evt.getXY();else{xy[0]=evt.clientX;xy[1]=evt.clientY}PTC.menu.showMenu(xy,params,"",row);return false};
PTC.menu.showMenu=function(xy,params,url,row){var tableId;if(Ext.isString(params)){PTC.menu.contextOid=extractParamValue(params,"oid");tableId=extractParamValue(params,"tableID")}else{PTC.menu.contextOid=params.oid;tableId=params.tableID}url=url||PTC.attributeHelper.get("ActionsMenu").url;var options={parameters:params};var contextMenu;var selections=tableUtils.getTableSelectedRowsById(tableId);var selectionMatch=PTC.menu._selectionMatch(selections,PTC.menu.contextOid);if(selections.length>1&&selectionMatch){var multiSelectBar=
PTC.menu.getMultiSelectBar(tableId,PTC.menu.contextOid);if(multiSelectBar){contextMenu=PTC.menu._createMultiSelectMenu(multiSelectBar);PTC.menu._showContextMenu(selectionMatch,tableId,xy,contextMenu)}}else{contextMenu=PTC.menu._createDynamicMenu(url,options,row);contextMenu.tableId=tableId;if(row)if(row.cachedMenuResponse){contextMenu.loaded=true;contextMenu.initializeMenu(row.cachedMenuResponse);PTC.menu._showContextMenu(selectionMatch,tableId,xy,contextMenu);contextMenu.positionMenu();PTC.menu.fireEvent("dynamicMenuLoad",
contextMenu);return}else contextMenu.requestOptions.onSuccess=contextMenu.requestOptions.onSuccess.wrap(function(original,response){original(response);row.cachedMenuResponse=Ext.decode(response.responseText)});PTC.menu._showContextMenu(selectionMatch,tableId,xy,contextMenu)}};PTC.menu._showContextMenu=function(selectionMatch,tableId,xy,contextMenu){if(!(!tableId||tableId==="")){var table=PTC.jca.table.Utils.getTable(tableId);if(table)if(!selectionMatch)if(table.getSelectionModel&&table.getSelectionModel())table.getSelectionModel().clearSelections()}contextMenu.showAt(xy)};
PTC.menu._selectionMatch=function(selections,contextOid){var selectionMatch=false;var i=selections.length;while(i--){var soid=getOidFromRowValue(selections[i].value);if(soid===contextOid){selectionMatch=true;break}}return selectionMatch};PTC.menu._destroyContextMenu=function(menu){PTC.menu.contextOid=undefined;menu.destroy()};
PTC.menu._createMultiSelectMenu=function(multiSelectBar){var contextMenu;contextMenu=new Ext.menu.Menu({id:"gridRowContextMenu",items:multiSelectBar.items,ignoreParentClicks:true,listeners:{hide:PTC.menu._destroyContextMenu}});return contextMenu};
PTC.menu._createDynamicMenu=function(url,options,row){var contextMenu;contextMenu=new PTC.menu.DynamicMenu({id:"gridRowContextMenu",loadOnce:row?true:false,requestUrl:url,requestOptions:options,enableScrolling:false,listeners:{hide:PTC.menu._destroyContextMenu}});return contextMenu};
PTC.menu.DynamicMenu=Ext.extend(Ext.menu.Menu,{loadOnce:false,loaded:false,scrollerHeight:11,padding:5,constructor:function(menuConfig){menuConfig.requestOptions=menuConfig.requestOptions||{};menuConfig.requestOptions.parameters=menuConfig.requestOptions.parameters||{};var menu=this;Ext.applyIf(menuConfig.requestOptions,{onSuccess:function(response){menu.initializeMenu(Ext.decode(response.responseText));menu.positionMenu();if(Ext.isIE7){var bdom=Ext.getBody().dom;bdom.className=bdom.className}PTC.menu.fireEvent("dynamicMenuLoad",
menu)},onFailure:function(){menu.removeAll(true);menu.addItem({text:bundleHandler.get("com.ptc.core.ui.navigationRB.UNABLE_TO_CONNECT")})},method:"get"});Ext.applyIf(menuConfig.requestOptions.parameters,{cacheBuster:(new Date).getTime()});this.loadingItems={id:"loading_menu_items_panel",icon:"netmarkets/javascript/ext/resources/images/default/grid/loading.gif",text:bundleHandler.get("com.ptc.core.ui.navigationRB.LOADING")};PTC.menu.DynamicMenu.superclass.constructor.call(this,menuConfig);this.ignoreParentClicks=
true;this.on("beforeshow",function(){if(this.items===undefined||this.items.getCount()===0||this.loadOnce===false||this.loaded===false)this.menuLoader()},this);this.on("hide",function(){if(this.loadOnce===false||this.loaded===false)this.removeAll(true)},this)},menuLoader:function(){this.add(this.loadingItems);requestHandler.doRequest(this.requestUrl,this.requestOptions)},initializeMenu:function(actionModel){var menu=this;var table=menu.tableId?Ext.getCmp(menu.tableId):undefined;PTC.menu.ActionModelToMenu(actionModel,
menu.id);PTC.actionModel.walkActionModelAndApply(actionModel,function(menuItem){var itemHandler=menuItem.handler;if(itemHandler!==undefined){itemHandler=Ext.isString(itemHandler)?eval(itemHandler):itemHandler;menuItem.handler=function(target,event){itemHandler(target,event,table);return true}}});menu.suspendEvents();menu.removeAll(true);menu.add(actionModel.items);menu.loaded=true;menu.resumeEvents()},positionMenu:function(){var menu=this;menu.doLayout();var xy=menu.getPosition();var layoutNeeded=
false;if(xy[0]+menu.getWidth()>Ext.getBody().getWidth())xy[0]=Ext.getBody().getWidth()-(menu.getWidth()+menu.padding);if(menu.getHeight()>Ext.getBody().getHeight()){xy[1]=menu.padding;menu.enableScrolling=true;layoutNeeded=true}else if(Ext.getBody().getHeight()-menu.getHeight()<xy[1])xy[1]=Ext.getBody().getHeight()-(menu.getHeight()+menu.padding);menu.getEl().setXY(xy);if(layoutNeeded)menu.doLayout()}});Ext.ComponentMgr.registerType("dynamicMenu",PTC.menu.DynamicMenu);
PTC.menu.DynamicMenuButton=Ext.extend(Ext.Button,{constructor:function(buttonConfig){PTC.menu.DynamicMenuButton.superclass.constructor.call(this,buttonConfig);this.menu.on("add",function(){this.realignMenu()},this);this.on("menushow",function(button,menu){this.realignMenu();PTC.menu.fireEvent("dynamicMenuShow",button,menu);PTC.action.actionTarget=button},this);this.menu.on("hide",function(menu){PTC.action.actionTarget=null})},realignMenu:function(){this.menu.el.alignTo(this.el,this.menuAlign)}});
Ext.ComponentMgr.registerType("dynamicMenuButton",PTC.menu.DynamicMenuButton);PTC.menu.closeMenusOutsideThisFrame=function(){try{for(var i=0,l=frames.length;i<l;i++)if("Ext"in frames[i])frames[i].Ext.menu.MenuMgr.hideAll();if(parent.location.href!==window.location.href&&"Ext"in parent){parent.Ext.menu.MenuMgr.hideAll();for(var j=0,length=parent.frames.length;j<length;j++)if("Ext"in parent.frames[j]&&parent.frames[j].location.href!==window.location.href)parent.frames[j].Ext.menu.MenuMgr.hideAll()}}catch(e){jsca.log(e)}};
Event.observe(window.document,"click",PTC.menu.closeMenusOutsideThisFrame);Ext.menu.Menu.prototype.isAllItemsSelected=function(){var allSelected=false;if(this.items){allSelected=true;this.items.each(function(menuItem){if(allSelected&&!menuItem.checked)allSelected=false})}return allSelected};
PTC.menu.getMultiSelectBar=function(tableId,contextOid){if(tableId){var selections=tableUtils.getTableSelectedRowsById(tableId);var j,size;for(j=0,size=selections.length;j<size;j++)if(selections[j].id.indexOf(contextOid)>=0&&selections.length>1){var table=tableUtils.getTable(tableId);if(table&&tableUtils.isExt()){var multiSelectBar=table.jcaTableConfig.multiSelectbar;return multiSelectBar}}}else return};PTC.messaging={};PTC.messaging.msgWindow=null;PTC.messaging.deferFadeoutTime=null;
PTC.messaging.deferTimeoutMill=3E3;PTC.messaging.getDeferTimeoutMill=function(){var pref=PTC.util.getPreference("/Display/FeedbackMessageDisplayTime");if(pref)PTC.messaging.deferTimeoutMill=parseFloat(pref)*1E3;PTC.messaging.getDeferTimeoutMill=function(){return PTC.messaging.deferTimeoutMill};return PTC.messaging.deferTimeoutMill};PTC.messaging.showInlineMessageParent=function(msgObjects){if(window.opener)return PTC.messaging.showInlineMessage(msgObjects)};
PTC.messaging.closeInlineMessage=function(){if(PTC.messaging.msgWindow){clearTimeout(PTC.messaging.deferFadeoutTime);PTC.messaging.msgWindow.close();PTC.messaging.msgWindow.destroy()}};PTC.messaging.closeInlineMessageFadeout=function(){if(PTC.messaging.msgWindow&&!PTC.messaging.msgWindow.isDestroyed)(function(){if(!PTC.messaging.msgWindow.getEl().hasActiveFx())PTC.messaging.closeInlineMessage()}).defer(1)};
PTC.messaging.showInlineMessage=function(msgObjects){if(!msgObjects.length||msgObjects.length<=0)return;PTC.messaging.closeInlineMessage();PTC.messaging.msgWindow=new Ext.Window({cls:"inlineWindow",id:"inlineWindow",x:0,y:0,draggable:false,resizable:false,title:"",shadow:false,header:false,closable:false,padding:"0px 0px 6px 0px",focus:Ext.emptyFn});var closeButton=new Ext.BoxComponent({autoEl:{tag:"div",cls:"x-tool x-tool-close",html:" "}});PTC.messaging.msgWindow.add(closeButton);var msgObjLength=
msgObjects.length;var needScrollBar=false;if(msgObjLength>=5)needScrollBar=true;var totalLength=msgObjLength*2;for(var i=0;i<msgObjLength;i++){var messagePanel=msgObjects[i];var oidsLength=0;if(messagePanel.OidIdentity&&messagePanel.OidIdentity.length)oidsLength=messagePanel.OidIdentity.length;totalLength+=oidsLength;if(totalLength>12&&needScrollBar!==true)needScrollBar=true;PTC.messaging.msgWindow.add(PTC.messaging._getMsgComponent(messagePanel))}if(needScrollBar===true)PTC.messaging.msgWindow.height=
300;PTC.messaging.msgWindow.show();PTC.messaging.msgWindow.getEl().slideIn("t",{duration:0.3});closeButton.getEl().addClassOnOver("x-tool-close-over");closeButton.getEl().on("click",PTC.messaging.closeInlineMessage);PTC.messaging.deferFadeoutTime=PTC.messaging.messageFadeout.defer(PTC.messaging.getDeferTimeoutMill())};PTC.messaging.messageFadeout=function(){PTC.messaging.msgWindow.getEl().fadeOut({endOpacity:0.01,duration:3,callback:PTC.messaging.closeInlineMessageFadeout})};
PTC.messaging._getMsgComponent=function(msgObj){var msgDiv=new Ext.Container({autoEl:{tag:"div",cls:"inlineMessage"},listeners:{render:function(){PTC.messaging.msgWindow.getEl().on("mouseover",PTC.messaging.makeMessagePermanent);PTC.messaging.msgWindow.getEl().on("mouseout",function(){PTC.messaging.deferFadeoutTime=PTC.messaging.messageFadeout.defer(PTC.messaging.getDeferTimeoutMill())})}}});if(msgObj.MessageType){var icon=null;if("SUCCESS"==msgObj.MessageType)icon="success_large.png";if("FAILURE"==
msgObj.MessageType)icon="failure_fixable_large.png";if("WARNING"==msgObj.MessageType)icon="warning_large.png";if("FATAL"==msgObj.MessageType)icon="failure_nofix_large.png";if("INFO"==msgObj.MessageType)icon="info_large.png";if(icon)msgDiv.add(new Ext.BoxComponent({autoEl:{tag:"img",src:getBaseHref()+"netmarkets/images/"+icon,cls:"inlineIcon"}}))}var msgText="";if(msgObj.MessageTitle)msgText+="<b>"+msgObj.MessageTitle+"</b><br/>";if(msgObj.Messages&&msgObj.Messages.length>0)for(var i=0;i<msgObj.Messages.length;i++)msgText+=
msgObj.Messages[i]+"<br/>";msgDiv.add(new Ext.BoxComponent({autoEl:{tag:"div",cls:"msgLabel",html:msgText}}));if(msgObj.OidIdentity&&msgObj.OidIdentity.length>0){var showLinks=!msgObj.showItemIdAsText;for(var j=0;j<msgObj.OidIdentity.length;j++){var oidIdentity=msgObj.OidIdentity[j];var displayIdentity="";var htmlString="";if(oidIdentity.objType)htmlString=oidIdentity.objType;if(oidIdentity.displayIdentity){if(htmlString!=="")htmlString=htmlString+" - ";htmlString=htmlString+PTC.util.HTMLEncoder.handleAdjacentSpaces(oidIdentity.displayIdentity)}var objectIdentityLine=
new Ext.Container({autoEl:{tag:"div",cls:"msgObjIdentityLine"}});if(oidIdentity.icon)objectIdentityLine.add(new Ext.BoxComponent({autoEl:{tag:"img",src:getBaseHref()+oidIdentity.icon}}));var itemIdConfig={tag:"span",html:htmlString,cls:"msgIdentityText"};if(showLinks){itemIdConfig.tag="a";var params={};if(msgObj.commonParams)params=msgObj.commonParams;if(oidIdentity.objectParams)for(var key in objectParams)if(key!==undefined)params[key]=objectParams[key];itemIdConfig.href=PTC.infoPage.getURL(oidIdentity.oid,
params)}var itemIdComp=new Ext.BoxComponent({autoEl:itemIdConfig});objectIdentityLine.add(itemIdComp);msgDiv.add(objectIdentityLine)}}return msgDiv};PTC.messaging.showWarningMessage=function(title,msg){PTC.messaging.showMessage(title,msg,null,Ext.MessageBox.WARNING)};
PTC.messaging.showMessage=function(title,msg,buttons,icon){Ext.Msg.show({title:title?title:bundleHandler.get("com.ptc.netmarkets.util.utilResource.ERROR_PAGE_TITLE"),msg:msg?msg:bundleHandler.get("com.ptc.core.ui.errorMessagesRB.UNEXPECTED_MESSAGE"),buttons:buttons?buttons:{ok:bundleHandler.get("com.ptc.core.ui.navigationRB.okDialogButton")},icon:icon?icon:Ext.MessageBox.ERROR})};
PTC.messaging.makeMessagePermanent=function(){clearTimeout(PTC.messaging.deferFadeoutTime);if(PTC.messaging.msgWindow.getEl().hasActiveFx()){PTC.messaging.msgWindow.getEl().stopFx();PTC.messaging.msgWindow.getEl().fadeIn({endOpacity:1,duration:1})}};PTC.miniNavigator={};Ext.apply(PTC.miniNavigator,new Ext.util.Observable);PTC.miniNavigator.addEvents("show");PTC.miniNavigator.menuTitleID="wvsnavdetailsPageActionsMenu";PTC.miniNavigator.log=log4javascript.getLogger("PTC.miniNavigator");
PTC.miniNavigator.abortPendingRequests=function(){requestHandler.abortAll(PTC.miniNavigator._pendingRequests);PTC.miniNavigator._pendingRequests=[]};PTC.miniNavigator._pendingRequests=[];PTC.miniNavigator.doRequest=function(){var transport=requestHandler.doRequest.apply(this,arguments);PTC.miniNavigator._pendingRequests[PTC.miniNavigator._pendingRequests.length]=transport;return transport};
function WVSAddEvent(obj,type,fn){if(obj.attachEvent){obj["e"+type+fn]=fn;obj[type+fn]=function(){obj["e"+type+fn](window.event)};obj.attachEvent("on"+type,obj[type+fn])}else obj.addEventListener(type,fn,false)}function WVSRemoveEvent(obj,type,fn){if(obj.detachEvent){obj.detachEvent("on"+type,obj[type+fn]);obj[type+fn]=null;obj["e"+type+fn]=null}else obj.removeEventListener(type,fn,false)}function WVSFindAbsPos(obj){var el=Ext.get(obj);if(!el)return[0,0];return el.getXY()}
PTC.miniNavigator.getThreeDOption=function(popupObject){var threeD="";if(popupObject.show3D)if(popupObject.useNavigation)threeD="&t=0";else threeD="&t=3";return threeD};
var WVSPopup={pinned:false,stuck:false,options:null,baseURL:null,helpUrl:null,oid:null,assocoid:null,type:null,typenav:false,pvaction:"0",homeoid:null,history:null,fhistory:null,win:null,status:null,stdtext:null,clashtext:null,pviewReady:false,pviewOrientation:null,pviewMode:"select",selectedChild:null,showing3D:false,show3D:false,showdyndoc:false,dragx:0,dragy:0,useNavigation:true,use3D:true,getRef:"",height:428,width:486,getHelp:function(){PTC.help.openHelpWindow(WVSPopup.helpUrl)},getData:function(oid){WVSPopup.oid=
decodeURIComponent(oid);var url="servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getMThumbInfo?oid="+oid+PTC.miniNavigator.getThreeDOption(WVSPopup)+WVSPopup.getRef;if(!WVSPopup.fetchServerData(url,{onSuccess:WVSPopup.thumbDataSuccess}))return},setShow3DImage:function(show3D){if(!WVSPopup.use3D)show3D=false;WVSPopup.show3D=show3D}};WVSPopup.log=log4javascript.getLogger("PTC.wvs");
WVSPopup.failure=function(transport){var pos=WVSFindAbsPos(_mtTimeOutImg);WVSPopup.showStatus(bundleHandler.get("com.ptc.netmarkets.util.utilResource.SERVER_ERROR")+transport.responseText,pos[0]+24,pos[1]+16,true);WVSPopup.log.error("WVS server request failed",transport.responseText)};WVSPopup.fetchServerData=function(theURL,options){Ext.applyIf(options,{method:"get",asynchronous:true,onFailure:WVSPopup.failure,onException:WVSPopup.failure});return PTC.miniNavigator.doRequest(theURL,options)};
WVSPopup.thumbDataSuccess=function(xmlhttp){if(xmlhttp.responseXML){if(!WVSPopup.updateThumbInfo(xmlhttp.responseXML))return}else return false};function MTnavigateTo(oid,nullFHistory){if(typeof nullFHistory==="undefined"||nullFHistory)WVSPopup.fhistory=null;WVSPopup.pinit();WVSPopup.show(oid,-1,-1,true,false,true)}
WVSPopup._createWinAndBasicSetup=function(){WVSPopup.baseURL=PTC.attributeHelper.get("WVSPopup.baseURL");WVSPopup.options=PTC.attributeHelper.get("WVSPopup.options");WVSPopup.helpUrl=PTC.attributeHelper.get("WVSPopup.helpUrl");MTsetViewerOptions();WVSPopup.createLayout(WVSPopup.createFrames());WVSAddEvent(document,"mousedown",WVSPopup.mouseHide);PTC.navigation.on("historyChange",WVSPopup.onPageChange);if(!Ext.isWindows)WVSPopup.use3D=false;if(!Ext.isIE&&!WVSPopup.isPVInstalled())WVSPopup.use3D=false;
if(!WVSPopup.use3D)WVSPopup.useNavigation=false};
WVSPopup.show=function(oid,x,y,show3D,setHome,setHistory){PTC.miniNavigator.abortPendingRequests();if(!WVSPopup.win)WVSPopup._createWinAndBasicSetup();else{if(!WVSPopup.win.isVisible()){WVSAddEvent(document,"mousedown",WVSPopup.mouseHide);PTC.navigation.on("historyChange",WVSPopup.onPageChange)}if(WVSPopup.oid===oid&&WVSPopup.win.isVisible()&&setHistory)return null}PTC.miniNavigator.getAndDisplayNavConfig(oid);if(WVSPopup.oid&&setHistory){if(!WVSPopup.history)WVSPopup.history=[];if(WVSPopup.history.length===
0||WVSPopup.history[WVSPopup.history.length-1]!=WVSPopup.oid)WVSPopup.history.push(WVSPopup.oid)}WVSPopup.pviewReady=false;WVSPopup.selectedChild=null;WVSPopup.hideStatus();var rightmenu=Ext.getCmp("wvsrightmenu");if(rightmenu)rightmenu.hide();WVSPopup.pviewMode="select";if(!WVSPopup.use3D)show3D=false;WVSPopup.show3D=show3D;WVSPopup.getData(oid);WVSPopup.setPosition(x,y);if(setHome||!WVSPopup.history){WVSPopup.homeoid=oid;WVSPopup.history=[];WVSPopup.fhistory=null}PTC.miniNavigator.fireEvent("show",
oid);WVSPopup.win.show()};WVSPopup.setPosition=function(x,y){if(x>0&&y>0&&!WVSPopup.pinned){var topEl=Ext.get(top.document);var scroll;if(topEl)scroll=topEl.getScroll();else scroll={top:0,left:0};x=x+scroll.left;if(x-scroll.left<0)x=scroll.left;y=y-WVSPopup.height/2+scroll.top;if(y-scroll.top<0)y=scroll.top;if(y+WVSPopup.height-scroll.top>top.document.body.clientHeight-2)y=top.document.body.clientHeight-2-WVSPopup.height+scroll.top;WVSPopup.win.setPagePosition(x,y)}};
WVSPopup.isPVInstalled=function(){if(!navigator.plugins)return false;var len=navigator.plugins.length;for(var i=0;i<len;i++)if(navigator.plugins[i].name=="Creo View")return true;return false};
WVSPopup.stick=function(){var si=Ext.getCmp("wvsstickicon");if(WVSPopup.stuck){WVSPopup.stuck=false;WVSPopup.unpinit();si.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_DISABLE_ROLLOVER"));si.btnEl.setStyle("background-image","url(netmarkets/images/unlock.gif)");Ext.getCmp("wvssticktext").setText("")}else{WVSPopup.stuck=true;WVSPopup.pinit();si.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_ENABLE_ROLLOVER"));si.btnEl.setStyle("background-image","url(netmarkets/images/lock.gif)");
Ext.getCmp("wvssticktext").setText("("+PTC.util.HTMLEncoder.encodeForHTMLContent(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_ROLLOVER_DISABLED"))+")")}};WVSPopup.stickit=function(){if(!WVSPopup.stuck)WVSPopup.stick()};WVSPopup.unstickit=function(){if(WVSPopup.stuck)WVSPopup.stick()};WVSPopup.pin=function(){if(WVSPopup.pinned){WVSPopup.pinned=false;WVSAddEvent(document,"mousedown",WVSPopup.mouseHide)}else{WVSPopup.pinned=true;WVSRemoveEvent(document,"mousedown",WVSPopup.mouseHide)}};
WVSPopup.pinit=function(){if(!WVSPopup.pinned)WVSPopup.pin()};WVSPopup.unpinit=function(){if(WVSPopup.pinned)WVSPopup.pin()};WVSPopup.isNavigateMode=function(){return WVSPopup.show3D&&WVSPopup.typenav&&WVSPopup.useNavigation};WVSPopup.setMode=function(u3d,nav){WVSPopup.use3D=u3d;WVSPopup.useNavigation=nav;if(!WVSPopup.use3d)WVSPopup.useNavigation=false};
function MTback(){if(WVSPopup.showing3D&&!WVSPopup.pviewReady)return;if(WVSPopup.history&&WVSPopup.history.length>0){if(!WVSPopup.fhistory)WVSPopup.fhistory=[];WVSPopup.fhistory.push(WVSPopup.oid);WVSPopup.oid=null;MTnavigateTo(WVSPopup.history.pop(),false)}}function MTforward(){if(WVSPopup.showing3D&&!WVSPopup.pviewReady)return;if(!WVSPopup.fhistory||WVSPopup.fhistory.length===0)return;MTnavigateTo(WVSPopup.fhistory.pop(),false)}
function MTforwardAll(){if(WVSPopup.showing3D&&!WVSPopup.pviewReady)return;if(!WVSPopup.fhistory||WVSPopup.fhistory.length===0)return;MTnavigateTo(WVSPopup.fhistory[0])}function MTrefresh(){WVSPopup.show(WVSPopup.oid,-1,-1,true,false,false)}
function MThome(){if(WVSPopup.showing3D&&!WVSPopup.pviewReady)return;if(WVSPopup.homeoid){if(WVSPopup.showing3D&&PTC.miniNavigator.is3dPluginPresent())WVSPopup.pviewOrientation=document.mtpvctl.GetViewLocation();WVSPopup.pinit();WVSPopup.show(WVSPopup.homeoid,-1,-1,true,true,false)}}
PTC.miniNavigator.getTitleMenuConfig=function(){var actionsMenu=PTC.attributeHelper.get("ActionsMenu");var defaultText=bundleHandler.get("com.ptc.core.ui.navigationRB.MININAVTHUMBPANE");var menuButton={xtype:"dynamicMenuButton",cls:"miniNavTitle",id:PTC.miniNavigator.menuTitleID,text:defaultText,defaultText:defaultText,menu:{xtype:"dynamicMenu",id:"wvsViewActionMenu",requestUrl:actionsMenu.url,loadOnce:true,requestOptions:{parameters:"actions=wvsCustomPaneWidgets",onSuccess:PTC.miniNavigator.menuSuccess}},
listeners:{click:function(button){PTC.util._setMainFormStartingElement(button.id);this.menu.positionMenu();PTC.menu.fireEvent("dynamicMenuLoad",this.menu)},afterRender:function(button){PTC.miniNavigator.doRequest(button.menu.requestUrl,button.menu.requestOptions)}}};return menuButton};PTC.miniNavigator.persistMiniTableOrder=function(event){var portalManager=Ext.getCmp(PTC.miniNavigator.cardManager).portalManager;var column=event.column||event.ownerCt;if(!column.oid)portalManager.create();else portalManager.update()};
PTC.miniNavigator.sortPortals=function(){this.items.sort("ASC",function(a,b){return a.itemIndex-b.itemIndex})};PTC.miniNavigator.cardManager="mini"+PTC.navigation.cardManager;
function MTLaunchDetailsSuccess(xmlhttp){if(xmlhttp.responseText&&xmlhttp.responseText.length>0)if(xmlhttp.responseText.indexOf("javascript")===0)PTC.jslint.foundEvalReservedWord(xmlhttp.responseText);else{var mainWindow=PTC.getMainWindow();mainWindow.PTC.navigation.loadContent(xmlhttp.responseText,true);if(mainWindow.PTC.navigator.isExpanded())mainWindow.PTC.navigator.collapseNavigator()}}
function MTLaunchDetails(){WVSPopup.hideStatus();var theURL="servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getDetailsPageURL?oid="+WVSPopup.oid;var coid=extractParamValue(top.location.href,"ContainerOid");if(!coid||coid.length===0)coid=extractParamValue(top.location.href,"oid");if(coid&&coid.length>0)theURL+="&coid="+coid;var options={onSuccess:MTLaunchDetailsSuccess};WVSPopup.fetchServerData(theURL,options)}
WVSPopup.createFrames=function(){var navBar=new Ext.Toolbar([{xtype:"button",id:"wvshomehome",icon:"wt/clients/images/wvs/back_all.gif",cls:"x-btn-icon",handler:MThome,tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_HOME")},{xtype:"button",id:"back_one",icon:"wt/clients/images/wvs/back_one.gif",cls:"x-btn-icon",handler:MTback,tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_BACK")},{xtype:"button",id:"forward_one",icon:"wt/clients/images/wvs/forward_one.gif",cls:"x-btn-icon",
handler:MTforward,tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_FORWARD")},{xtype:"button",id:"forward_all",icon:"wt/clients/images/wvs/forward_all.gif",cls:"x-btn-icon",handler:MTforwardAll,tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_FORWARD_ALL")},{xtype:"button",id:"refresh",icon:"netmarkets/images/refresh_tbar.gif",cls:"x-btn-icon",handler:MTrefresh,tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_REFRESH")},"->",PTC.miniNavigator.getTitleMenuConfig(),
{xtype:"button",id:"wvsstickicon",icon:"netmarkets/images/unlock.gif",cls:"x-btn-icon",handler:WVSPopup.stick,tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_DISABLE_ROLLOVER")}]);var whereUsed={id:"tbn_nav_whereUsed",layout:"fit",collapsible:true,title:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_WHERE_USED"),xtype:"panel"};var uses={id:"tbn_nav_uses",collapsible:true,title:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_USES"),xtype:"panel"};var whereusedPanel={xtype:"panel",
id:"thumbNailNavPanel",resizable:true,autoScroll:true,items:[whereUsed,uses]};var relatedInfoPanel={xtype:"miniNavPortal",id:PTC.miniNavigator.relatedInformation};var portalManager=new PTC.jca.manager.PortalContentManager;Ext.ComponentMgr.onAvailable(PTC.miniNavigator.relatedInfoColumn,function(column){this.init(column)},portalManager);var miniCardManager={id:PTC.miniNavigator.cardManager,layout:"card",region:"center",activeItem:0,portalManager:portalManager,items:[whereusedPanel,relatedInfoPanel]};
var dynamicDocPanel={id:"dyn_doc_panel",xtype:"panel",autoScroll:true};var wvsBackgroundColor=(_docColorOption&16777215).toString(16);WVSPopup.win=new Ext.Window({header:false,id:"MTWindow",cls:"miniInfoWindowStyle",width:WVSPopup.width,autoHeight:false,height:WVSPopup.height,boxMinWidth:WVSPopup.width,boxMinHeight:WVSPopup.height,x:-999,y:-999,plain:true,title:"",draggable:false,closable:false,resizable:true,infoConfig:null,tbar:new Ext.Toolbar({cls:"miniInfoTitleBar",items:[{id:"titleText",xtype:"tbtext",
text:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_THUMBNAIL_NAVIGATOR")},{id:"wvssticktext",xtype:"tbtext",text:"",style:"font-weight:normal"},"->",{id:"helpicon",tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_HELP"),xtype:"button",icon:"netmarkets/images/help_tablebutton.gif",handler:WVSPopup.getHelp},{id:"closebox",xtype:"box",autoEl:{tag:"div",onclick:"WVSPopup.hide();"},cls:"x-tool x-tool-close",overCls:"x-tool-close-over"}]}),shim:true,layout:"border",items:[{xtype:"panel",
region:"north",id:"actionToolbar",height:28,items:[navBar]},{xtype:"panel",frame:true,split:true,resizable:true,region:"west",height:"218px",width:"288px",minWidth:96,maxWidth:290,id:"vis",listeners:{resize:PTC.miniNavigator.adjustThumbnailSize},items:[{id:"vis_img_panel",width:288,height:218,bodyStyle:"background-color: #"+wvsBackgroundColor,html:'<div id="ccol_div" style="width:288px; height:192px; border:0; align:left; valign: top; display: none"></div><img id="ccol_img" style="width:288px; height:192px; border:0; align:middle;"/>',
collapsible:true,title:bundleHandler.get("com.ptc.core.ui.navigationRB.VISUALIZATION_TITLE"),items:[dynamicDocPanel]},{id:"actionstoolbar",xtype:"container",items:{xtype:"toolbar",layout:"table",border:false,items:[{xtype:"button",id:"wvscopy",icon:"netmarkets/images/copy.gif",cls:"x-btn-icon",handler:MTcopyTo,tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_COPY_TO_CLIPBOARD")},{xtype:"button",id:"wvsdetails",icon:"netmarkets/images/details.gif",cls:"x-btn-icon",handler:MTLaunchDetails,
tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_VIEW_INFORMATION")},{xtype:"button",id:"wvspvlaunch",icon:"netmarkets/images/creo_view.png",cls:"x-btn-icon",handler:MTLaunchPV,tooltip:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_OPEN_IN_PRODUCTVIEW")},{xtype:"button",id:"wvspartdoc",icon:"wt/clients/images/wvs/toggle_icon.gif",cls:"x-btn-icon",handler:MTnavigateToAssociated,disabled:true},{xtype:"button",id:"wvsactionsmenu",icon:"netmarkets/images/arrow_menu_d9x9.gif",cls:"x-btn-icon",
handler:PTC.miniNavigator.showMenu,disabled:false}]}},{id:"vis_atts_panel",html:'<div id="attributesPanel"><div id="attributesPanelInner"></div></div>',xtype:"container",autoScroll:true,border:false}]},miniCardManager]});WVSPopup.win.on("afteraction",PTC.miniNavigator.onAfterAction);WVSPopup.win.show();WVSPopup.win.on("afterlayout",PTC.miniNavigator.setAttributePanelHeight);WVSPopup.win.setInfoConfig=function(config){this.infoConfig=config};WVSPopup.win.getInfoConfig=function(){return this.infoConfig};
var w=Ext.fly("MTWindow");w.on("mouseenter",WVSPopup.mousein,this);w.on("mouseleave",WVSPopup.mouseout,this);var visPanel=Ext.getCmp("vis_img_panel");visPanel.collapse=PTC.miniNavigator.visPanelCollapse;visPanel.expand=PTC.miniNavigator.visPanelExpand;PTC.miniNavigator.on("show",PTC.miniNavigator.onShowHideMenu);return document.getElementById("MTContentPane")};PTC.miniNavigator.relatedInformation="relatedInformationPortal";PTC.miniNavigator.getRelatedInfoPortalColumn=function(){return Ext.getCmp(PTC.miniNavigator.relatedInfoColumn)};
PTC.miniNavigator.Portal=Ext.extend(Ext.ux.Portal,{constructor:function(config){config=config||{};Ext.applyIf(config,{autoScroll:true,listeners:{beforedrop:function(){this.getPortalColumn().un("add",PTC.miniNavigator.sortPortals)},drop:PTC.miniNavigator.persistMiniTableOrder},items:[{id:PTC.miniNavigator.relatedInfoColumn,xtype:"miniNavPortalColumn"}]});PTC.miniNavigator.Portal.superclass.constructor.call(this,config)},getPortalColumn:function(){return this.getComponent(PTC.miniNavigator.relatedInfoColumn)}});
PTC.miniNavigator.relatedInfoColumn="relatedInformationPortal_column";Ext.ComponentMgr.registerType("miniNavPortal",PTC.miniNavigator.Portal);PTC.miniNavigator.PortalColumn=Ext.extend(Ext.ux.PortalColumn,{constructor:function(config){config=config||{};Ext.applyIf(config,{columnWidth:1,setSize:FALSE_FUNC});PTC.miniNavigator.PortalColumn.superclass.constructor.call(this,config)},getPortlets:function(){return this.items.items}});Ext.ComponentMgr.registerType("miniNavPortalColumn",PTC.miniNavigator.PortalColumn);
PTC.miniNavigator.Portlet=Ext.extend(Ext.ux.Portlet,{constructor:function(config){config=config||{};Ext.applyIf(config,{setSize:FALSE_FUNC,collapsible:true,listeners:{expand:PTC.miniNavigator.persistMiniTableOrder}});this.actionName=config.actionName;this.actionType=config.actionType;PTC.miniNavigator.Portlet.superclass.constructor.call(this,config);this.on("afterrender",function(){this.on("collapse",PTC.miniNavigator.persistMiniTableOrder)},this,{single:true})}});
Ext.ComponentMgr.registerType("miniNavPortlet",PTC.miniNavigator.Portlet);PTC.miniNavigator.setAttributePanelHeight=function(){var westPanel=Ext.getCmp("vis");var attsPanel=Ext.getCmp("vis_atts_panel");var otherPanelsHeight=westPanel.getFrameHeight();for(var i=0,l=westPanel.items.items.length;i<l;i++){var nextPanel=westPanel.items.items[i];var h=nextPanel.getHeight();if(nextPanel.id!==attsPanel.id)otherPanelsHeight+=nextPanel.getHeight()}attsPanel.setHeight(westPanel.getOuterSize().height-otherPanelsHeight)};
PTC.miniNavigator.setAttributePanelHeight=PTC.util.delayAllCalls(PTC.miniNavigator.setAttributePanelHeight);function MTUpdateTipText(tip,text){if(!tip){WVSPopup.log.error(text);return}if(tip.body)tip.body.update(text);else tip.html=text}function MTUpdateToolTipTextFromHTML(tip){MTUpdateTipText(tip,tip.target.dom.innerHTML);return true}
WVSPopup.createLayout=function(inner_frame){WVSPopup.pviewrun=Ext.getDom("ccol_div");WVSPopup.pviewimg=Ext.getDom("ccol_img");WVSPopup.right_col=Ext.getCmp("thumbNailNavPanel").getEl().dom;Ext.QuickTips.register({target:"wvsnumtext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvsnamtext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvsvertext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvsstatetext",
listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvscontexttext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvscnamtext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvscdesctext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvscstatetext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvsctypetext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});
Ext.QuickTips.register({target:"wvscassigneetext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});Ext.QuickTips.register({target:"wvscdatetext",listeners:{beforeshow:MTUpdateToolTipTextFromHTML}});WVSPopup.status=new Ext.Tip({hidden:true,maxWidth:1200});var wvsmenu=new Ext.menu.Menu({id:"wvsrightmenu",hidden:true,renderTo:WVSPopup.win,shadow:false,items:[{xtype:"menuitem",icon:"netmarkets/images/zoom_all.gif",text:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_ZOOM_ALL"),handler:MTzoomToAll},
{xtype:"menuitem",icon:"netmarkets/images/spin_center.gif",text:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_SET_SPIN_CENTER"),handler:MTspinCenter},{xtype:"menuseparator"},{xtype:"menuitem",icon:"netmarkets/images/copy.gif",text:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_COPY_IMAGE"),handler:MTcopyToSystemClipboard}]});var w=Ext.fly("wvsrightmenu");w.on("mouseenter",WVSPopup.mousein,this);w.on("mouseleave",WVSPopup.mouseout,this);WVSAddEvent(WVSPopup.win.getTopToolbar().getEl().dom,
"mousedown",WVSPopup.startDrag)};WVSPopup.showStatus=function(text,x,y,fade){MTUpdateTipText(WVSPopup.status,text);WVSPopup.status.showAt([x,y]);if(fade)WVSPopup.status.el.hide({duration:3})};WVSPopup.hideStatus=function(){if(_mtTimeOut)clearTimeout(_mtTimeOut);if(WVSPopup.status)WVSPopup.status.hide()};function MTaddDependencies(){}
function MTaddData(view){WVSPopup.type=view.getAttribute("type");WVSPopup.assocoid=view.getAttribute("assocoid");WVSPopup.idicontip=view.getAttribute("tip");if(WVSPopup.oid===WVSPopup.homeoid)Ext.getCmp("wvshomehome").setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_RETURN_TO").replace(/\{0\}/,WVSPopup.idicontip));WVSPopup.typenav=view.getAttribute("typenav")=="1"?true:false;WVSPopup.pvaction=view.getAttribute("pvaction");WVSPopup.showdyndoc=view.getAttribute("showdyndoc")=="1"?true:
false;var pvlaunch=Ext.getCmp("wvspvlaunch");if(WVSPopup.pvaction=="1"){pvlaunch.setIcon("netmarkets/images/creo_view.png");pvlaunch.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_OPEN_IN_PRODUCTVIEW"));pvlaunch.enable()}else if(WVSPopup.pvaction=="2"){pvlaunch.setIcon("wt/clients/images/wvs/publisher.gif");pvlaunch.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_PUBLISH"));pvlaunch.enable()}else if(WVSPopup.pvaction=="3"){if(WVSPopup.type=="epmdocument")pvlaunch.setIcon("netmarkets/images/creo_view.png");
else pvlaunch.setIcon("wt/clients/images/wvs/partstruct.gif");pvlaunch.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_OPEN_STRUCTURE_IN_PV"));pvlaunch.enable()}else if(WVSPopup.pvaction=="4"){pvlaunch.setIcon("wt/clients/images/wvs/generic.gif");pvlaunch.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_OPEN_DOCUMENT_IN_PV"));pvlaunch.enable()}else if(WVSPopup.pvaction=="5"){pvlaunch.setIcon("netmarkets/images/creo_view.png");pvlaunch.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_ADDTOPV_VIEW"));
pvlaunch.enable()}else if(WVSPopup.pvaction=="0"){pvlaunch.setIcon("netmarkets/images/creo_view.png");pvlaunch.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_OPEN_IN_PRODUCTVIEW"));pvlaunch.disable()}else if(WVSPopup.pvaction=="-1"){pvlaunch.setIcon("wt/clients/images/wvs/publisher_notpublishable.gif");pvlaunch.setTooltip(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_NOT_PUBLISHABLE"));pvlaunch.disable()}if(view.getAttribute("details")=="1")Ext.getCmp("wvsdetails").enable();
else Ext.getCmp("wvsdetails").disable();var copyicon=Ext.getCmp("wvscopy");var associcon=Ext.getCmp("wvspartdoc");if(WVSPopup.type.indexOf("clash")===0){copyicon.disable();associcon.disable()}else{copyicon.enable();if(!WVSPopup.assocoid)associcon.disable();else{associcon.enable();associcon.setTooltip(WVSPopup.type=="wtpart"?bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_DISPLAY_CAD"):bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_DISPLAY_PART"))}}}
WVSPopup.updateRelatedMiniTable=function(xmlDoc){var refs=xmlDoc.getElementsByTagName("ref");var relatedPanel=Ext.getCmp("tbn_nav_related");var thumbNailNavPanel=Ext.getCmp("thumbNailNavPanel");if(refs&&refs.length>0){if(!relatedPanel){var related={id:"tbn_nav_related",collapsible:true,autoHeight:true,height:"auto",autoScroll:true,title:bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_RELATED"),xtype:"panel"};thumbNailNavPanel.add(related);thumbNailNavPanel.doLayout();relatedPanel=Ext.getCmp("tbn_nav_related")}relatedPanel.body.update(MTaddDependencies(refs,
bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_RELATED"),"1",relatedPanel))}else if(relatedPanel)thumbNailNavPanel.remove(relatedPanel)};
WVSPopup.updateNavigateThumbnailsMiniTables=function(xmlDoc){var iConfig=Ext.getCmp("MTWindow").getInfoConfig();if(typeof iconfig==="undefined"||iconfig.data.showNavigateThumbnails){var whereUsedPanel=Ext.getCmp("tbn_nav_whereUsed");if(whereUsedPanel)whereUsedPanel.body.update(MTaddDependencies(xmlDoc.getElementsByTagName("parent"),bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_WHERE_USED"),"1",whereUsedPanel));var usesPanel=Ext.getCmp("tbn_nav_uses");if(usesPanel)usesPanel.body.update(MTaddDependencies(xmlDoc.getElementsByTagName("child"),
bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_USES"),"0",usesPanel));WVSPopup.updateRelatedMiniTable(xmlDoc)}else Ext.getCmp(PTC.miniNavigator.cardManager).layout.setActiveItem(1)};
WVSPopup.updateThumbInfo=function(xmlDoc){var thumbnail=null;var thumbnail3d=null;var val=xmlDoc.getElementsByTagName("twod");if(val&&val.length===1)thumbnail=val[0].firstChild.nodeValue;var td=xmlDoc.getElementsByTagName("threed");if(td&&td.length===1)thumbnail3d=td[0].firstChild.nodeValue;var view=xmlDoc.getElementsByTagName("view")[0];if(!view)return false;MTaddData(view);if(WVSPopup.type.indexOf("clash_")===0&&WVSPopup.use3D)WVSPopup.show3D=true;MTsetViewer(thumbnail,thumbnail3d);WVSPopup.updateNavigateThumbnailsMiniTables(xmlDoc);
return true};
WVSPopup.mouseHide=function(event){if(!WVSPopup.win)return;var pos=WVSPopup.win.getPosition(false);var width=WVSPopup.win.getWidth();var height=WVSPopup.win.getHeight();var xout=event.clientX<pos[0]||event.clientX>pos[0]+width;var yout=event.clientY<pos[1]||event.clientY>pos[1]+height;if(xout)PTC.miniNavigator.log.trace("x is out (min, max, actual)",pos[0],pos[0]+width,event.clientX);if(yout)PTC.miniNavigator.log.trace("y is out (min, max, actual)",pos[1],pos[1]+height,event.clientY);var hasMenuParent=
Ext.fly(event.target||event.srcElement).parent(".x-menu");try{if((xout||yout)&&!hasMenuParent)WVSPopup.hide(event)}catch(e){}};WVSPopup.hide=function(event){PTC.miniNavigator.abortPendingRequests();if(!WVSPopup.win)return;WVSPopup.win.hide();WVSPopup.hideStatus();var rightmenu=Ext.getCmp("wvsrightmenu");if(rightmenu)rightmenu.hide();WVSPopup.unpinit();WVSPopup.unstickit();WVSRemoveEvent(document,"mousedown",WVSPopup.mouseHide);PTC.navigation.un("historyChange",WVSPopup.onPageChange)};
WVSPopup.onPageChange=function(url){WVSPopup.hide();return true};WVSPopup.mousein=function(){MTswitchTo3D();if(!WVSPopup.pinned)WVSRemoveEvent(document,"mousedown",WVSPopup.mouseHide)};WVSPopup.mouseout=function(){if(!WVSPopup.pinned&&WVSPopup.win.isVisible())WVSAddEvent(document,"mousedown",WVSPopup.mouseHide)};
WVSPopup.startDrag=function(event){if(WVSPopup.win.getEl().dom.style.cursor==="move")return;WVSPopup.win.getEl().dom.style.cursor="move";WVSPopup.dragx=event.clientX;WVSPopup.dragy=event.clientY;WVSAddEvent(document,"mousemove",WVSPopup.doDrag);WVSAddEvent(document,"mouseup",WVSPopup.endDrag);WVSPopup.hideStatus();WVSPopup.pinit()};
WVSPopup.doDrag=function(event){var x=event.clientX;var y=event.clientY;var pos=WVSPopup.win.getPosition(false);var newx=pos[0]+x-WVSPopup.dragx;var newy=pos[1]+y-WVSPopup.dragy;WVSPopup.dragx=x;WVSPopup.dragy=y;WVSPopup.win.setPagePosition(newx,newy)};WVSPopup.endDrag=function(event){WVSPopup.win.getEl().dom.style.cursor="default";WVSRemoveEvent(document,"mousemove",WVSPopup.doDrag);WVSRemoveEvent(document,"mouseup",WVSPopup.endDrag)};
PTC.miniNavigator.showWidgetPane=function(event,target){WVSPopup.mousein();PTC.miniNavigator.loadRelatedWidgets();var cardManager=Ext.getCmp(PTC.miniNavigator.cardManager);cardManager.layout.setActiveItem(1);Ext.getCmp(PTC.miniNavigator.menuTitleID).setText(target.text);cardManager.doLayout();return false};
PTC.miniNavigator.showNavPane=function(event,target){WVSPopup.mousein();Ext.getCmp(PTC.miniNavigator.cardManager).layout.setActiveItem(0);Ext.getCmp(PTC.miniNavigator.menuTitleID).setText(target.text);return false};
PTC.miniNavigator.menuSuccess=function(response){var actionModel=Ext.decode(response.responseText);var menu=Ext.getCmp(PTC.miniNavigator.menuTitleID).menu;menu.initializeMenu(actionModel);if(menu.isVisible())menu.positionMenu();menu.on("afterlayout",function(menu){menu.items.each(function(menuItem){menuItem.el.on("mouseover",WVSPopup.mousein)})})};PTC.miniNavigator.url=getBaseHref()+"ptc1/tcomp/miniInfoPage?u8=1&portlet=component";
PTC.miniNavigator.updateVisPanel=function(){var iConfig=Ext.getCmp("MTWindow").getInfoConfig();var visPanel=Ext.getCmp("vis_img_panel");var visPanelVisible=visPanel.getEl().isVisible();var openInCreoViewButton=Ext.getCmp("wvspvlaunch");var copyButton=Ext.getCmp("wvscopy");var partDocButton=Ext.getCmp("wvspartdoc");if(iConfig.data.showVisualization&&!visPanelVisible){visPanel.show();openInCreoViewButton.show();copyButton.show();partDocButton.show()}else if(!iConfig.data.showVisualization&&visPanelVisible){visPanel.hide();
openInCreoViewButton.hide();copyButton.hide();partDocButton.hide()}};PTC.miniNavigator.renderPanels=function(response){var config=Ext.util.JSON.decode(response.responseText.trim());this.setInfoConfig(config);var identity=PTC.infoPage.getIdentityHTML(config);var titleCmp=Ext.getCmp("titleText");titleCmp.setText("");titleCmp.getEl().dom.innerHTML=identity;PTC.miniNavigator._renderAttrPanel(config.attributePanelModel);PTC.miniNavigator.configureRightPane();PTC.miniNavigator.renderRelatedInfo();PTC.miniNavigator.updateVisPanel()};
PTC.miniNavigator.configureRightPane=function(){var iConfig=Ext.getCmp("MTWindow").getInfoConfig();var cardManager=Ext.getCmp(PTC.miniNavigator.cardManager);if(iConfig.data.showNavigateThumbnails&&!iConfig.data.showRelatedInfo)Ext.getCmp(PTC.miniNavigator.cardManager).layout.setActiveItem(0);else if(!iConfig.data.showNavigateThumbnails&&iConfig.data.showRelatedInfo)Ext.getCmp(PTC.miniNavigator.cardManager).layout.setActiveItem(1);PTC.miniNavigator.resetMenuButton(iConfig,iConfig.tabSet.items[1].components.items)};
PTC.miniNavigator.renderRelatedInfo=function(){var iConfig=Ext.getCmp("MTWindow").getInfoConfig();var relatedInfo=iConfig.tabSet.items[1];if(iConfig.data.showRelatedInfo){var portalCol=PTC.miniNavigator.getRelatedInfoPortalColumn();portalCol.oid=relatedInfo.oid;portalCol.tabSetKey=iConfig.tabSet.tabSetKey;portalCol.objectType=iConfig.tabSet.objectType;PTC.miniNavigator.getRelatedInfoPanels(iConfig,relatedInfo.components.items);PTC.miniNavigator.getRelatedInfoPortalColumn().show()}};
PTC.miniNavigator._renderAttrPanel=function(attributePanelModel){if(WVSPopup.attrPanel){WVSPopup.attrPanel.destroy(true);var panel=Ext.getCmp("vis_atts_panel");panel.getEl().update(panel.initialConfig.html)}attributePanelModel.useExistingDUniqueDivs=false;attributePanelModel.forceAutoWidth=true;WVSPopup.attrPanel=new PTC.attributePanel.AttributePanel(attributePanelModel)};
PTC.miniNavigator.getAndDisplayNavConfig=function(oid){var url=PTC.miniNavigator.url+"&oid="+oid;PTC.miniNavigator.doRequest(url,{method:"get",onSuccess:PTC.miniNavigator.renderPanels.bind(Ext.getCmp("MTWindow")),onError:WVSPopup.failure})};PTC.miniNavigator.get3DThumbnail=function(){return Ext.getDom("ccol_div")};PTC.miniNavigator.get2DThumbnail=function(){return Ext.getDom("ccol_img")};PTC.miniNavigator.getDynamicDocThumbnail=function(){return Ext.getCmp("dyn_doc_panel")};
PTC.miniNavigator.getThumbnailWidth=function(){var thumbnailPanel=Ext.getCmp("vis_img_panel");var width=thumbnailPanel?thumbnailPanel.body.dom.style.width:"288px";return width};PTC.miniNavigator.getThumbnailHeight=function(){var thumbnailPanel=Ext.getCmp("vis_img_panel");var height=thumbnailPanel?thumbnailPanel.body.dom.style.height:"218px";return height};
PTC.miniNavigator.adjustThumbnailSize=function(resizablePanel,new_width,new_height){if(PTC.miniNavigator.collapsed)return;var width,height;var thumbnailPanel=Ext.getCmp("vis_img_panel");PTC.miniNavigator.setAttributePanelHeight();if(!thumbnailPanel||typeof new_width==="undefined"||new_width<0)return;thumbnailPanel=thumbnailPanel.body.dom;var tpEl=Ext.get(thumbnailPanel);var currentSize=tpEl.getSize();var width_to_use=currentSize.width;if(width_to_use<=0)width_to_use=PTC.miniNavigator._oldBodyWidth;
var height_to_use=currentSize.height;if(height_to_use<=0)height_to_use=PTC.miniNavigator._oldBodyHeight;var ratio=new_width/parseInt(width_to_use,10);if(isNaN(ratio)||!isFinite(ratio))return;width=Math.round(ratio*parseInt(width_to_use,10));height=Math.round(ratio*parseInt(height_to_use,10));tpEl.setSize(width,height);var threeD_thumbnail=PTC.miniNavigator.get3DThumbnail();if(threeD_thumbnail){var threeDEl=Ext.get(threeD_thumbnail);threeDEl.setSize(width,height)}var twoD_thumbnail=PTC.miniNavigator.get2DThumbnail();
if(twoD_thumbnail){var twoDEl=Ext.get(twoD_thumbnail);twoDEl.setSize(width,height)}var dynDoc_thumbnail=PTC.miniNavigator.getDynamicDocThumbnail();if(dynDoc_thumbnail)dynDoc_thumbnail.setSize(width,height)};
PTC.miniNavigator.visPanelCollapse=function(){PTC.miniNavigator._oldBodyHeight=this.body.getHeight();PTC.miniNavigator._oldBodyWidth=this.body.getWidth();PTC.miniNavigator.adjustThumbnailSize(Ext.getCmp("vis"),0);PTC.miniNavigator.collapsed=true;this.collapsed=true;this.header.addClass(this.collapsedCls);return false};
PTC.miniNavigator.visPanelExpand=function(){if(typeof PTC.miniNavigator._oldBodyHeight!=="undefined"){PTC.miniNavigator.collapsed=false;this.collapsed=false;PTC.miniNavigator.adjustThumbnailSize(Ext.getCmp("vis"),this.container.getWidth());this.header.removeClass(this.collapsedCls)}};PTC.miniNavigator.is3dPluginPresent=function(){return typeof document.mtpvctl!=="undefined"};
PTC.miniNavigator.contextMenuEventHandler=function contextMenuEventHandler(evt,evtTarget){if(evt!==null){var relatedCmp=PTC.miniNavigator.getRelatedInfoPortalColumn();var panels=relatedCmp.items;for(var i=0,l=panels.length;i<l;i++){var relatedSubPanels=panels.items;for(var j=0,m=relatedSubPanels.length;j<m;j++){var miniTables=relatedSubPanels[j].items.items;for(var k=0,n=miniTables.length;k<n;k++){var miniTable=miniTables[k];PTC.jca.clearSelectedMiniTableRowHighlight(evtTarget,miniTable)}}}evt.stopEvent()}};
PTC.miniNavigator.onAfterLayout=function(relatedCmp){relatedCmp.mun(relatedCmp.getEl(),"contextmenu",PTC.miniNavigator.contextMenuEventHandler);relatedCmp.mon(relatedCmp.getEl(),"contextmenu",PTC.miniNavigator.contextMenuEventHandler)};PTC.miniNavigator.isRelatedWidgetPaneOpen=function(){var cardManager=Ext.getCmp(PTC.miniNavigator.cardManager);return cardManager.layout.activeItem.id===PTC.miniNavigator.relatedInformation};
PTC.miniNavigator.resetMenuButton=function(config,itemArr){var menuButton=Ext.getCmp(PTC.miniNavigator.menuTitleID);if(itemArr===undefined||itemArr===null||itemArr.length<=0){menuButton.hide();var target={};target.text=menuButton.defaultText;PTC.miniNavigator.showNavPane(null,target)}else if(config.data.showRelatedInfo&&config.data.showNavigateThumbnails){menuButton.enable();menuButton.show()}else{menuButton.disable();if(config.data.showNavigateThumbnails)menuButton.setText(menuButton.menu.items.items[0].text);
else menuButton.setText(menuButton.menu.items.items[1].text);menuButton.show()}};
PTC.miniNavigator._loadRelatedWidgets=function(actionItems){function param(key,value){return"&"+key+"="+value}var endIndex=PTC.debug.isJCADebug()?actionItems.length-1:actionItems.length;for(var i=0;i<endIndex;i++){var item=actionItems[i];var requestURL=item.actionURL+param("itemIndex",i)+param("actionName",item.actionName);requestURL+=param("actionType",item.actionType)+param("collapse",item.collapse);var options={method:"get",asynchronous:true,onSuccess:PTC.miniNavigator.renderRelatedInfoPanels};
PTC.miniNavigator.doRequest(requestURL,options)}};PTC.miniNavigator.loadRelatedWidgets=function(){var relatedCmp=PTC.miniNavigator.getRelatedInfoPortalColumn();if(relatedCmp.needsLoad===true){relatedCmp.needsLoad=false;relatedCmp.on("add",PTC.miniNavigator.sortPortals);PTC.miniNavigator._loadRelatedWidgets(relatedCmp.actionItems)}};
PTC.miniNavigator.getRelatedInfoPanels=function(config,relatedInfoItems){var relatedCmp=PTC.miniNavigator.getRelatedInfoPortalColumn();relatedCmp.removeAll(true);relatedCmp.needsLoad=true;relatedCmp.actionItems=relatedInfoItems;if(PTC.miniNavigator.isRelatedWidgetPaneOpen())PTC.miniNavigator.loadRelatedWidgets();relatedCmp.on("afterlayout",PTC.miniNavigator.onAfterLayout)};
PTC.miniNavigator.renderRelatedInfoPanels=function(response){PTC.miniNavigator.log.debug("Processing response for related info url: ",response.request.url);var configAndData=Ext.decode(response.responseText.trim());var config=configAndData.config;config.totalRows=configAndData.data.length;config.initialRows=configAndData.data;PTC.miniNavigator.createRelatedInfoPanels(configAndData.config);var relatedCmp=PTC.miniNavigator.getRelatedInfoPortalColumn();if(relatedCmp)relatedCmp.doLayout()};
PTC.miniNavigator.getMiniTableTitleBar=function(tableName,count){return"<div class='miniTableCount'>"+count+"</div>"+"<div class='miniTableTitle' ext:qtip='"+tableName+"'>"+tableName+"</div>"};PTC.miniNavigator.isMiniTableCollapsed=function(jcaTableConfig){var isCollapsed=jcaTableConfig.collapse;if(isCollapsed===undefined)isCollapsed=jcaTableConfig.totalRows===undefined||jcaTableConfig.totalRows===0;return isCollapsed};
PTC.miniNavigator.createRelatedInfoPanels=function(jcaTableConfig){var relatedPanel=PTC.miniNavigator.getRelatedInfoPortalColumn();var jcaDebugInfo=PTC.debug.getJCADebugHTML(jcaTableConfig);var miniTableName=jcaTableConfig.tableName;var miniTableCount=PTC.jca.miniTableCountMsg(jcaTableConfig.totalRows)+jcaDebugInfo;var isCollapsed=PTC.miniNavigator.isMiniTableCollapsed(jcaTableConfig);var relatedSubPanelConfig={xtype:"miniNavPortlet",id:"relatedObjs"+jcaTableConfig.tableID,title:PTC.miniNavigator.getMiniTableTitleBar(miniTableName,
miniTableCount),itemIndex:jcaTableConfig.itemIndex,actionName:jcaTableConfig.actionName,actionType:jcaTableConfig.actionType,collapsed:isCollapsed,items:[jcaTableConfig]};PTC.miniNavigator.log.trace("inserting minitable "+jcaTableConfig.tableID);relatedPanel.add(relatedSubPanelConfig)};
PTC.miniNavigator.showMenu=function(target,event){var params={context:"object$miniNavigator$"+WVSPopup.oid+"$"+WVSPopup.oid+"!*",oid:WVSPopup.oid,tableID:"MTWindow",actionName:"actionsMenu"};PTC.menu.showActionsMenu(event,params)};
PTC.miniNavigator.onAfterAction=function(formResult){var result=false;if(formResult&&formResult.U&&formResult.U[WVSPopup.oid])WVSPopup.show(formResult.U[WVSPopup.oid][0],-1,-1,true,false,false);else if(formResult&&formResult.Del&&formResult.Del[WVSPopup.oid])WVSPopup.hide();else{MTrefresh();if(formResult.js&&formResult.js.length>1||formResult.URL&&formResult.URL.length>1)result=true}return result};PTC.miniNavigator.onShowHideMenu=function(){var menu=Ext.getCmp("gridRowContextMenu");if(menu)menu.hide()};
PTC.jca.MiniTableSelectedRowStyle="ptc-grid-row-focus";PTC.jca.clearSelectedMiniTableRowHighlight=function(clickedItem,miniTable){var tableFoos=miniTable.items.items;for(var i=0,l=tableFoos.length;i<l;i++){var tableFoo=tableFoos[i];var tableRows=tableFoo.all.elements;for(var j=0,m=tableRows.length;j<m;j++){var tableRow=tableRows[j];var needClear=true;var ancestors=clickedItem.ancestors();for(i=0,n=ancestors.length;i<n;i++){var ancestor=ancestors[i];if(tableRow==ancestor){needClear=false;break}}if(needClear)Ext.get(tableRow).removeClass(PTC.jca.MiniTableSelectedRowStyle)}}};
PTC.jca.MiniTable=function(jcaTableConfig){var store=this._createStore(jcaTableConfig);store.loadData({total:jcaTableConfig.totalRows,rows:jcaTableConfig.initialRows});var miniTableInternalTpl=new Ext.XTemplate('<div style="display: none" class="x-list-header"><div class="x-list-header-inner">','<tpl for="columns">','<div style="width:{[values.width*100]}%;text-align:{align};"><em unselectable="on" id="',jcaTableConfig.tableID,'-xlhd-{#}">',"{header}","</em></div>","</tpl>",'<div class="x-clear"></div>',
"</div></div>",'<div class="x-list-body"><div class="x-list-body-inner">',"</div></div>");var miniTableTpl=new Ext.XTemplate('<table class="miniTable" cellpadding="0" cellspacing="0">','<tpl for=".">','<tpl for="rows">','<tr class="x-miniTable-row-class">','<tpl for="parent.columns">',"<td",' class="miniTable_{[values.id]}">{[this.miniTableJSCACellRenderer(parent, values.dataIndex) ]}</td>',"</tpl>","</tr>","</tpl>","</tpl>","</table>",{miniTableJSCACellRenderer:function(data,columnId){var jsca_value=
"";var jsca_row={item:data};jsca_row.get=function(id){return data[id]};var jsca_col={id:columnId};this.id=columnId+"_miniTable";if(data===undefined)return jsca_value;var jsca_renderer=data.renderer||jsca.columns.simpleRenderer;if(typeof jsca_renderer==="string")jsca_renderer=PTC.util.convertStringToFunc(jsca_renderer);if(typeof jsca_renderer==="function")jsca_value=jsca_renderer(this,jsca_col,jsca_row);return jsca_value}});var listView=new Ext.list.ListView({store:store,id:jcaTableConfig.tableID+
"_listView",columns:jcaTableConfig.currentColumnModel.gridColumnModel,tpl:miniTableTpl,internalTpl:miniTableInternalTpl,itemSelector:"tr.x-miniTable-row-class"});listView.on("contextmenu",function(dataView,index,nodeElement,evt){if(!evt.hasModifier()){Ext.get(nodeElement).addClass(PTC.jca.MiniTableSelectedRowStyle);PTC.util._setMainFormStartingElement(dataView.el.id);var row=dataView.store.getAt(index);var params=PTC.menu._constructParams(row,dataView);PTC.menu.showActionsMenu(evt,params,row)}});
var config={items:listView,border:false,id:jcaTableConfig.tableID+"_listViewPanel"};PTC.jca.MiniTable.superclass.constructor.call(this,config)};
Ext.extend(PTC.jca.MiniTable,Ext.Panel,{_createStore:function(jcaTableConfig){var storeFields=jcaTableConfig.currentColumnModel.storeFields;var rowRecord=Ext.data.Record.create(storeFields);var httpReader=new PTC.jca.WJsonReader({totalProperty:"total",root:"rows"},rowRecord);var rowStore=new Ext.data.GroupingStore({proxy:new Ext.data.HttpProxy(jcaTableConfig.storeURL),baseParams:jcaTableConfig.storeURL.params,reader:httpReader});return rowStore}});Ext.ComponentMgr.registerType("jcaMiniTable",PTC.jca.MiniTable);
PTC.jca.miniTableCountMsg=function(totalRows){var totalObjsMsgTemplate=new Template(bundleHandler.get("com.ptc.core.ui.tableRB.TABLE_DISPLAYED_LOAD_COMPLETE_MESSAGE"));var totalObjsMsg=totalObjsMsgTemplate.evaluate({total:totalRows});return"("+totalObjsMsg+")"};
PTC.jca.miniTableTitleBar=function(barConfig){var tableID=barConfig.tableID;var expandButton=new Ext.Button({id:tableID+"_toggle",tableid:tableID,cls:"tableToggle",iconCls:"expandCollapse_collapsed",tooltip:bundleHandler.get("com.ptc.netmarkets.util.utilResource.COLLAPSE_TABLE"),handler:PTC.jca.expandCollapseMiniTable});var items=[expandButton,{xtype:"tbtext",text:barConfig.tableName}];items.push("->");var formattedTxt=' <span class="tableCount">'+PTC.jca.miniTableCountMsg(barConfig.totalRows)+"</span> ";
items.push({itemId:"titleMessageCount",xtype:"tbtext",text:formattedTxt});Ext.apply(barConfig,{id:tableID+".titleBar",items:items});PTC.jca.miniTableTitleBar.superclass.constructor.call(this,barConfig)};Ext.extend(PTC.jca.miniTableTitleBar,Ext.Toolbar);
PTC.jca.expandCollapseMiniTable=function(button,event){var miniTable=Ext.getCmp("myStuffPanel");if(miniTable!==undefined){var panels=[miniTable.body];if(miniTable.jcaCollapsed){miniTable.el.removeClass(this.collapsedCls);panels.each(function(panel){if(panel!==undefined)if(panel.dom)panel.dom.style.display="block";else panel.show()});miniTable.jcaCollapsed=false;button.setIconClass("expandCollapse_collapsed");button.setTooltip(bundleHandler.get("com.ptc.netmarkets.util.utilResource.COLLAPSE_TABLE"))}else{panels.each(function(panel){if(panel!==
undefined)if(panel.dom)panel.dom.style.display="none";else panel.hide()});miniTable.jcaCollapsed=true;button.setIconClass("expandCollapse_expanded");button.setTooltip(bundleHandler.get("com.ptc.netmarkets.util.utilResource.EXPAND_TABLE"))}}};PTC.jca.renderMiniTable=function(jcaTableConfig){jcaTableConfig.renderTo=tableUtils.getFormattedTableId(jcaTableConfig.tableID);return Ext.ComponentMgr.create(jcaTableConfig,"jcaMiniTable")};function popupErrorDialog(msg){wfalert(msg)}
function switchTLNContent(theURL,doAsynch){if(theURL.indexOf("http")<0&&theURL.indexOf("/")!==0)theURL="/"+theURL;var type=extractParamValue(theURL,"tlnType");var action=extractParamValue(theURL,"tlnAction");var id="tlnContentArea_"+type+action;var actionConfig={id:id,actionURL:theURL,text:action};var title=actionConfig.text;PTC.infoPage.addThirdLevelNavTab(actionConfig);return false}
function getUpdateOpenerWindow(){try{if(opener)return opener.top.window;else return top.window}catch(e){return top.window}}function isResultOfPost(){var mform=this.getMainForm();return mform.nmwindowname.value!=="none"}function onResizeWindow(){if(isWizardType)adjustWizardContentAreaHeight();else if(window.location.href.indexOf("portlet=poppedup")>=0)PTC.jca.table.Utils.adjustTableHeight();truncateWizardTitle()}onResizeWindow=PTC.util.delayAllCalls(onResizeWindow,50);
function resizeWindow(bigger){var deltaWidth=100;var deltaHeight=100;if(!bigger){deltaWidth*=-1;deltaHeight*=-1}window.resizeBy(deltaWidth,deltaHeight)}
function getSelectedContext(){var oidString="nothing selected";var sels=getSelectedItems();if(sels){var alength=sels.length;if(alength>1){JCAAlert("com.ptc.netmarkets.util.utilResource.TOO_MANY_SELECTED");return false}else if(sels.length==1)oidString=sels[0].value}if(oidString!=="nothing selected"&&!PTC.util.isAFolder(oidString)){JCAAlert("com.ptc.netmarkets.util.utilResource.NO_FOLDER_SELECTED");return null}return oidString}
function getPopupOpenerWindow(){if(PTC.lightbox.isLightbox(window))return window.parent;else return window.opener}function switchTab(tab){if(callUserSubmitFunction()){clearActionFormData();clearDialogFormData();var formAction=PTC.util.getFormAction(getMainForm());formAction+="&"+"com.ptc.netmarket.tab="+tab;PTC.util.setFormAction(getMainForm(),formAction);PTC.navigation.submitForm()}}function closePopup(){wfWindowClose1()}function WaitAndClose(){wfWindowClose1.defer(3E3)}wfWindowClose1=function(){wfWindowClose()};
function wfWindowCloseMore(){if(document.location.href.indexOf("more.jsp")>0)wfWindowClose()}function wfWindowCloseMyWindow(myWindow){if(isWf())myWindow.wfWindowClose();else myWindow.close()}function setInputFieldValue(val,elementId){var element=document.getElementById(elementId);element.value=val}
function setSelectedOption(selectedElementVal,elementId){var select=document.getElementById(elementId);var select_options_length=select.options.length;for(var i=0;i<select_options_length;i++)if(select.options[i].value==selectedElementVal)select.options[i].selected=true;else select.options[i].selected=false}
function sizeToContent(frame,buffer_size,check_viz){var flipViz=false;var xbody=frame.contentWindow.document.body;if(!xbody)return;if(check_viz===true)if(!$("attributesPanelWrapper").visible())flipViz=true;if(flipViz)$("attributesPanelWrapper").toggle();var height=xbody.offsetHeight>xbody.scrollHeight?xbody.offsetHeight:xbody.scrollHeight;var width=xbody.offsetWidth>xbody.scrollWidth?xbody.offsetWidth:xbody.scrollWidth;if(flipViz)$("attributesPanelWrapper").toggle();var delta=0;if(!frame.deltaAdded){frame.deltaAdded=
true;delta=typeof buffer_size==="number"?buffer_size:50}else if(frame.height!=height)delta=50;frame.height=height+delta;frame.width=width+delta;frame.scrolling="auto"}function originalBackgroundSBRow(elems,originalBackground){try{if(elems!==null){var elems_length=elems.length;for(var i=0;i<elems_length;i++)originalBackground.push(elems[i].style.backgroundColor)}}catch(e){}}
function highlightSBRow(elems,color){try{if(elems!==null){var elems_length=elems.length;for(var i=0;i<elems_length;i++)elems[i].style.backgroundColor=color}}catch(e){}}function restoreBackgroundSBRow(elems,originalBackground){try{if(elems!==null){var elems_length=elems.length;for(var i=0;i<elems_length;i++)elems[i].style.backgroundColor=originalBackground[i]}}catch(e){}}
function sizeAndScrollSBIntoView(frame,rowToScrollTo,formName){var noHighlight=false;var form=frame.contentWindow.document.forms[formName];if(rowToScrollTo===null)if(form!==undefined)rowToScrollTo=form.rowToScrollto.value;if(rowToScrollTo!==null&&rowToScrollTo!==undefined){var index=rowToScrollTo.indexOf("|");if(index>=0){rowToScrollTo=rowToScrollTo.substring(0,index);noHighlight=true}}sizeToContent(frame);var elem=frame.contentWindow.document.getElementById(rowToScrollTo);if(rowToScrollTo!==""&&
elem!==null){var parentElem=elem.parentNode;var parent=parentElem.parentNode;parentElem.scrollIntoView();parentElem.focus();if(parent!==null&&!noHighlight){var elems=parent.getElementsByTagName("*");var originalBackground=[];originalBackgroundSBRow(elems,originalBackground);var color="#FFFF99";highlightSBRow(elems,color);var highlightFn=function(){restoreBackgroundSBRow(elems,originalBackground)};setTimeout(highlightFn,2E3)}}}
function setLocation(){var mform=this.getMainForm();if(mform&&mform.xposition!==undefined){var xpos=Browser.getX();var ypos=Browser.getY();if(xpos>0&&ypos>0){mform.xposition.value=xpos;mform.yposition.value=ypos}}}PTC.help={};PTC.help.openHelpWindow=function(helpUrl){var helpWindow=window.open(helpUrl,"HelpWindow","toolbar=yes,location=yes,directories=yes,status=yes,menubar=yes,scrollbars=yes,resizable=yes");helpWindow.focus()};
PTC.help.createHelpButtonConfigForSelector=function(selector){var helpModel={selector:selector};var baseurl=PTC.properties.getWTProperty("wt.whc.url");helpModel.url=baseurl+"/"+selector+".html";return PTC.help.getHelpButtonConfig(helpModel)};PTC.help.getHelpButtonConfig=function(helpModel){PTC.help.getCustomHelpCenterURL(helpModel);if(helpModel.url){Ext.applyIf(helpModel,{iconCls:"helpButton",handler:function(){PTC.help.openHelpWindow(helpModel.url)},xtype:"button",cls:"help"});return helpModel}else return null};
PTC.help.getCustomHelpCenterURL=function(helpModel){if(helpModel.selector){var wtproperty;try{var currentWindow=getWindow();while(!wtproperty&&currentWindow){wtproperty=extractParamValue(currentWindow.location.href,"helpCenter");currentWindow=currentWindow.opener}}catch(e){PTC.log.debug("Error trying to find helpCenter param, so just assume its undefined.",e)}var url=null;if(wtproperty){url=PTC.properties.getWTProperty(wtproperty);if(url)helpModel.url=url+"/"+helpModel.selector+".html"}}};
PTC.help.helpButton=function(helpModel){var helpButton=PTC.help.getHelpButtonConfig(helpModel);if(helpButton)var helpPanel=new Ext.Panel({renderTo:"help_viewport",header:false,border:false,items:[helpButton]})};PTC.help.contactPubs=function(){var url="mailto:documentation@ptc.com?subject=Windchill Help";var newWindow=window.open(url,"windchillMailTo","resizable=yes,scrollbars=yes,menubar=yes,toolbar=yes,location=yes,status=yes");if(newWindow)newWindow.close()};PTC.properties={};
PTC.properties.getWTProperty=function(property){var propertyVal=PTC.attributeHelper.get("WTProperties."+property);if(propertyVal===undefined){var propsurl="ptc1/WTProperties/";var options={method:"get",asynchronous:false,parameters:"?property="+property,onSuccess:function(response){propertyVal=response.responseText;PTC.attributeHelper.set("WTProperties."+property,propertyVal)}};var request=requestHandler.doRequest(propsurl,options)}return propertyVal};PTC.event={};
PTC.event.fireEvent=function(element,eventName){var evt;if(document.createEventObject){evt=document.createEventObject();return element.fireEvent("on"+eventName,evt)}else{evt=document.createEvent("HTMLEvents");evt.initEvent(eventName,true,true);return!element.dispatchEvent(evt)}};
PTC.event.fireMouseEvent=function(item){if(is_ie){var evtObj=document.createEventObject();item.fireEvent("onclick",evtObj)}else{var evt=document.createEvent("MouseEvents");evt.initMouseEvent("click",true,true,window,1,1,1,1,1,false,false,false,false,0,item);item.dispatchEvent(evt)}};
if(!("handleSuccesfullTaskRetry"in window))handleSuccesfullTaskRetry=function(taskId){if(isWf()){var url=getBaseHref()+"ptc1/dataops/taskState?taskId="+encodeURIComponent(taskId);var options={method:"get",asynchronous:true,onSuccess:function(transport){if(transport.status==200||transport.status===0){var responseDoc=transport.responseText.trim();var dataObj=Ext.util.JSON.decode(responseDoc);if(dataObj&&dataObj.isServerRegistered&&dataObj.taskType&&dataObj.taskType==="wt.dataops.delete.DeleteTask"){if(!("synchronizeWS"in
window))PTC.navigation.loadScript("templates/uwgm/cadx/ws/wsTable.js");synchronizeWS()}}}};requestHandler.doRequest(url,options)}PTC.navigation.reload()};
PTC.event.preventBackspaceKeyFromNavigatingBack=function(event){var e=window.event||event;if(e.keyCode===8||e.keyCodeVal&&e.keyCodeVal===8){var d=e.srcElement||e.target;if(d.tagName.toUpperCase()=="HTML"||d.tagName.toUpperCase()=="BODY"||d.tagName.toUpperCase()=="DIV"||d.tagName.toUpperCase()=="A"||d.tagName.toUpperCase()=="TD"||d.tagName.toUpperCase()=="BUTTON"||d.tagName.toUpperCase()=="INPUT"&&d.readOnly){if(e.preventDefault)e.preventDefault();e.returnValue=false}}};document.onkeydown=PTC.event.preventBackspaceKeyFromNavigatingBack;
PTC.mobile={};PTC.mobile.MOBILE_REDIRECT_COOKIE="Redirect2MobileApp";PTC.mobile.isMobileRequest=function(){var useragent=navigator.userAgent;return useragent.match(/iPhone|iPad|Android/)!==null};PTC.mobile.setRedirectCookie=function(enable){var exDate=new Date;exDate.setDate(exDate.getDate()+180);var redirectCookie=PTC.mobile.MOBILE_REDIRECT_COOKIE+"="+enable+"; path=/; expires="+exDate.toGMTString();document.cookie=redirectCookie};
PTC.mobile.redirectToMobileApp=function(){var params=PTC.util.extractAllParams(window.location.href);window.location=PTC.mobile.getRoute("info","home","oid="+params.oid)};PTC.mobile.getRoute=function(controller,action,extraParams){var baseURL=getBaseHref();var route="windchill"+baseURL.substring(baseURL.indexOf(":"),baseURL.length-1)+"?controller="+controller;if(action)route=route+"&action="+action;else route=route+"&action=home";if(extraParams)route=route+"&"+extraParams;return route};
PTC.mobile.isTablet=function(){if(navigator.userAgent.match(/iPad/)!==null)return true;if(navigator.userAgent.match(/Android/)!==null&&navigator.userAgent.match(/Mobile/)===null)return true;return false};PTC.mobile.confirm=function(title,msg,fn,scope){Ext.Msg.confirm(title,msg,fn,scope);PTC.mobile.adjustDialogSize(PTC.mobile.isTablet())};
PTC.mobile.adjustDialogSize=function(isTablet){var dialog=Ext.Msg.getDialog();var dialogWidth=window.innerWidth*0.75;var isPortrait=window.innerWidth<window.innerHeight;if(isTablet){var buttonMultiplier=1.5;var buttonTextSize="16px";if(isPortrait){var dialogHeight=window.innerHeight*0.18;var dialogHeaderTextSize="26px";var dialogBodyTextSize="24px"}else{var dialogHeight=window.innerHeight*0.25;var dialogHeaderTextSize="18px";var dialogBodyTextSize="16px"}}else{var buttonMultiplier=3;var buttonTextSize=
"30px";var dialogHeaderTextSize="42px";var dialogBodyTextSize="40px";if(isPortrait)var dialogHeight=window.innerHeight*0.35;else var dialogHeight=window.innerHeight*0.85}try{dialog.setSize(dialogWidth,dialogHeight);dialog.setPosition((window.innerWidth-dialogWidth)/2,(window.innerHeight-dialogHeight)/2);dialog.buttons.each(function(button){button.setSize(button.getWidth()*buttonMultiplier,button.getHeight()*buttonMultiplier);var buttonTextEl=button.getEl().child(".x-btn-text");buttonTextEl.setSize(buttonTextEl.getWidth()*
buttonMultiplier,buttonTextEl.getHeight()*buttonMultiplier);buttonTextEl.setStyle("font-size",buttonTextSize)});var msgHeader=dialog.getEl().child(".x-window-header-text");msgHeader.setStyle("font-size",dialogHeaderTextSize);var msgBody=dialog.getEl().child(".ext-mb-text");msgBody.setStyle("font-size",dialogBodyTextSize)}catch(e){log4javascript.getLogger("PTC.mobile").warn("Error while resizing the redirect dialog. This can likely be ignored.",e)}};
PTC.mobile.handleRedirectConfirm=function(buttonId){if(buttonId==="yes"){PTC.mobile.setRedirectCookie(true);window.location=PTC.mobile.getRoute("info","home","oid="+this.oid)}else{PTC.mobile.setRedirectCookie(false);window.location.reload(true)}};Ext.ns("PTC.mpml");
PTC.mpml.selectRequiredAndConfirmation=function(event,target,table,message){if(target.ownerCt.id!=="gridRowContextMenu"&&table&&!table.getSelectionModel().hasSelection()){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");return false}return JCAConfirm(event,"com.ptc.netmarkets.util.utilResource.CONFIRM_REMOVE")};
jsca.columns.multiRenderer_internal=function(table,column,row,func,getRowFunc,getCellFunc){var result="";var cell=null;if(typeof row.get==="function")cell=row.get(column.id);else cell=getRowItem(row)[column.id];if(!cell)return result;var data=jsca.columns.getCellValue(column,row);var resultArray=[];if(typeof data.length!=="undefined"&&!(data instanceof String))for(var i=0,size=data.length;i<size;i++){var object=data[i];cell.gui=object.gui;resultArray.push(func(object,table,column,row,getRowFunc,getCellFunc))}else{cell.gui=
data;resultArray.push(func(data,table,column,row,getRowFunc,getCellFunc))}cell.gui=null;result=resultArray.join();return result};multiRendererJSCA=function(object,table,column,row,getRowFunc,getCellFunc){jsca.columns.handleRenderer(object,column);return object.renderer(table,column,row,getRowFunc,getCellFunc)};
multiRendererJSCA.searchFunc=function(object,table,column,row){jsca.columns.handleRenderer(object,column);if(typeof object.renderer.searchFunc==="function")return object.renderer.searchFunc(table,column,row);return null};multiRendererJSCA.groupFunc=function(object,table,column,row){jsca.columns.handleRenderer(object,column);if(typeof object.renderer.groupFunc==="function")return object.renderer.groupFunc(table,column,row);return null};
jsca.columns.multiRenderer=function(table,column,row,getRowFunc,getCellFunc){return jsca.columns.multiRenderer_internal(table,column,row,multiRendererJSCA,getRowFunc,getCellFunc)};function multiJSCASrchText(object,table,column,row,getRowFunc,getCellFunc){jsca.columns.handleRenderer(object,column);if(!object.renderer.searchFunc)object.renderer.searchFunc=exportListUtilities.defaultExportRenderer;return object.renderer.searchFunc(table,column,row,getRowFunc,getCellFunc)}
function multiExportRendererJSCA(object,table,column,row,getRowFunc,getCellFunc){jsca.columns.handleRenderer(object,column);if(!object.renderer.exportRenderer)object.renderer.exportRenderer=exportListUtilities.defaultExportRenderer;return object.renderer.exportRenderer(table,column,row,getRowFunc,getCellFunc)}
function getUnescapedText(text){if(!text||text==="&nbsp;"||text===" &nbsp; ")return" ";if(typeof text.indexOf!=="function"||text.indexOf("<")<0&&text.indexOf("&")<0)return text;else return PTC.util.unescapeHTML(text)}
function getJSCASearchTextForCell(cell){if(!cell)return"";if(cell.cellValue&&cell.cellValue[0])return getJSCASearchTextForCell(cell.cellValue[0]);var text=cell.html||cell.value||cell.currentValue||cell.displayValue;if(cell.gui)text=cell.gui.html||cell.gui.displayValue||cell.gui.value||"";return getUnescapedText(text)}
jsca.columns.getJSCASearchText=function(table,column,row){if(column&&column.renderer&&typeof column.renderer.searchFunc==="function"){var result=column.renderer.searchFunc(table,column,row);if(Ext.isString(result))return result.strip()}var cellValue=jsca.columns.getCellValue(column,row);var text=getJSCASearchTextForCell(cellValue);if(text&&text!==" "&&Ext.isString(text))return text.strip();else if(Ext.isString(cellValue)){text=getUnescapedText(cellValue);return text?text.strip():""}return""};
jsca.columns.handleRenderer=function(object,column){if(object.renderer===undefined)object.renderer=column.renderer;else if(typeof object.renderer==="string")object.renderer=PTC.util.convertStringToFunc(object.renderer);if(object.renderer===undefined){column.renderer=jsca.columns.defaultRenderer;object.renderer=jsca.columns.defaultRenderer}};PTC.infoPage.myTabId="infoPage_myTab";
PTC.infoPage.myTab=function(){return{TabState:{PRIVATE_TAB:0,PUBLIC_TAB:1,OOTB_TAB:3,OOTB_ADMIN_TAB:4,PUBLIC_OTHER_ADMIN_TAB:5},TabAction:{INHERIT_TAB:"inheritTab"},getTabStateLabel:function(state){switch(state){case 0:return"Private Tab";case 1:return"Public Tab";case 3:return"OOTB Tab";case 4:return"OOTB Admin Tab";case 5:return"Public Other Admin Tab";default:return"Tab State Not Defined"}},getJCADebugInfo:function(actionConfig,tabState){var debugInfo="<b>tabState: </b> "+(actionConfig.inheritedTab?
"Inherited tab":this.getTabStateLabel(tabState))+"<br>"+"<b>Public : </b> "+(actionConfig.isPublic===true?true:false)+"<br>"+"<b>Editable : </b> "+(actionConfig.editable===true?true:false)+"<br>";var debugInfoConfig={jcaDebugInfo:debugInfo};return PTC.debug.getJCADebugHTML(debugInfoConfig)},tabRenderer:function(actionConfig,infoModel){var overrideableProperties={};if(Ext.isDefined(actionConfig.allowContextMenu))overrideableProperties.allowContextMenu=actionConfig.allowContextMenu;if(Ext.isDefined(actionConfig.closable))overrideableProperties.closable=
actionConfig.closable;if(Ext.isDefined(actionConfig.closeAction))overrideableProperties.closeAction=actionConfig.closeAction;var tabState=this.getTabState({admin:infoModel.tabSet.admin,isPublic:actionConfig.isPublic,editable:actionConfig.editable});var jcaDebugInfo="";if(PTC.debug.isJCADebug())jcaDebugInfo=this.getJCADebugInfo(actionConfig,tabState);var instanceConfig={title:PTC.debug.isJCADebug()?actionConfig.text+jcaDebugInfo:actionConfig.text,id:infoModel.myTabConfig.id+"_"+actionConfig.actionID,
cls:actionConfig.editable?"":"lockedTab ",defaultItems:actionConfig.items,allowContextMenu:actionConfig.editable?actionConfig.editable:false,editable:actionConfig.editable?actionConfig.editable:false,closable:actionConfig.editable,closeAction:actionConfig.editable?"close":"",oid:actionConfig.oid,tabCls:this.getTabCls(tabState),isPublic:actionConfig.isPublic,infoModelId:infoModel.id,inlineHelpMessage:actionConfig.inlineHelpMessage};Ext.applyIf(instanceConfig,infoModel.myTabConfig);Ext.apply(instanceConfig,
overrideableProperties);return new PTC.infoPage.myTab.MyTabPanel(instanceConfig)},initializeMyTabConfig:function(infoModel){if(!infoModel.myTabConfig)infoModel.myTabConfig={id:PTC.infoPage.TabUtils.getTabIdPrefix(infoModel),thirdLevelNavModel:infoModel.thirdLevelNavModel,stateful:false}},getTabState:function(options){var admin=options.admin;var isPublic=options.isPublic===true?true:false;var editable=options.editable===true?true:false;var result=this.TabState.PUBLIC_TAB;if(editable&&!isPublic)result=
this.TabState.PRIVATE_TAB;if(!editable&&isPublic)result=this.TabState.PUBLIC_OTHER_ADMIN_TAB;if(!editable&&!isPublic)result=this.TabState.OOTB_TAB;if(!editable&&!isPublic&&admin)result=this.TabState.OOTB_ADMIN_TAB;return result},getTabCls:function(tabState){var result="";if(tabState===PTC.infoPage.myTab.TabState.PRIVATE_TAB)result="privateEditableTab";if(tabState===PTC.infoPage.myTab.TabState.OOTB_ADMIN_TAB||tabState===PTC.infoPage.myTab.TabState.PUBLIC_OTHER_ADMIN_TAB)result="adminOOTBTab";return result},
getMyTabMenu:function(actionModel,id){var myTabMenu=JCAClone(actionModel);PTC.menu.ActionModelToMenu(myTabMenu);var menuDefaults={checked:false,hideOnClick:false};myTabMenu.defaults=menuDefaults;PTC.actionModel.walkActionModelAndApplyToAll(myTabMenu,function(item){if(item.menu&&item.menu.items){var menuItems=item.menu.items;for(var i=0;i<menuItems.length;i++)menuItems[i].parent=item;item.id=id+"_"+item.actionID;item.menu.defaults=menuDefaults;item.handler=function(){};item.checkHandler=function(item){for(var i=
0;i<item.menu.items.items.size();i++){var child=item.menu.items.items[i];if(child.setChecked)child.setChecked(item.checked)}}}else{item.id=PTC.infoPage._makeActionItemId(id,item.id);item.handler=function(){};item.checkHandler=function(item,checked){if(!item.initialConfig.hidden&&!item.initialConfig.disabled){var myTab=PTC.infoPage.myTab.getMyTab(id);if(checked===true){myTab.addItem(item,true);if(item.parent&&item.parentMenu&&item.parentMenu.isAllItemsSelected())PTC.infoPage.myTab.setSelection(Ext.getCmp(item.parent.id),
true,true)}else{myTab.removeItem(item);if(item.parent)PTC.infoPage.myTab.setSelection(Ext.getCmp(item.parent.id),false,true)}myTab.doLayout()}}}});return myTabMenu},getMyTab:function(id){return Ext.getCmp(id)}}}();
PTC.infoPage.myTab.MyTabPanel=function(myTabConfig){var myTabTOC={xtype:"container",region:"north",autoHeight:true,items:PTC.infoPage.myTab.MyTabPanel.getTOCItems(myTabConfig)};var tableContainer=new PTC.dd.DropZoneTableContainer({id:myTabConfig.id+"myTab_tables",tabId:myTabConfig.id,cls:"myTab-tableContainer",region:"center"},PTC.infoPage.myTab.MyTabPanel.ddTableGroup);var config=Ext.applyIf({layout:myTabConfig.layout?myTabConfig.layout:"border",items:[myTabTOC,tableContainer],getTabContentManager:function(){if(!this.tabContentManager)this.tabContentManager=
new PTC.jca.manager.TabContentManager;return this.tabContentManager},getCustomizeMenu:function(){return Ext.getCmp(this.id+"_TOC_addTablesToMyTab")},getTabPublicIcon:function(){return Ext.get(this.id+"_TOC_tocPublicIcon")},getCustomizeMenuItem:function(actionType,actionName){var id=PTC.infoPage._makeActionItemId(this.id,actionType+actionName);return Ext.getCmp(id)},listeners:{render:PTC.infoPage.myTab.MyTabPanel.loadTables,activate:function(tab){this.getTabContentManager().init(tab);this.doLayout()},
beforerender:function(tab){this.getTabContentManager().init(tab)},beforedestroy:function(tab){var el=tab.getEl();if(el)PTC.jca.table.Utils.cleanUp(el.dom)}}},myTabConfig);PTC.infoPage.myTab.MyTabPanel.superclass.constructor.call(this,config);this.on("beforeclose",function(tab){var tabPanel=Ext.getCmp(tab.dockContainer);return PTC.infoPage.getTabManager(tabPanel).deleteTab(this,PTC.infoPage.myTab.MyTabPanel.closeTabHandler)});PTC.infoPageTableMgr.registerTabId(this.id)};
PTC.infoPage.myTab.MyTabPanel.closeTabHandler=function(tab){var tabPanel=Ext.getCmp(tab.dockContainer);tabPanel.tabSet.saveTabOrderRemoveTab(tabPanel,tab.actionID);if(typeof tabPanel._calcDropPlaces==="function")tabPanel._calcDropPlaces();return true};
PTC.infoPage.myTab.MyTabPanel.loadTables=function(myTabPanel){PTC.performance.restartTimer();var clonedContentItems=JCAClone(myTabPanel.getTabContentManager().getContents().reverse());var parentMenuHash=new Hash;clonedContentItems.each(function(item){var actionConfig=PTC.actionModel.getActionConfig(item.actionType?item.actionType+item.actionName:item.actionID,myTabPanel.initialConfig.thirdLevelNavModel);if(actionConfig){var actionConfigClone=Ext.applyIf({id:PTC.infoPage._makeActionItemId(myTabPanel.id,
actionConfig.id),allowContextMenu:myTabPanel.allowContextMenu},actionConfig);myTabPanel.addItem(actionConfigClone,false);var extCmp=Ext.getCmp(actionConfigClone.id);if(extCmp&&extCmp.setChecked){extCmp.setChecked(true,true);if(extCmp.parent&&extCmp.parent.id){var submenuItemCount=parentMenuHash.get(extCmp.parent.id);submenuItemCount=submenuItemCount?++submenuItemCount:1;if(extCmp.parent.menu&&extCmp.parent.menu.items&&submenuItemCount===extCmp.parent.menu.items.length)PTC.infoPage.myTab.setSelection(Ext.getCmp(extCmp.parent.id),
true,true);else parentMenuHash.set(extCmp.parent.id,submenuItemCount)}}}})};
PTC.infoPage.myTab.MyTabPanel.getTOCItems=function(myTabConfig){var myTabMenu={};if(myTabConfig.thirdLevelNavModel)myTabMenu=PTC.infoPage.myTab.getMyTabMenu(myTabConfig.thirdLevelNavModel,myTabConfig.id);var tocLinks={id:myTabConfig.id+"_TOC",cls:"myTab-toc",xtype:"tocPanel",tocMenu:myTabMenu};var tocItems=[tocLinks];if(myTabConfig.inlineHelpMessage){var inlineHelp=new Ext.Container({html:'<img border="0" src="wtcore/images/tip.gif" />'+myTabConfig.inlineHelpMessage,cls:"inlineHelpBox"});tocItems.push(inlineHelp)}return tocItems};
Ext.extend(PTC.infoPage.myTab.MyTabPanel,Ext.Panel,{addItem:function(itemConfig,persistChanges){var tocLinks=this.getTOCLinks();var tableContainer=this.getTableContainer();var table=tableContainer.addTable({id:itemConfig.id,actionURL:itemConfig.actionURL,actionID:itemConfig.actionID,actionName:itemConfig.actionName,actionType:itemConfig.actionType});tocLinks.addLink(itemConfig,this.id);if(persistChanges===true)this.getTabContentManager().add(itemConfig)},removeItem:function(item){this.getTOCLinks().removeLink(item.id);
this.getTableContainer().removeTable(item.id);this.getTabContentManager().remove(item)},insertItemBefore:function(movedItemId,targetItemId){this.getTOCLinks().insertLinkBefore(movedItemId,targetItemId);this.getTableContainer().insertTableBefore(movedItemId,targetItemId);this.getTabContentManager().saveItems()},insertItemAfter:function(movedItemId,targetItemId){this.getTOCLinks().insertLinkAfter(movedItemId,targetItemId);this.getTableContainer().insertTableAfter(movedItemId,targetItemId);this.getTabContentManager().saveItems()},
getTOCLinks:function(){return this.items.items[0].findByType("tocPanel")[0]},getTableContainer:function(){return this.items.items[1]}});PTC.infoPage.myTab.MyTabPanel.ddLinkGroup="myTabLinks";PTC.infoPage.myTab.MyTabPanel.ddTableGroup="myTabTables";
PTC.infoPage.myTab.MyTabTOCPanel=function(tocConfig){var customizeMenu={xtype:"button",id:tocConfig.id+"_addTablesToMyTab",text:bundleHandler.get("com.ptc.core.ui.navigationRB.MY_TAB_MENU"),menuAlign:"tr-br?",menu:tocConfig.tocMenu,tooltip:tocConfig.tocMenu.tooltip,cls:"add-item-button"};var initialConfig=tocConfig.ownerCt.initialConfig?tocConfig.ownerCt.initialConfig:tocConfig;var tabState=PTC.infoPage.myTab.getTabState({isPublic:initialConfig.ownerCt.isPublic,editable:initialConfig.ownerCt.closable});
var statusHiddenCls=tabState===PTC.infoPage.myTab.TabState.PUBLIC_TAB?"":"hidden";var status={xtype:"box",autoEl:{tag:"img",src:"netmarkets/images/publicTab.png",title:bundleHandler.get("com.ptc.core.ui.navigationRB.TAB_STATUS_PUBLIC"),id:tocConfig.id+"_tocPublicIcon",cls:"toc-public-icon "+statusHiddenCls}};Ext.applyIf(tocConfig,{border:false,layout:"column",autoHeight:true,items:[{id:tocConfig.id+"_myTab_toc_links",xtype:"panel",border:false,columnWidth:1,html:"&nbsp;",items:[{id:tocConfig.id+"_end_divider",
xtype:"box",autoEl:{tag:"span",html:"&nbsp;"}}]},{xtype:"panel",width:150,padding:"0 0 0 3px",border:false,items:[customizeMenu,status]}]});PTC.infoPage.myTab.MyTabTOCPanel.superclass.constructor.call(this,tocConfig);if(PTC.trail.isTrailEnabled())PTC.trail.infoPage.addCustomizeMenuListener(customizeMenu.id)};
Ext.extend(PTC.infoPage.myTab.MyTabTOCPanel,Ext.Panel,{links:{},addLink:function(linkConfig,id){var linkId=linkConfig.id+"_tocItem";var newTOCLink=new Ext.Panel({id:linkId,cls:"myTab-link dragDrop-draggable",border:false,listeners:{render:function(){this.mon(this.getEl(),"click",function(){PTC.infoPage.myTab.getMyTab(id).getTableContainer().scrollTo(linkConfig.id)})}},html:linkConfig.text});var linkPanel=this.getLinkPanel();var tab=this.getTabContentPanel();if(tab.editable)linkPanel.on("afterLayout",
function(){PTC.dd.createDropZone({id:linkId,sGroup:PTC.infoPage.myTab.MyTabPanel.ddLinkGroup});PTC.dd.createDDProxy({id:linkId,sGroup:PTC.infoPage.myTab.MyTabPanel.ddLinkGroup},PTC.infoPage.myTab.DDLinkProxy)},this,{single:true});newTOCLink.itemId=linkConfig.id;linkPanel.insert(0,newTOCLink);this.links[linkConfig.id]=newTOCLink.id},removeLink:function(itemId){var linkPanel=this.getLinkPanel();var link=Ext.getCmp(this.links[itemId]);if(linkPanel&&link){linkPanel.remove(link);delete this.links[itemId]}},
insertLinkBefore:function(movedItemId,targetItemId){var movedLink=Ext.get(this.links[movedItemId]);var targetLink=Ext.get(this.links[targetItemId]);movedLink.insertBefore(targetLink)},insertLinkAfter:function(movedItemId,targetItemId){var movedLink=Ext.get(this.links[movedItemId]);var targetLink=Ext.get(this.links[targetItemId]);movedLink.insertAfter(targetLink)},getLinkPanel:function(){return this.items.items[0]},getTabContentPanel:function(){return this.findParentByType(PTC.infoPage.myTab.MyTabPanel)}});
Ext.ComponentMgr.registerType("tocPanel",PTC.infoPage.myTab.MyTabTOCPanel);PTC.infoPage.myTab.endDrag=function(){if(this.lastTarget){var el=Ext.get(this.getEl());var movedItem=Ext.getCmp(el.id);var movedItemId=movedItem.itemId;var activeMyTab=movedItem.findParentByType(PTC.infoPage.myTab.MyTabPanel);var targetId=Ext.getCmp(this.lastTarget.id).itemId;if(this.insertAfter)activeMyTab.insertItemAfter(movedItemId,targetId);else activeMyTab.insertItemBefore(movedItemId,targetId)}};
PTC.infoPage.myTab.DDTableProxy=function(id,sGroup,config){};
Ext.extend(PTC.infoPage.myTab.DDTableProxy,PTC.dd.DDProxy,{reset:function(){if(this.lastTarget){this.lastTarget.removeClass("myTab-table-after");this.lastTarget.removeClass("myTab-table-before")}PTC.infoPage.myTab.DDTableProxy.superclass.reset.call(this)},onDragOver:function(e,targetId){PTC.infoPage.myTab.DDTableProxy.superclass.onDragOver.apply(this,arguments);if(targetId!==this.getEl().id){var target=Ext.get(targetId);var dividerClass=this.insertAfter?"myTab-table-after":"myTab-table-before";target.addClass(dividerClass)}},
endDrag:function(){PTC.infoPage.myTab.endDrag.apply(this,arguments);PTC.infoPage.myTab.DDTableProxy.superclass.endDrag.apply(this,arguments)}});PTC.infoPage.myTab.DDLinkProxy=function(id,sGroup,config){PTC.infoPage.myTab.DDLinkProxy.superclass.constructor.call(this,id,sGroup,config,PTC.dd.DDProxy.isDragRight)};
Ext.extend(PTC.infoPage.myTab.DDLinkProxy,PTC.dd.DDProxy,{reset:function(){if(this.lastDivider)this.lastDivider.removeClass("myTab-link-divider-over");PTC.infoPage.myTab.DDLinkProxy.superclass.reset.call(this)},onDragOver:function(e,targetId){PTC.infoPage.myTab.DDLinkProxy.superclass.onDragOver.apply(this,arguments);var target=Ext.get(targetId);var divider=this.insertAfter?target.next():target;divider.addClass("myTab-link-divider-over");this.lastDivider=divider},endDrag:function(){PTC.infoPage.myTab.endDrag.apply(this,
arguments);PTC.infoPage.myTab.DDLinkProxy.superclass.endDrag.apply(this,arguments)}});PTC.infoPage.myTab.addNewTab=function(tabPanel){if(tabPanel)PTC.infoPage.getTabManager(tabPanel).add(PTC.infoPage.myTab.addCallback)};
PTC.infoPage.myTab.addCallback=function(newTab,tabPanel){var dp=new Ext.ux.DockPanel({dockonly:true,constrainHeader:true});newTab.dockContainer=tabPanel.id;newTab.plugins=[dp];dp.init(newTab);newTab.on("activate",function(newTab){PTC.infoPage.getTabManager(newTab.getOwner()).getActiveTab().setActiveTab(newTab)});PTC.infoPage.getTabManager(newTab.getOwner()).getActiveTab().setActiveTab(newTab)};PTC.infoPage.myTab.getMyTabConfig=function(tabPanel){return tabPanel.initialConfig.myTabConfig};
PTC.infoPage.myTab.getNewTabConfig=function(tabPanel,json){var defaultConfig=PTC.infoPage.myTab.getMyTabConfig(tabPanel);var title=getUnescapedText(PTC.infoPage.myTab.getUniqueTabName(tabPanel));var objOid=json.oid.split(":");var modelName="tab";var modelType=PTC.trail.GENERATED_ID+objOid[2];var actionID=modelName+"_"+modelType;var config=Ext.applyIf({id:PTC.infoPage.TabUtils.getTabIdPrefix(tabPanel.infoModel)+"_"+actionID,actionID:actionID,oid:json.oid,title:title,closable:true,editable:true,tabCls:PTC.infoPage.myTab.getTabCls(PTC.infoPage.myTab.getTabState({admin:null,
isPublic:json.isPublic,editable:true})),closeAction:"close"},defaultConfig);return config};PTC.infoPage.myTab.getUniqueTabName=function(tabPanel){var titles=[];tabPanel.items.each(function(item){titles[titles.length]=item.title});return bundleHandler.getUniqueName("com.ptc.core.ui.navigationRB.INFO_PAGE_NEW_TAB",titles)};PTC.infoPage.myTab.addNewTabActionID="new_tab_action";
PTC.infoPage.myTab.addNewTabAction=function(id){var tabPanel=Ext.getCmp(id);if(!tabPanel)return;var newTab={id:PTC.infoPage.myTab.addNewTabActionID,iconCls:"tab-add",title:"&nbsp;",tabCls:"privateEditableTab",tabTip:bundleHandler.getBundleStringAndInserts("com.ptc.core.ui.navigationRB.INFO_PAGE_NEW_TAB",[""]),closable:false,allowContextMenu:false};tabPanel.add(newTab)};
PTC.infoPage.myTab.setSelection=function(menuItem,markAsChecked,supressEvent){if(menuItem&&typeof menuItem.setChecked==="function")menuItem.setChecked(markAsChecked,supressEvent)};PTC.infoPage.myTab._renameTabCallback=function(panel,parameters){var data=Ext.decode(parameters.data);panel.setTitle(data.name);if(panel.ownerCt&&panel.ownerCt.delegateUpdates)panel.ownerCt.delegateUpdates()};
PTC.infoPage.myTab.closeActionHandler=function(target,event,selectedTab){PTC.infoPage.getTabManager(selectedTab.getOwner()).deleteTab(selectedTab,PTC.infoPage.myTab.MyTabPanel.closeTabHandler)};
PTC.infoPage.myTab.setTabVisibilityCallback=function(tab,parameters){var data=Ext.decode(parameters.data);var publicIcon=tab.getTabPublicIcon();var tabOwner=Ext.get(tab.ownerCt.id+"__"+tab.id);if(data.isPublic===true){if(tabOwner)tabOwner.removeClass("privateEditableTab");if(publicIcon)publicIcon.removeClass("hidden")}else{if(tabOwner)tabOwner.addClass("privateEditableTab");if(publicIcon)tab.getTabPublicIcon().addClass("hidden")}tab.cachedMenuResponse=undefined};
PTC.infoPage.myTab.setVisibilityActionHandler=function(selectedTab,visibility){PTC.infoPage.getTabManager(selectedTab).updateTab(selectedTab,"",visibility,PTC.infoPage.myTab.setTabVisibilityCallback)};
PTC.infoPage.myTab.showHideOnSubtypeActionHandler=function(selectedTab,param){isInherit=param==="showOnSubtype"?true:false;var params={tabAction:PTC.infoPage.myTab.TabAction.INHERIT_TAB};PTC.infoPage.getTabManager(selectedTab.getOwner()).updateTab(selectedTab,"","",PTC.infoPage.myTab._showHideOnSubtypeCallback,"",params,isInherit)};PTC.infoPage.myTab._showHideOnSubtypeCallback=function(tab){tab.cachedMenuResponse=undefined};
PTC.infoPage.myTab.renameActionHandler=function(target,event,selectedTab){var OKButtonText=bundleHandler.get("com.ptc.core.ui.navigationRB.okDialogButton");var cancelButtonText=bundleHandler.get("com.ptc.core.ui.navigationRB.cancelDialogButton");Ext.MessageBox.buttonText.ok=OKButtonText;Ext.MessageBox.buttonText.cancel=cancelButtonText;var win;var windowId="renameWindow";var OKButton=new Ext.Button({text:OKButtonText,formBind:true,handler:function(button,event){var nameField=Ext.getCmp("newName");
var val=PTC.util.unescapeHTML(nameField.getValue().strip());var dupFound=false;var tabPanel=selectedTab.getOwner();tabPanel.items.each(function(item){if(item!=selectedTab&&item.title.toLowerCase()===val.toLowerCase()){dupFound=true;return false}return true});if(dupFound)nameField.markInvalid(bundleHandler.get("com.ptc.core.ui.navigationRB.RENAME_TAB_DUPLICATE_NAME"));else{PTC.infoPage.getTabManager(tabPanel).updateTab(selectedTab,val,"",PTC.infoPage.myTab._renameTabCallback);win.close()}}});var cancelButton=
new Ext.Button({text:cancelButtonText,handler:function(button,event){Ext.getCmp(windowId).close()}});var preKey="RENAME_TAB";var formId="renameForm";var defaultFieldValue=selectedTab.title;win=PTC.lightbox.createSimpleLightBoxWindowAndForm(windowId,formId,defaultFieldValue,preKey,OKButton,cancelButton);win.show()};PTC.jca.MyStuffTabPanel=function(myTabConfig){PTC.jca.MyStuffTabPanel.superclass.constructor.call(this,myTabConfig)};
Ext.extend(PTC.jca.MyStuffTabPanel,PTC.infoPage.myTab.MyTabPanel,{addItem:function(itemConfig,persistChanges){var tocLinks=this.getTOCLinks();var tableContainer=this.getTableContainer();var table=tableContainer.addWidget({id:itemConfig.id,actionURL:itemConfig.actionURL,actionID:itemConfig.actionID,actionName:itemConfig.actionName,actionType:itemConfig.actionType,actionText:itemConfig.text});if(persistChanges===true)this.getTabContentManager().add(itemConfig)}});
PTC.jca.createMyStuff=function(myStuffConfig){var myStuffPanel=Ext.getCmp("navigation_myStuffTab");if(!myStuffConfig){myStuffPanel.doLayout();return}myStuffConfig.layout="anchor";var newPanel=new PTC.jca.MyStuffTabPanel(myStuffConfig);newPanel.render("myStuffDivID");myStuffPanel.on("tabChange",myStuffPanel.doLayout())};
Object.extend(PTC.navigation,{subWindowsToClose:[],addSubWindowToClose:function(subWindow){if(subWindow)this.subWindowsToClose[this.subWindowsToClose.length]=subWindow;else jsca.log("PTC.navigation.addSubWindowToClose: subWindow is null or undefined?")},closeStillOpenSubWindows:function(actionWindow){jsca.log("Called PTC.navigation.closeStillOpenSubWindows().");jsca.log("Number of possible open sub windows to close: %s",this.subWindowsToClose.length);for(var index=0,len=this.subWindowsToClose.length;index<
len;++index){var subWindow=this.subWindowsToClose[index];jsca.log("Calling wfWindowCloseMyWindow to close sub window.");wfWindowCloseMyWindow(subWindow);if(typeof subWindow.opener=="object"&&subWindow.opener!==actionWindow)jsca.log("Opener of specified sub window is different from this window? Sub Window: %s",subWindow)}}});Ext.ns("PTC.ws");
PTC.navigation.handleProeUniqueUrls=function(creoLaunchedUrl){if(creoLaunchedUrl)if(creoLaunchedUrl.indexOf("tcomp/infoPage")>=0&&creoLaunchedUrl.indexOf("uniqueUrl")>=0){creoLaunchedUrl=removeParamFromString("uniqueUrl",creoLaunchedUrl);var loadws=function(){PTC.navigation.loadContent(creoLaunchedUrl)};loadws.defer(1);return false}else{var oid=decodeURIComponent(extractParamValue(creoLaunchedUrl,"oid"));if(oid&&oid.indexOf("OR:wt.epm.workspaces.EPMWorkspace")>-1){var wsIframe=PTC.templateProcessor.getTPContentWindow();
if(!wsIframe)return true;var refreshTblContent=false;if(wsIframe.currentWSOid===oid)refreshTblContent=true;if("reloadPage"in wsIframe.PTC.ws&&wsIframe.PTC.ws.reloadPage){wsIframe.PTC.ws.reloadPage=false;PTC.navigation.log.debug("PTC.navigation.handleProeUniqueUrls: PTC.ws.reloadPage set to true. Reloading page");refreshTblContent=false}if(refreshTblContent&&"refreshPageContent"in wsIframe.PTC.util){PTC.navigation.log.debug("PTC.navigation.handleProeUniqueUrls: loading workspace. wsoid : ",oid," refreshing just table content");
wsIframe.PTC.util.refreshPageContent();return false}else PTC.navigation.log.debug("PTC.navigation.handleProeUniqueUrls: reloading page")}}return true};PTC.navigation.on("historyChange",PTC.navigation.handleProeUniqueUrls,PTC.navigation);
PTC.navigator=function(){function setWidthWithoutValidation(width){var cmp=PTC.navigator.getNavigator();cmp.setWidth(width);if(cmp.rendered&&cmp.collapsed){PTC.navigator.moveNavigatorRight();cmp=Ext.getCmp("navigatorTabPanel");cmp.setWidth("100%")}}function setWidth(width){var maxWidth=window.Browser.getWindowWidth()*2/3;var isNum=Ext.isNumber(width);if(isNum)if(width<maxWidth)setWidthWithoutValidation(width);else setMaxWidth();else if(width.substring(0,width.length-1)<66)setWidthWithoutValidation(width);
else setMaxWidth()}function setMaxWidth(){setWidthWithoutValidation("66%")}return{setWidth:setWidth,setMaxWidth:setMaxWidth,setWidthWithoutValidation:setWidthWithoutValidation}}();
PTC.navigator.getBrowseWidth=function(tabPanel){var activeTabItems;if(!tabPanel||!tabPanel.activeTab)return getDefaultBrowseTabWidth();activeTabItems=tabPanel.activeTab.items;var width=40;for(var i=0;i<activeTabItems.length;i++)width+=activeTabItems.items[i].tabEl.offsetWidth;var defaultWidth=getDefaultBrowseTabWidth();return width>defaultWidth?width:defaultWidth};PTC.navigator.log=log4javascript.getLogger("PTC.navigator");PTC.navigator.activeSubTabButton=undefined;
PTC.navigator._updateCurrentMainForm=function(id){PTC.util._setMainFormStartingElementFromParent(id);PTC.navigator.currentMainForm=id};
PTC.navigator.activatePanelListener=function(p){PTC.jca.table.stickiness.clearTableStickinessInTab(p.id);var divId=p.id+"-contentDiv";var cd=Ext.get(divId);p.removeAll(true);if(cd){var h=Ext.getCmp("jca_viewport").getHeight()*0.75;PTC.navigation.setInProgress(cd.dom,h)}var loadUrl=p.url;if(p.activeUrl){loadUrl=p.activeUrl;p.activeUrl=undefined}loadUrl=Ext.urlAppend(loadUrl,"portlet=component");var onSuccess=function(){PTC.navigator._updateCurrentMainForm.defer(10,PTC.navigator,[divId])};getElementHtml("",
divId,true,loadUrl,false,onSuccess)};
PTC.navigator.getSubPanels=function(navItems){if(navItems===undefined)return null;var subPanels=[];for(var i=0,l=navItems.length;i<l;i++){var action=navItems[i];var debugurl=action.url;if(debugurl!==null&&debugurl!==undefined)if(action.actionModelName!==null&&action.actionModelName!==undefined)if(debugurl.indexOf("?")>-1)debugurl=debugurl+"&actionModelName="+action.actionModelName+"&modelType="+action.modelType;else debugurl=debugurl+"?actionModelName="+action.actionModelName+"&modelType="+action.modelType;
var panelConfig={id:action.id,title:action.title,autoScroll:true,html:'<div id="'+action.id+"-contentDiv"+'"></div>',url:debugurl,tabCls:"navigator-tab navigator-tab-text",autoWidth:true,listeners:{activate:PTC.navigator.activatePanelListener}};var panel=new Ext.Panel(panelConfig);PTC.navigator.log.debug("Configured sub tab panel with id: '",panel.id,"' and title: '",panel.title,"'");subPanels.push(panel)}return subPanels};PTC.navigator.getActiveState=function(){return{activeTab:this.items.indexOf(this.getActiveTab())}};
PTC.navigator.getActiveStateForTab=function(){return{activeTab:this.items.indexOf(this.getActiveTab())}};PTC.navigator.helpIcons=[];PTC.navigator.configureHelpIcon=function(tabId,helpIconConfig){PTC.navigator.helpIcons[tabId]=helpIconConfig};PTC.navigator.getActiveStateForPanel=function(){var obj={};if(Ext.state.Manager.get(this.getStateId()))obj=Ext.state.Manager.get(this.getStateId());if(this.getWidth())obj[PTC.navigator.getActiveTab().id+"_"+"width"]=this.getWidth();return obj};
PTC.navigator.restoreTabWidth=function(tabPanel,tab){var stateId=PTC.navigator.getNavigator().getStateId();var state;if(stateId)state=Ext.state.Manager.get(stateId);var width;if(state!==undefined&&state[tab.id+"_width"]>0){width=state[tab.id+"_width"];PTC.navigator.setWidthWithoutValidation(width)}else{width=getTabWidth(tabPanel,tab);if(Ext.isString(width)&&width.indexOf("%")>-1)width=(Ext.isIE?getWindow().document.body.offsetWidth:getWindow().outerWidth)*2/3;var minTabWidth=getMinimumTabWidth();
PTC.navigator.setWidth(!width||width<minTabWidth?minTabWidth:width)}};PTC.navigator.handlePlugins=function(){return PTC.util.handlePlugins(this,this.pinned)};
PTC.navigator.getNavigatorPanel=function(){getHelpIconConfiguration=function(tabId){var help=null;if(PTC.navigator.helpIcons[tabId])help=PTC.help.getHelpButtonConfig(PTC.navigator.helpIcons[tabId]);if(help)Ext.applyIf(help,{id:"windchillHelp",qtip:bundleHandler.get("com.ptc.core.ui.navigationRB.WIN_TITLE_HELP_TAB_HELP")});return help};getTabWidth=function(tabPanel,tab){var width=0;if(tab.id==="object_main_navigation")width=PTC.navigator.getBrowseWidth(tabPanel);else if(tab.id==="object_search_navigation")if(PTC.navigator.getSearchWidth)width=
PTC.navigator.getSearchWidth();else width="66%";return width};getMinimumTabWidth=function(){return 100};getDefaultBrowseTabWidth=function(){return Ext.getBody().getWidth()/4};var navigatorPanelSubTabs=[];Ext.state.Manager.setProvider(new PTC.jca.state.ClientStateProvider);for(var i=0,l=navigatorMainTabs.length;i<l;i++){var tab=navigatorMainTabs[i];var tabListeners=undefined;var debugurl=tab.url;if(tab.isAccordion)tabListeners=PTC.navigator.getAccordionListeners();else if(tab.url)tabListeners={activate:PTC.navigator.activatePanelListener};
if(debugurl!==null&&debugurl!==undefined)if(tab.actionModelName!==null&&tab.actionModelName!==undefined)if(debugurl.indexOf("?")>-1)debugurl=debugurl+"&actionModelName="+tab.actionModelName+"&modelType="+tab.modelType;else debugurl=debugurl+"?actionModelName="+tab.actionModelName+"&modelType="+tab.modelType;var panelConfig={id:tab.id,title:tab.title,html:'<div id="'+tab.id+"-contentDiv"+'"></div>',url:debugurl,activeTab:0,autoWidth:true,stateful:true,stateEvents:["tabchange"],getState:PTC.navigator.getActiveStateForTab,
items:tab.isAccordion?PTC.navigation.getAccordionItems(tab.subTabs):PTC.navigator.getSubPanels(tab.subTabs),listeners:tabListeners};var helpButton=getHelpIconConfiguration(tab.id);if(helpButton)panelConfig.tools=[helpButton];var panel;if(tab.url)panel=new Ext.Panel(panelConfig);else panel=new Ext.TabPanel(panelConfig);PTC.navigator.log.debug("Configured main tab panel with id: '",panel.id,"' and with title: '",panel.title,"'");navigatorPanelSubTabs.push(panel)}var navigatorPanelContentArea=new PTC.jca.table.TableContainer({id:"navigatorPanelContentArea",
autoHeight:true,items:[new Ext.TabPanel({activeTab:0,id:"navigatorTabPanel",items:navigatorPanelSubTabs,firstTimeRendered:true,autoWidth:true,stateful:true,stateEvents:["tabchange"],getState:PTC.navigator.getActiveState,tools:[{id:"home",qtip:bundleHandler.get("com.ptc.core.ui.navigationRB.WIN_TITLE_HOME_TAB_HOME"),handler:function(event,toolEl,panel){PTC.navigator.collapseNavigator();PTC.navigation.goHome()}}],listeners:{tabChange:function(tabPanel,tab){if(PTC.navigator.isPinned())return;PTC.navigator.restoreTabWidth(tabPanel,
tab)}}})]});if(PTC.trail.isTrailEnabled())navigatorPanelContentArea.on("render",PTC.trail.navigator.listener);var navigatorPanel=new Ext.Panel({id:"navigatorPanel",title:PTC.navigation.NAVIGATION_TITLE,width:"23%",autoHeight:true,region:"west",minSize:100,margins:{left:0,top:-3,right:0},cmargins:{left:0,top:-3,bottom:-3,right:0},border:true,collapsible:true,collapsed:true,header:false,bodyCssClass:"x-navigatorPanel-body",stateful:true,stateEvents:["bodyresize"],getState:PTC.navigator.getActiveStateForPanel,
items:navigatorPanelContentArea,listeners:{render:function(p){p.resizer=new Ext.Resizable(p.getEl(),{handles:"e",minWidth:getMinimumTabWidth()});p.resizer.on("resize",function(r,w,h,e){e.stopPropagation();PTC.navigator.changeWidth(w)})},resize:function(p,adjWidth,adjHeight,rawWidth,rawHeight){var panel=PTC.navigator.getNavigator();if(panel&&panel.resizer)panel.resizer.minWidth=getMinimumTabWidth();var cmp1=Ext.getCmp("navigatorPanelContentArea");cmp1.fireEvent("bodyresize")}}});navigatorPanel.mon(PTC.action,
"objectsaffected",PTC.navigator.onObjectsAffected,null,{delay:isWf()?0:10});navigatorPanel.addEvents("changeState");navigatorPanel.on("changeState",PTC.util.firePluginChecks,null,{delay:10});PTC.util.on("checkplugins",PTC.navigator.handlePlugins,navigatorPanel);return navigatorPanel};
PTC.navigator.changeWidth=function(width){var cmp=PTC.navigator.getNavigator();cmp.setWidth(width);PTC.navigator.log.debug("Resizing navigator to the width:",width);if(PTC.navigator.isPinned())PTC.navigator.adjustWidthWhenPinned("unpin",width);PTC.navigator.moveNavigatorRight(width)};PTC.navigator.isExpanded=function(){var cmp=getWindow().Ext.getCmp("jca_viewport");if(cmp&&cmp.layout&&cmp.layout.getNavigator()){var isNavigatorSlid=cmp.layout.getNavigator().isSlid;if(isNavigatorSlid)return isNavigatorSlid}return null};
PTC.navigator.expandNavigator=function(){var regionCmp=Ext.getCmp("jca_viewport").layout.getNavigator();var navPanel=Ext.getCmp("navigatorPanel");if(!regionCmp.isSlid){regionCmp.slideOut();regionCmp.el.setLeft("0px");if(navPanel&&navPanel.getWidth()>window.Browser.getWindowWidth())navPanel.setWidth(window.Browser.getWindowWidth()-PTC.navigator.NAVIGATOR_RESIZE_CONSTANT);PTC.navigator.moveNavigatorRight()}};
PTC.navigator.collapseNavigator=function(){var cmp=Ext.getCmp("jca_viewport").layout.getNavigator();if(cmp.isSlid)PTC.navigator.moveNavigatorLeft()};PTC.navigator.getNavigator=function(){return Ext.getCmp("navigatorPanel")};PTC.navigator.getActiveTab=function(){var cmp=Ext.getCmp("navigatorTabPanel");if(cmp)return cmp.getActiveTab()};PTC.navigator.setActiveTab=function(item){PTC.navigator.log.debug("Set main navigator tab to ",item);var cmp=Ext.getCmp("navigatorTabPanel");if(cmp)cmp.setActiveTab(item)};
PTC.navigator.getActiveSubTab=function(){var cmp=Ext.getCmp("navigatorTabPanel");if(cmp)return cmp.getActiveTab().getActiveTab()};
PTC.navigator.setActiveSubTab=function(maintab,subtab,url,expandNavigator){PTC.navigator.log.debug("Set sub tab to ",subtab);var cmp=Ext.getCmp("navigatorTabPanel");var mainTabCmp=cmp.getComponent(maintab);var subTabCmp=cmp.getComponent(maintab).getComponent(subtab);var fireActivate=false;var rendered=subTabCmp.rendered;if(cmp&&mainTabCmp&&subTabCmp){if(url){PTC.navigator.log.debug("Load sub tab with url: ",url);subTabCmp.activeUrl=url}if((expandNavigator===undefined||expandNavigator===true)&&!PTC.navigator.isExpanded())PTC.navigator.expandNavigator();
if(mainTabCmp.id===cmp.getActiveTab().id)fireActivate=true;else cmp.setActiveTab(maintab);if(subTabCmp.id===mainTabCmp.getActiveTab().id)fireActivate=true;else{cmp.getActiveTab().setActiveTab(subtab);fireActivate=false}PTC.navigator._updateCurrentMainForm(cmp.getActiveTab().getActiveTab().id+"-contentDiv");if(fireActivate===true&&rendered===true)subTabCmp.fireEvent("activate",subTabCmp)}};PTC.navigator.isNavigatorEnabled=function(){return PTC.attributeHelper.get("com.ptc.netmarkets.javascript.navigatorPanelEnabled")};
PTC.navigator.onNavigatorCollapseClick=function(a){var navigatorRegionCmp=Ext.getCmp("jca_viewport").layout.getNavigator();a.stopPropagation();if(navigatorRegionCmp.isSlid)PTC.navigator.collapseNavigator();else PTC.navigator.expandNavigator()};
PTC.navigator.moveNavigatorLeft=function(element){if(PTC.navigator.isPinned()){if(PTC.isDefined(element))PTC.util._setMainFormStartingElement(element);return}var navigatorRegionCmp=Ext.getCmp("jca_viewport").layout.getNavigator();navigatorRegionCmp.slideIn();PTC.navigator.getNavigator().fireEvent("changeState");var win=getWindow();var navigatorPanelXcollapsed=Ext.get("navigatorPanel-xcollapsed");var navigatorPanelXcollapsedEle=navigatorPanelXcollapsed.dom;var navigatorPanelXcollapsedEleStyle=navigatorPanelXcollapsedEle.getAttribute("style");
var navigatorPanelEle=win.Ext.get("navigatorPanel").dom;navigatorPanelXcollapsed.setLeft(0);navigatorPanelXcollapsed.setTop(navigatorPanelEle.styleTop);navigatorPanelXcollapsedEle.removeClassName("expanded");var toolEle=getElementsByClassNameAndTag("x-tool-expand-east",navigatorPanelXcollapsedEle,"div")[0];if(toolEle)toolEle.className=toolEle.className.replace(/east/g,"west");var bodyEle=win.document.getElementsByTagName("body")[0];bodyEle.appendChild(navigatorPanelXcollapsedEle);var form=getMainForm();
if(form&&form.parentNode)PTC.navigator.currentMainForm=form.parentNode.id;var activeCard=PTC.navigation.getActiveCard();if(activeCard)PTC.util._setMainFormStartingElementFromParent(activeCard.id)};
PTC.navigator.moveNavigatorRight=function(width){var win=getWindow();PTC.navigator.getNavigator().doLayout(false,true);PTC.navigator.getNavigator().fireEvent("changeState");var navigatorPanelXcollapsed=win.Ext.get("navigatorPanel-xcollapsed");var navigatorPanelXcollapsedEle=win.Ext.getDom("navigatorPanel-xcollapsed");var navigatorPanelEle=win.Ext.getDom("navigatorPanel");if(width===undefined)width=Ext.fly(navigatorPanelEle).getWidth();if(width===0)return;var totalWidth=width+Ext.fly(navigatorPanelXcollapsed).getWidth()-
2;var resizableHandle=Ext.get(Ext.DomQuery.selectNode(".x-resizable-handle",navigatorPanelEle));resizableHandle.setLeft(totalWidth);navigatorPanelXcollapsed.setLeft(width);navigatorPanelXcollapsed.setTop(0);if(!hasParentById(navigatorPanelXcollapsedEle,navigatorPanelEle.id)){navigatorPanelEle.appendChild(navigatorPanelXcollapsedEle);navigatorPanelXcollapsed.addClass("expanded");var toolEle=getElementsByClassNameAndTag("x-tool-expand-west",navigatorPanelXcollapsedEle,"div")[0];if(toolEle)toolEle.className=
toolEle.className.replace(/west/g,"east")}if(PTC.navigator.currentMainForm){var mainform=PTC.util._setMainFormStartingElementFromParent(PTC.navigator.currentMainForm);PTC.util._setMainFormStartingElement(mainform)}if(!navigatorPanelEle.styleTop)navigatorPanelEle.styleTop=navigatorPanelEle.offsetTop+"px";var tabPanel=Ext.getCmp("navigatorTabPanel");if(tabPanel&&tabPanel.firstTimeRendered===true){var navigatorHeight=Ext.getCmp("jca_viewport").layout.center.getSize().height+10;tabPanel.setHeight(navigatorHeight);
tabPanel.doLayout();tabPanel.firstTimeRendered=false}};
PTC.navigator.addToolTipToNavigatorBar=function(navigator){var navBar=Ext.getDom("navigatorPanel-xcollapsed");navigator.tip=new Ext.ToolTip({target:navBar,trackMouse:true,cls:"wctip",hideDelay:0,delegate:"div",renderTo:document.body,listeners:{beforeshow:function updateTipBody(tip){if(tip.triggerElement.id==="navlinks")Ext.DomHelper.overwrite(tip.body.dom,PTC.navigator.hoverTab);else if(tip.triggerElement.hasClassName("x-tool-pin"))Ext.DomHelper.overwrite(tip.body.dom,bundleHandler.get("com.ptc.core.ui.navigationRB.PIN_NAVIGATOR"));
else if(tip.triggerElement.hasClassName("x-tool-unpin"))Ext.DomHelper.overwrite(tip.body.dom,bundleHandler.get("com.ptc.core.ui.navigationRB.UNPIN_NAVIGATOR"));else if(PTC.navigator.isExpanded())Ext.DomHelper.overwrite(tip.body.dom,bundleHandler.get("com.ptc.core.ui.navigationRB.COLLAPSE_NAVIGATOR_BAR"));else if(!PTC.navigator.isExpanded())Ext.DomHelper.overwrite(tip.body.dom,bundleHandler.get("com.ptc.core.ui.navigationRB.EXPAND_NAVIGATOR_BAR"))}}})};
PTC.navigator.addLinksToNavigatorBar=function(){var navBar=Ext.get("navigatorPanel-xcollapsed");var title=bundleHandler.get("com.ptc.core.ui.navigationRB.NAVIGATOR_TITLE");var navTitleEle=Ext.DomHelper.append(navBar,{tag:"div",id:"navtitle",cls:"rotate-text",html:title},true);if(!Ext.isIE8&&document.documentMode&&document.documentMode>8){var metric=Ext.util.TextMetrics.createInstance(navTitleEle);var height=metric.getWidth(title);navTitleEle.setBottom(height+8)}var links="";for(var l=navigatorMainTabs.length,
j=0;j<l;j++){if(j!==0)links+="&nbsp;|&nbsp;";var encodedTooltip=PTC.util.HTMLEncoder.encodeForHTMLContent(navigatorMainTabs[j].tooltip);links+="<a href='#' id='"+navigatorMainTabs[j].id+"_nav' onclick=\"PTC.navigator.selectNavigatorTab('"+navigatorMainTabs[j].id+"', event);return false;\"";links+=" onmouseover=\"PTC.navigator.setHoverNavigatorTab('"+PTC.util.HTMLEncoder.encodeForHTMLContent(encodedTooltip)+"')\"";if(navigatorMainTabs[j].accesskey)links+=' accesskey="'+navigatorMainTabs[j].accesskey+
'"';links+=">";links+=navigatorMainTabs[j].title+"</a>"}var verLinksEle=navBar.createChild({id:"navlinks",cls:"rotate-text",html:links});if(Ext.isIE8){verLinksEle.setHeight("auto");navTitleEle.setHeight("auto")}};PTC.navigator.selectNavigatorTab=function(tabId,e){PTC.navigator.expandNavigator();PTC.navigator.setActiveTab(tabId);var tab=PTC.navigator.getActiveTab();tab.fireEvent("activate",tab);if(Ext.isIE)e.cancelBubble=true;else e.stopPropagation()};
PTC.navigator.setHoverNavigatorTab=function(tabName){PTC.navigator.hoverTab=tabName};PTC.navigator.restoreTreePanelState=function(tp,state){if(!tp.rendered||!state)return;for(var i=0;i<state.expanded.length;i++){var path=state.expanded[i];tp.expandPath(path)}};
PTC.navigator.slideInIf=function(e){var v=getWindow().Ext.getCmp("jca_viewport");if(v===undefined||!PTC.navigator.isNavigatorEnabled())return;var center=v.layout.center;if(!center)return;var centerRgEl=center.el;var northRgEl;if(v.layout.north)northRgEl=v.layout.north.el;var evtTargetEl=typeof e.getTarget!=="function"?e.target:e.getTarget();if(PTC.navigator.isExpanded()&&(centerRgEl.contains(evtTargetEl)||northRgEl.contains(evtTargetEl)||Ext.fly(getWindow().document).contains(window.frameElement)&&
!PTC.lightbox.isLightbox(window)))PTC.navigator.moveNavigatorLeft(evtTargetEl);else{var ele=PTC.util.getForm(evtTargetEl);if(PTC.isDefined(ele))PTC.navigator.currentMainForm=PTC.util._setMainFormStartingElement(ele)}};
PTC.navigator.getAccordionListeners=function(){if(!Ext.QuickTips.isEnabled())Ext.QuickTips.init();return{tabChange:function(tp,tab){if(PTC.navigator.activeSubTabButton)PTC.navigator.activeSubTabButton.destroy();PTC.action.fixIconForSSL(tab);PTC.navigator.activeSubTabButton=new Ext.Button({icon:tab.icon,scale:"large",tooltip:{text:tab.tabTip,cls:"wctip"}});var tabStripTextEle=getElementsByClassNameAndTag("x-tab-strip-text",tab.tabEl,"span")[0];PTC.navigator.activeSubTabButton.render(new Ext.Element(tabStripTextEle))},
activate:function(tp){PTC.navigator.log.debug("activate tab: "+tp.id);var firstA=tp.getActiveTab()?tp.getActiveTab().getContentTarget().query("a")[0]:undefined;if(firstA)Ext.get(firstA).focus(10);else{var subTabCount=tp.items.length;for(var tabStripIndex=0;tabStripIndex<subTabCount;tabStripIndex++){var tabStripEle=tp.getComponent(tabStripIndex);if(tabStripEle){var tabStripTextEle=Ext.get(tabStripEle.tabEl).child(".x-tab-strip-text");if(tabStripTextEle)Ext.QuickTips.register({target:tabStripTextEle,
text:tabStripEle.tabTip,cls:"wctip"})}}}}}};PTC.navigator.viewAllHandler=function(event,toolEl,panel){PTC.navigation.remapNavigationLinks(event)};PTC.navigator.PINNED="NavigatorPinned";
PTC.navigator.togglePinning=function(event,toolEl,opt){if(!PTC.navigator.isPinned()){if(!PTC.navigator.isExpanded())PTC.navigator.expandNavigator();PTC.navigator.adjustWidthWhenPinned("unpin");PTC.navigator.getNavigator().pinned=true;PTC.jca.state.getSessionStateStore().set(PTC.navigator.PINNED,true);PTC.navigation.resetTwoPanes()}else{PTC.navigator.adjustWidthWhenPinned("pin",0);PTC.navigator.getNavigator().pinned=false;PTC.navigator.collapseNavigator();PTC.jca.state.getSessionStateStore().set(PTC.navigator.PINNED,
false);PTC.navigation.resetTwoPanes()}PTC.navigator.getNavigator().fireEvent("changeState")};PTC.navigator.isPinned=function(){return PTC.navigator.getNavigator().pinned};
PTC.navigator.adjustWidthWhenPinned=function(tool,w){var win=getWindow(),navBar=win.Ext.getDom("navigatorPanel-xcollapsed");if(!navBar)return;if(w===undefined)w=PTC.navigator.getNavigator().getWidth();var contentArea=win.Ext.getCmp(PTC.navigation.contentTabID+"_contentArea"),viewport=win.Ext.getCmp("jca_viewport"),contentArea_leftMargin=Number(viewport.getLayout().center.getMargins().left),navBarWidth=Number(navBar.getWidth())+contentArea_leftMargin,viewportWidth=viewport.getWidth();contentArea.setPosition(w+
navBarWidth);contentArea.setWidth(viewportWidth-(w+navBarWidth));var toolEl=getElementsByClassNameAndTag("x-tool",navBar,"div")[1];if(toolEl)toolEl.className="x-tool x-tool-"+tool;PTC.navigator.disableExpandCollapse(tool)};PTC.navigator.disableExpandCollapse=function(tool){var toolEl=getElementsByClassNameAndTag("x-tool",Ext.getDom("navigatorPanel-xcollapsed"),"div")[0];if(tool=="unpin")Ext.fly(toolEl).addClass("navBarDisableExpCol");else Ext.fly(toolEl).removeClass("navBarDisableExpCol")};
PTC.navigator.initialize=function(navigator){navigator.slideInIf=PTC.navigator.slideInIf;navigator.autoHide=false;navigator.animFloat=false;var recentlyAccessedButton=Ext.getCmp(PTC.navigation.breadcrumb.RECENTLY_ACCESSED_BUTTON_ID);if(recentlyAccessedButton)PTC.navigator.NAVIGATOR_RESIZE_CONSTANT=window.Browser.getWindowWidth()-recentlyAccessedButton.x;var t=navigator.toolTemplate.overwrite(navigator.collapsedEl.dom,{id:"expand-"+navigator.position},true);t.addClassOnOver("x-tool-expand-"+navigator.position+
"-over");t.on("click",PTC.navigator.onNavigatorCollapseClick,navigator,{stopEvent:true});var pinTool=navigator.toolTemplate.append(navigator.collapsedEl.dom,{id:"pin",qtip:"Pin"},true);pinTool.on("click",PTC.navigator.togglePinning,navigator.collapsedEl.dom,{stopEvent:true});navigator.collapsedEl.removeAllListeners();navigator.collapsedEl.addListener("click",PTC.navigator.onNavigatorCollapseClick,navigator,{stopEvent:true});PTC.navigator.addLinksToNavigatorBar();PTC.navigator.addToolTipToNavigatorBar(navigator);
var pinned=PTC.jca.state.getSessionStateStore().get(PTC.navigator.PINNED);if(pinned)if(!PTC.navigator.isExpanded()){PTC.navigator.expandNavigator();PTC.navigator.getNavigator().pinned=true;PTC.navigator.restoreTabWidth(PTC.navigator.getNavigator(),PTC.navigator.getActiveTab());PTC.navigator.adjustWidthWhenPinned("unpin")}};
PTC.navigator.onObjectsAffected=function(frConfig){if(frConfig&&frConfig.navigatorTreePanelNodesforUpdate&&frConfig.navigatorTreePanelNodesforUpdate.length>0){var nodes=frConfig.navigatorTreePanelNodesforUpdate;for(var nodeIdx=0,len=nodes.length;nodeIdx<len;nodeIdx++)PTC.navigation.updateTreePanel(nodes[nodeIdx],true)}if(frConfig&&frConfig.getUpdatedOids){var refreshIfNeeded=function(child){if(child){var childId=child.id;for(var oidIdx=0,oidCount=oids.length;oidIdx<oidCount;oidIdx++){var oid=oids[oidIdx];
if(childId.indexOf(oid)>-1){PTC.navigation._updateTreePanel(panelId,true);break}}}};var oids=frConfig.getUpdatedOids();var main=Ext.getCmp("object_main_navigation");var panels=main.items.items;for(var panelIdx=0,panelCount=panels.length;panelIdx<panelCount;panelIdx++){var panelId=panels[panelIdx].id;var panel=Ext.getCmp(panelId);var rootNode=panel.getRootNode();rootNode.eachChild(refreshIfNeeded)}}return true};PTC.navigator.NAVIGATOR_RESIZE_CONSTANT=0;
PTC.navigator.onViewportResize=function(v,adjWidth,adjHeight,rawWidth,rawHeight){var navPanel=Ext.getCmp("navigatorPanel");var navPanelTabs=Ext.getCmp("navigatorTabPanel");if(navPanel&&navPanelTabs&&rawHeight){navPanel.setHeight(rawHeight-30);navPanelTabs.setHeight(rawHeight-30)}var navBar=Ext.getDom("navigatorPanel-xcollapsed");var navBarWidth=navBar?navBar.getWidth():0;var navPanelWidth=navPanel&&navPanel.getEl()?navPanel.getWidth():0;if(navBarWidth+navPanelWidth>rawWidth)PTC.navigator.changeWidth(rawWidth-
PTC.navigator.NAVIGATOR_RESIZE_CONSTANT)};
jsca.columns.nmActionRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);if(data&&typeof data.html!=="undefined"){result=data.html;if(data.isHtmlCleaned!==true){var rowContext=getRowContext(row);if(data.id=="GEN"){data=JCAClone(data);jsca.columns.setCellValue(column,row,data);data.id=jsca.columns.nmActionRenderer.getId(table,column)}result=result.replace(/title\s*=\s*\"(.*?)\"/g,'ext:qtip="$1"');result=result.replace(/alt\s*=\s*\"(.*?)\"/g,"");result=result.interpolate({ID:data.id,
LABEL:data.label,TOOLTIP:data.tooltip,CONTEXT:rowContext,ACTION_CONTEXT:getCompContext(rowContext),EA:getElementAddress(rowContext),OID:getRowOid(row)});if(result.indexOf("88OID88")>0)result=result.replace(/88OID88/g,encodeURIComponent(getRowOid(row)));if(result.indexOf("<script")>=0)result.evalScripts();data.html=result;data.isHtmlCleaned=true}result=result+jsca.columns.getHiddenInputs(data.hiddenData)}else result=data;return result};
jsca.columns.nmActionRenderer.exportRenderer=function(table,column,row){var data=jsca.columns.getCellValue(column,row);if(data)return typeof data==="string"?data:data.label;else return""};jsca.columns.nmActionRenderer.searchFunc=function(table,column,row){var data=jsca.columns.getCellValue(column,row);if(data&&data.html&&data.isHtmlCleaned)return getUnescapedText(data.html);else{var result=jsca.columns.nmActionRenderer(table,column,row);if(Ext.isString(result))return getUnescapedText(result);return""}};
jsca.columns.nmActionRenderer.getId=function(table,column){column.idCounter=(column.idCounter?column.idCounter:0)+1;if(!table.trailCompliantId)table.trailCompliantId=tableUtils.fixStrForTrail(table.id);return table.trailCompliantId+"_nmActionRenderer_id_"+PTC.trail.GENERATED_ID+column.idCounter};
jsca.columns.actionsMenuRenderer=function(table,column,row){var ActionsMenuData=PTC.attributeHelper.get("ActionsMenu");var id=jsca.columns.nmActionRenderer.getId(table,column);var params=PTC.menu._constructParams(row,table);params=Object.toQueryString(params);if(params.indexOf("'")>=0)params=params.replace("'","\\'");var label=ActionsMenuData.label.replace(/"/g,"&quot;");var result='<a id="'+id+'" href="#"'+"onclick=\"PTC.menu.showActionsMenu(event, '"+params+'\');Event.stop(event);"><img src="netmarkets/images/arrow_menu_d9x9.gif" ext:qtip="'+
label+'" height="16" width="16"></a>';return result};
jsca.columns.numericRenderer=function(table,column,row){var data=jsca.columns.getCellValue(column,row);var result=" ";if(data&&data.displayValue)result=data.displayValue;if(data&&typeof data.rawValue!=="undefined"&&(data.rawValue||data.rawValue===0))try{if(!jsca.columns.numericRenderer.batchRequests){jsca.columns.numericRenderer.batchRequests=new PTC.jca.batch.BatchRequest({url:getBaseHref()+"ptc1/numeric/",maxBatchSize:50,onSuccess:function(response){var result=PTC.decode(response.responseText);
for(var i=0,length=result.length;i<length;i++){var uid=result[i].uniqueId;var dValue=result[i].displayValue;$(jsca.columns.numericRenderer.uniqueIdPrefix+uid).innerHTML=dValue;try{jsca.columns.numericRenderer.batchRequests.dataArray[uid].displayValue=dValue}catch(e){jsca.columns.numericRenderer.log.error(e)}}},onFailure:function(response){jsca.columns.numericRenderer.log.error("ERROR in jsca.columns.numericRenderer() getting numeric component data for displaying.")}});jsca.columns.numericRenderer.batchRequests.dataArray=
[];PTC.navigation.on("historyChange",function(){jsca.columns.numericRenderer.batchRequests=null},this,{single:true})}var uniqueId=jsca.columns.numericRenderer.uniqueId++;jsca.columns.numericRenderer.batchRequests.dataArray[uniqueId]=data;jsca.columns.numericRenderer.batchRequests.addRequest({type:data.type,externalForm:data.rawValue,isPercent:data.isPct,isCurrency:data.isCurrency,unitOfMeasure:data.unitOfMeasure,uniqueId:uniqueId});result='<span id="'+jsca.columns.numericRenderer.uniqueIdPrefix+uniqueId+
'" />'}catch(e){jsca.columns.numericRenderer.log.error(e);jsca.columns.numericRenderer.log.error("Could not format the numeric value in the numericRenderer where the type is ",data.type," and the raw value is ",data.rawValue);result=data.rawValue}if(data&&data.comparable===undefined)data.comparable=result;data.value=result;result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};
jsca.columns.numericRenderer.searchFunc=function(table,column,row){var data=jsca.columns.getCellValue(column,row);var result="";if(data&&data.displayValue)result=data.displayValue;else result=jsca.columns.numericRenderer(table,column,row);if(result&&typeof result.replace==="function"){var re=new RegExp(String.fromCharCode(160),"g");result=result.replace(re," ")}return result};jsca.columns.numericRenderer.exportRenderer=jsca.columns.numericRenderer.searchFunc;jsca.columns.numericRenderer.log=log4javascript.getLogger("PTC.jsca.columns.numericRenderer");
jsca.columns.numericRenderer.uniqueId=0;jsca.columns.numericRenderer.uniqueIdPrefix="numeric_";jsca.columns.numericRenderer.validateFloatingPointWithUnit=function(elem,errorMsgRB,regEx){var value=elem.value;value=value.trim();var strArr=value.split(" ");if(strArr.length===1)PTC.wizard.validateValueForNaN(value,errorMsgRB,regEx,elem);else if(strArr.length===2)PTC.wizard.validateValueForNaN(strArr[0],"com.ptc.core.ui.errorMessagesRB.NUMERIC_VALUE_ERROR_MSG",regEx,elem);else if(strArr.length>2)JCAAlert(errorMsgRB)};
Ext.ns("PTC.objCompare");
PTC.objCompare.validateCompareAction=function(event,table){var tableID=table===undefined?undefined:table.id;var selItems=getJCASelectedTableItems(tableID);if(selItems.length<2){JCAAlert("com.ptc.windchill.enterprise.ocmp.ocmpClientResource.COMPARE_ERROR_MESSAGE");try{Event.stop(event)}catch(exc){}return false}var isInvalidCompare=false;var refObjOid=getOidFromRowValue(selItems[0].value);for(var indx=1;indx<selItems.length;indx++){var curOid=getOidFromRowValue(selItems[indx].value);if(refObjOid==curOid){isInvalidCompare=
true;break}}if(isInvalidCompare){JCAAlert("com.ptc.windchill.enterprise.ocmp.ocmpClientResource.COMPARE_ERROR_MESSAGE_INELIGIBLE_OBJECTS");try{Event.stop(event)}catch(excpn){}return false}return postSelectValidation(event,"wtObjCompareMultiple")};PTC.objCompare.getXmlHttpObject=function(){var httpObject=null;if(window.XMLHttpRequest)httpObject=new XMLHttpRequest;else if(window.ActiveXObject)httpObject=new ActiveXObject("Microsoft.XMLHTTP");return httpObject};
PTC.objCompare.navigate=function(linkId,navigateTo){var currentPageNo=document.getElementById(linkId+"CurrentPageNo").value;var navigateToPageNo=0;if(navigateTo=="Next")navigateToPageNo=parseInt(currentPageNo,10)+1;else navigateToPageNo=parseInt(currentPageNo,10)-1;document.getElementById(linkId+"CurrentPageNo").value=navigateToPageNo;PTC.objCompare.loadLinkTableRows(linkId,navigateToPageNo)};
PTC.objCompare.loadLinkTableRows=function(linkId,pageNo){var xmlhttp=PTC.objCompare.getXmlHttpObject();if(xmlhttp===null)return;var totalPages=document.getElementById(linkId+"TotPages").value;var linkTblDataSessionKey=document.getElementById(linkId+"LinkTblDataSessionKey").value;var totalLinkDiffs=document.getElementById(linkId+"TotalLinkDiffs").value;var totalObjCount=document.getElementById(linkId+"TotalObjCount").value;var url="netmarkets/jsp/ocmp/common/linkTablePage.jsp";url=url+"?pageNo="+pageNo+
"&linkId="+linkId+"&totalPages="+totalPages+"&linkTblDataSessionKey="+linkTblDataSessionKey;url=url+"&totalLinkDiffs="+totalLinkDiffs+"&totalObjCount="+totalObjCount;xmlhttp.onreadystatechange=function(){PTC.objCompare.displayLinkTableRows(xmlhttp,linkId)};xmlhttp.open("GET",url,true);xmlhttp.send(null)};
PTC.objCompare.displayLinkTableRows=function(xmlhttp,linkId){if(xmlhttp.readyState==4)if(xmlhttp.status==200){document.getElementById(linkId+"PageHolder").innerHTML=xmlhttp.responseText;var linkTblDataUnavailable=document.getElementById(linkId+"SessionDataUnavailable");if(linkTblDataUnavailable!==null){alert(linkTblDataUnavailable.value);location.reload(true)}}};
PTC.objCompare.getComparisonOptionsPageURL=function(JSONObj,oidsParamName,referringUrlParamName,sourceOid,compOptionsJspRelativePath){var oids=sourceOid;for(indx=0;indx<JSONObj.pickedObject.length;indx++){var oid=JSONObj.pickedObject[indx].oid;oids=oids.concat(",",oid)}oids=PTC.objCompare.compressOids(oids);var pathName=location.pathname;pathName=pathName.substring(1);var contextPath=pathName.substring(0,pathName.indexOf("/"));pathName="/"+contextPath+compOptionsJspRelativePath;var referringURL=location.href;
temp=PTC.util.removeURLParams(referringURL,["CSRF_NONCE"]);var paramNames=[oidsParamName];var paramValues=[oids];return PTC.objCompare.createPageURL(compOptionsJspRelativePath,paramNames,paramValues,referringUrlParamName,referringURL)};
PTC.objCompare.selectUnselectAllCompareOptions=function(compareOptionsIdsCSList,selectAllCompOptsElemId){var compareOptionsIdsColl=compareOptionsIdsCSList.split(",");var checkboxValue=document.getElementById(selectAllCompOptsElemId).checked;for(var indx=0;indx<compareOptionsIdsColl.length;indx++)if(compareOptionsIdsColl[indx]!==""&&document.getElementById(compareOptionsIdsColl[indx])!==null)document.getElementById(compareOptionsIdsColl[indx]).checked=checkboxValue};
PTC.objCompare.isCheckboxesAllChecked=function(compareOptionsIdsCSList){var isAllChecked=true;var compareOptionsIdsColl=compareOptionsIdsCSList.split(",");for(var indx=0;indx<compareOptionsIdsColl.length;indx++)if(compareOptionsIdsColl[indx]!==""&&document.getElementById(compareOptionsIdsColl[indx])!==null&&document.getElementById(compareOptionsIdsColl[indx]).checked===false){isAllChecked=false;break}return isAllChecked};
PTC.objCompare.getComparisonReportURL=function(oidsParamName,compareOptsParamName,referringUrlParamName,commonCompReportJspRelativePath,oids,compareOpts){oids=PTC.objCompare.compressOids(oids);var paramNames=[oidsParamName,compareOptsParamName];var paramValues=[oids,compareOpts];return PTC.objCompare.createPageURL(commonCompReportJspRelativePath,paramNames,paramValues)};
PTC.objCompare.createPageURL=function(jspRelativePath,paramNamesArray,paramValuesArray,referringUrlParamName,referringURL){var pathName=location.pathname;pathName=pathName.substring(1);var contextPath=pathName.substring(0,pathName.indexOf("/"));pathName="/"+contextPath+jspRelativePath;var pageURL=document.URL;pageURL=pageURL.replace(location.pathname,pathName);pageURL=pageURL.substring(0,pageURL.indexOf("?")+1);for(indx=0;indx<paramNamesArray.length;indx++){if(indx!==0)pageURL=pageURL.concat("&");
pageURL=pageURL.concat(paramNamesArray[indx],"=",paramValuesArray[indx])}pageURL=pageURL.replace(/AND/g,"&");if(referringURL){referringURL=escape(referringURL.replace(/&/g,"AND"));pageURL=pageURL.concat("&",referringUrlParamName,"=",referringURL,"&END_RURL=END");pageURL=pageURL.concat("&END_RURL=END")}return pageURL};PTC.objCompare.performComparisonReportPageLoad=function(){PTC.trail.addDomDumpHandler("ComparisonReport_Dom_Dump","PTC.trail.comparisonReport.domDumpHandler","/netmarkets/javascript/util/trail/comparisonReport.js")};
PTC.objCompare.compressOids=function(oids){var compressedOids=oids;if(oids.indexOf("OCMPCOMPRESSED:")==-1){var oidsArray=oids.split(",");var compressedOidsStrBuff="";compressedOidsStrBuff+="OCMPCOMPRESSED:";var currObjType;var prevObjType=null;var objIdIndx;for(var indx=0;indx<oidsArray.length;indx++){var oid=oidsArray[indx];objIdIndx=oid.lastIndexOf(":")+1;currObjType=oid.substring(0,objIdIndx);if(currObjType===prevObjType)compressedOidsStrBuff+=oid.substring(objIdIndx);else compressedOidsStrBuff+=
oid;compressedOidsStrBuff+=",";prevObjType=currObjType}if(compressedOidsStrBuff.indexOf(",")!=-1)compressedOidsStrBuff=compressedOidsStrBuff.substring(0,compressedOidsStrBuff.length-1);compressedOids=compressedOidsStrBuff}return compressedOids};PTC.objCompare.validateNoOfObjects=function(oids,objLimit){if(oids.split(",").length>objLimit)return JCAConfirm("com.ptc.windchill.enterprise.ocmp.ocmpClientResource.COMPARE_WARNING_NO_OF_OBCTS");return true};Ext.namespace("PTC.rule");
var oidUtils=function(){var OID_SEP="#";var OR="OR:";var VR="VR:";var EMPTY={};function getKey(oid){var result;if(oid.value)result=oid.value;else if(typeof oid.get==="function")result=oid.get("oid");else result=oid;result=oidUtils.normalize(result);return result}function isSetEntry(data,property){var datum=data[property];if(!datum)return false;return datum&&(datum.value||datum==EMPTY)}function split(oidString){var result;if(oidString&&oidString.length>0){if(oidString.lastIndexOf(OID_SEP)>oidString.length-
OID_SEP.length-1)oidString=oidString.substring(0,oidString.lastIndexOf(OID_SEP));result=oidString.split(OID_SEP)}return result}var enableAndToggleCallback=function(oid,node){if(node&&node.parentNode){node.disabled=false;node.checked=!node.checked;var tID=tableUtils.findParentTableNodeId(node);if(tID)rowHighlighter.onClick(node,null,null,tID)}};var enableCallback=function(oid,node){if(node)node.disabled=false};var disableCallback=function(oid,node){if(node)node.disabled=true};function OidSet(oids){this.data=
{};this.fastArray=[];if(oids)this.addAll(oids);this.modified=false}OidSet.prototype={toString:function(){var result=[];var isEmpty=true;for(var property in this.data)if(typeof property==="string"){if(!isSetEntry(this.data,property))continue;if(isEmpty){result.push(property);isEmpty=false}else{result.push(OID_SEP);result.push(property)}}return result.join("")},clear:function(){for(var property in this.data)if(isSetEntry(this.data,property))delete this.data[property];this.modified=false},addString:function(oidString){var oids=
split(oidString);var result=false;if(oids)result=this.addAll(oids);return result},addAll:function(oids){var result=false;this.fastArray=oids;var oids_length=oids.length;for(var i=0;i<oids_length;i++)if(this.add(oids[i]?oids[i]:oids.items&&oids.items[i]))result=true;return result},add:function(oid){var result=false;if(!oid)return result;var key=getKey(oid);var value;if(oid.value)value=oid;else if(typeof oid.get==="function")value=oid.get("oid");else value=EMPTY;if(!this.data[key]){result=true;this.data[key]=
value;this.modified=true}return result},removeAll:function(oids){var result=false;var oids_length=oids.length;for(var i=0;i<oids_length;i++)if(this.remove(oids[i]))result=true;return result},remove:function(oid){var result=false;var key=getKey(oid);var value=this.data[key];if(value){if(value!=EMPTY)result=value;else result=true;delete this.data[key];this.modified=true}return result},containsAll:function(oids){var oids_length=oids.length;for(var i=0;i<oids_length;i++){if(this.contains(oids[i]))continue;
return false}return true},contains:function(oid){var key=getKey(oid);return isSetEntry(this.data,key)},iterate:function(callback){for(var property in this.data)if(typeof property==="string"){if(!isSetEntry(this.data,property))continue;callback(property)}},_fastIterate:function(callback){var fa=this.fastArray;for(var i=0,l=fa.length;i<l;i++)callback(null,fa[i])},isModified:function(){return this.modified},node:function(oid){var result;var key=getKey(oid);var value=this.data[key];if(value&&value!=EMPTY)result=
value;return result},enable:function(toggleChecked){if(toggleChecked)this.iterate(enableAndToggleCallback);else this.iterate(enableCallback)},disable:function(){this.iterate(disableCallback)}};return{newOidSet:function(oids){return new OidSet(oids)},newOidSetForSelected:function(tableID){var selected;if(tableUtils.isJSCA(tableID))selected=getJCASelectedTableItems(tableID);else selected=getSelectedItems();return oidUtils.newOidSet(selected)},normalize:function(oidString){var result=null;if(oidString&&
oidString.indexOf){var startIdx=oidString.lastIndexOf("$");if(startIdx!=-1){var caretIdx=oidString.indexOf("^",startIdx);if(caretIdx!=-1)startIdx=caretIdx;startIdx++;var endIdx=oidString.indexOf("!*",startIdx);if(endIdx==-1)endIdx=oidString.length;result=oidString.substring(startIdx,endIdx)}else result=oidString}return result},getTableOids:function(tableID){var oidList=[];var rows=tableUtils.getTableRows(tableID);if(rows&&rows.items){var items=rows.items;for(var i=0,len=items.length;i<len;i++)oidList.push(items[i].data.oid)}return oidList}}}();
var OPTIONMANAGER=function(){return{reloadTab:function(panelId){var tab=Ext.getCmp(panelId);if(tab)tab.getUpdater().refresh()},renderRightPane:function(params){var previousTreeSelection=OPTIONMANAGER.getStoredPreviousTreeSelection(params.optionType);if(previousTreeSelection)params.ocmselectedoid=previousTreeSelection;else{OPTIONMANAGER.setStoredPreviousTreeSelection($("ocmselectedoid").value,params.optionType);previousTreeSelection=OPTIONMANAGER.getStoredPreviousTreeSelection(params.optionType);params.ocmselectedoid=
previousTreeSelection}var rTabs=Ext.getCmp("optionmanager_rightpanetabs");rTabs.purgeListeners();rTabs.removeAll(true);var rightPaneURL=$("ocm.rightpane.url").value;var options={parameters:params,asynchronous:false,onSuccess:function(response){if(params.optionType)if(OPTIONMANAGER.getStoredTabId(params.optionType))params.tabId=OPTIONMANAGER.getStoredTabId(params.optionType);var activtabid;var jsonarr=eval(response.responseText);var len=jsonarr.length;for(var i=0;i<len;i++){var config=jsonarr[i];var tabURL=
config.url+"&context="+params.context+"&AjaxEnabled=thirdLevelNav";rTabs.add({title:config.title,autoLoad:{url:tabURL,scripts:true},border:true,layout:"fit",autoScroll:true,id:config.id,listeners:{resize:OPTIONMANAGER.updateRightPanelTables}});if(i===0)activtabid=config.id;if(params.tabId==config.id)activtabid=config.id}rTabs.activate(activtabid);rTabs.on("tabChange",function(panel,tab){if(tab)OPTIONMANAGER.setStoredTabId(tab.id,params.optionType)});rTabs.on("resize",function(tabPanel,awidth,aheight,
rwidth,rheight){var activeTab=tabPanel.getActiveTab();if(activeTab)activeTab.setSize(tabPanel.getInnerWidth(),tabPanel.getInnerHeight())})}};requestHandler.doRequest(rightPaneURL,options)},updateRightPanelTables:function(activeTabPanel){var scrollbarWidth=PTC.jca.table.scroll.getWindowScrollbarWidth(activeTabPanel);var adjustGridWidth=activeTabPanel.getInnerWidth()-scrollbarWidth;var task=new Ext.util.DelayedTask(function(){var tables=PTC.jca.table.Utils.getExtTables(activeTabPanel.id);tables.each(function(table){PTC.jca.table.scroll.updateTableSize(table.id,
false,adjustGridWidth)})});task.delay(250)},renderLeftPane:function(params){var treeParams={AjaxEnabled:"thirdLevelNav",optionType:params.optionType};Ext.getCmp("optionmanager_leftpane").load({url:"ptc1/comp/optionmanager.mvc.treetable?oid="+params.oid+"&containerRef"+params.ContainerOid,scripts:true,params:treeParams})},renderFilterCombo:function(){var tb=Ext.getCmp("optionmanager.mvc.treetable.toolBar");var filterViewURL=$("ocm.filterView.url").value;var options={parameters:params,asynchronous:false,
onSuccess:function(response){var jsonModel=eval(response.responseText);tb.on("beforerender",function(){var filterCombo=tb.findById("optionTypeCombo");if(!filterCombo)if(jsonModel[0]){var cbStore=new Ext.data.ArrayStore({fields:["displayType","params"],autoLoad:true,data:jsonModel[0]});var config={id:"optionTypeCombo",store:cbStore,displayField:"displayType",typeAhead:true,mode:"local",triggerAction:"all",selectOnFocus:true,width:135,forceSelection:true,valueNotFoundText:"no found",value:jsonModel[1],
listeners:{select:OPTIONMANAGER.doOptionFiltering}};var combo=new Ext.form.ComboBox(config);tb.insert(tb.items.length-1,combo);combo.on("render",OPTIONMANAGER.resizeToFitContent,combo)}})}};requestHandler.doRequest(filterViewURL,options)},resizeToFitContent:function(){if(!this.elMetrics)this.elMetrics=Ext.util.TextMetrics.createInstance(this.getEl());var m=this.elMetrics;var width=0;var el=this.el;this.store.each(function(r){var text=r.get("displayType");width=Math.max(width,m.getWidth(text))});if(el){width+=
el.getBorderWidth("lr");width+=el.getPadding("lr")}if(this.trigger)width+=this.trigger.getWidth();this.listWidth=width;this.setWidth(width)},registerTreeEvent:function(){var treetable=Ext.getCmp("optionmanager.mvc.treetable");treetable.getColumnModel().getColumnAt(0).hidden=true;treetable.on("rowclick",function(grid,rowidx){var selectionmodel=grid.getSelectionModel();selectionmodel.selectRow(rowidx)});var selectionmodel=treetable.getSelectionModel();selectionmodel.on("rowselect",function(model,rowIndex){var selectedrow=
model.getSelected();if(selectedrow&&selectedrow.get("oid")&&$("ocmselectedoid"))if($("ocmselectedoid").value!==selectedrow.get("oid")){$("ocmselectedoid").value=selectedrow.get("oid");if(selectedrow.item._parent!=-1)OPTIONMANAGER.setStoredPreviousTreeSelection($("ocmselectedoid").value,params.optionType);else OPTIONMANAGER.setStoredPreviousTreeSelection(null,params.optionType);OPTIONMANAGER.renderRightPane(params)}PTC.jca.table.Utils.focusRow(treetable,rowIndex,selectionmodel.isSelected(rowIndex));
return true});treetable.on("beforedestroy",function(){var toolbar=Ext.getCmp("optionmanager.mvc.treetable.toolBar");if(toolbar)toolbar.destroy()});treetable.on("afterrender",function(){var task=new Ext.util.DelayedTask(function(){var previousTreeSelection=OPTIONMANAGER.getStoredPreviousTreeSelection(params.optionType);if(previousTreeSelection){var row=tableUtils.getTableRowFromOid("optionmanager.mvc.treetable",previousTreeSelection);if(row)tableUtils.selectRow(treetable,row,true)}});task.delay(2E3)})},
draw:function(params){var treetable=Ext.getCmp("optionmanager.mvc.treetable");if(treetable)treetable.destroy();if(window.params.optionType&&!params.optionType)params.optionType=window.params.optionType;OPTIONMANAGER.renderLeftPane(params);OPTIONMANAGER.renderRightPane(params);return true},doOptionFiltering:function(theCombo,viewRecord,viewIndex){var ocmparams=viewRecord.get("params");$("ocmselectedoid").value=ocmparams.ocmselectedoid;params=ocmparams;OPTIONMANAGER.draw(params)},getSelectedObjectInTree:function(){var treetable=
PTC.jca.table.Utils.getTable("optionmanager.mvc.treetable");if(treetable){var selectionmodel=treetable.getSelectionModel();var selectedrow=selectionmodel.getSelected();return selectedrow}return null},getObjectTypeFromOid:function(oidString){if(oidString){var oidSplit=oidString.split(":");if(oidSplit.length>1){var nodename=oidSplit[1];if(OPTIONMANAGER.isRootNode(nodename))nodename=OPTIONMANAGER.root;return nodename}}return null},getSelectedObjectType:function(optionType){var objectTypeToReturn=OPTIONMANAGER.root;
var selectedrow=OPTIONMANAGER.getSelectedObjectInTree();if(selectedrow&&selectedrow.item._parent==-1||selectedrow===undefined)return objectTypeToReturn;var oidString=OPTIONMANAGER.getStoredPreviousTreeSelection(optionType);if(selectedrow)oidString=selectedrow.get("oid");var objectType=OPTIONMANAGER.getObjectTypeFromOid(oidString);if(objectType)objectTypeToReturn=objectType;return objectTypeToReturn},getStoredTabIdKey:function(optionType){return OPTIONMANAGER.getSelectedObjectType(optionType)+OPTIONMANAGER.stickinessTabKey+
"-"+optionType+"-"+$("ocmcachekey").value},getStoredTabId:function(optionType){var tabId=OPTIONMANAGER.getClientStorage().get(OPTIONMANAGER.getStoredTabIdKey(optionType));return tabId},setStoredTabId:function(tabId,optionType){OPTIONMANAGER.getClientStorage().set(OPTIONMANAGER.getStoredTabIdKey(optionType),tabId)},getClientStorage:function(){if(!PTC.isDefined(this.clientStorageProvider))this.clientStorageProvider=new PTC.jca.state.ClientStateProvider;return this.clientStorageProvider},getStoredPreviousTreeSelectionKey:function(optionType){return OPTIONMANAGER.stickinessTreeSelectionKey+
"-"+optionType+"-"+$("ocmcachekey").value},getStoredPreviousTreeSelection:function(optionType){var previousOid=OPTIONMANAGER.getClientStorage().get(OPTIONMANAGER.getStoredPreviousTreeSelectionKey(optionType));return previousOid},setStoredPreviousTreeSelection:function(selectionOID,optionType){OPTIONMANAGER.getClientStorage().set(OPTIONMANAGER.getStoredPreviousTreeSelectionKey(optionType),selectionOID)},updateOnDelete:function(oidToDelete,parentoid,sourceTableID,targetTableID,activeTabIDToCheck){var parentRow=
PTC.jca.table.Utils.getTableRowFromOid("optionmanager.mvc.treetable",parentoid);var parentHadChildren=false;if(parentRow)parentHadChildren=parentRow.store.hasChildNodes(parentRow);PTC.jca.table.Utils.removeRows(sourceTableID,oidToDelete);PTC.jca.table.Utils.removeRows(targetTableID,oidToDelete);PTC.jca.table.scroll.updateTableSize("optionmanager.mvc.treetable");if(sourceTableID=="optionmanager.mvc.treetable"&&parentoid){var currentlySelected=$("ocmselectedoid").value;if(parentRow){PTC.jca.table.Utils.selectRow("optionmanager.mvc.treetable",
parentRow,true);$("ocmselectedoid").value=parentoid;OPTIONMANAGER.setStoredPreviousTreeSelection(null,params.optionType)}var rTabs=Ext.getCmp("optionmanager_rightpanetabs");var activeTabId=rTabs.getActiveTab().getId();var isShowingChilds=activeTabId.indexOf(activeTabIDToCheck)!=-1;if(isShowingChilds&&currentlySelected!=parentoid||!isShowingChilds)OPTIONMANAGER.renderRightPane(params)}else if(targetTableID=="optionmanager.mvc.treetable"&&parentoid){var sourcetable=Ext.getCmp(sourceTableID);var rowCount=
PTC.jca.table.Utils.getRowData(sourcetable).length;var allDeleted=rowCount===0;if(parentRow&&allDeleted){var isRoot=parentRow.data._parent==-1;if(isRoot)if(parentHadChildren)parentRow.set("_is_leaf",!parentRow.store.hasChildNodes(parentRow));else OPTIONMANAGER.renderLeftPane(params);else parentRow.set("_is_leaf",true)}}},isRootNode:function(nodename){return OPTIONMANAGER.rootNodes.indexOf(nodename)!=-1},updateOnDeleteRule:function(sourceChoiceVerRefs,rulesToDelete,tableID){PTC.jca.table.Utils.removeRows(tableID,
rulesToDelete)}}}();Ext.ComponentMgr.onAvailable("optionmanager.mvc.treetable",OPTIONMANAGER.registerTreeEvent);Ext.ComponentMgr.onAvailable("optionmanager.mvc.treetable.toolBar",OPTIONMANAGER.renderFilterCombo);OPTIONMANAGER.stickinessTabKey="_ocm_selectedTab";OPTIONMANAGER.stickinessTreeSelectionKey="ocm_Previous_TreeSelection";OPTIONMANAGER.root="root";OPTIONMANAGER.rootNodes=["root","wt.inf.library.WTLibrary","wt.pdmlink.PDMLinkProduct","com.ptc.windchill.option.model.OptionSet"];
Ext.isIE6=Ext.isIE&&/msie 6/.test(navigator.userAgent.toLowerCase());Ext.isIE9=Ext.isIE&&/msie 9/.test(navigator.userAgent.toLowerCase());Ext.isIE10=Ext.isIE&&(/msie 10/.test(navigator.userAgent.toLowerCase())||/trident\/6\.0/.test(navigator.userAgent.toLowerCase()));Ext.isIE11=Ext.isIE&&(/msie 11/.test(navigator.userAgent.toLowerCase())||/trident\/7\.0/.test(navigator.userAgent.toLowerCase()));Ext.isIE64BIT=Ext.isIE&&/Win64; x64/.test(navigator.userAgent);Ext.isGCF=/chromeframe/.test(navigator.userAgent);
Ext.is={};Ext.is.iPad=navigator.userAgent.match(/iPad/i)!==null;
PTC.onReady(function(){if(Ext.isIE9)Ext.getBody().addClass("ext-ie9");else if(Ext.isIE10)Ext.getBody().addClass("ext-ie10");else if(Ext.isIE11)Ext.getBody().addClass("ext-ie11");else if(Ext.isIE8)Ext.getBody().addClass("ext-ie8Only");if(Ext.isIE&&document.documentMode&&document.documentMode<9)Ext.getBody().addClass("ie-docMode8");if(isWf&&isWf())Ext.getBody().addClass("embedded");var isDTIElement=Ext.fly("isDTI");if(Ext.isIE&&isDTIElement&&isDTIElement.dom.value==="true")Ext.getBody().addClass("DTI")});
Ext.SplitButton.prototype.getMenuClass=function(){return"x-btn-split"};Ext.grid.GridView.prototype.initTemplates=Ext.grid.GridView.prototype.initTemplates.wrap(function(proceed){var result=proceed();if(this.templates.cell.JCAREPLACED!==true){this.templates.cell.JCAREPLACED=true;this.templates.cell.set(this.templates.cell.html.gsub('unselectable="on"',""));this.templates.cell.set(this.templates.cell.html.gsub('tabIndex="0"','tabIndex="-1"'))}return result});
Ext.grid.RowSelectionModel.prototype.initEvents=Ext.grid.RowSelectionModel.prototype.initEvents.wrap(function(proceed){if(this.grid.initialConfig.disableSelection===true)return;return proceed()});
Ext.grid.RowSelectionModel.prototype.onRefresh=function(){var ds=this.grid.store,index;var s=this.getSelections();this.clearSelections(true);var len=s.length;if(len>0){this.suspendEvents();var valueIdx=[];ds.data.each(function(item,index,length){valueIdx[item.id]=index});for(var i=0;i<len;i++){var r=s[i];index=valueIdx[r.id];if(index!==null&&index!=="undefined")this.selectRow(index,true,false,r,true)}this.resumeEvents()}if(s.length!=this.selections.getCount())this.fireEvent("selectionchange",this)};
Ext.menu.Item.prototype.getTemplateArgs=Ext.menu.Item.prototype.getTemplateArgs.wrap(function(proceed){if(this.href===undefined)this.href=PTC.jslint.SCRIPT_URL_STRING+"var abc = doNothing()";return proceed.call(this)});Ext.grid.GridView.prototype.focusRow=function(row,ensureVisible){this.focusCell(row,0,false,ensureVisible)};
Ext.grid.GridView.prototype.focusCell=function(row,col,hscroll,ensureVisible){if(ensureVisible!==false)this.syncFocusEl(this.ensureVisible(row,col,hscroll));if(Ext.isGecko)this.focusEl.focus();else this.focusEl.focus.defer(1,this.focusEl)};Ext.grid.GridView.prototype.onLoad=Ext.emptyFn;
Ext.ux.grid.BufferView.prototype.renderRows=function(startRow,endRow){var g=this.grid,cm=g.colModel,ds=g.store,stripe=g.stripeRows;var colCount=cm.getColumnCount();if(ds.getCount()<1)return"";var cs=this.getColumnData();startRow=startRow||0;endRow=!Ext.isDefined(endRow)?ds.getCount()-1:endRow;var rs=ds.getRange(startRow,endRow);var delta=endRow-startRow;while(rs.length<=delta)rs.push(Ext._EMPTY_RECORD);var visRowCount=this.grid.view.getVisibleRows();if(startRow===0&&visRowCount.first===0&&!g.tree&&
rs.length>visRowCount.last-visRowCount.first&&visRowCount.last+2<rs.length&&!this.isLocked&&!this.canGroup()){var lastRowIndex=rs.length,lastVisRowIndex=visRowCount.last;var visibleRows=rs.slice(visRowCount.first,visRowCount.last+1);var alt=this.doRender(cs,[rs[visRowCount.last+1]],ds,visRowCount.last+1,colCount,stripe);var nonAlt=this.doRender(cs,[rs[visRowCount.last+2]],ds,visRowCount.last+2,colCount,stripe);var result=this.doRender(cs,visibleRows,ds,visRowCount.first,colCount,stripe);var fetchArr=
[];if(visibleRows.length%2){fetchArr[0]=alt;fetchArr[1]=nonAlt}else{fetchArr[0]=nonAlt;fetchArr[1]=alt}for(var k=lastVisRowIndex+1,m=lastRowIndex;k<m;k++)result+=fetchArr[k%2];return result}return this.doRender(cs,rs,ds,startRow,colCount,stripe)};Ext.grid.GridView.prototype.updateHeaderSortState=Ext.grid.GridView.prototype.updateHeaderSortState.wrap(function(proceed){if(this.ds!==undefined)proceed.call(this);else return});
Ext.grid.GridView.prototype.updateColumnHidden=Ext.grid.GridView.prototype.updateColumnHidden.wrap(function(proceed,col,hidden){proceed.call(this,col,hidden);var totalColWidth=this.grid.getColumnModel().getTotalWidth(false);var width=this.grid.getInnerWidth();if(totalColWidth>width&&this.grid.scrollAdded!==true&&!hidden){var contentAreaHeight=PTC.jca.table.scroll.getContentArea(this.grid.getEl()).getHeight()-28;var newHeight=this.grid.getHeight()+Ext.getScrollBarWidth();if(newHeight<contentAreaHeight){this.grid.setHeight(this.grid.getHeight()+
Ext.getScrollBarWidth());this.grid.scrollAdded=true}}PTC.jca.ColumnUtils.resizeLastColumn(this.grid,null,null,this.grid.getStickyConfig())});
Ext.ux.grid.LockingGridView.prototype.updateColumnHidden=Ext.ux.grid.LockingGridView.prototype.updateColumnHidden.wrap(function(proceed,col,hidden){proceed.call(this,col,hidden);var totalColWidth=this.grid.getColumnModel().getTotalWidth(false);var width=this.grid.getInnerWidth();if(totalColWidth>width&&this.grid.scrollAdded!==true&&!hidden){var contentAreaHeight=PTC.jca.table.scroll.getContentArea(this.grid.getEl()).getHeight()-28;var newHeight=this.grid.getHeight()+Ext.getScrollBarWidth();if(newHeight<
contentAreaHeight){this.grid.setHeight(this.grid.getHeight()+Ext.getScrollBarWidth());this.grid.scrollAdded=true}}PTC.jca.ColumnUtils.resizeLastColumn(this.grid,null,null,this.grid.getStickyConfig())});Ext.ux.grid.LockingGridView.prototype.onColumnLock=Ext.ux.grid.LockingGridView.prototype.onColumnLock.wrap(function(proceed){proceed.call(this);this.grid.fireEvent("viewready",this.grid)});
PTC.jca.table.setMenuItemGroupingProperty=function(index,ms,cm,disableGrp){if(undefined!==ms.get("groupBy"))ms.get("groupBy").setDisabled(disableGrp);if(undefined!==ms.get("showGroups"))ms.get("showGroups").setDisabled(disableGrp)};PTC.jca.table.setMenuItemLockProperty=function(index,ms,cm,disableLock){if(cm.getColumnCount()-1===index||disableLock===true){ms.get("lock").setDisabled(true);ms.get("unlock").setDisabled(true)}else{ms.get("lock").setDisabled(cm.isLocked(index));ms.get("unlock").setDisabled(!cm.isLocked(index))}};
Ext.override(Ext.ux.grid.LockingGridView,{getCachedLockedRows:function(allLockedRows){if(allLockedRows)return allLockedRows;return this.getLockedRows()},doClean:function(){if(!this.isLocked)return Ext.ux.grid.LockingGridView.superclass.doClean.apply(this,arguments);if(this.ds!==undefined&&this.getVisibleRowCount()>0){var vr=this.getVisibleRows();var first=vr.first;var last=vr.last;var i=0,rows=this.getRows(),lrows=this.getLockedRows();if(first<=0)i=last+1;var allRows=null;var rows_length=rows.length;
for(var len=this.ds.getCount();i<len;i++){var rowIndex=i;allRows=this.getCachedAllRows(allRows);var row=rows[i];var lrow=lrows[i];if(row)rowIndex=row.rowIndex;if((i<first||i>last)&&i<rows_length){if(this.variableRowHeight===true&&(this._rowHeightCache[i]===undefined||row.style.height==="auto"||row.style.height==="")){var rh=row.offsetHeight;row.style.height=rh-this.borderHeight+"px";lrow.style.height=rh-this.borderHeight+"px";if(this.isRowRendered(rowIndex,allRows))this._rowHeightCache[i]=rh}this.preCleanRow(row);
this.preCleanRow(lrow);row.innerHTML="";lrow.innerHTML="";this._cache[i]=false;this._ghostCache[i]=undefined}}}},processColumnLock:function(index,cm,llen){if(cm.getColumnCount(true)<=llen+1){this.onDenyColumnLock();return}if(cm.getColumnCount(true)<=index+1){this.onDenyColumnLock();return}cm.suspendEvents();if(llen!=index){for(i=llen;i<=index;i++){cm.setLocked(cm.getLockedCount(),true,true);cm.moveColumn(cm.getLockedCount(),cm.getLockedCount())}cm.setColumnWidth(0,cm.getColumnWidth(0))}else{cm.setLocked(index,
true);cm.setColumnWidth(0,cm.getColumnWidth(0))}cm.resumeEvents();if(!this.isLocked){this.isLocked=true;this.el.dom.innerHTML="";this.templates=undefined;this.initTemplates();this.renderUI(true);this.grid.fireEvent("render",this.grid);this.refresh(true)}else this.refresh(true);cm.fireEvent("columnlockchange",this,index,true)},doBFRender:function(cs,rs,ds,startRow,colCount,stripe,onlyBody){if(!this.isLocked)return Ext.ux.grid.LockingGridView.superclass.doBFRender.apply(this,arguments);var ts=this.templates,
ct=ts.cell,rt=ts.row,rb=ts.rowBody,last=colCount-1;var rh=this.getStyleRowHeight();var vr=this.getVisibleRows();var tstyle="width:"+this.getTotalWidth()+";";var tstyleWidthOnly="width:"+this.getTotalWidth()+";";var tsytleAndHeight=tstyle+"height:"+rh+"px;";var lstyle="width:"+this.getLockedWidth()+";";var lsytleAndHeight=lstyle+"height:"+rh+"px;";tstyle=tsytleAndHeight;lstyle=lsytleAndHeight;var buf=[],lbuf=[],cb,lcb,c,p={},rpdisplayed={tstyle:tstyle},rphidden={tstyle:tsytleAndHeight},r;for(var j=
0,len=rs.length;j<len;j++){var rp=rpdisplayed;r=rs[j];cb=[];lcb=[];if(r===undefined)r=Ext._EMPTY_RECORD;var rowIndex=j+startRow;var visible=this.isVisible(rowIndex,vr);if(r.IS_EMPTY===true)this._ghostCache[rowIndex]=true;else if(visible||this._cache[rowIndex]&&!visible)this._cache[rowIndex]=visible;if(visible)for(var i=0;i<colCount;i++){c=cs[i];p.id=c.id;p.css=i===0?"x-grid3-cell-first ":i===last?"x-grid3-cell-last ":"";p.attr=p.cellAttr="";p.value=c.renderer.call(c.scope,r.get(c.name),p,r,rowIndex,
i,ds);p.style=c.style;if(p.value===undefined||p.value==="")p.value="&#160;";if(r.dirty&&typeof r.modified[c.name]!=="undefined")p.css+=" x-grid3-dirty-cell";if(c.scope.isWrapped){p.css+="x-grid3-cell-wrap";this.variableRowHeight=true}if(c.locked)lcb[lcb.length]=ct.apply(p);else cb[cb.length]=ct.apply(p);if(this.variableRowHeight===true)rp.tstyle=tstyleWidthOnly}else rp=rphidden;var alt=[];if(!onlyBody){if(stripe&&(rowIndex+1)%2===0)alt[0]="x-grid3-row-alt";if(r.dirty)alt[1]=" x-grid3-dirty-row";rp.cols=
colCount;if(typeof this.getRowClass==="function")alt[2]=this.getRowClass(r,rowIndex,rp,ds);rp.alt=alt.join(" ")}else rp.alt="";rp.cells=cb.join("");rp.tstyle=visible?tstyle:tsytleAndHeight;buf[buf.length]=!visible?ts.rowHolder.apply(rp):onlyBody?rb.apply(rp):rt.apply(rp);rp.cells=lcb.join("");rp.tstyle=visible?lstyle:lsytleAndHeight;lbuf[lbuf.length]=!visible?ts.rowHolder.apply(rp):onlyBody?rb.apply(rp):rt.apply(rp)}return[buf.join(""),lbuf.join("")]},handleHdDown:function(e,t){Ext.ux.grid.LockingGridView.superclass.handleHdDown.call(this,
e,t);if(Ext.fly(t).hasClass("x-grid3-hd-btn")){var hd=this.findHeaderCell(t),index=this.getCellIndex(hd),ms=this.hmenu.items,cm=this.cm;if(PTC.trail.isTrailEnabled())PTC.trail.hmenu.listener(this.grid.id,index);var disableGrp=false;if(!cm.config[index].sortable||cm.isLocked(0)){disableGrp=true;PTC.jca.table.setMenuItemGroupingProperty(index,ms,cm,disableGrp)}if(this.grid.enableColLock!==false){var disableLock=this.canGroup();PTC.jca.table.setMenuItemLockProperty(index,ms,cm,disableLock)}}},renderUI:function(rendered){var g=
this.grid;if(!this.isLocked)Ext.ux.grid.LockingGridView.superclass.renderUI.apply(this,arguments);else{var header=this.renderHeaders();var body=this.templates.body.apply({rows:"&#160;"});var html=this.templates.master.apply({body:body,header:header[0],ostyle:"width:"+this.getOffsetWidth()+";",bstyle:g.autoWidth?"width:auto;":"width:"+this.getTotalWidth()+";",lockedBody:body,lockedHeader:header[1],lstyle:"width:"+this.getLockedWidth()+";"});g.getGridEl().dom.innerHTML=html;this.initElements();Ext.fly(this.innerHd).on("click",
this.handleHdDown,this);Ext.fly(this.lockedInnerHd).on("click",this.handleHdDown,this);this.mainHd.on({scope:this,mouseover:this.handleHdOver,mouseout:this.handleHdOut,mousemove:this.handleHdMove});this.lockedHd.on({scope:this,mouseover:this.handleHdOver,mouseout:this.handleHdOut,mousemove:this.handleHdMove});this.scroller.on("scroll",this.syncScroll,this);if(g.enableColumnResize!==false){this.splitZone=new Ext.grid.GridView.SplitDragZone(g,this.mainHd.dom);this.splitZone.setOuterHandleElId(Ext.id(this.lockedHd.dom));
this.splitZone.setOuterHandleElId(Ext.id(this.mainHd.dom))}if(g.enableColumnMove){this.columnDrag=new Ext.grid.GridView.ColumnDragZone(g,this.innerHd);this.columnDrag.setOuterHandleElId(Ext.id(this.lockedInnerHd));this.columnDrag.setOuterHandleElId(Ext.id(this.innerHd));this.columnDrop=new Ext.grid.HeaderDropZone(g,this.mainHd.dom)}}if(g.enableHdMenu!==false&&g.enableColLock!==false&&!this.hmenu.items.get("lock")){this.hmenu.insert(2,"-");this.hmenu.insert(3,{itemId:"lock",text:this.lockText,cls:"xg-hmenu-lock"});
this.hmenu.insert(4,{itemId:"unlock",text:this.unlockText,cls:"xg-hmenu-unlock"})}if(g.trackMouseOver&&this.isLocked){this.lockedBody.on({scope:this,mouseover:this.onRowOver,mouseout:this.onRowOut});this.mainBody.on({scope:this,mouseover:this.onRowOver,mouseout:this.onRowOut})}}});
Ext.ux.grid.LockingGridView.prototype.renderUI=Ext.ux.grid.LockingGridView.prototype.renderUI.wrap(function(proceed,a,b){var ret=proceed.call(this,a,b);if(this.isLocked)this.lockedScroller.on("mousewheel",function(event){var delta;event=event.browserEvent;if(event.wheelDelta)delta=event.wheelDelta;else if(event.detail)delta=-event.detail*120;this.scroller.scroll(delta<0?"d":"u",Math.abs(delta))},this);return ret});
Ext.ux.grid.BufferView.prototype.doOverridenUpdate=function(){var g=this.grid;if(PTC.automation.isAutomationTest()&&g.jcaTableConfig.tree===true)if(this.getVisibleRowCount()>0){var ds=g.store;var vr=this.getVisibleRows();for(var i=vr.first,vrl=vr.last;i<=vrl;i++){var storeRow;if(this.isVisible(i,vr)){storeRow=ds.getAt(i);if(storeRow!==undefined&&storeRow.IS_EMPTY!==true){var lvl=storeRow.get("_level")-1;var lvlClass="ux-maximgb-tg-level-"+lvl;var trow=this.getRow(i);this.fly(trow).addClass(lvlClass)}}}}if(this.grid&&
this.grid.store){if(this.grid.store.firstChunk)if(this.grid.store.getTotalCount()>0){PTC.performance.stopComponentTimer(this.grid.store.jscaTableID,null,"firstChunk");this.grid.store.firstChunk=undefined}if(this.grid.store.DATA_RENDERED){if(getWindow().PTC.performance.Timer.InfoEnabled)PTC.performance.stopComponentTimer(this.grid.store.jscaTableID,null,"dataRendered");if(this.grid.firedDataRenderedEvent!==true){this.grid.firedDataRenderedEvent=true;this.grid.fireEvent("datarendered",this.grid)}}}};
Ext.ux.grid.BufferView.prototype.toggleGroup=Ext.ux.grid.BufferView.prototype.toggleGroup.wrap(function(proceed,group,expanded){if(getWindow().PTC.performance.Timer.InfoEnabled)PTC.performance.startComponentTimer(group.id,"Total time taken to toggle the group: ");proceed.call(this,group,expanded);this._visible_answer=undefined;this.doPartialDataChange();if(getWindow().PTC.performance.Timer.InfoEnabled)PTC.performance.stopComponentTimer(group.id,null,"deltaTime")});
Ext.ux.grid.BufferView.prototype.doUpdate=Ext.ux.grid.BufferView.prototype.doUpdate.wrap(function(proceed,forceRenderRows){this.clearVisibleCaches();if(this.getVisibleRowCount()>0){var g=this.grid,cm=g.colModel,ds=g.store;var cs=this.getColumnData();var vr=this.getVisibleRows();var cmcount=cm.getColumnCount();var doStripe=g.stripeRows;var sm=g.getSelectionModel();var allRows=this.getCachedAllRows(null,null);var exRows=0;for(var i=vr.first,vrl=vr.last;i<=vrl;i++){var trow=allRows[i];if(this.canGroup()&&
trow)if(exRows===0){var sibs=this.getSiblingRows(trow);if(sibs.crows)i+=sibs.crows;exRows=sibs.erows}else exRows--;if(this.isVisible(i,vr))if(!this.isRowRendered(i,allRows)||forceRenderRows){if(trow!==undefined){var storeRow=ds.getAt(i);var html="";if(storeRow!==undefined&&storeRow.IS_EMPTY!==true){html=this.doBFRender(cs,[storeRow],ds,i,cmcount,doStripe,true);this._ghostCache[i]=false}else this._ghostCache[i]=true;if(Ext.isIE)PTC.util.purge(trow,true);trow.innerHTML=html;this.postUpdateRow(trow);
if(this.variableRowHeight===true)trow.style.height="auto";if(this._selectCache[i]===undefined)this._selectCache[i]=false;var isSelected=sm.isSelected(storeRow);var nonSelectableClass="nonselectable-record";if(g.jcaTableConfig.nonSelectRowColumn||g.jcaTableConfig.strikeThroughColumn){var isSelectable=PTC.jca.table.isRowSelectable(storeRow,ds,g);var isStrikeThrough=PTC.jca.table.rowStrikeThrough.getBooleanValue(storeRow,g.jcaTableConfig.strikeThroughColumn)=="true";if(this._selectableCache[i]!=isSelectable){this._selectableCache[i]=
isSelectable;if(isSelectable)this.fly(trow).removeClass(nonSelectableClass);else this.fly(trow).addClass(nonSelectableClass)}if(this._strikeThroughCache[i]!=isStrikeThrough){this._strikeThroughCache[i]=isStrikeThrough;if(isStrikeThrough)this.fly(trow).addClass(PTC.jca.table.rowStrikeThrough.getStrikeThroughCSS());else{var strikeRowThroughCss=PTC.jca.table.rowStrikeThrough.getStrikeThroughCSS();while(this.fly(trow).hasClass(strikeRowThroughCss))this.fly(trow).removeClass(strikeRowThroughCss)}}}if(this._selectCache[i]!==
isSelected){this._selectCache[i]=isSelected;if(isSelected)this.fly(trow).addClass(this.selectedRowClass);else this.fly(trow).removeClass(this.selectedRowClass)}}}else if(trow&&this.variableRowHeight===true&&this._rowHeightCache[i]===undefined)trow.style.height="auto"}if(forceRenderRows)this.doClean();else{if(this.grid.tree)this.clearVisibleCaches();this.clean()}}this.doOverridenUpdate()});
Ext.grid.GroupingView.prototype.getSiblingRows=function(r){var sibs={crows:0,erows:0};if(this.canGroup()&&r){var nxSibs=r.nextSiblings().size();var gr=Ext.get(this.getGroupFromRow(r));if(nxSibs)if(gr.hasClass("x-grid-group-collapsed")&&nxSibs)sibs.crows=nxSibs;else sibs.erows=nxSibs}return sibs};
Ext.ux.grid.LockingGridView.prototype.processRows=Ext.ux.grid.LockingGridView.prototype.processRows.wrap(function(proceed,startRow,skipStripe){var rows=this.getRows();if(!this.ds||this.ds.getCount()<1||rows.length<=0)return;if(!this.isLocked)return Ext.ux.grid.LockingGridView.superclass.processRows.apply(this,Array.prototype.slice.call(arguments,1));var lrows=this.getLockedRows(),row,lrow;skipStripe=skipStripe||!this.grid.stripeRows;startRow=startRow||0;var rowHeightSets=[];for(var i=0,len=rows.length;i<
len;++i){row=rows[i];lrow=lrows[i];row.rowIndex=i;lrow.rowIndex=i;if(!skipStripe){row.className=row.className.replace(this.rowClsRe," ");lrow.className=lrow.className.replace(this.rowClsRe," ");if((i+1)%2===0){row.className+=" x-grid3-row-alt";lrow.className+=" x-grid3-row-alt"}}}if(startRow===0){Ext.fly(rows[0]).addClass(this.firstRowCls);Ext.fly(lrows[0]).addClass(this.firstRowCls)}Ext.fly(rows[rows.length-1]).addClass(this.lastRowCls);Ext.fly(lrows[lrows.length-1]).addClass(this.lastRowCls)});
Ext.ux.grid.LockingGridView.prototype.syncRowHeight=function(trow,lrow,rowIndex){if(this.variableRowHeight===true){if(rowIndex===undefined)rowIndex=trow.rowIndex;trow.style.height="auto";lrow.style.height="auto";var trowHeight=Ext.fly(trow).getHeight();var lrowHeight=Ext.fly(lrow).getHeight();if(trowHeight>lrowHeight){lrow.style.height=trowHeight-this.borderHeight+"px";trow.style.height=lrow.style.height}else if(trowHeight<lrowHeight){trow.style.height=lrowHeight-this.borderHeight+"px";lrow.style.height=
trow.style.height}this._rowHeightCache[rowIndex]=Ext.fly(lrow).getHeight()}};
Ext.ux.grid.LockingGridView.prototype.doUpdate=Ext.ux.grid.LockingGridView.prototype.doUpdate.wrap(function(proceed,forceRenderRows){if(!this.isLocked)return Ext.ux.grid.LockingGridView.superclass.doUpdate.apply(this,Array.prototype.slice.call(arguments,1));this.clearVisibleCaches();if(this.getVisibleRowCount()>0){var g=this.grid,cm=g.colModel,ds=g.store;var cs=this.getColumnData();var vr=this.getVisibleRows();var cmcount=cm.getColumnCount();var doStripe=g.stripeRows;var sm=g.getSelectionModel();
var allRows=this.getRows();var allLockedRows=this.getLockedRows();for(var i=vr.first,vrl=vr.last;i<=vrl;i++)if(this.isVisible(i,vr)){var trow=allRows[i];var lrow=allLockedRows[i];if(!this.isRowRendered(i,allRows)||forceRenderRows){if(trow!==undefined){var storeRow=ds.getAt(i);var html="";if(storeRow!==undefined&&storeRow.IS_EMPTY!==true){html=this.doBFRender(cs,[storeRow],ds,i,cmcount,doStripe,true);this._ghostCache[i]=false}else this._ghostCache[i]=true;trow.innerHTML=html[0];lrow.innerHTML=html[1];
this.postUpdateRow(trow);this.postUpdateRow(lrow);this.syncRowHeight(trow,lrow);if(this._selectCache[i]===undefined)this._selectCache[i]=false;var isSelected=sm.isSelected(i);var nonSelectableClass="nonselectable-record";if(g.jcaTableConfig.nonSelectRowColumn||g.jcaTableConfig.strikeThroughColumn){var isSelectable=PTC.jca.table.isRowSelectable(storeRow,ds,g);var isStrikeThrough=PTC.jca.table.rowStrikeThrough.getBooleanValue(storeRow,g.jcaTableConfig.strikeThroughColumn)=="true";if(this._selectableCache[i]!=
isSelectable){this._selectableCache[i]=isSelectable;if(isSelectable){this.fly(trow).removeClass(nonSelectableClass);this.fly(lrow).removeClass(nonSelectableClass)}else{this.fly(trow).addClass(nonSelectableClass);this.fly(lrow).addClass(nonSelectableClass)}}if(this._strikeThroughCache[i]!=isStrikeThrough){this._strikeThroughCache[i]=isStrikeThrough;if(isStrikeThrough){this.fly(trow).addClass(PTC.jca.table.rowStrikeThrough.getStrikeThroughCSS());this.fly(lrow).addClass(PTC.jca.table.rowStrikeThrough.getStrikeThroughCSS())}else{var strikeRowThroughCss=
PTC.jca.table.rowStrikeThrough.getStrikeThroughCSS();while(this.fly(trow).hasClass(strikeRowThroughCss)){this.fly(trow).removeClass(strikeRowThroughCss);this.fly(lrow).removeClass(strikeRowThroughCss)}}}}if(this._selectCache[i]!==isSelected){this._selectCache[i]=isSelected;if(isSelected){this.fly(trow).addClass(this.selectedRowClass);this.fly(lrow).addClass(this.selectedRowClass)}else{this.fly(trow).removeClass(this.selectedRowClass);this.fly(lrow).removeClass(this.selectedRowClass)}}}}else if(trow&&
lrow&&this.variableRowHeight===true&&this._rowHeightCache[i]===undefined)this.syncRowHeight(trow,lrow,i)}if(forceRenderRows)this.doClean();else this.clean()}this.doOverridenUpdate()});PTC.jca.table.scroll.resetRowHeightCache=function(grid){if(grid.view)grid.view._rowHeightCache={}};
Ext.ux.grid.BufferView.prototype.resetCaches=Ext.ux.grid.BufferView.prototype.resetCaches.wrap(function(proceed){proceed.call(this);this._rowHeightCache={};this._grpHdHeightCache={};this._strikeThroughCache={};this._selectableCache={}});
Ext.ux.grid.BufferView.prototype.initTemplates=Ext.ux.grid.BufferView.prototype.initTemplates.wrap(function(proceed){this._cache={};this._rowHeightCache={};this._grpHdHeightCache={};this._ghostCache={};this._selectCache={};this._strikeThroughCache={};this._selectableCache={};var grid=this.grid;grid.colModel.on("widthchange",PTC.jca.table.scroll.resetRowHeightCache.createCallback(grid));grid.colModel.on("hiddenchange",PTC.jca.table.scroll.resetRowHeightCache.createCallback(grid));grid.on("columnresize",
PTC.jca.table.scroll.resetRowHeightCache.createCallback(grid));grid.view.on("refresh",this.resetCaches);grid.view.on("rowremoved",this.resetCaches);grid.view.on("rowinserted",this.resetCaches);proceed.call(this)});
Ext.override(Ext.ux.grid.LockingGridView,{processRows:function(startRow,skipStripe){var rows=this.getRows();if(!this.ds||this.ds.getCount()<1||rows.length<=0)return;if(!this.isLocked)return Ext.ux.grid.LockingGridView.superclass.processRows.apply(this,arguments);var lrows=this.getLockedRows(),row,lrow;skipStripe=skipStripe||!this.grid.stripeRows;startRow=startRow||0;var rowHeightSets=[];for(var i=0,len=rows.length;i<len;++i){row=rows[i];lrow=lrows[i];row.rowIndex=i;lrow.rowIndex=i;if(!skipStripe){row.className=
row.className.replace(this.rowClsRe," ");lrow.className=lrow.className.replace(this.rowClsRe," ");if((i+1)%2===0){row.className+=" x-grid3-row-alt";lrow.className+=" x-grid3-row-alt"}}}if(startRow===0){Ext.fly(rows[0]).addClass(this.firstRowCls);Ext.fly(lrows[0]).addClass(this.firstRowCls)}Ext.fly(rows[rows.length-1]).addClass(this.lastRowCls);Ext.fly(lrows[lrows.length-1]).addClass(this.lastRowCls)}});
Ext.ux.grid.BufferView.prototype.getRowsForTableTree=function(rowIndex){if(this.getAllRenderableRows){var renderableRows=this.getAllRenderableRows();return this.getRow(renderableRows[rowIndex])}else return this.getRow(rowIndex)};
Ext.override(Ext.ux.grid.BufferView,{cacheSize:5,wrapText:"Wrap",doClean:function(){try{if(this.ds!==undefined&&this.getVisibleRowCount()>0){var vr=this.getVisibleRows();var first=vr.first;var last=vr.last;var i=0,rows=this.getRows();if(first<=0)i=last+1;var rows_length=rows.length;var renderableRows=null;var allRows=null;var row;for(var len=this.ds.getCount();i<len;i++){var rowIndex=i;allRows=this.getCachedAllRows(allRows);if(this.getAllRenderableRows){renderableRows=this.getCachedRenderableRows(renderableRows);
row=allRows[renderableRows[rowIndex]]}else row=allRows[rowIndex];if(row)rowIndex=row.rowIndex;if(row)if(!this.isVisible(rowIndex,vr)&&i<rows_length){if(this.variableRowHeight===true&&(this._rowHeightCache[rowIndex]===undefined||row.style.height==="auto"||row.style.height==="")){var rh=row.offsetHeight;row.style.height=rh-this.borderHeight+"px";if(this.isRowRendered(rowIndex,allRows))this._rowHeightCache[rowIndex]=rh}this.preCleanRow(row);if(Ext.isIE)PTC.util.purge(row,true);row.innerHTML="";delete this._cache[rowIndex];
delete this._ghostCache[rowIndex]}}}if(this.grid.tree)this.clearVisibleCaches()}catch(e){jsca.log(e)}},isRowRendered:function(index,allRows){var row=null;if(allRows)row=allRows[index];else row=this.getRow(index);return row&&row.childNodes.length>0},getCachedAllRows:function(allRows){if(allRows===null)allRows=this.getRows();return allRows},getCachedRenderableRows:function(renderableRows){if(renderableRows===null)renderableRows=this.getAllRenderableRows();return renderableRows},getVisibleRows:function(){var renderableRows=
null;if(this._visible_answer!==undefined)return this._visible_answer;var allRows=this.getCachedAllRows(null);var ds=this.ds;var count=this.getVisibleRowCount();var scrollTop=this.scroller.dom.scrollTop;var start=0;var defaultRowHeight=this.getCalculatedRowHeight();var allgrps;var tcnt=ds.getCount();if(this.canGroup())allgrps=this.getGroups();if(this.variableRowHeight===true){var range=this.getVisibleRowsRangeForVarRowHt(scrollTop,allRows,defaultRowHeight,allgrps,count);start=range.start;count=range.count}else{start=
scrollTop===0?0:Math.floor(scrollTop/defaultRowHeight)-1;if(start>tcnt)start=Math.min(start,tcnt-count);if(this.canGroup()&&this.hasGroups()){start=this.getViewportStartingRow(start,scrollTop,allRows,defaultRowHeight,allgrps);start=this.adjustViewportStartingRow(start,count,scrollTop,allRows,allgrps);count=this.adjustViewportRowCount(start,count,allRows,allgrps)}}var ch=this.scroller.dom.clientHeight;start=start<0?0:start;if(this.getAllRenderableRows){renderableRows=this.getCachedRenderableRows(renderableRows);
row=allRows[renderableRows[start]]}else row=allRows[start];if(row&&(this.canGroup()||!this.variableRowHeight)){var y=Ext.get(row).getOffsetsTo(this.innerHd)[1];var originalY=y;var originalStart=start;var maxStartRow=this.ds.getCount()-count;var pixPerRowMaxRatio=defaultRowHeight*2;var last=-1;var trips=0;while(Math.abs(y)>50&&last!=start&&trips++<25){last=start;start-=y/pixPerRowMaxRatio;start=Math.floor(start);start=Math.min(start,maxStartRow);start=Math.max(start,0);row=allRows[start];var tableRow=
Ext.get(row);if(tableRow)y=tableRow.getOffsetsTo(this.innerHd)[1]}}if(Math.abs(originalY)-50<Math.abs(y)-50)start=originalStart;var answer={first:Math.max(start-this.cacheSize,0),last:Math.min(start+count+this.cacheSize,this.ds.getCount()-1)};if(answer.last>1)this._visible_answer=answer;return answer},getVisibleRowsRangeForVarRowHt:function(scrollTop,allRows,defaultRowHeight,allgrps,count){var start=0,tcnt=this.ds.getCount();if(this.canGroup()&&this.hasGroups()){start=this.getViewportStartingRowForVarRowHt(scrollTop,
allRows,defaultRowHeight,allgrps);if(start+1!==tcnt)count=this.adjustViewportRowCountForVarRowHt(start,allRows,defaultRowHeight,allgrps)}else start=this.getViewportStartRowForUngroupedVarRowHt(scrollTop,allRows,defaultRowHeight);if(start+1===tcnt)start-=count;return{start:start,count:count}},getViewportStartRowForUngroupedVarRowHt:function(scrollTop,allRows,defaultRowHeight){var row,start=0,rowHeightSum=0,ds=this.ds,renderableRows=null;for(var i=0,l=ds.getCount();i<l;i++){var rowIndex=i;if(this.getAllRenderableRows){renderableRows=
this.getCachedRenderableRows(renderableRows);row=allRows[renderableRows[rowIndex]]}else row=allRows[rowIndex];if(row)rowIndex=row.rowIndex;var rh=this._rowHeightCache[rowIndex];if(!rh)if(row)rh=row.offsetHeight;rowHeightSum=rowHeightSum+rh;start=i;if(rowHeightSum>=scrollTop)i=l}return start},getViewportStartingRowForVarRowHt:function(scrollTop,allRows,defaultRowHeight,allgrps){var rowHeightSum=0,start=0;for(var i=0;i<allgrps.length;i++){var gr=allgrps[i];var grhdht=this.getGroupHeaderHeight(gr,i);
rowHeightSum+=grhdht;if(Ext.get(gr.id).hasClass("x-grid-group-collapsed"))continue;var rows=Ext.getDom(gr.id+"-bd").childElements(),rc=rows.size();for(var j=0;j<rc;j++){var row=rows[j];var ri=row.rowIndex;var rh=this._rowHeightCache[ri];if(!rh)if(row&&this.isRowRendered(ri,allRows)){rh=row.offsetHeight;this._rowHeightCache[ri]=rh}else rh=defaultRowHeight;rowHeightSum+=rh;start=ri;if(rowHeightSum>=scrollTop)break}if(rowHeightSum>=scrollTop)break}return start},adjustViewportRowCountForVarRowHt:function(start,
allRows,defaultRowHeight,allgrps){var r=allRows[start],i=0;var vh=this.scroller.dom.getHeight();if(r)i=this.nodListToArray(allgrps).indexOf(this.getGroupFromRow(r));var rowHeightSum=0,collapsedRowCount=0,count=0;for(var k=i;k<allgrps.length;k++){var gr=allgrps[k];if(k!==i){var grhdht=this.getGroupHeaderHeight(gr,k);rowHeightSum+=grhdht;count++}var rows=Ext.getDom(gr.id+"-bd").childElements(),rc=rows.size();if(Ext.get(gr.id).hasClass("x-grid-group-collapsed")){collapsedRowCount+=rc;continue}var gri=
k===i?rows.indexOf(r):0;for(var l=gri;l<rc;l++){var row=rows[l];if(row){var ri=row.rowIndex;var rh=this._rowHeightCache[ri];if(!rh){rh=row?row.offsetHeight:defaultRowHeight;if(row&&this.isRowRendered(ri,allRows)){rh=row.offsetHeight;this._rowHeightCache[ri]=rh}else rh=defaultRowHeight}rowHeightSum+=rh;count++;if(rowHeightSum>=vh)break}}if(rowHeightSum>=vh)break}count+=collapsedRowCount;return count},getViewportStartingRow:function(start,scrollTop,allRows,defaultRowHeight,allgrps){var grps=this.nodListToArray(allgrps);
var r=Ext.get(allRows[start]);if(r){var gr=this.getGroupFromRow(r);var gi=grps.indexOf(gr);var grhdht=this.getGroupHeaderHeight(gr,gi);start=Math.floor((scrollTop-(gi+1)*grhdht)/defaultRowHeight)}start=Math.max(start,0);return start},adjustViewportStartingRow:function(start,count,scrollTop,allRows,allgrps){var grps=this.nodListToArray(allgrps);var r=Ext.get(allRows[start]);var cgr;if(r)cgr=this.getGroupFromRow(r);var collapsedRowCount=0;var cogrs=cgr?Ext.DomQuery.select("div[class*=x-grid-group-collapsed]",
cgr.parentElement):[];for(var i=0;i<cogrs.size();i++)if(cogrs[i].offsetTop<scrollTop)collapsedRowCount+=Ext.getDom(cogrs[i].id+"-bd").childElements().size();var tcnt=this.ds.getCount();start+=collapsedRowCount;start=Math.min(start,tcnt-count);return start},adjustViewportRowCount:function(start,count,allRows,allgrps){var grps=this.nodListToArray(allgrps);var r=Ext.get(allRows[start]);var collapsedRowCount=0,rcnt=0,cgri=-1,cgr;if(r){cgr=Ext.getDom(r.parent().parent().id);cgri=grps.indexOf(cgr);rcnt=
r.dom.nextSiblings().size();if(r.parent().parent().hasClass("x-grid-group-collapsed")){collapsedRowCount=rcnt+1;rcnt=1}}for(var i=cgri+1;i<grps.size()&&rcnt<count;i++){gid=grps[i].id;g=Ext.get(gid);if(g&&g.hasClass("x-grid-group-collapsed")){collapsedRowCount+=Ext.getDom(gid+"-bd").childElements().size();rcnt++}else rcnt+=Ext.getDom(gid+"-bd").childElements().size()}count+=collapsedRowCount;return count},getGroupFromRow:function(r){var gr;if(r){r=Ext.get(r);gr=r.parent().parent().dom}return gr},getGroupHeaderHeight:function(gr,
index){var grhdht=this._grpHdHeightCache[index];if(!grhdht&&gr){var grhd=Ext.DomQuery.select("div[id='"+gr.id+"-hd']",gr)[0];grhdht=grhd.getHeight();this._grpHdHeightCache[index]=grhdht}return grhdht},hasGroups:function(){var fc=this.mainBody.dom.firstElementChild||this.mainBody.dom.children[0];return fc&&fc.className.indexOf("x-grid-group")>-1},nodListToArray:function(nl){var a=[];if(!nl)return[];if("toArray"in Object(nl))return nl.toArray();try{a=Array.prototype.concat.apply([],nl)}catch(e){var length=
nl.length||0;a=new Array(length);while(length--)a[length]=nl[length]}return a},handleHdDown:function(e,t){Ext.ux.grid.BufferView.superclass.handleHdDown.call(this,e,t);var wrapClass="xg-hmenu-wrap";var unwrapClass="xg-hmenu-unwrap";if(Ext.fly(t).hasClass("x-grid3-hd-btn")){var hd=this.findHeaderCell(t),index=this.getCellIndex(hd),ms=this.hmenu.items,cm=this.cm;if(!cm.getColumnAt(index).isWrapped){ms.get("wrapContent").setText(this.wrapText);ms.get("wrapContent").removeClass(unwrapClass).addClass(wrapClass)}else{ms.get("wrapContent").setText(this.unWrapText);
ms.get("wrapContent").removeClass(wrapClass).addClass(unwrapClass)}}},doBFRender:function(cs,rs,ds,startRow,colCount,stripe,onlyBody){var ts=this.templates,ct=ts.cell,rt=ts.row,rb=ts.rowBody,last=colCount-1;var rh=this.getStyleRowHeight();var vr=this.getVisibleRows();var tstyle="width:"+this.getTotalWidth()+";";var tstyleWidthOnly="width:"+this.getTotalWidth()+";";var tsytleAndHeight=tstyle+"height:"+rh+"px;";if(this.variableRowHeight!==true)tstyle=tsytleAndHeight;var buf=[],cb,c,p={},rpdisplayed=
{tstyle:tstyle},rphidden={tstyle:tsytleAndHeight},r;for(var j=0,len=rs.length;j<len;j++){var rp=rpdisplayed;r=rs[j];cb=[];if(r===undefined)r=Ext._EMPTY_RECORD;var rowIndex=j+startRow;var visible=this.isVisible(rowIndex,vr);if(r.IS_EMPTY===true)this._ghostCache[rowIndex]=true;else if(visible||this._cache[rowIndex]&&!visible)this._cache[rowIndex]=visible;if(visible){for(var i=0;i<colCount;i++){c=cs[i];p.id=c.id;p.css=i===0?"x-grid3-cell-first ":i===last?"x-grid3-cell-last ":"";p.attr=p.cellAttr="";
p.value=c.renderer.call(c.scope,r.get(c.name),p,r,rowIndex,i,ds);p.style=c.style;if(p.value===undefined||p.value==="")p.value="&#160;";if(r.dirty&&typeof r.modified[c.name]!=="undefined")p.css+=" x-grid3-dirty-cell";if(c.scope.isWrapped){p.css+="x-grid3-cell-wrap";this.variableRowHeight=true}cb[cb.length]=ct.apply(p)}if(this.variableRowHeight===true)rp.tstyle=tstyleWidthOnly}else rp=rphidden;var alt=[];if(!onlyBody){if(stripe&&(rowIndex+1)%2===0)alt[0]="x-grid3-row-alt";if(r.dirty)alt[1]=" x-grid3-dirty-row";
rp.cols=colCount;if(typeof this.getRowClass==="function")alt[2]=this.getRowClass(r,rowIndex,rp,ds);rp.alt=alt.join(" ")}else rp.alt="";rp.cells=cb.join("");buf[buf.length]=!visible?ts.rowHolder.apply(rp):onlyBody?rb.apply(rp):rt.apply(rp)}return buf.join("")},doRender:function(cs,rs,ds,startRow,colCount,stripe,onlyBody){if(rs.length<1)return"";if(!this.canGroup()||this.isUpdating)return this.doBFRender.apply(this,arguments);var groupField=this.getGroupField(),colIndex=this.cm.findColumnIndex(groupField),
g,gstyle="width:"+this.getTotalWidth()+";",cfg=this.cm.config[colIndex],groupRenderer=cfg.groupRenderer||cfg.renderer,prefix=this.showGroupName?(cfg.groupName||cfg.header)+": ":"",groups=[],curGroup,i,len,gid;for(i=0,len=rs.length;i<len;i++){var rowIndex=startRow+i,r=rs[i],gvalue=r.data[groupField];g=this.getGroup(gvalue,r,groupRenderer,rowIndex,colIndex,ds);if(!curGroup||curGroup.group!=g){gid=this.constructId(g,groupField,colIndex);this.state[gid]=!(Ext.isDefined(this.state[gid])?!this.state[gid]:
this.startCollapsed);curGroup={group:g,gvalue:gvalue,text:prefix+g,groupId:gid,startRow:rowIndex,rs:[r],cls:this.state[gid]?"":"x-grid-group-collapsed",style:gstyle};groups.push(curGroup)}else curGroup.rs.push(r);r._groupId=gid}var buf=[];for(i=0,len=groups.length;i<len;i++){g=groups[i];this.doGroupStart(buf,g,cs,ds,colCount);buf[buf.length]=this.doBFRender.call(this,cs,g.rs,ds,g.startRow,colCount,stripe,onlyBody);this.doGroupEnd(buf,g,cs,ds,colCount)}return buf.join("")}});
Ext.ux.grid.BufferView.prototype.getGroup=Ext.ux.grid.BufferView.prototype.getGroup.wrap(function(proceed,v,r,groupRenderer,rowIndex,colIndex,ds){var g=proceed.call(this,v,r,groupRenderer,rowIndex,colIndex,ds);return Ext.util.Format.htmlEncode(g).replace(/'/g,"&apos;")});Ext.QuickTip.prototype.tagConfig.qtipEncode="qtipEncode";Ext.QuickTip.prototype.minWidth=25;
Ext.QuickTip.prototype.getTipCfg=Ext.QuickTip.prototype.getTipCfg.wrap(function(proceed,e){var ttp=proceed.call(this,e);if(!this.interceptTitles){var cfg=this.tagConfig;var theTarget=e.getTarget();var encodeTip=Ext.fly(theTarget).getAttribute(cfg.qtipEncode,cfg.namespace);if(!theTarget.qtip&&(!encodeTip||encodeTip==="true"))ttp=Ext.util.Format.htmlEncode(ttp)}return ttp});
Ext.grid.GridView.prototype.getColumnTooltip=Ext.grid.GridView.prototype.getColumnTooltip.wrap(function(proceed,i){var result=proceed.call(this,i);if(typeof result==="string")if(result.substring(0,8)==="ext:qtip")if(result.indexOf("<br>")>0||result.indexOf("&quot;")>0)return result+' ext:qtipEncode="false"';return result});
Ext.grid.RowSelectionModel.prototype.selectAll=function(){if(this.isLocked())return;if(this.fireEvent("beforerowselectall",this)!==false){this.suspendEvents();this.selections.clear();var store=this.grid.store;var nonSelectableRowCount=0;for(var i=0,len=store.getCount();i<len;i++)if(PTC.jca.table.isRowSelectable(store.getAt(i),store))this.selectRow(i,true);else nonSelectableRowCount++;this.grid.store.nonSelectableRowCount=nonSelectableRowCount;this.resumeEvents();this.fireEvent("rowmassselection",
this,this.selections.items);this.fireEvent("selectionchange",this)}};
Ext.grid.RowSelectionModel.prototype.clearSelections=function(fast,deselectall){if(this.isLocked())return;if(fast!==true){var ds=this.grid.store;var s=this.selections;var v=this.grid.getView();this.suspendEvents();var suspended=this.eventsSuspended===true;var items=s.items;if(deselectall===true&&ds.data)items=ds.data.items;for(var i=0,l=items.length;i<l;i++){var r=items[i];if(suspended)v.onRowDeselect(deselectall===true?i:ds.indexOfId(r.id));else this.deselectRow(ds.indexOfId(r.id))}s.clear();this.resumeEvents();
this.fireEvent("rowmassdeselection",this)}else this.selections.clear();this.last=false};
Ext.override(Ext.data.Store,{add:function(records,snapShotOnly){records=[].concat(records);if(records.length<1)return;var selectedRecords=[];var table=PTC.jca.table.Utils.getTable(this.jscaTableID);for(var i=0,len=records.length;i<len;i++){records[i].join(this);if(table&&table.jcaTableConfig.preSelectableColumn&&PTC.jca.table.getColumnBooleanStringValue(records[i],table.jcaTableConfig.preSelectableColumn,"false")==="true")if(!table.jcaTableConfig.nonSelectRowColumn||PTC.jca.table.getColumnBooleanStringValue(records[i],
table.jcaTableConfig.nonSelectRowColumn,"false")==="false")selectedRecords.push(records[i])}var index=this.data.length;if(snapShotOnly!==true)this.data.addAll(records);if(this.snapshot)this.snapshot.addAll(records);if(selectedRecords.length>0)if(table.viewReady)PTC.jca.table.preSelectRecordInDS(table,selectedRecords);else table.on("render",PTC.jca.table.preSelectRecordInDS.createCallback(table,selectedRecords));if(snapShotOnly!==true)this.fireEvent("add",this,records,index)},queryExact:function(property,
value){return this.query(property,new RegExp("^"+Ext.escapeRe(value)+"$","i"))}});Ext.grid.RowSelectionModel.prototype.initEvents=Ext.grid.RowSelectionModel.prototype.initEvents.wrap(function(proceed){this.addEvents("rowmassselection","rowmassdeselection");return proceed()});Ext.ux.grid.BufferView.prototype.onRowDeselect=function(index){if(this.isRowRendered(index)){this._selectCache[index]=false;return Ext.ux.grid.BufferView.superclass.onRowDeselect.call(this,index)}};
Ext.ux.grid.BufferView.prototype.onRowSelect=function(index){if(this.isRowRendered(index)){this._selectCache[index]=true;return Ext.ux.grid.BufferView.superclass.onRowSelect.call(this,index)}};Ext.ux.grid.BufferView.prototype.doPartialDataChange=function(forceRenderRows){this._cache={};var g=this.grid;if(!g)return;var gridView=g.getView(),ds=g.store,nonSelectableClass="nonselectable-record";var rows=gridView.getRows();this.doUpdate(forceRenderRows)};
Ext.ux.grid.LockingGridView.prototype.doPartialDataChange=function(forceRenderRows){if(!this.isLocked)return Ext.ux.grid.LockingGridView.superclass.doPartialDataChange.apply(this,arguments);this._cache={};var g=this.grid,gridView=g.getView(),ds=g.store,nonSelectableClass="nonselectable-record";var rows=gridView.getRows();this.doUpdate(forceRenderRows)};
Ext.grid.CheckboxSelectionModel.prototype.onHdMouseDown=function(e,t){if(t.className=="x-grid3-hd-checker"){e.stopEvent();var hd=Ext.fly(t.parentNode);var isChecked=hd.hasClass("x-grid3-hd-checker-on");if(isChecked){hd.removeClass("x-grid3-hd-checker-on");this.clearSelections(null,true)}else{hd.addClass("x-grid3-hd-checker-on");this.selectAll()}}};
Ext.override(Ext.menu.Menu,{constrainScroll:function(y){var max,full=this.ul.setHeight("auto").getHeight(),returnY=y,normalY,parentEl,scrollTop,viewHeight;if(this.floating){var parentDocument=parent.document;var isIframe=Ext.fly(parentDocument).contains(window.frameElement)&&parentDocument.viewport!==undefined;if(isIframe)if(this.maxHeight)max=this.maxHeight;else max=parentDocument.viewport.getHeight()-(y+Ext.get(window.frameElement).getTop());else{parentEl=Ext.fly(this.el.dom.parentNode);scrollTop=
parentEl.getScroll().top;viewHeight=parentEl.getViewSize().height;normalY=y-scrollTop;if(this.maxHeight)max=this.maxHeight;else max=viewHeight-normalY;if(full>viewHeight){max=viewHeight;returnY=y-normalY}else if(max<full){returnY=y-(full-max);max=full}}}else max=this.getHeight();if(this.maxHeight)max=Math.min(this.maxHeight,max);if(full>max&&max>0){this.activeMax=max-this.scrollerHeight*2-this.el.getFrameWidth("tb")-Ext.num(this.el.shadowOffset,0);this.ul.setHeight(this.activeMax);this.createScrollers();
this.el.select(".x-menu-scroller").setDisplayed("")}else{this.ul.setHeight(full);this.el.select(".x-menu-scroller").setDisplayed("none")}this.ul.dom.scrollTop=0;return returnY}});Ext.grid.GridPanel.prototype.getState=Ext.grid.GridPanel.prototype.getState.wrap(function(proceed){if(!PTC.isDefined(this.colModel))return;if(!"config"in this.colModel)return;return proceed.call(this)});
Ext.grid.GridView.prototype.getRow=Ext.grid.GridView.prototype.getRow.wrap(function(original,index){if(index<0)return undefined;return original(index)});
if(Ext.ux&&Ext.ux.PanelResizer){Ext.ux.PanelResizer.prototype.onRender=Ext.ux.PanelResizer.prototype.onRender.wrap(function(proceed,p){proceed.call(this,p);if(this.tooltip){if(!Ext.QuickTips.isEnabled())Ext.QuickTips.init();Ext.QuickTips.register({target:this.handle,text:this.tooltip})}});Ext.ux.PanelResizer.prototype.onDragEnd=Ext.ux.PanelResizer.prototype.onDragEnd.wrap(function(proceed,p){proceed.call(this,p);this.panel.fireEvent("updateTableSize",this)})}
Ext.grid.RowSelectionModel.prototype.onRowUpdated=Ext.grid.RowSelectionModel.prototype.onRowUpdated.wrap(function(proceed,v,index,r){if(this.grid.view.skipSelect===true){this.grid.view.skipSelect=false;return}proceed.call(this,v,index,r)});
Ext.override(Ext.ux.grid.RadioSelectionModel,{selectRow:function(index){var store=this.grid.store;if(!Ext.isNumber(index))if(typeof index==="string")index=store.indexOfId(index);else index=store.indexOf(index);if(!PTC.jca.table.isRowSelectable(store.getAt(index),store))return;Ext.ux.grid.RadioSelectionModel.superclass.selectRow.apply(this,arguments);var row;var cm=this.grid.colModel;var rId=cm.getIndexById(this.id);if(this.grid.rendered===true)if(cm.isLocked(rId))row=Ext.fly(this.grid.view.getLockedRow(index));
else row=Ext.fly(this.grid.view.getRow(index));if(row&&row.child("input[type=radio]")&&row.child("input[type=radio]").dom)row.child("input[type=radio]").dom.checked=true}});Ext.ux.grid.RadioSelectionModel.prototype.menuDisabled=true;Ext.menu.Menu.prototype.initComponent=Ext.menu.Menu.prototype.initComponent.wrap(function(proceed){proceed.call(this);Ext.EventManager.removeResizeListener(this.hide,this)});Ext.Component.log=log4javascript.getLogger("PTC.Ext.Component");
Ext.Component.prototype.preInitComponent=Ext.Component.prototype.preInitComponent.wrap(function(original,config){if(config.id){var obsoleteComponent=Ext.getCmp(config.id);if(obsoleteComponent){Ext.Component.log.debug("Trying to create new component with id of existing component. Destroy the old before creating a new one. Id used: ",config.id);try{obsoleteComponent.destroy()}catch(ex){Ext.Component.log.error("Error destroying component=",config.id,ex)}}}this.addEvents("afteraction");this.enableBubble("afteraction");
return original.call(this,config)});Ext.ux.grid.LockingGridView.prototype.handleHdMenuClick=Ext.ux.grid.LockingGridView.prototype.handleHdMenuClick.wrap(function(proceed,item,e){var ds=this.ds;if(e&&e.shiftKey){e.stopEvent();ds.shiftKeyOn=true}else ds.shiftKeyOn=false;proceed.call(this,item,e)});Ext.ux.grid.BufferView.prototype.setVariableRowHeight=function(variableRowHeight){this.variableRowHeight=variableRowHeight;this.syncHeights=variableRowHeight};
Ext.form.ComboBox.prototype.onViewClick=Ext.form.ComboBox.prototype.onViewClick.wrap(function(original,doFocus){if(PTC.automation.isAutomationTest())return original.call(this,doFocus);else{if(PTC.autosuggest.suggestBoxHandler.isAutoSuggest(this.id)){original.defer(1,this,[false]);return false}return original.call(this,false)}});
Ext.Element.prototype.getConstrainToXY=function(el,local,offsets,proposedXY){var os={top:0,left:0,bottom:0,right:0};return function(el,local,offsets,proposedXY){el=Ext.get(el);offsets=offsets?Ext.applyIf(offsets,os):os;var vw,vh,vx=0,vy=0;if(el.dom==document.body||el.dom==document){vw=Ext.lib.Dom.getViewWidth()-(Ext.isNumber(this.shadowOffset)?this.shadowOffset:0);vh=Ext.lib.Dom.getViewHeight()}else{vw=el.dom.clientWidth-(Ext.isNumber(this.shadowOffset)?this.shadowOffset:0);vh=el.dom.clientHeight;
if(!local){var vxy=el.getXY();vx=vxy[0];vy=vxy[1]}}var s=el.getScroll();vx+=offsets.left+s.left;vy+=offsets.top+s.top;vw-=offsets.right;vh-=offsets.bottom;var vr=vx+vw;var vb=vy+vh;var xy=proposedXY||(!local?this.getXY():[this.getLeft(true),this.getTop(true)]);var x=xy[0],y=xy[1];var w=this.dom.offsetWidth,h=this.dom.offsetHeight;var moved=false;if(x+w>vr){x=vr-w;moved=true}if(y+h>vb){y=vb-h;moved=true}if(x<vx){x=vx;moved=true}if(y<vy){y=vy;moved=true}return moved?[x,y]:false}}();
Ext.Ajax.timeout=3E5;Ext.override(Ext.data.JsonReader,{extractValues:function(data,items,len){return data}});
Ext.lib.Dom.getXY=Ext.lib.Dom.getXY.wrap(function(proceed,elOrig){var b,scroll,bd=document.body||document.documentElement,ret=[0,0];var el=Ext.getDom(elOrig);if(el!=bd)if(el.getBoundingClientRect){var leftB;var topB;try{b=el.getBoundingClientRect();leftB=b.left;topB=b.top}catch(e){leftB=0;topB=0}scroll=Ext.getDoc().getScroll();ret=[Math.round(leftB+scroll.left),Math.round(topB+scroll.top)]}else return proceed.call(this,elOrig);return ret});
Ext.override(Ext.ux.maximgb.tg.AdjacencyListStore,{hasChildNodes:function(rc){var i,len;if(this.useChildNodeCache===true){var children=this.childNodeCache[rc.id];return children?children.length>0:false}if(this.isLeafNode(rc))return false;var rcid=rc.id;var records=this.data.items;var parent_const=this.parent_id_field_name;for(i=0,len=records.length;i<len;i++){var nextrc=records[i];if(nextrc.data[parent_const]===rcid){nextrc._index=i;return true}}return false},getNodeChildren:function(rc){var i,len,
result=[];if(this.useChildNodeCache===true){var children=this.childNodeCache[rc.id];return children?children:result}if(this.isLeafNode(rc))return result;var rcid=rc.id;var records=this.data.items;var parent_const=this.parent_id_field_name;for(i=0,len=records.length;i<len;i++){var nextrc=records[i];if(nextrc.data[parent_const]===rcid){nextrc._index=i;result.push(nextrc)}}return result},enableChildNodeCache:function(){if(!this.useChildNodeCache){this.useChildNodeCache=true;this.initializeChildNodeCache()}},
disableChildNodeCache:function(){this.useChildNodeCache=false;this.resetChildNodeCache()},initializeChildNodeCache:function(){this.childNodeCache={};var _cache=this.childNodeCache;var records=this.data.items;var parent_const=this.parent_id_field_name;for(var i=0,len=records.length;i<len;i++){var nextrc=records[i];var parentId=nextrc.data[parent_const];var children=_cache[parentId];nextrc._index=i;if(typeof children==="undefined")_cache[parentId]=[nextrc];else children.push(nextrc)}},resetChildNodeCache:function(){delete this.childNodeCache}});
Ext.override(Ext.XTemplate,{applySubTemplate:function(id,values,parent,xindex,xcount){var me=this,len,t=me.tpls[id],vs,buf=[];try{if(t.test&&!t.test.call(me,values,parent,xindex,xcount)||t.exec&&t.exec.call(me,values,parent,xindex,xcount))return""}catch(e){return""}vs=t.target?t.target.call(me,values,parent):values;len=vs.length;parent=t.target?values:parent;if(t.target&&Ext.isArray(vs)){for(var i=0;i<len;i++)buf[buf.length]=t.compiled.call(me,vs[i],parent,i+1,len);return buf.join("")}return t.compiled.call(me,
vs,parent,xindex,xcount)}});
Ext.tree.TreeNodeUI.prototype.renderElements=function(n,a,targetNode,bulkRender){this.indentMarkup=n.parentNode?n.parentNode.ui.getChildIndent():"";var cb=Ext.isBoolean(a.checked),nel,href=a.href?a.href:Ext.isGecko?"":"#",buf=['<li class="x-tree-node"><div ext:tree-node-id="',n.id,'" class="x-tree-node-el x-tree-node-leaf x-unselectable ',a.cls,'" unselectable="on">','<span class="x-tree-node-indent">',this.indentMarkup,a.singleClickExpand&&n.ownerTree.root.childNodes.indexOf(n)<0?'<img src="'+this.emptyIcon+
'" class="x-tree-ec-icon" />':"","</span>",'<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow" />',a.icon?'<img src="'+a.icon+'" class="x-tree-node-icon'+(a.icon?" x-tree-node-inline-icon":"")+(a.iconCls?" "+a.iconCls:"")+'" unselectable="on" />':"<span></span>",cb?'<input class="x-tree-node-cb" type="checkbox" '+(a.checked?'checked="checked" />':"/>"):"",'<a hidefocus="on" class="x-tree-node-anchor" href="',href,'" tabIndex="1" ',a.hrefTarget?' target="'+a.hrefTarget+'"':"",PTC.debug.isJsDebug()&&
n.attributes.qtipEncode=="false"?'><span unselectable="on" qtipEncode="false">':'><span unselectable="on">',n.text,"</span></a></div>",'<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>"].join("");if(bulkRender!==true&&n.nextSibling&&(nel=n.nextSibling.ui.getEl()))this.wrap=Ext.DomHelper.insertHtml("beforeBegin",nel,buf);else this.wrap=Ext.DomHelper.insertHtml("beforeEnd",targetNode,buf);this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var cs=this.elNode.childNodes;
this.indentNode=cs[0];this.ecNode=cs[1];this.iconNode=cs[2];var index=3;if(cb){this.checkbox=cs[3];this.checkbox.defaultChecked=this.checkbox.checked;index++}this.anchor=cs[index];this.textNode=cs[index].firstChild};Ext.override(Ext.Element,{hasClass:function(className){try{return className&&this.dom&&this.dom.className&&(" "+this.dom.className+" ").indexOf(" "+className+" ")!=-1}catch(e){PTC.log.error(e)}return false}});
Ext.override(Ext.layout.MenuLayout,{doAutoSize:function(){var ct=this.container,w=ct.width;if(ct.floating)if(w)ct.setWidth(w);else if(Ext.isIE){ct.setWidth(Ext.isStrict?"auto":ct.minWidth);var el=ct.getEl(),t=el.dom.offsetWidth;ct.setWidth(ct.getLayoutTarget().getWidth()+el.getFrameWidth("lr"))}}});
Ext.override(Ext.dd.DragTracker,{onMouseMove:function(e,target){if(this.active&&Ext.isIE&&!e.browserEvent.button)if(this.panelResizer===1){e.preventDefault();this.onMouseUp(e);this.panelResizer=2;this.onDrag(e);return}else{e.preventDefault();this.onMouseUp(e);return}e.preventDefault();var xy=e.getXY(),s=this.startXY;this.lastXY=xy;if(!this.active)if(Math.abs(s[0]-xy[0])>this.tolerance||Math.abs(s[1]-xy[1])>this.tolerance)this.triggerStart();else return;this.fireEvent("mousemove",this,e);this.onDrag(e);
this.fireEvent("drag",this,e)}});
Ext.override(Ext.ux.PanelResizer,{onDragStart:function(e){this.dragging=true;this.startHeight=this.panel.el.getHeight();this.tracker.panelResizer=1;this.fireEvent("dragstart",this,e)},onDrag:function(e){if(this.tracker.panelResizer===2)this.panel.setHeight((this.startHeight-this.tracker.getOffset()[1]).constrain(this.minHeight,this.maxHeight)+150);else this.panel.setHeight((this.startHeight-this.tracker.getOffset()[1]).constrain(this.minHeight,this.maxHeight));this.fireEvent("drag",this,e)}});
Ext.lib.Ajax.serializeForm=function(form){var fElements=form.elements||(document.forms[form]||Ext.getDom(form)).elements,hasSubmit=false,encoder=encodeURIComponent,element,options,name,val,data="",type;Ext.each(fElements,function(element){name=element.name;type=element.type;if(PTC.isInputElements(element)===false)return;if(!element.disabled&&name)if(/select-(one|multiple)/i.test(type))Ext.each(element.options,function(opt){if(opt.selected)data+=String.format("{0}={1}&",encoder(name),encoder((opt.hasAttribute?
opt.hasAttribute("value"):opt.getAttribute("value")!==null)?opt.value:opt.text))});else if(!/undefined|reset|button/i.test(type))if(!(/radio|checkbox/i.test(type)&&!element.checked)&&!(type=="submit"&&hasSubmit)){data+=encoder(name)+"="+encoder(element.value)+"&";hasSubmit=/submit/i.test(type)}});return data.substr(0,data.length-1)};
PTC.isInputElements=function(element){var tags=["INPUT","SELECT","TEXTAREA","INPUTSELECTOR","SELECTONE","SELECTMANY","OPTIONVALUE"];var tagName=element.tagName;if(tagName&&tagName.toUpperCase){tagName=tagName.toUpperCase();if(tags.indexOf(tagName)===-1)return false}return true};Ext.Button.prototype.initButtonEl=Ext.Button.prototype.initButtonEl.wrap(function(proceed,btn,btnEl){var result=proceed.call(this,btn,btnEl);if(this.accesskey)btnEl.set({accesskey:this.accesskey});return result});
Ext.ux.grid.BufferView.prototype.renderUI=Ext.ux.grid.BufferView.prototype.renderUI.wrap(function(proceed,rendered){proceed.call(this,rendered);this.hmenu.insert(2,"-");this.hmenu.insert(3,{itemId:"wrapContent",text:this.wrapText})});
Ext.ux.maximgb.tg.GridView.prototype.initTemplates=Ext.ux.maximgb.tg.GridView.prototype.initTemplates.wrap(function(orig){var ts=this.templates||{};if(!ts.mastercell)ts.mastercell=new Ext.Template('<td class="x-grid3-col x-grid3-cell x-grid3-td-{id} {css}" style="{style}" tabIndex="0" {cellAttr}>','<div class="ux-maximgb-tg-mastercell-wrap">',"{treeui}",'<div class="x-grid3-cell-inner x-grid3-col-{id}" {attr}>{value}</div>',"</div>","</td>");this.templates=ts;return orig.call(this)});
Ext.ux.maximgb.tg.GridView.prototype.ensureVisibleTree=function(row,col,hscroll){return Ext.ux.maximgb.tg.GridView.superclass.ensureVisible.call(this,row,col,hscroll)};
Ext.override(Ext.ux.maximgb.tg.GridView,{doRender:function(cs,rs,ds,startRow,colCount,stripe,onlyBody){var ts=this.templates,ct=ts.cell,rt=ts.row,rb=ts.rowBody,last=colCount-1;var rh=this.getStyleRowHeight();var vr=this.getVisibleRows();var tstyle="width:"+this.getTotalWidth();var tstyleWidthOnly="width:"+this.getTotalWidth();var tsytleAndHeight=tstyle+";height:"+rh+"px;";if(this.variableRowHeight!==true)tstyle=tsytleAndHeight;var buf=[],cb,c,p={},rpdisplayed={tstyle:tstyle},rphidden={tstyle:tsytleAndHeight},
r;for(var j=0,len=rs.length;j<len;j++){var rp=rpdisplayed;r=rs[j];cb=[];if(r===undefined)r=Ext._EMPTY_RECORD;var rowIndex=j+startRow;var visible=rowIndex>=vr.first&&rowIndex<=vr.last&&this.isVisible(rowIndex,vr);if(r.IS_EMPTY===true)this._ghostCache[rowIndex]=true;if(visible||this._cache[rowIndex]&&!visible)this._cache[rowIndex]=visible;if(visible){for(var i=0;i<colCount;i++){c=cs[i];p.id=c.id;p.css=i===0?"x-grid3-cell-first ":i===last?"x-grid3-cell-last ":"";p.attr=p.cellAttr="";p.value=c.renderer.call(c.scope,
r.get(c.name),p,r,rowIndex,i,ds);p.style=c.style;if(Ext.isEmpty(p.value))p.value="&#160;";if(this.markDirty&&r.dirty&&typeof r.modified[c.name]!=="undefined")p.css+=" x-grid3-dirty-cell";if(c.id===this.grid.master_column_id){p.treeui=this.renderCellTreeUI(r,ds);ct=ts.mastercell}else{p.treeui="";ct=ts.cell}if(c.scope.isWrapped){p.css+="x-grid3-cell-wrap";this.variableRowHeight=true}cb[cb.length]=ct.apply(p)}if(this.variableRowHeight===true)rp.tstyle=tstyleWidthOnly}else rp=rphidden;var alt=[];if(!onlyBody){if(stripe&&
(rowIndex+1)%2===0)alt[0]="x-grid3-row-alt";if(r.dirty)alt[1]=" x-grid3-dirty-row";rp.cols=colCount;if(typeof this.getRowClass==="function")alt[2]=this.getRowClass(r,rowIndex,rp,ds);rp.alt=alt.join(" ")}else rp.alt="";rp.cells=cb.join("");if(!ds.isVisibleNode(r,rowIndex))rp.display_style="display: none;";else rp.display_style="";rp.level=ds.getNodeDepth(r);buf[buf.length]=!visible?ts.rowHolder.apply(rp):onlyBody?rb.apply(rp):rt.apply(rp)}return buf.join("")},_processNodes:function(nodes,indexes,store){for(var i=
0,l=nodes.length;i<l;i++){var record=nodes[i];var nodeIndex=record._index;if(!nodeIndex)nodeIndex=store.indexOf(record);indexes.push(nodeIndex);var hasChildren=!store.isLeafNode(record);var needToGetChildren=hasChildren&&store.isExpandedNode(record);if(needToGetChildren)this._processNodes(store.getNodeChildren(record),indexes,store)}},_allRenderable:function(store){var indexes=[];var origCacheState=store.useChildNodeCache;try{store.enableChildNodeCache();if(!(store===undefined||store===null)){var rootNodes=
store.getRootNodes();this._processNodes(rootNodes,indexes,store)}}finally{if(!origCacheState)store.disableChildNodeCache()}return indexes}});
Ext.grid.GroupingView.prototype.onGroupByClick=Ext.grid.GroupingView.prototype.onGroupByClick.wrap(function(proceed){this.groupingAction=true;if(this.isLocked){this.isLocked=false;this.el.dom.innerHTML="";this.templates=undefined;this.initTemplates();this.renderUI(true);this.grid.fireEvent("render",this.grid)}PTC.jca.setGroupingChangedByClient(this.grid.id);proceed.call()});
Ext.grid.GroupingView.prototype.onShowGroupsClick=Ext.grid.GroupingView.prototype.onShowGroupsClick.wrap(function(proceed,mi,checked){PTC.jca.setGroupingChangedByClient(this.grid.id);proceed.call(this,mi,checked)});
Ext.menu.Item.prototype.onClick=Ext.menu.Item.prototype.onClick.wrap(function(proceed,e){if(getWindow().PTC.performance.Timer.InfoEnabled){var gridId=PTC.jca.table.Utils.getComponentIDForMenu(this.ownerCt.id);PTC.performance.startComponentTimer(gridId);PTC.performance.startComponentActionTimer("Menu Action",gridId)}proceed.call(this,e)});
if(Ext.isWebKit)Ext.override(Ext.grid.ColumnModel,{getTotalWidth:function(includeHidden){if(!this.totalWidth){var boxsizeadj=3;this.totalWidth=0;for(var i=0,len=this.config.length;i<len;i++)if(includeHidden||!this.isHidden(i))this.totalWidth+=this.getColumnWidth(i)+boxsizeadj}return this.totalWidth}});
if(Ext.isChrome)Ext.override(Ext.ux.grid.LockingColumnModel,{getTotalLockedWidth:function(){var totalWidth=0;var boxsizeadj=3;for(var i=0,len=this.config.length;i<len;i++)if(this.isLocked(i)&&!this.isHidden(i))totalWidth+=this.getColumnWidth(i)+boxsizeadj;return totalWidth}});
Ext.ux.maximgb.tg.AbstractTreeStore.prototype.loadRecords=function(o,options,success){if(!o||success===false){if(success!==false)this.fireEvent("load",this,[],options);if(options.callback)options.callback.call(options.scope||this,[],options,false);return}var r=o.records,t=o.totalRecords||r.length,page_offset=this.getPageOffsetFromOptions(options),loaded_node_id=this.getLoadedNodeIdFromOptions(options),loaded_node,i,len,prev_record,record,idx,updated,self=this;if(!options||options.add!==true){if(this.pruneModifiedRecords)this.modified=
[];for(i=0,len=r.length;i<len;i++)r[i].join(this);if(this.snapshot){this.data=this.snapshot;delete this.snapshot}if(!options||options.add!==true)this.data.clear();this.data.addAll(r);this.page_offset=page_offset;this.totalLength=t;if(len>0&&(this.isLoading&&!this.isLoading()||!this.chunk))this.applySort();this.fireEvent("datachanged",this)}else{if(loaded_node_id)loaded_node=this.getById(loaded_node_id);if(loaded_node){this.setNodeLoaded(loaded_node,true);this.setNodeChildrenOffset(loaded_node,page_offset);
this.setNodeChildrenTotalCount(loaded_node,Math.max(t,r.length));this.removeNodeDescendants(loaded_node)}var eventAlreadySuspended=this.eventsSuspended;this.suspendEvents();updated={};for(i=0,len=r.length;i<len;i++){record=r[i];idx=-1;if(idx==-1)this.add(record);else{updated[record.id]=true;prev_record=this.getAt(idx);prev_record.reject();prev_record.data=record.data;r[i]=prev_record}}if(len>0&&(this.isLoading&&!this.isLoading()||!this.chunk))this.applySort();if(!eventAlreadySuspended)this.resumeEvents();
if(r.length>2&&!this.eventsSuspended)this.fireEvent("datachanged",this);else if(!this.eventsSuspended)for(i=0,len=r.length;i<len;i++){record=r[i];if(updated[record.id]===true)this.fireEvent("update",this,record,Ext.data.Record.COMMIT);else this.fireEvent("add",this,[record],this.data.indexOf(record))}}this.fireEvent("load",this,r,options);if(options.callback)options.callback.call(options.scope||this,r,options,true)};PTC.part={};
PTC.part.paste=function(){var INITIAL_ROWS_PREFIX="initialRows_";return{appendTableOidsToForm:function(evt){var tableId=tableUtils.findTableID(evt);appendFormHiddenInput(getMainForm(),INITIAL_ROWS_PREFIX+tableId,"");PTC.jca.table.Utils.updateInitialRows(tableId)},validatePaste:function(evt,validationSelector){PTC.part.paste.appendTableOidsToForm(evt);return onClickValidation(evt,validationSelector)}}}();PTC.partslink={};PTC.partslink.refine={};PTC.partslink.result={};PTC.partslink.freeform={};
PTC.partslink.findSimilar={};PTC.partslink.suma={};PTC.partslink.suma.typeArray=new Array("Part","Manufacture","Vendor");PTC.partslink.suma.imageArray=new Array("wtcore/images/part.gif","wtcore/images/suma/mfr_part.gif","wtcore/images/suma/vdr_part.gif");PTC.partslink.refine.valListSeparator="|";PTC.partslink.refine.EnumerationValues={};PTC.partslink.refine.PropertyEnumerationMap={};
PTC.partslink.refine.createDisplayValueVsInternalValueMap=function(selectObject,fldID){PTC.partslink.refine.EnumerationValues={};for(var i=0;i<selectObject.length;i++){var displayName=selectObject.options[i].text;var internalValue=selectObject.options[i].value;PTC.partslink.refine.EnumerationValues[displayName]=internalValue}PTC.partslink.refine.PropertyEnumerationMap[fldID]=PTC.partslink.refine.EnumerationValues};
PTC.partslink.refine.updateEnumeratedFieldValues=function(enumeratedAttributeValues,fldID){if(PTC.partslink.refine.PropertyEnumerationMap[fldID]==undefined){var selectBoxField=document.getElementById("csmSearchOperator_"+fldID);PTC.partslink.refine.createDisplayValueVsInternalValueMap(selectBoxField,fldID)}var tokenizedValues=enumeratedAttributeValues.value.split("|");var internalValueField=document.getElementById(fldID+"_internalValues");internalValueField.value="";PTC.partslink.refine.changed(internalValueField,
internalValueField.value);for(var i=0;i<tokenizedValues.length;i++){var entry=tokenizedValues[i].trim();var internalValue;if(PTC.partslink.refine.PropertyEnumerationMap[fldID][entry]!=null){internalValue=PTC.partslink.refine.PropertyEnumerationMap[fldID][entry];if(PTC.partslink.refine.isDuplicate(internalValue,internalValueField.value))continue;else{internalValueField.value+=" "+PTC.partslink.refine.valListSeparator+" "+internalValue;PTC.partslink.refine.changed(internalValueField,internalValueField.value);
continue}}else if(!PTC.partslink.refine.isDuplicate(entry,internalValueField.value)){internalValueField.value+=" "+PTC.partslink.refine.valListSeparator+" "+entry;PTC.partslink.refine.changed(internalValueField,internalValueField.value);continue}}};
PTC.partslink.checkEnumEnterPressed=function(selectObject,fldID,event,context){if(event.keyCode==13){Event.stop(event);PTC.partslink.refine.updateEnumeratedFieldValues(selectObject,fldID);if(context=="REFINE_SEARCH")PTC.partslink.refine.submitRefineSearch();else if(context=="FIND_SIMILAR_SEARCH")PTC.partslink.findSimilar.submitFindSimilar()}};
PTC.partslink.refine.addTextToField=function(selectObject,fldId){PTC.partslink.refine.createDisplayValueVsInternalValueMap(selectObject,fldId);var selectIndex=selectObject.selectedIndex;var selectText=selectObject.options[selectIndex].text;var internalValue=selectObject.options[selectIndex].value;var field=document.getElementById(fldId);var internalValueField=document.getElementById(fldId+"_internalValues");if(selectIndex==0){field.value="";internalValueField.value="";PTC.partslink.refine.changed(field,
field.value);PTC.partslink.refine.changed(internalValueField,internalValueField.value)}else if(field.value!=""){if(!PTC.partslink.refine.isDuplicate(selectText,field.value)){field.value+=" "+PTC.partslink.refine.valListSeparator+" "+selectText;PTC.partslink.refine.changed(field,field.value)}if(!PTC.partslink.refine.isDuplicate(internalValue,internalValueField.value)){internalValueField.value+=" "+PTC.partslink.refine.valListSeparator+" "+internalValue;PTC.partslink.refine.changed(internalValueField,
internalValueField.value)}}else{field.value=selectText;internalValueField.value=internalValue;PTC.partslink.refine.changed(field,field.value);PTC.partslink.refine.changed(internalValueField,internalValueField.value)}};
PTC.partslink.refine.isDuplicate=function(listItem,text){var start=0;var textLen=text.length;while(start<textLen){var ch=text.charAt(start);if(ch==" "||ch==PTC.partslink.refine.valListSeparator){start++;continue}else{var sepPos=text.indexOf(PTC.partslink.refine.valListSeparator,start);if(sepPos==-1)sepPos=textLen;var itemLen=listItem.length;for(var j=0;start<sepPos;start++){var ch;if(j>=itemLen)ch=" ";else{ch=listItem.charAt(j);j++}if(text.charAt(start)!=ch)break}if(start>=sepPos&&j>=itemLen)return true;
start=sepPos+1}}return false};PTC.partslink.refine.changed=function(field,theValue){var form_elements=getMainForm().elements;var field_ID=field.id;var field_element=form_elements[field_ID];field_element.value=theValue};PTC.partslink.refine.refinePageTooltip=function(selectTxtBox){selectTxtBox.title=selectTxtBox.value};
PTC.partslink.refine.makeVisible=function(rowID,selection){var selectIndex=selection.selectedIndex;var rangeDefault=document.getElementById(rowID);var rangeHi=document.getElementById("rangeHi_"+rowID);var rangeHiphen=document.getElementById("refineDo:Hiphen"+rowID);var rangeLow=document.getElementById("rangeLow_"+rowID);if(selectIndex==3){rangeDefault.style.display="none";rangeHi.style.display="inline";rangeHiphen.style.display="inline";rangeLow.style.display="inline"}else{rangeDefault.style.display=
"inline";rangeHi.style.display="none";rangeHiphen.style.display="none";rangeLow.style.display="none";if(selectIndex==0){rangeDefault.value="";rangeHi.value="";rangeLow.value=""}}var grid=tableUtils.getTable("partslink.refine.attributeTableBuilder");var columnIndex=grid.getColumnModel().getIndexById("Value");grid.jcaHeaderResize(grid,columnIndex)};
PTC.partslink.refine.submitRefineSearch=function(){var executeSearch=document.getElementById("executeSearch");executeSearch.value=true;var url="ptc1/websearch/refine";submitTo(url);return false};PTC.partslink.findSimilar.submitFindSimilar=function(){var executeSearch=document.getElementById("executeSearch");executeSearch.value=true;var url="ptc1/websearch/findsimilar";submitTo(url);return false};
PTC.partslink.result.searchResults=function(){var classVar=document.getElementById("class").value;var url="ptc1/websearch/refine?class="+encodeURI(classVar);url=url+"&executeSearch=true";PTC.navigation.loadContent(getBaseHref()+url);return false};PTC.partslink.result.viewAllResults=function(){var classVar=document.getElementById("class").value;var url="ptc1/websearch/refine?class="+encodeURI(classVar);url=url+"&action=results";PTC.navigation.loadContent(getBaseHref()+url);return false};
PTC.partslink.result.viewSchematic=function(){var url=document.getElementById("schematicURL").value;var options="menubar=0,toolbar=0,resizable=1,scrollbars=0";wfWindowOpen(getBaseHref()+url,target="_blank",options);return false};PTC.partslink.result.goToRefineSearch=function(){var classVar=document.getElementById("class").value;var url="ptc1/websearch/refine?class="+encodeURI(classVar);PTC.navigation.loadContent(getBaseHref()+url);return false};
PTC.partslink.freeform.PTLcheckKeyPressed=function(e,eleName){if(e.keyCode==13){Event.stop(e);var ele=document.getElementsByName(eleName);ele[0].click()}};PTC.partslink.freeform.submitFreeFormSearch=function(){var freeFormSearchText=document.getElementById("freeFormSearchBox").value;if(freeFormSearchText.trim().length>0){var url="ptc1/websearch/freeform?freeFormSearchBox="+encodeURI(freeFormSearchText);PTC.navigation.loadContent(url)}return false};
PTC.partslink.suma.submitTypeChange=function(typeString){var classEle=$("class");var classVar=classEle.value;PTC.util._setMainFormStartingElement(classEle);getMainForm().action="ptc1/websearch/start?class="+encodeURI(classVar)+"&"+encodeURI(typeString);PTC.navigation.submitForm();return true};
PTC.partslink.suma.sumaCheckBox=function(typeID,typeLabel,imageString,value){var img=getBaseHref()+imageString;var chkItem=new Ext.form.Checkbox({checked:value,id:typeID,boxLabel:'<img src="'+img+'"/>'+" "+typeLabel,renderTo:"sumaCheckBox",listeners:{check:PTC.partslink.suma.checkSumaPartTypesListener}});chkItem.wrap.addClass("chk-same-line")};
PTC.partslink.suma.renderSumaCheckBoxes=function(searchString,typeLabel){var selectedTypeArray=new Array;var chked=false;selectedTypeArray=searchString.split(",");for(var index=0;index<PTC.partslink.suma.typeArray.length;index++){chked=false;for(var selectedIndex=0;selectedIndex<selectedTypeArray.length;selectedIndex++)if(selectedTypeArray[selectedIndex].trim()==PTC.partslink.suma.typeArray[index])chked=true;PTC.partslink.suma.sumaCheckBox(PTC.partslink.suma.typeArray[index],typeLabel[index],PTC.partslink.suma.imageArray[index],
chked)}};PTC.partslink.suma.checkSumaPartTypesListener=function(){var str="";for(i=0,k=0;i<PTC.partslink.suma.typeArray.length;i++)if(Ext.getCmp(PTC.partslink.suma.typeArray[i]).getValue()){if(k==0)str="partType="+PTC.partslink.suma.typeArray[i];else str=str+"&partType="+PTC.partslink.suma.typeArray[i];k=k+1}if(k==0){var noSelectionErrorMsg=document.getElementById("noSelectionErrorMsg").value;alert(noSelectionErrorMsg);Ext.getCmp(this.id).setValue(true);return}PTC.partslink.suma.submitTypeChange(str)};
PTC.partslink.submitSourceContext=function(){var classVar=document.getElementById("class").value;var url="ptc1/websearch/refine?class="+encodeURI(classVar);url=url+"&action=results";submitTo(url);return false};
PTC.partslink.submitOtherMatchedClass=function(){var classVar=document.getElementById("matchedClasses").value;var oldomclass=document.getElementById("class").value;var url="ptc1/websearch/refine?action=freeform";url=url+"&class="+encodeURI(classVar)+"&oldmatchedclass="+encodeURI(oldomclass);PTC.navigation.loadContent(url);return false};
PTC.partslink.checkEnterPressed=function(event,context){if(event.keyCode==13){Event.stop(event);if(context=="REFINE_SEARCH")PTC.partslink.refine.submitRefineSearch();else if(context=="FIND_SIMILAR_SEARCH")PTC.partslink.findSimilar.submitFindSimilar()}};PTC.partAlternateRepUI={};PTC.partAlternateRepUI.callOpenInCADTool=function(openInCadTool){eval(openInCadTool)};
PTC.partAlternateRepUI.redirectToUpdatedCARInfoPage=function viewInfo(oid,workspaceName,topLevelEPMDocumentOid){var redirectURL="ptc1/tcomp/infoPage?oid="+oid;if(workspaceName!=null&&workspaceName.trim()!=""){var wsName={wsName:workspaceName.trim()};redirectURL+="&"+Ext.urlEncode(wsName)}PTC.partAlternateRepUI["carRedirectUrl"]=redirectURL;if(top&&top.window&&top.window.external&&top.window.external.ptc){var redirectCallback=function(){window.parent.PTC.navigation.loadContent(PTC.partAlternateRepUI.carRedirectUrl)};
window.WildfireUserAgent="Wildfire";window.refreshInfoServerContent=new Array;window.refreshInfoServerContent[0]=oid;if(topLevelEPMDocumentOid!=null&&topLevelEPMDocumentOid.trim()!="")window.refreshInfoServerContent[1]=topLevelEPMDocumentOid;window.refreshCCInfo(redirectCallback)}else window.parent.PTC.navigation.loadContent(PTC.partAlternateRepUI.carRedirectUrl)};
PTC.paste=function(){function getObjectHandle(){var objectHandle=opener.getElementByName("objectHandle");if(objectHandle&&objectHandle!==null)return objectHandle.value;else return""}return{getTableID:function(){var params=location.search.parseQuery();var tableID=null;if(typeof params.tableID==="string")tableID=params.tableID;else tableID=params.tableID[0];return tableID},pasteItems:function(objects,tableId,additionalParams){if(additionalParams){var json=Ext.util.JSON.decode(additionalParams);if(json&&
json.refreshOid)PTC.infoPage.refreshTop(json.refreshOid,true)}if(objects&&objects!==null&&objects.length>0){var list=objects.split("#");var params;if(list.length<=100)params={doAjaxUpdate:true,preventDuplicates:true};else params={refreshTable:true,preventDuplicates:true};rowHandler.addRows(list,tableId,null,params)}},pasteSelectItems:function(objects,tableId,status,pasteFunc,additionalParams){pasteFunc(objects,tableId,additionalParams);handleWizWindow(status)},launchPasteSelectItems:function(title,
message,js){if(message!==null)title=title+"\n\n"+message;if(wfconfirm_gen(title))eval(js)},copyTableRowElements:function(){var mform=getMainForm();var objHandle=getObjectHandle();var itemTypeInstanceId=opener.getElementByName(objHandle+"itemTypeInstanceId");if(itemTypeInstanceId)appendFormHiddenInput(mform,"itemTypeInstanceId",itemTypeInstanceId.value);var editObjRef=opener.getElementByName(objHandle+"editObjectRef");if(editObjRef)appendFormHiddenInput(mform,"editObjectRef",editObjRef.value);var INITIAL_ROWS_PREFIX=
"initialRows_";var ADDED_ROWS_PREFIX="addRows_";var REMOVED_ROWS_PREFIX="rmRows_";var tableId=tableUtils.getUnformattedTableId(PTC.paste.getTableID());var initialOidNode=opener.tableUtils.getInitialRows(tableId);var addedOidNode=opener.tableUtils.getAddedRows(tableId);var removedOidNode=opener.tableUtils.getRemovedRows(tableId);var initialOidValue=initialOidNode&&initialOidNode!==null?initialOidNode.value:"";var addedOidValue=addedOidNode&&addedOidNode!==null?addedOidNode.value:"";var removedOidValue=
removedOidNode&&removedOidNode!==null?removedOidNode.value:"";appendFormHiddenInput(mform,INITIAL_ROWS_PREFIX+tableId,initialOidValue);appendFormHiddenInput(mform,ADDED_ROWS_PREFIX+tableId,addedOidValue);appendFormHiddenInput(mform,REMOVED_ROWS_PREFIX+tableId,removedOidValue)}}}();var RelatedChanges=function(){return{show:function(vrRef){var params={tabAction:"changesTab",tabType:"object"};PTC.infoPage.goTo(vrRef,params)},mouseOver:function(object){object.style.cursor="pointer"}}}();
PTC.performance={};PTC.performance.logger=log4javascript.getLogger("PTC.performance");PTC.performance.wizardTimer="wizardTimer";Ext.apply(PTC.performance,new Ext.util.Observable);PTC.performance.addEvents("pageReady");PTC.performance.GLOBAL_CLICK_TIMER=null;PTC.performance.filterStoreForUndefined=function(rec){return rec.get("Time")?true:false};PTC.performance.Timer=function(name){this.name=name;this.init()};
PTC.performance.Timer.prototype.init=function(){this.startTime=undefined;this.readyTime=undefined;this.titleReadyTime=undefined;this.stopTime=undefined;this.componentTimeBeans=[];this.initialWizardLaunch=false;this.actionDesc="Timed action started"};PTC.performance.Timer.prototype.getElapsedTime=function(){return(this.stopTime-this.getStartTime())/1E3};PTC.performance.Timer.prototype.start=function(){this.startTime=(new Date).getTime();PTC.performance.logger.trace("---restart timer at: ",this.startTime)};
PTC.performance.Timer.prototype.getStartTime=function(){var t=this.startTime;if(this.initialWizardLaunch){if(PTC.lightbox.isLightbox(self))t=top.PTC.performance.getTimer().startTime;else t=PTC.getMainWindow().PTC.performance.getTimer().startTime;PTC.performance.logger.trace("using time off the main window timer: ",t)}return t};PTC.performance.Timer.prototype.measure=function(){this.stopTime=(new Date).getTime()};PTC.performance.Timer.prototype.setReadyTime=function(){this.readyTime=(new Date).getTime()};
PTC.performance.Timer.prototype.getReadyElapsedTime=function(){return(this.readyTime-this.getStartTime())/1E3};PTC.performance.Timer.prototype.getTimeBean=function(timerId){var l=this.componentTimeBeans.length;var bean;for(var i=0;i<l;i++)if(this.componentTimeBeans[i].timerId===timerId){bean=this.componentTimeBeans[i];break}return bean};PTC.performance.Timer.prototype.pushTimeBean=function(b){this.componentTimeBeans.push(b)};
PTC.performance.Timer.prototype.flushLogs=function(){if(!this.renderTask)this.renderTask=new Ext.util.DelayedTask(this._flushLogs);this.renderTask.delay(300,null,this)};
PTC.performance.Timer.prototype._flushLogs=function(){var basicData=[];var addtlData=[];var pageReadyTime=-1;for(var i=0,l=this.componentTimeBeans.length;i<l;i++){if(this.componentTimeBeans[i].addtlLogFlag)this.componentTimeBeans[i].addRecords(addtlData);else this.componentTimeBeans[i].addRecords(basicData,addtlData);if(this.readyTime===undefined){var compReadyTimePer=this.componentTimeBeans[i].getReadyAttrib();if(compReadyTimePer>pageReadyTime)pageReadyTime=compReadyTimePer}else pageReadyTime=this.getReadyElapsedTime()}var basicStore;
var addtlStore;var timerRef=getWindow().PTC.performance.Timer;if(timerRef.enableUI){var chkbox=new Ext.form.Checkbox({boxLabel:"Additional Timers Enabled",listeners:{check:function(chkbox,checked){PTC.performance.Timer.handleChkBoxEvt(checked,timerDialog)}}});if(timerRef.enableAddtl)chkbox.setValue(true);var TDStateProvider=new PTC.jca.state.ClientStateProvider;var collapsedState=TDStateProvider.get("LBTWinCollapsed");if(collapsedState===undefined){TDStateProvider.set("LBTWinCollapsed",false);collapsedState=
false}var timerDialog=new Ext.Window({id:"timerWindow",title:"",model:true,autoScroll:true,collapsible:true,expandOnShow:!collapsedState,collapsed:collapsedState,width:560,height:205,bbar:new Ext.Toolbar({width:560,items:[chkbox]}),listeners:{beforecollapse:function(){TDStateProvider.set("LBTWinCollapsed",true)},beforeexpand:function(){TDStateProvider.set("LBTWinCollapsed",false)}}});var gridTitle="Time Measurements [Action started on "+(new Date(this.getStartTime())).format("H:i:s.u")+"]";basicStore=
PTC.performance.Timer.addGridComp(timerDialog,gridTitle,basicData);if(timerRef.enableAddtl)addtlStore=PTC.performance.Timer.addGridComp(timerDialog,"Additional Time Measurements",addtlData);this.refreshTitle(timerDialog,pageReadyTime);timerDialog.show()}if(timerRef.enableLogs){PTC.performance.logAllMessages(basicStore);if(timerRef.enableAddtl)PTC.performance.logAllMessages(addtlStore);PTC.log.sendAllMessages()}};
PTC.performance.Timer.addGridComp=function(timerDialog,panelTitle,dataToLoad){var store=new Ext.data.GroupingStore({reader:new Ext.data.ArrayReader({fields:[{name:"Event"},{name:"Time"},{name:"timeBeanId"}]}),groupField:"timeBeanId"});store.loadData(dataToLoad);store.filterBy(PTC.performance.filterStoreForUndefined);var grid=new Ext.grid.GridPanel({groupBy:"timeBeanId",store:store,colModel:new Ext.grid.ColumnModel({columns:[{id:"Event",header:"Event",width:160,groupable:false},{id:"Time",header:"Time(seconds)",
width:160,groupable:false},{dataIndex:"timeBeanId",header:"id",hidden:true}]}),autoExpandColumn:"Event",height:"auto",autoHeight:true,width:600,title:panelTitle,view:new Ext.grid.GroupingView({groupTextTpl:"Measurements for {gvalue}"})});timerDialog.add(grid);return store};
PTC.performance.Timer.handleChkBoxEvt=function(checked,timerDialog){var timerRef=getWindow().PTC.performance.Timer;if(timerRef.enableAddtl!==checked){timerRef.enableAddtl=checked;PTC.performance.pushToServer(true,timerRef.enableLogs,timerRef.enableAddtl)}};
PTC.performance.Timer.prototype.refreshTitle=function(timerDialog,pageReadyTime){var prefix="<u>Page Timer</u> -  Ready : ";var prefixLog="Page Timer -  Ready : ";var separator=" s  |  Complete : ";var suffix=" s";var completeTime=(this.stopTime-this.getStartTime())/1E3;if(pageReadyTime<0)pageReadyTime=completeTime;timerDialog.titleReadyTime=pageReadyTime;var title=pageReadyTime.toFixed(3)+separator+completeTime.toFixed(3)+suffix;timerDialog.setTitle(prefix+title);if(getWindow().PTC.performance.Timer.enableLogs){if(this.actionDesc!==
undefined){PTC.performance.logger.debug("Timed activity description : "+this.actionDesc);this.actionDesc=undefined}PTC.performance.logger.debug(prefixLog+title)}};PTC.performance.getTimer=function(){var timerRef=getWindow().PTC.performance.Timer;if(timerRef.InfoEnabled){var globalTimer=timerRef.GLOBAL_CLICK_TIMER;if(!globalTimer){timerRef.GLOBAL_CLICK_TIMER=new PTC.performance.Timer("Navigator_click");timerRef.GLOBAL_CLICK_TIMER.start();globalTimer=timerRef.GLOBAL_CLICK_TIMER}return globalTimer}};
PTC.performance.getTimerJSONStr=function(){var timerRef=getWindow().PTC.performance.Timer;if(timerRef.InfoEnabled){var timerJSON=JSON.stringify(timerRef.GLOBAL_CLICK_TIMER);return timerJSON}};PTC.performance.getTimeMeasureFor=function(componentId,checkpoint){if(getWindow().PTC.performance.Timer.InfoEnabled){var timer=PTC.performance.getTimer();var componentTimerBean=timer.getTimeBean(componentId);return componentTimerBean.getCheckPointTime(checkpoint)}};
PTC.performance.restartTimer=function(){if(getWindow().PTC.performance.Timer.InfoEnabled){var timer=PTC.performance.getTimer();timer.init();timer.start();return timer}};PTC.performance.startComponentTimer=function(componentId,defaultMessage,addtlLogFlag){return PTC.performance.startTimeGauge(componentId,defaultMessage,addtlLogFlag)};
PTC.performance.startTimeGauge=function(componentId,defaultMessage,addtlLogFlag){if(getWindow().PTC.performance.Timer.InfoEnabled){PTC.performance.logger.trace(">START ",componentId);var timer=PTC.performance.getTimer();var componentTimerBean=timer.getTimeBean(componentId);if(!componentTimerBean){componentTimerBean=new PTC.performance.TimeBean(componentId,defaultMessage);timer.pushTimeBean(componentTimerBean)}else componentTimerBean.initialize();componentTimerBean.start();if(addtlLogFlag!==undefined)if(addtlLogFlag)componentTimerBean.addtlLogFlag=
true}return componentTimerBean};PTC.performance.startComponentActionTimer=function(action,componentId){if(getWindow().PTC.performance.Timer.InfoEnabled){PTC.performance.logger.trace(">START action timer ",componentId);var timer=PTC.performance.getTimer();var componentTimerBean=timer.getTimeBean(componentId);if(componentTimerBean)componentTimerBean.startActionTimer(action);return componentTimerBean}};
PTC.performance.stopComponentTimer=function(componentId,componentTimerBean,event){if(getWindow().PTC.performance.Timer.InfoEnabled){var flushLogs=true;var timer=PTC.performance.getTimer();if(timer&&!PTC.isDefined(componentTimerBean))componentTimerBean=timer.getTimeBean(componentId);if(timer&&componentTimerBean){timer.measure();componentTimerBean.measure();PTC.performance.logger.trace("<<STOP ",componentId,"  event:",event," stopTime:",timer.stopTime);if(event==="firstChunk"){componentTimerBean.setFirstChunkRenderingTime(timer.getElapsedTime());
flushLogs=false}else if(event==="dataRendered")if(componentTimerBean.getTotalTableRenderingTime()===undefined)componentTimerBean.setTotalTableRenderingTime(timer.getElapsedTime());else{if(componentTimerBean.needsActionTime())componentTimerBean.setActionRenderingTime(componentTimerBean.stopTime)}else if(event==="emptyTable"){componentTimerBean.setEmptyTableRenderingTime(timer.getElapsedTime());flushLogs=false}else if(event==="tableResized"){if(componentTimerBean.needsActionTime())componentTimerBean.setActionRenderingTime(componentTimerBean.stopTime)}else if(event===
"rowFocus"){if(componentTimerBean.needsActionTime())componentTimerBean.setActionRenderingTime(componentTimerBean.stopTime)}else if(event==="deltaTime")componentTimerBean.setTimeToRenderFromLastClick(componentTimerBean.getElapsedTime());else componentTimerBean.setTimeToRenderFromLastClick(timer.getElapsedTime());if(flushLogs)timer.flushLogs()}else PTC.performance.logger.trace("<<STOP called but no timeBean found? ",componentId,"  event:",event," timeBean: ",componentTimerBean)}};
PTC.performance.stopTimeGauge=function(scenarioId,checkpoint,flushLogs,mode,addtlLogFlag){if(getWindow().PTC.performance.Timer.InfoEnabled){var timer=PTC.performance.getTimer();var componentTimerBean=timer.getTimeBean(scenarioId);if(timer&&componentTimerBean){timer.measure();componentTimerBean.measure();if(checkpoint===undefined)checkpoint=componentTimerBean.defaultMessage;PTC.performance.logger.trace("<<STOP ",scenarioId,"  checkpoint:",checkpoint," mode 0 Time:",timer.stopTime," mode 1 Time:",componentTimerBean.stopTime);
if(mode===1)componentTimerBean.setCheckPointTime(checkpoint,componentTimerBean.getElapsedTime(),addtlLogFlag);else componentTimerBean.setCheckPointTime(checkpoint,timer.getElapsedTime(),addtlLogFlag);if(flushLogs)timer.flushLogs()}else PTC.performance.logger.trace("<<STOP called but no timeBean found? ",scenarioId," checkpoint: ",checkpoint)}};PTC.performance.TimeBean=function(timerId,defaultMessage){this.timerId=timerId;this.defaultMessage=defaultMessage||"Time taken since last timer restart";this.initialize()};
PTC.performance.TimeBean.prototype.initialize=function(){this.timeToRenderFromLastClick=undefined;this.emptyTableRenderingTime=undefined;this.firstChunkRenderingTime=undefined;this.totalTableRenderingTime=undefined;this.loadWizardStep=undefined;this.loadWizardFromClick=undefined;this.startTime=undefined;this.stopTime=undefined;this.menuRendered=undefined;this.actions=[];this.checkpoints=[];this.addtlLogFlag=undefined};
PTC.performance.TimeBean.ReadyAttribs=["firstChunkRenderingTime","timeToRenderFromLastClick","totalTableRenderingTime"];PTC.performance.TimeBean.prototype.getReadyAttrib=function(){for(var attIdx in PTC.performance.TimeBean.ReadyAttribs)if(typeof PTC.performance.TimeBean.ReadyAttribs[attIdx]!=="function"){attr=PTC.performance.TimeBean.ReadyAttribs[attIdx];if(this[attr]!==undefined)return this[attr]}};
PTC.performance.TimeBean.prototype.addRecords=function(basicData,addtlData){var id=this.timerId;if(addtlData===undefined)addtlData=basicData;basicData.push(["Processing Started",this.getProcessingStartTime(),id]);basicData.push(["Empty Table Displayed",this.emptyTableRenderingTime,id]);basicData.push(["First Chunk Displayed",this.firstChunkRenderingTime,id]);basicData.push(["Complete Table Displayed",this.totalTableRenderingTime,id]);if(this.checkpoints)for(var i=0,il=this.checkpoints.length;i<il;i++){var checkpoint=
this.checkpoints[i];if(checkpoint.totalActionTime)if(checkpoint.addtlLogFlag){if(getWindow().PTC.performance.Timer.enableAddtl)addtlData.push([checkpoint.id,checkpoint.totalActionTime,id])}else basicData.push([checkpoint.id,checkpoint.totalActionTime,id])}basicData.push([this.defaultMessage,this.timeToRenderFromLastClick,id]);if(getWindow().PTC.performance.Timer.enableAddtl)if(this.actions)for(var j=0,jl=this.actions.length;j<jl;j++){var action=this.actions[j];if(action.totalActionTime)addtlData.push([action.id,
action.totalActionTime,id])}};PTC.performance.TimeBean.prototype.getEmptyTableRenderingTime=function(){return this.emptyTableRenderingTime};PTC.performance.TimeBean.prototype.setEmptyTableRenderingTime=function(t){this.emptyTableRenderingTime=t};PTC.performance.TimeBean.prototype.getProcessingStartTime=function(){var processingStartTime=undefined;if(this.emptyTableRenderingTime!==undefined){var timer=PTC.performance.getTimer();processingStartTime=(this.startTime-timer.startTime)/1E3}return processingStartTime};
PTC.performance.TimeBean.prototype.getFirstChunkRenderingTime=function(){return this.firstChunkRenderingTime};PTC.performance.TimeBean.prototype.setFirstChunkRenderingTime=function(t){this.firstChunkRenderingTime=t};PTC.performance.TimeBean.prototype.getTotalTableRenderingTime=function(){return this.totalTableRenderingTime};PTC.performance.TimeBean.prototype.setTotalTableRenderingTime=function(t){this.totalTableRenderingTime=t};
PTC.performance.TimeBean.prototype.getElapsedTime=function(){return(this.stopTime-this.startTime)/1E3};PTC.performance.TimeBean.prototype.setTimeToRenderFromLastClick=function(t){this.timeToRenderFromLastClick=t};PTC.performance.TimeBean.prototype.startActionTimer=function(action){if(!this.actions)this.actions=[];this.actions.push({id:action,startTime:(new Date).getTime()})};
PTC.performance.TimeBean.prototype.needsActionTime=function(){var foundMissingStop=false;if(this.actions)this.actions.each(function(item){if(typeof item.totalActionTime==="undefined")foundMissingStop=true});return foundMissingStop};PTC.performance.TimeBean.prototype.setActionRenderingTime=function(t){this.actions.each(function(item){if(!item.totalActionTime)item.totalActionTime=(t-item.startTime)/1E3})};
PTC.performance.TimeBean.prototype.getCheckPointTime=function(checkpoint){if(this.checkpoints){var cpl=this.checkpoints.length;for(var indx=0;indx<cpl;indx++)if(this.checkpoints[indx].id===checkpoint)return this.checkpoints[indx].totalActionTime}};PTC.performance.TimeBean.prototype.setCheckPointTime=function(checkpoint,t,alf){if(!this.checkpoints)this.checkpoints=[];if(alf===undefined)alf=false;this.checkpoints.push({id:checkpoint,totalActionTime:t,addtlLogFlag:alf})};
PTC.performance.TimeBean.prototype.start=function(){this.startTime=(new Date).getTime()};PTC.performance.TimeBean.prototype.measure=function(){this.stopTime=(new Date).getTime()};PTC.performance.logAllMessages=function(store){if(store!==undefined)store.each(function(rec){var time=rec.get("Time");if(time){var timerId=rec.get("timeBeanId");PTC.performance.logger.debug(timerId," :: "+rec.get("Event")+": ",time)}})};
PTC.performance.enableClientLogger=function(enableUI,enableLogs,enableAddtl,pushToServer){var timerRef=getWindow().PTC.performance.Timer;timerRef.InfoEnabled=true;timerRef.enableUI=enableUI;timerRef.enableLogs=enableLogs;timerRef.enableAddtl=enableAddtl;var mylogger=log4javascript.getLogger("PTC.performance");mylogger.setLevel(log4javascript.Level.DEBUG);PTC.performance.getTimer();if(pushToServer)PTC.performance.pushToServer(enableUI,enableLogs,enableAddtl);PTC.performance.addListeners()};
PTC.performance.pushToServer=function(enableUI,enableLogs,enableAddtl){var doEnable="";if(enableUI)doEnable="ui";if(enableLogs)doEnable=doEnable+"log";if(enableAddtl)doEnable=doEnable+"addtl";if(!enableUI&&!enableLogs)doEnable=false;var req=new Ajax.Request(getBaseHref()+"app/?clientLogger="+doEnable,{method:"get",onSuccess:TRUE_FUNC,onFailure:TRUE_FUNC})};PTC.performance.setActionDesc=function(description){var timer=PTC.performance.getTimer();if(timer)timer.actionDesc=description};
PTC.performance.startWizardTimer=function(timerId,initialWizardLaunch){if(getWindow().PTC.performance.Timer.InfoEnabled){if(initialWizardLaunch){PTC.performance.startComponentTimer("WIZARD","Wizard Loaded");PTC.performance.getTimer().initialWizardLaunch=true}PTC.performance.startComponentTimer("WIZ_STEP_"+timerId,"Step Loaded")}};PTC.performance.stopWizardTimer=function(stepId){PTC.performance.stopComponentTimer("WIZ_STEP_"+stepId)};PTC.performance.stopExpandTimer=function(){PTC.performance.stopComponentTimer("expand row")};
PTC.performance.expandRowTimerListener=function(s,rec){PTC.performance.startComponentTimer("expand row","Row Expanded");s.on("expandnode",PTC.performance.stopExpandTimer,null,{single:true})};PTC.performance.expandRowServerTimerListener=function(rc,params,tableId){var s=Ext.getCmp(tableId).store;if(PTC.jca.isAsync(s)){s.un("expandnode",PTC.performance.stopExpandTimer);s.on("dataSourceComplete",PTC.performance.stopExpandTimer)}};
PTC.performance.collapseRowTimerListener=function(s,rec){PTC.performance.startComponentTimer("collapse row","Row Collapsed");s.on("collapsenode",function(){PTC.performance.stopComponentTimer("collapse row")},null,{single:true})};PTC.performance.setPageReady=function(){var timer=PTC.performance.getTimer();if(timer)timer.setReadyTime()};PTC.performance.handleReadyEvent=function(){if(getWindow().PTC.performance.Timer.InfoEnabled){var timer=PTC.performance.getTimer();if(timer)timer.setReadyTime()}};
PTC.performance.addListeners=function(){Event.observe(window.document,"mousedown",function(){PTC.performance.restartTimer()});PTC.performance.on("pageReady",PTC.performance.handleReadyEvent);Ext.util.Observable.observeClass(Ext.grid.GridPanel);Ext.grid.GridPanel.on("rowcontextmenu",function(){PTC.performance.startComponentTimer("gridRowContextMenu","Menu Displayed")});PTC.menu.on("dynamicMenuShow",function(button,menu){PTC.performance.startComponentTimer(button.id,"Menu Displayed");menu.idForPerfLogger=
button.id});PTC.wizard.on("wizardLoadComplete",function(){PTC.performance.stopComponentTimer("WIZARD");PTC.performance.stopWizardTimer(getCurrentStep())});PTC.menu.on("dynamicMenuLoad",function(menu){var id=menu.idForPerfLogger?menu.idForPerfLogger:menu.id;PTC.performance.stopComponentTimer(id)});PTC.attributePanel.on("beforeRender",function(panel){PTC.performance.startComponentTimer(panel.id,"Attribute Panel Displayed");panel.on("afterrender",function(panel){PTC.performance.stopComponentTimer(panel.id)})});
PTC.performance.addTreeTimerListeners(Ext.ux.maximgb.tg.AdjacencyListStore,PTC.jca.DataSourceTreePagingStore);PTC.performance.addScrollTimerListeners()};
PTC.performance.addTreeTimerListeners=function(){for(var i=0,l=arguments.length;i<l;i++){var treeClass=arguments[i];Ext.util.Observable.observeClass(treeClass);treeClass.on("beforecollapsenode",PTC.performance.collapseRowTimerListener);treeClass.on("beforeexpandnode",PTC.performance.expandRowTimerListener);PTC.jca.tree.on("beforeexpandnodeserver",PTC.performance.expandRowServerTimerListener)}};
PTC.performance.tableScrollWrapper=function(proceed,a,b,c){var result=proceed.call(this,a,b,c);var perfRef=getWindow().PTC.performance;if(perfRef.Timer.InfoEnabled&&perfRef.tableScrollWrapper._isScrolling){PTC.performance.stopComponentTimer("scroll",null,"deltaTime");perfRef.tableScrollWrapper._isScrolling=false}return result};
PTC.performance.addScrollTimerListeners=function(){var perfRef=getWindow().PTC.performance;Ext.grid.GridPanel.on("bodyscroll",function(){if(perfRef.Timer.InfoEnabled){perfRef.tableScrollWrapper._isScrolling=true;PTC.performance.startComponentTimer("scroll","Scroll Updated")}});Ext.ux.grid.LockingGridView.prototype.doUpdate=Ext.ux.grid.LockingGridView.prototype.doUpdate.wrap(PTC.performance.tableScrollWrapper);Ext.ux.grid.BufferView.prototype.doUpdate=Ext.ux.grid.BufferView.prototype.doUpdate.wrap(PTC.performance.tableScrollWrapper)};
var searchPicker=new function(){this.clickedBtnId=null;this.setClickedBtnId=function(btnId){searchPicker.clickedBtnId=btnId}};
function PickerValidator(argSuggestParams){var suggestParams=argSuggestParams;var hasFocus=false;var validator=this;var field=$(suggestParams.suggestId);var launchingPicker=false;var btnId=null;this.setup=function(){Event.observe(field,"focus",this.handleOnFocus);Event.observe(field,"blur",this.handleOnBlur);validator.setBtnId()};this.handleOnFocus=function(){hasFocus=true};this.handleOnBlur=function(){hasFocus=false;if(launchingPicker==true){launchingPicker=false;return}setTimeout(function(){validator.checkFocusAndValidate()},
600)};this.checkFocusAndValidate=function(){if(btnId==searchPicker.clickedBtnId){searchPicker.clickedBtnId="";return}if(!hasFocus)validator.validatePicker()};this.validatePicker=function(){var fieldValue=field.value;if(fieldValue!=null&&fieldValue.trim().length>0){var hiddenFieldId=suggestParams.suggestId+"Hidden";var hiddenValue=$(hiddenFieldId).value;if(hiddenValue==null||hiddenValue.length==0){document.body.style.cursor="wait";validator.validateAjax()}}};this.validateAjax=function(){var parameters=
suggestParams.options.parameters;parameters=removeParamFromString("suggestable","?"+parameters);parameters=parameters+"&suggestable="+field.value;new Ajax.Request("servlet/SuggestServlet",{method:"post",parameters:parameters,onSuccess:validator.handleResults,onFailure:validator.handleError})};this.handleError=function(){document.body.style.cursor="auto";field.value=""};this.handleResults=function(response){if(200!=response.status){validator.handleError();return}var responseText=response.responseText;
$(suggestParams.suggestId+"Results").innerHTML=responseText;validator.checkResultsDiv()};this.checkResultsDiv=function(){var list=$(suggestParams.suggestId+"Results").getElementsByTagName("li");node=list[0];var isLaunchPicker=true;if(list.length==1){isLaunchPicker=false;var displayValue=node.firstChild.nodeValue;var valueNodes=Element.select(node,".value");var value=valueNodes[0].innerHTML.trim();if(value==null||value=="")isLaunchPicker=true;else{field.value=displayValue;validator.setPickerHiddenFields()}}document.body.style.cursor=
"auto";if(isLaunchPicker){validator.setFocus();validator.launchPicker();validator.clearPicker()}};this.setPickerHiddenFields=function(node){autoSuggestHandler.moveSuggestValue(field,node)};this.launchPicker=function(){launchingPicker=true;var btnHref=$(btnId).href;var launchScript=unescape(btnHref.substring("javascript:".length));eval(launchScript)};this.setBtnId=function(){var indxLabel=suggestParams.suggestId.indexOf("$label$");var pickerId=suggestParams.suggestId.substring(0,indxLabel);btnId=pickerId+
"_FIND_BTN"};this.setFocus=function(){field.focus();field.value=field.value};this.clearPicker=function(){field.value=""}}
TypePickerPreferenceCallback=function(pickerObject,fieldId,fieldTEId){var pickedObjects=pickerObject.pickedObjects;var internalFieldToUpdate=$(fieldId);var displayFieldToUpdate=$(fieldTEId);var newInternalValue="";var newDisplayValue="";for(var i=0,l=pickedObjects.length;i<l;i++){var theType=pickedObjects[i].theType;if(theType.indexOf("|")>0&&theType.indexOf("WCTYPE")==-1)theType="WCTYPE|"+theType;newInternalValue+=theType+",";newDisplayValue+=pickedObjects[i].unencodedType+", "}newInternalValue=
newInternalValue.substring(0,newInternalValue.length-1);newDisplayValue=newDisplayValue.substring(0,newDisplayValue.length-2);internalFieldToUpdate.value=newInternalValue;displayFieldToUpdate.value=newDisplayValue};Ext.namespace("PTC");
PTC.Progressbar=function(renderToId){Ext.util.CSS.createStyleSheet(".pbarLabel {text-align:right; height:10px;}");Ext.util.CSS.createStyleSheet(".statusLabel {text-align:left; height:10px;}");var statusLabel=bundleHandler.get("com.ptc.core.htmlcomp.htmlcompResource.STATUS_LABEL");var topLabelCtrl=new Ext.form.Label({cellCls:"pbarLabel",text:"",colspan:"2"});var statusLabelCtrl=new Ext.form.Label({cellCls:"statusLabel"});var progressBarCtrl=new Ext.ProgressBar({width:300,colspan:"2"});var bottomLabelCtrl=
new Ext.form.Label({cellCls:"pbarLabel"});var innerContainer=new Ext.Container({layout:"table",layoutConfig:{columns:2},style:{margin:"10px"},items:[topLabelCtrl,progressBarCtrl,statusLabelCtrl,bottomLabelCtrl]});var mainContainer=new Ext.Container({renderTo:renderToId,layout:"table",layoutConfig:{columns:1},style:{borderColor:"#6495ED",width:"320px",borderStyle:"solid",borderWidth:"1px",position:"relative",margin:"auto",top:"50%","margin-top":"-30px"}});mainContainer.add(innerContainer);mainContainer.doLayout();
statusLabelCtrl.update(statusLabel);return{update:function(topLabel,percentage){var percentageLabel=bundleHandler.get("com.ptc.core.htmlcomp.htmlcompResource.PERCENTAGE_COMPLETED");percentageLabel=percentageLabel.replace("{0}",percentage);topLabelCtrl.update(topLabel);bottomLabelCtrl.update(percentageLabel);progressBarCtrl.updateProgress(percentage/100,"")},remove:function(){mainContainer.destroy()}}};
function createLocationValidation(evt){var sels=getSelectedItems();if(sels.length>1){JCAAlert("com.ptc.projectmanagement.plannable.plannableResource.MULTIPLE_TASKS_SELECTED_ERROR");return false}if(sels[0]){var normalizedOid=normalizeForTree(sels[0].value);if(isPlan(normalizedOid)){JCAAlert("com.ptc.projectmanagement.plannable.plannableResource.INVALID_LOCATION_PLAN_SELECTED");return false}}return true}
function normalizeForTree(oidString){var result=null;if(oidString&&oidString.indexOf){var startIdx=oidString.lastIndexOf("$");if(startIdx!=-1){var caretIdx=oidString.lastIndexOf("^");if(caretIdx!=-1)startIdx=caretIdx;startIdx++;var endIdx=oidString.indexOf("!*",startIdx);if(endIdx==-1)endIdx=oidString.length;result=oidString.substring(startIdx,endIdx)}else result=oidString}return result}Ext.namespace("PTC.projectstatus");isProjectLinkInstalled=true;
PTC.projectstatus.projectStatusIcon=function(statusConfig){var config=Ext.copyTo({},statusConfig,"projectName,status, statusIcon,state,project2IconPath");this.tpl=new Ext.XTemplate(['<span class="breadcrumb">','<img title="{projectName}" alt="{projectName}" src="{project2IconPath}" />&nbsp;<label>{state}</label>&nbsp;<img title="{status}" alt="{status}" src="{statusIcon}" />',"</span>"],{compiled:true});PTC.projectstatus.projectStatusIcon.superclass.constructor.call(this,config);this.html=this.tpl.apply(config);
this.getHtml=function(){return this.html}};Ext.extend(PTC.projectstatus.projectStatusIcon,Ext.Container,{});
PTC.projectstatus.ProjectStatusPanel=Ext.extend(Ext.Panel,{id:"ProjectStatusPanelId",flex:1,height:25,width:175,layout:"hbox",layoutconfig:{padding:"1",align:"right"},border:false,header:false,listener:{beforerender:function(){PTC.projectstatus.ProjectStatusPanel.update}},addStatus:function(projectStatusItem){this.removeAll(true);var project2IconPath=projectStatusItem["project2IconPath"];if(project2IconPath!=null&&project2IconPath.length>0){var projectStatusIcon=new PTC.projectstatus.projectStatusIcon(projectStatusItem);
this.add(projectStatusIcon)}this.doLayout()}});
PTC.projectstatus.ProjectStatusPanel.update=function(url){if(url){var currentOid=decodeURIComponent(extractParamValue(url,"ContainerOid"));var isContainerOid="Y";if(!currentOid){currentOid=decodeURIComponent(extractParamValue(url,"oid"));isContainerOid="N"}var projectStatusControllerUrl=getBaseHref()+"ptc1/projectStatusController/";var ajaxOptions={method:"post",asynchronous:true,parameters:{oid:currentOid,isContainerOid:isContainerOid},onSuccess:PTC.projectstatus.ProjectStatusPanel.onSuccess};requestHandler.doRequest(projectStatusControllerUrl,
ajaxOptions)}};PTC.projectstatus.ProjectStatusPanel.update=PTC.util.delayAllCalls(PTC.projectstatus.ProjectStatusPanel.update,300);PTC.projectstatus.ProjectStatusPanel.onSuccess=function(result,options){var projectStatusItem=Ext.util.JSON.decode(result.responseText);var ProjectStatusPanelComp=Ext.getCmp("ProjectStatusPanelId");if(ProjectStatusPanelComp)ProjectStatusPanelComp.addStatus(projectStatusItem)};PTC.projectstatus.ProjectStatusPanel.refresh=function(refreshInfo){PTC.projectstatus.ProjectStatusPanel.update(window.location.href)};
PTC.projectstatus.ProjectStatusPanel.onObjectsAffected=function(formResult){var currentOid=decodeURIComponent(extractParamValue(window.location.href,"oid"));if(currentOid){var newUrl=PTC.util.replaceURLParam(window.location.href,"oid",encodeURIComponent(currentOid));PTC.projectstatus.ProjectStatusPanel.update(newUrl)}return true};
function buildHiddenList(fromList,toHidden,includeAll){var size=includeAll&&includeAll===true?fromList.length:fromList.length-1;var oids="";for(var i=0;i<size;i++)oids=oids+fromList[i].value+"#";toHidden.value=oids}
function moveMilestone(fromList,toList){var toListOptions=toList.options;var spaceOption=toListOptions[toListOptions.length-1];spaceOption=new Option(spaceOption.text,spaceOption.value,false,true);toListOptions[toListOptions.length-1]=null;toList.selectedIndex=-1;for(var selIndex=fromList.length-2;selIndex>=0;selIndex--){var fromListOption=fromList.options[selIndex];var trlID=fromListOption.getAttribute("trlId");if(fromListOption.selected){var toListOption=new Option(fromListOption.text,fromListOption.value,
false,true);toListOption.setAttribute("trlId",trlID);toListOptions[toListOptions.length]=toListOption;toListOption.selected=true;fromList[selIndex]=null}}spaceOption=new Option(spaceOption.text,spaceOption.value,false,true);toListOptions[toListOptions.length]=spaceOption;spaceOption.selected=false;fromList.options[fromList.length-1].selected=false;buildHiddenList(getMainForm().milestone_deliverables,getMainForm().hiddennewdeliverables)}
function addDeliverableToMilestone(){var fromList=getMainForm().all_deliverables;var toList=getMainForm().milestone_deliverables;moveMilestone(fromList,toList);return false}function removeDeliverableFromMilestone(){var fromList=getMainForm().milestone_deliverables;var toList=getMainForm().all_deliverables;moveMilestone(fromList,toList);return false}var firstTime=true;
function moveMilestone2(fromList,toList){if(firstTime){buildHiddenList(getMainForm().timeline_milestones,getMainForm().hiddenoldtimeline);firstTime=false}var toListOptions=toList.options;var spaceOption=toListOptions[toListOptions.length-1];spaceOption=new Option(spaceOption.text,spaceOption.value,false,true);toListOptions[toListOptions.length-1]=null;toList.selectedIndex=-1;for(var selIndex=fromList.length-2;selIndex>=0;selIndex--){var fromListOption=fromList.options[selIndex];if(fromListOption.selected){var toListOption=
new Option(fromListOption.text,fromListOption.value,false,true);toListOptions[toListOptions.length]=toListOption;toListOption.selected=true;fromList[selIndex]=null}}spaceOption=new Option(spaceOption.text,spaceOption.value,false,true);toListOptions[toListOptions.length]=spaceOption;spaceOption.selected=false;fromList.options[fromList.length-1].selected=false;buildHiddenList(getMainForm().timeline_milestones,getMainForm().hiddennewtimeline)}
function addMilestoneToTimeline(){var fromList=getMainForm().all_milestones;var toList=getMainForm().timeline_milestones;moveMilestone2(fromList,toList);return false}function removeMilestoneFromTimeline(){var fromList=getMainForm().timeline_milestones;var toList=getMainForm().all_milestones;moveMilestone2(fromList,toList);return false}PTC.isDefined=function(object){return object===undefined||object===null?false:true};
PTC.isDefinedAndNotEmptyString=function(object){return!PTC.isDefined(object)||object===""?false:true};
jsca.columns.pushButtonRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);result="<button ";if(data.id)result+=jsca.columns.idStr(data.id);result+='type="'+data.type+'" ';if(data.name)result+=jsca.columns.nameStr(data.name);result+=data.disabled?" disabled":" ";if(data.tooltip)result+=jsca.columns.tooltipStr(data.tooltip);if(typeof data.jsactions==="string")result+=data.jsactions;else $H(data.jsactions).each(function(pair){result+=pair.key+'="'+pair.value+
'" '});result+=">";result+=data.label;result+="</button>";result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};
jsca.columns.radioButtonGroupRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);var buttons=data.radioButtons;if(buttons)for(var i=0,l=buttons.length;i<l;i++){result+=jsca.columns._radioButtonRenderer(buttons[i]);result+="<br />"}if(data.id)result='<span id="'+data.id+'">'+result+"</span>";result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};
jsca.columns.radioButtonRenderer=function(table,column,row){var data=jsca.columns.getCellValue(column,row);return jsca.columns._radioButtonRenderer(data)};
jsca.columns._radioButtonRenderer=function(data){var result="";if(data.checked&&data.enabled)result+='<input type="hidden" '+(data.id?jsca.columns.idStr(data.id+jsca.columns.OLDSTR):"")+jsca.columns.nameStr(data.name+jsca.columns.OLDSTR)+jsca.columns.valueStr(data.value)+"/>";if(data.enabled){result+=(data.renderLabel&&!data.renderLabelOnRight?data.label:"")+"<input "+jsca.columns.idStr(data.id)+'type="radio" '+jsca.columns.nameStr(data.name)+(data.disabled?"disabled ":"");if(data.tooltip)result+=
jsca.columns.tooltipStr(data.tooltip);result+=data.jsActions;result+=jsca.columns.valueStr(data.value)+(data.checked?"checked ":"")+data.styleClasses+"/>"+(data.renderLabel&&data.renderLabelOnRight?data.label:"")}else if(data.checked)result+='<img src="'+data.checkedGif+'" hspace=0 vspace=0 border=0 height=13 width=13> ';else result+='<img src="'+data.uncheckedGif+'" hspace=0 vspace=0 border=0 height=23 width=16>';result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};Ext.ns("PTC.receivedDelivery");
PTC.receivedDelivery.validateUploadActionSelection=function(evt){var sels=PTC.jca.table.Utils.getSelectedItmesByEvent(evt);if(sels){var alength=sels.length;if(alength>0){JCAAlert("com.ptc.windchill.rd.receivedDeliveryResource.RD_TABLE_ROW_SELECTED_ALERT");return false}}return true};
var createPreviewMappingPanel=function(tl_tableID,context,rdOID,soid,disableButton,displayLogs,extendedLogs,calledFrom,windefineMapping,selectContainer){var exceptionString="StatusException";var refreshButton=new Ext.Button({id:tl_tableID+"_preview",buttonAlign:"center",icon:"netmarkets/images/refresh.gif",iconAlign:"top",enabled:true,fieldLabel:bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.REFRESH_PREVIEW"),tooltip:bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.REFRESH_PREVIEW"),
hideLabel:true,handler:function(){PTC.wizard.loadMask=new Ext.LoadMask("previewMappingPanel",{msg:bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.PREVIEW_IN_PROGRESS")});PTC.wizard.loadMask.show();disableOkButton();var activeTab=contextTabsObj.getActiveTab();var activeTabIndex=contextTabsObj.items.indexOf(activeTab);var requestObject=Ext.Ajax.request({url:"netmarkets/jsp/rd/callPreviewMapping.jsp?selectContainer="+activeTabIndex+"&isExtendedPreview=false&From="+calledFrom+"&rdOID="+
rdOID+"",params:{},mode:"GET",asynchronous:false,success:function(response){var logs=response.responseText;PTC.wizard.loadMask.hide();enableOkButton();if(logs.indexOf(exceptionString)!=-1)JCAAlert("com.ptc.core.appsec.appSecResource.INVALID_NONCE");else activeTab.body.update(Ext.util.Format.nl2br(Ext.util.Format.htmlEncode(unescape(logs))));var extendedRequestObject=Ext.Ajax.request({url:"netmarkets/jsp/rd/callPreviewMapping.jsp?selectContainer="+activeTabIndex+"&isExtendedPreview=true&From="+calledFrom+
"&rdOID="+rdOID+"",params:{},mode:"GET",asynchronous:false,success:function(response){var logs=response.responseText;PTC.wizard.loadMask.hide();enableOkButton();if(logs.indexOf(exceptionString)!=-1)JCAAlert("com.ptc.core.appsec.appSecResource.INVALID_NONCE");else extendedPreviewTextAreaObj.setValue(logs)},failure:function(response){var logs=response.responseText;PTC.wizard.loadMask.hide();enableOkButton();activeTab.body.update(Ext.util.Format.nl2br(Ext.util.Format.htmlEncode(unescape(logs))))}})},
failure:function(response){var logs=response.responseText;PTC.wizard.loadMask.hide();enableOkButton();activeTab.body.update(Ext.util.Format.nl2br(Ext.util.Format.htmlEncode(unescape(logs))))}});if(windefineMapping!==undefined){mappingPanelWithToolbarObj.remove(warningMsgPanel);mappingPanelWithToolbarObj.doLayout()}}});var mappingButton=new Ext.Button({id:tl_tableID+"_mapping",buttonAlign:"right",icon:"netmarkets/images/preferences.png",fieldLabel:bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.DEFINE_MAPPING_TITLE"),
tooltip:bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.DEFINE_MAPPING_TITLE"),iconAlign:"top",hideLabel:true,handler:function(){PTC.receivedDelivery.launchDefineMapping(rdOID,context,soid)}});var warningImage=new Ext.BoxComponent({id:tl_tableID+"_staleWarningImage",autoEl:{tag:"img",src:"com/ptc/core/htmlcomp/images/warning.gif"}});var warningMsg=new Ext.form.DisplayField({id:tl_tableID+"_staleWarningMsg",cls:"inlineHelpBox",style:"margin-left: 10px;left: 10px",html:bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.PREVIEW_STALE_WARNING_MESSAGE")});
var warningMsgPanel=new Ext.Panel({id:tl_tableID+"_warningMsgPanel",frame:false,layout:"hbox",items:[warningImage,warningMsg]});var mappingGroupText=bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.PREVIEW_MAPPING_TEXT");var mappingGroupTitle=bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.PREVIEW_MAPPING_GROUP");var otherGroupText=bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.EXTENDED_PREVIEW_MAPPING_TEXT");var otherGroupTitle=bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.EXTENDED_PREVIEW_GROUP");
var contextTabsId=tl_tableID+"_contextTabs";var extendedPreviewTextAreaId=tl_tableID+"_extendedPreviewTextArea";var mappingPanelWithToolbarId=tl_tableID+"_panelWithToolbar";var mainPanel=new Ext.Panel({id:tl_tableID+"_mainPanel",frame:false,layout:"fit",style:"margin-right: 9px",monitorResize:true,renderTo:"previewMappingPanel",items:[{xtype:"fieldset",id:tl_tableID+"_previewFieldSet",title:'<span class="attributePanel-fieldset-title">'+mappingGroupTitle+"</span>",autoHeight:true,collapsible:true,
collapsed:false,items:[{xtype:"displayfield",id:tl_tableID+"_previewMappingText",fieldLabel:"Preview Mapping",hideLabel:true,html:'<p align="justify">'+mappingGroupText+"</p><br>"},{xtype:"panel",id:mappingPanelWithToolbarId,frame:true,tbar:[refreshButton,mappingButton],items:[{xtype:"tabpanel",id:contextTabsId,activeTab:0,height:250,plain:false,defaults:{autoScroll:true},items:[{id:"retainContainer",title:bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.RETAIN_CONTAINER")},{id:"singleContainer",
title:bundleHandler.get("com.ptc.windchill.rd.receivedDeliveryResource.SINGLE_CONTAINER")}]}]}]},{xtype:"fieldset",id:tl_tableID+"_extendedPreviewFieldSet",title:'<span class="attributePanel-fieldset-title">'+otherGroupTitle+"</span>",autoHeight:true,collapsible:true,collapsed:false,items:[{xtype:"displayfield",id:tl_tableID+"_extendedPreviewText",fieldLabel:"Extended Preview",hideLabel:true,html:'<p align="justify">'+otherGroupText+"</p><br>"},{xtype:"textarea",id:extendedPreviewTextAreaId,name:"description",
hideLabel:true,labelSeparator:"",height:250,autoScroll:true,readOnly:true,width:"98.5%",value:unescape(extendedLogs)}]}]});mainPanel.doLayout();var contextTabsObj=Ext.ComponentMgr.get(contextTabsId);var extendedPreviewTextAreaObj=Ext.ComponentMgr.get(extendedPreviewTextAreaId);var mappingPanelWithToolbarObj=Ext.ComponentMgr.get(mappingPanelWithToolbarId);if(disableButton=="true"){mappingButton.disable();refreshButton.disable()}if(selectContainer=="true")contextTabsObj.setActiveTab(0);else contextTabsObj.setActiveTab(1);
contextTabsObj.getActiveTab().body.update(Ext.util.Format.nl2br(Ext.util.Format.htmlEncode(unescape(displayLogs))));if(windefineMapping!==undefined){mappingPanelWithToolbarObj.add(warningMsgPanel);mappingPanelWithToolbarObj.doLayout()}};
PTC.receivedDelivery.launchDefineMapping=function(rdOID,context,soid){if(navigator.appName.indexOf("Microsoft")==-1)windefineMapping=window.open("ptc1/fedInfraUI/defineMapping?&wizardActionClass=com.ptc.windchill.fedInfra.mapping.forms.DefineMappingTableFormProcessor&portlet=poppedup&wizardActionMethod=execute&oid="+rdOID+"&context="+context+"&soid="+soid,null,"resizable=yes,scrollbars=yes,menubar=no,toolbar=no,location=no,status=yes,left=50,top=50,height=650,width=1000");else windefineMapping=window.open("../fedInfraUI/defineMapping?&wizardActionClass=com.ptc.windchill.fedInfra.mapping.forms.DefineMappingTableFormProcessor&portlet=poppedup&wizardActionMethod=execute&oid="+
rdOID+"&context="+context+"&soid="+soid,null,"resizable=yes,scrollbars=yes,menubar=no,toolbar=no,location=no,status=yes,left=50,top=50,height=650,width=1000")};PTC.receivedDelivery.onOKClickCloseDefineMapping=function(){if(windefineMapping)if(windefineMapping.open&&!windefineMapping.closed)windefineMapping.close();window.close()};
PTC.receivedDelivery.validateSelection=function(evt,action){var sels=PTC.jca.table.Utils.getSelectedItmesByEvent(evt);var alength=sels.length;if(sels.length===0&&action!="VIEWIMPORTLOG"){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");Event.stop(evt);return false}if(sels)if(alength!=1)if(action=="PREVIEW"){JCAAlert("com.ptc.windchill.rd.receivedDeliveryResource.RD_TABLE_PREVIEW_ACTION_SELECTED_ALERT");return false}else if(action=="IMPORT"){JCAAlert("com.ptc.windchill.rd.receivedDeliveryResource.RD_TABLE_PREVIEW_ACTION_SELECTED_ALERT");
return false}else if(action=="REPREPAREFILES"){JCAAlert("com.ptc.windchill.rd.receivedDeliveryResource.RD_TABLE_REPREPARE_ACTION_SELECTED_ALERT");return false}return true};var columns=jsca.columns;
function enableGenerateReport(){var buttonDisabled=false;if(getMainForm().proj)if(getMainForm().proj.value==="")buttonDisabled=true;if(getMainForm().name)if(getMainForm().name.value==="")buttonDisabled=true;if(getMainForm().org)if(getMainForm().org.value==="")buttonDisabled=true;if(getMainForm().obj_name_str)if(getMainForm().obj_name_str.value==="")buttonDisabled=true;if(getMainForm().StartDate)if(getMainForm().StartDate.value==="")buttonDisabled=true;if(getMainForm().EndDate)if(getMainForm().EndDate.value===
"")buttonDisabled=true;document.getElementById("PJLreport____nmreportexecuteAuditReport").disabled=buttonDisabled;return true}function enableSavetoFile(rowCount){var buttonDisabled=true;if(rowCount>0)buttonDisabled=false;document.getElementById("PJLreport____nmreportsaveAuditReportToFile").disabled=buttonDisabled}
function localizeReportDateString(dateToLocalize,dateFormat){var formatKeyStr=dateFormat.toUpperCase();var inputDateArr=dateToLocalize.split("/");var locDateArr;var dateSeparator;if(formatKeyStr.indexOf("-")>=0){locDateArr=formatKeyStr.split("-");dateSeparator="-"}else if(formatKeyStr.indexOf("/")>=0){locDateArr=formatKeyStr.split("/");dateSeparator="/"}else{locDateArr=formatKeyStr.split(".");dateSeparator="."}var order="";if(locDateArr[0].indexOf("Y")>=0){var locYear=locDateArr[0];var locMonth;var locDay;
if(locDateArr[1].indexOf("M")>=0){locMonth=locDateArr[1];locDay=locDateArr[2];order="2|0|1"}else{locDay=locDateArr[1];locMonth=locDateArr[2];order="2|1|0"}}else if(locDateArr[1].indexOf("Y")>=0){locYear=locDateArr[1];if(locDateArr[0].indexOf("M")>=0){locMonth=locDateArr[0];locDay=locDateArr[2];order="0|2|1"}else{locDay=locDateArr[0];locMonth=locDateArr[2];order="1|2|0"}}else{locYear=locDateArr[2];if(locDateArr[0].indexOf("M")>=0){locMonth=locDateArr[0];locDay=locDateArr[1];order="0|1|2"}else{locDay=
locDateArr[0];locMonth=locDateArr[1];order="1|0|2"}}var orderArr=order.split("|");var localReportDate=inputDateArr[orderArr[0]]+dateSeparator+inputDateArr[orderArr[1]]+dateSeparator+inputDateArr[orderArr[2]];return localReportDate}
function autoPopulateAuditReportDatesNew(today,yesterday,last7Days,thisMonth,lastMonth,thisYear,lastYear,dateFormat,startField,endField,timePeriodField){var selIndx=timePeriodField.selectedIndex;var periodSelection=timePeriodField[selIndx].text;var dateString=getMainForm().todaysDate.value;var dateToday=dateString.split(":");var tempDate1;var tempDate2;if(periodSelection==today){startField.value=localizeReportDateString(dateToday[1]+"/"+dateToday[2]+"/"+dateToday[0],dateFormat);endField.value=localizeReportDateString(dateToday[1]+
"/"+dateToday[2]+"/"+dateToday[0],dateFormat)}else if(periodSelection==yesterday)if(dateToday[2]==="01"){if(dateToday[1]==="01")tempDate1="12/31/"+(dateToday[0]-1);else tempDate1=formatReportDate(dateToday[1]-1)+"/"+getLastDayOfMonth(dateToday[1]-1,dateToday[0])+"/"+dateToday[0];startField.value=localizeReportDateString(tempDate1,dateFormat);endField.value=localizeReportDateString(tempDate1,dateFormat)}else{startField.value=localizeReportDateString(dateToday[1]+"/"+formatReportDate(dateToday[2]-1)+
"/"+dateToday[0],dateFormat);endField.value=localizeReportDateString(dateToday[1]+"/"+formatReportDate(dateToday[2]-1)+"/"+dateToday[0],dateFormat)}else if(periodSelection==last7Days){tempDate1=dateToday[2]-6;if(tempDate1<=0)if(dateToday[1]<="01")startField.value=localizeReportDateString(formatReportDate(dateToday[1]-1)+"/"+(31+tempDate1)+"/"+(dateToday[0]-1),dateFormat);else{tempDate2=getLastDayOfMonth(dateToday[1]-1,dateToday[0]);startField.value=localizeReportDateString(formatReportDate(dateToday[1]-
1)+"/"+(tempDate2+tempDate1)+"/"+dateToday[0],dateFormat)}else startField.value=localizeReportDateString(dateToday[1]+"/"+formatReportDate(tempDate1)+"/"+dateToday[0],dateFormat);endField.value=localizeReportDateString(dateToday[1]+"/"+dateToday[2]+"/"+dateToday[0],dateFormat)}else if(periodSelection==thisMonth){startField.value=localizeReportDateString(dateToday[1]+"/01/"+dateToday[0],dateFormat);endField.value=localizeReportDateString(dateToday[1]+"/"+getLastDayOfMonth(dateToday[1],dateToday[0])+
"/"+dateToday[0],dateFormat)}else if(periodSelection==lastMonth)if(dateToday[1]==="01"){startField.value=localizeReportDateString(formatReportDate(dateToday[1]-1)+"/01/"+(dateToday[0]-1),dateFormat);endField.value=localizeReportDateString(formatReportDate(dateToday[1]-1)+"/"+getLastDayOfMonth(dateToday[1]-1,dateToday[0])+"/"+(dateToday[0]-1),dateFormat)}else{startField.value=localizeReportDateString(formatReportDate(dateToday[1]-1)+"/01/"+dateToday[0],dateFormat);endField.value=localizeReportDateString(formatReportDate(dateToday[1]-
1)+"/"+getLastDayOfMonth(dateToday[1]-1,dateToday[0])+"/"+dateToday[0],dateFormat)}else if(periodSelection==thisYear){startField.value=localizeReportDateString("01/01/"+dateToday[0],dateFormat);endField.value=localizeReportDateString("12/31/"+dateToday[0],dateFormat)}else if(periodSelection==lastYear){startField.value=localizeReportDateString("01/01/"+(dateToday[0]-1),dateFormat);endField.value=localizeReportDateString("12/31/"+(dateToday[0]-1),dateFormat)}}
function autoPopulateAuditReportDates(today,yesterday,last7Days,thisMonth,lastMonth,thisYear,lastYear,dateFormat){return autoPopulateAuditReportDatesNew(today,yesterday,last7Days,thisMonth,lastMonth,thisYear,lastYear,dateFormat,getMainForm().StartDate,getMainForm().EndDate,getMainForm().timePeriod)}
var requestHandler=function(){var MAX_PARAMS=18;function isAjaxEnabled(params){var result=params.isAjaxEnabled&&params.isAjaxEnabled==="row";if(result==="")result=false;if(!result&&params.popupUrl&&params.popupUrl.indexOf("AjaxEnabled=row")!=-1){params.isAjaxEnabled="row";result=true}return result}function getPostUrl(tableID,params){var result=PTC.util.getFormAction(params.mform);if(params.ajaxClass&&params.ajaxClass!=="null"&&params.ajaxClass!=="NONE")result=params.ajaxClass;else if(tableID&&tableUtils.getTableUrl(tableID))result=
tableUtils.getTableUrl(tableID);else if(currentStepStrName){result=getPageUrl(wizardSteps[currentStepStrName].url,currentStepStrName);var soidIdx=result.indexOf("soid");if(soidIdx!=-1&&params.mform.soid)result=removeParamFromString("soid",result);result=removeParamFromString("wizardActionMethod",result);result=removeParamFromString("wizardActionClass",result)}else{var tln=parseTlnUrl(result,params);if(tln)result=tln}result=URL_utils.removeAnchor(result);if(result.indexOf("http")<0)result=getBaseHref()+
result;result=addURIParam(result,"tableId",tableID,true);return result}function parseTlnUrl(url,params){var result;if(!window.TLN_CONTENT_URL||params.anonymousParams[14]==="leftPaneOnly"||url.indexOf("leftPaneOnly")!=-1||!$("tlnContentArea"))result=null;else{var idx=window.TLN_CONTENT_URL.indexOf("?");var query=window.TLN_CONTENT_URL.substring(idx);var paramMap=$H(query.parseQuery()).toArray();result=window.TLN_CONTENT_URL.substring(0,idx);var paramMap_length=paramMap.length;for(var i=0;i<paramMap_length;i++){var key=
paramMap[i][0];if(key==="AjaxEnabled"||key==="tableID"||key==="tableId")continue;result=transferParam(window.TLN_CONTENT_URL,result,key)}}return result}function buildParamString(params){var result=params.parameters||"";var uniqueValue=PTC.util.getUniqueId();result=addURIParam(result,"unique_page_number",uniqueValue);if(params.isAjaxEnabled&&params.isAjaxEnabled!=="page")result=addURIParam(result,"AjaxEnabled",params.isAjaxEnabled);if(params.actionClass)result=addURIParam(result,"wizardActionClass",
params.actionClass);if(params.actionMethod)result=addURIParam(result,"wizardActionMethod",params.actionMethod);if(params.tableID)result=addURIParam(result,"tableID",params.tableID);if(params.actionName)result=addURIParam(result,"actionName",params.actionName);result=requestHandler.addURIParams(result,params.anonymousParams);return result}function addFormParams(paramString,mform){return paramString}function addURIParam(params,name,value,queryString){var addParam="";if(queryString&&params.indexOf("?")==
-1)addParam+="?";else if(params.length>0)addParam+="&";addParam+=encodeURIComponent(name);addParam+="=";addParam+=encodeURIComponent(value);return params+addParam}function fastAddURIParam(params,name,value){var addParam=name;addParam+="=";addParam+=encodeURIComponent(value);params.push(addParam)}var disableSelected=function(oid,node){if(node)node.disabled=true};var selectedItemHelper=function(){var paramArray=[];var callback=function(oid,item){if(item&&item.checked&&item.name.indexOf("pjl_sel")!=
-1&&item.name!=="selectAll"&&item.name!="checkbox3"&&item.value!=="select_all"){var paramValue=item.value;fastAddURIParam(paramArray,"soid",paramValue)}};return{getItemParams:function(selectedItems){selectedItems._fastIterate(callback);var result=paramArray.join("&");if(result!=="")result="&"+result;paramArray=[];return result}}}();return{handleRequest:function(tableID,params,isAction){var result=false;if(tableID==="null")tableID=null;var isTableRefresh=tableID&&isAjaxEnabled(params);if(isTableRefresh||
isAction){if(tableID){if(params.isAjaxEnabled==="row"){var table=tableUtils.getTable(tableID);if(table&&table.fireEvent("beforeRowRefresh",tableID,params)===false)return false}params.tableID=tableID;params.selectedItems=oidUtils.newOidSetForSelected(tableID);if(params.selectedItems&&params.disableSelected)params.selectedItems.disable()}var postUrl=getPostUrl(tableID,params);postUrl=removeParamFromString("AjaxEnabled",postUrl);params.isNoContent=false;params.doXMLHTTP=true;if(params.actionName)postUrl=
removeParamFromString("actionName",postUrl);var paramUrl=requestHandler.getParamString(params);paramUrl+="&dynamicUpdate=true";if(params.dynamicAction)paramUrl+="&dynamicAction="+params.dynamicAction;var addproe=$("addproe");if(addproe&&addproe.value)paramUrl+="&addproe=true";if(params.iframeForm&&params.iframeForm.length>0)paramUrl+="&"+params.iframeForm;else{var formParams="&"+Ext.lib.Ajax.serializeForm(params.mform);paramUrl+=formParams}var _asynchronous=isIE||!isWizardWindow();if(_asynchronous&&
params.asynchronous!==undefined&&params.asynchronous===false)_asynchronous=params.asynchronous;var options={asynchronous:_asynchronous,parameters:paramUrl};if(isAction){var actionControllerURL=getBaseHref()+"ptc1/action"+postUrl.substring(postUrl.indexOf("?"),postUrl.length);postUrl=actionControllerURL}var actionTarget=PTC.action.actionTarget;options.onSuccess=function(transport){PTC.action.actionTarget=actionTarget||params.actionTarget;try{asyncResponseHandler.handleResponse(transport.responseText,
params);if(params.onSuccess)params.onSuccess.apply(this,arguments)}finally{PTC.action.actionTarget=null;options.onSuccess=null}};var transport=requestHandler.doRequest(postUrl,options);result=true}return result},doRequest:function(url,options){var customOnSuccessFunc=options.onSuccess;options.onSuccess=function(response){var reloaded=PTC.navigation.handleResponseHasFormBasedAuth(response);if(!reloaded&&customOnSuccessFunc)return customOnSuccessFunc.apply(this,arguments)};if(!options.requestHeaders)options.requestHeaders=
[];if(!options.requestHeaders.contentType)options.requestHeaders.contentType="application/x-www-form-urlencoded; charset=UTF-8";if(options.method&&options.method=="POST")options.method="post";if(!options.onException)options.onException=requestHandler.defaultExceptionHandler;if(!options.onFailure)options.onFailure=options.onException;if(PTC.debug.isJCADebug())if(!options.parameters||Ext.isString(options.parameters))options.parameters="jcaDebug=true&"+(options.parameters||"");else if(options instanceof
Object)options.parameters.jcaDebug=true;var request=new Ajax.Request(url,options);return request.transport},defaultExceptionHandler:function(request,err){try{if(request.transport&&!request.transport._aborted){var transport=request.transport;requestHandler.log.error("Exception processing ajax request, enable PTC.requestHandler logging for more info. ",err);requestHandler.log.debug("url ",request.url);requestHandler.log.debug("options ",request.options);requestHandler.log.trace("transport.responseText ",
transport.responseText);requestHandler.log.trace("transport.readyState ",transport.readyState);requestHandler.log.trace("transport.status ",transport.status);requestHandler.log.trace("transport.statusText ",transport.statusText);requestHandler.log.trace("transport.responseXML ",transport.responseXML);requestHandler.log.trace("transport ",transport)}}catch(e){requestHandler.log.error("Exception trying to log exception from ajax request",e)}},abort:function(transport){if(transport&&typeof transport.abort===
"function"){transport._aborted=true;transport.abort();this.log.trace("aborted request ",transport.url)}},abortAll:function(transports){for(var i=0,l=transports.length;i<l;i++)this.abort(transports[i])},parseAnonymousParams:function(startIndex,params,result){if(!result)result=[];var max=Math.min(params.length,startIndex+MAX_PARAMS);for(var i=startIndex;i<max;i++)result.push(params[i]);return result},getParamString:function(params){var result=buildParamString(params);if(params.doXMLHTTP)result=addFormParams(result,
params.mform);if(!params.isNoContent){var selectedItems=params.selectedItems;if(!selectedItems)selectedItems=oidUtils.newOidSetForSelected(params.tableID);result+=selectedItemHelper.getItemParams(selectedItems)}return result},addURIParam:addURIParam,addURIParams:function(paramString,paramArray,queryString){var result=paramString;var paramArray_length=paramArray.length;for(var i=0;i<paramArray_length;i+=2){if(!paramArray[i])continue;var name=paramArray[i];if(!paramArray[i+1])continue;var value=paramArray[i+
1];result=addURIParam(result,name,value,queryString)}return result},log:log4javascript.getLogger("PTC.requestHandler")}}();
PTC.revision=function(){function callAJAXValidation(validation_key,formdata){var status=true;var input=document.getElementById("CSVK");var ckey=(new Date).getTime();if(input!=null)input.value=ckey;else appendFormHiddenInput(getMainForm(),"CSVK",ckey);var url="servlet/UIValidationAJAXServlet";var options={method:"post",asynchronous:false,parameters:formdata+"&"+"validation_key="+validation_key};var request=requestHandler.doRequest(url,options);if(request.readyState==4&&(request.status==200||request.status==
0)){this.req=request;status=AJAXValidationCallback.call(this)}return status}return{validateRevision:function(event){var target=is_ie?event.srcElement||event.target:event.target||event.srcElement;if(target){var targetName=target.name;var status=true;var MODE="mode";var OID="oid";var REVISIONTYPENAME="revisionTypeName";var JSONHIDDENFIELD_SUFFIX="__jsonHiddenFields";var generatedRevisionFieldName=targetName;var revisionTypeName;var mode;var oid;var containerRef;var revisionInput=Ext.getDom(generatedRevisionFieldName);
if(revisionInput){var jsonHiddenFieldsElement=Ext.getDom(targetName+JSONHIDDENFIELD_SUFFIX);if(jsonHiddenFieldsElement){var jsonElement=Ext.util.JSON.decode(jsonHiddenFieldsElement.value);if(jsonElement){revisionTypeName=jsonElement[REVISIONTYPENAME];mode=jsonElement[MODE];oid=jsonElement[OID]}}var containerRefElement=Ext.getDom("containerRef");if(containerRefElement)containerRef=containerRefElement.value;var formObject=new Object;formObject.mode=mode;formObject.revisionLabelPicker_Entered=revisionInput.value;
formObject.selectedOrEntered="entered";formObject.oid=oid;formObject.oids="["+oid+"]";formObject.containerRef=containerRef;if(revisionTypeName)formObject.revisionTypeName=revisionTypeName;var formData=URL_utils.getParams(window.location.href)+"&"+Ext.urlEncode(formObject);status=callAJAXValidation("revisionLabelPickerValidation",formData);if(!status){revisionInput.value="";try{var toHighlight=Ext.get(revisionInput);if(toHighlight!==null)toHighlight.highlight("",{duration:5})}catch(e){}}}return status}}}}();
var rowHandler=function(){var REMOVED_ROW_CLASSNAME="tableremovedrowbg";var addedOidNode;var removedOidNode;var initialOidNode;var visuallyRemove=false;var preventDuplicates=false;var tableID;var existingOids=oidUtils.newOidSet();var removedOids=oidUtils.newOidSet();var addedOids=oidUtils.newOidSet();var initialOids=oidUtils.newOidSet();var appendOidList=oidUtils.newOidSet();var removeCallback=function(oid){var nonPersisted=addedOids.remove(oid);if(nonPersisted){appendOidList.remove(oid);if(initialOidNode)initialOids.remove(oid)}};
var addCallback=function(oid){var removed=removedOids.remove(oid);if(removed){var removedNode=existingOids.node(oid);if(removedNode){removedNode.disabled=false;rowHighlighter.onClick(removedNode,true,REMOVED_ROW_CLASSNAME)}if(appendOidList.contains(oid))appendOidList.remove(oid)}else if(preventDuplicates&&existingOids.contains(oid)){addedOids.remove(oid);appendOidList.remove(oid)}};function appendOidString(inputField,oidString){if(!inputField)return;var currentString=inputField.value;if(currentString&&
currentString[currentString.length-1]!=="#")inputField.value+="#";inputField.value+=oidString}function add(oidList,params){var result=false;if(removedOidNode&&removedOidNode.value&&params.dynamicAction!=="U")removedOids.addString(removedOidNode.value);if(params.dynamicAction!=="U"){appendOidList.addAll(oidList);addedOids.addAll(oidList);addedOids.iterate(addCallback)}if(removedOids.isModified())removedOidNode.value=removedOids.toString();var oidString="";if(params.doAjaxUpdate||addedOidNode)oidString=
addedOids.toString();if(!oidString&&params.dynamicAction==="U")oidString=oidList.join("#");if(oidString!=="")if(params.doAjaxUpdate){params.mform=getMainForm();params.disableSelected=true;params.refreshOnNoOp=true;params.isAjaxEnabled="row";params.anonymousParams=["","","addedOid",oidString];requestHandler.handleRequest(tableID,params)}else{var appendString=appendOidList.toString();if(appendString!=="")appendOidString(addedOidNode,appendString);if(params.refresh)if(currentStepStrName){refreshCurrentStep(params.iframeForm);
result=true}else getUpdateOpenerWindow().PTC.navigation.reload();else if(params.refreshTable)refreshCurrentElementID(tableUtils.getFormattedTableId(tableID))}return result}function remove(oidList){if(addedOidNode&&addedOidNode.value)addedOids.addString(addedOidNode.value);if(initialOidNode&&initialOidNode.value)initialOids.addString(initialOidNode.value);appendOidList.addAll(oidList);removedOids.addAll(oidList);removedOids.iterate(removeCallback);if(addedOids.isModified()){addedOidNode.value=addedOids.toString();
if(initialOidNode&&initialOids.isModified())initialOidNode.value=initialOids.toString()}var appendString=appendOidList.toString();if(appendString!=="")appendOidString(removedOidNode,appendString);var table=tableUtils.getTable(tableID);if(table){var rowStore=table.getStore();var toRemoveArray=[];rowStore.each(function(item){var ioid=item.get("oid");var contextStr=item.get("jsca_context");if(ioid!==undefined&&(removedOids.contains(ioid)||removedOids.contains(contextStr)))toRemoveArray.push(item)});
var massUpdate=toRemoveArray.length>8&&table.disableMassUpdateOnRemove!==true;if(massUpdate)rowStore.suspendEvents();rowStore.remove(toRemoveArray);if(massUpdate){rowStore.resumeEvents();rowStore.fireEvent("datachanged",rowStore)}PTC.jca.table.scroll.updateTableSize(tableID,true)}jsca.unSelectAll(null,tableID);return false}function init(table_id){tableID=table_id;if(existingOids.isModified())existingOids.clear();if(removedOids.isModified())removedOids.clear();if(addedOids.isModified())addedOids.clear();
if(appendOidList.isModified())appendOidList.clear();if(initialOids.isModified())initialOids.clear();initialOidNode=tableUtils.getInitialRows(tableID);addedOidNode=tableUtils.getAddedRows(tableID);removedOidNode=tableUtils.getRemovedRows(tableID);preventDuplicates=false;visuallyRemove=false}function initExistingOids(existingRows){var allOids=getAllOidsInTable();if(allOids)existingOids=allOids;else{if(!existingRows)existingRows=oidUtils.getTableOids(tableID);if(existingRows)existingOids.addAll(existingRows)}}
function getAllOidsInTable(){if(initialOidNode){var initialOids=oidUtils.newOidSet();initialOids.addString(initialOidNode.value);var addOids=oidUtils.newOidSet();if(addedOidNode)addOids.addString(addedOidNode.value);var rmOids=oidUtils.newOidSet();if(removedOidNode)rmOids.addString(removedOidNode.value);var idx=0;var addList=[];for(var oid in addOids.data)if(typeof oid!=="function")addList[idx++]=oid;initialOids.addAll(addList);var rmList=[];idx=0;for(oid in rmOids.data)if(typeof oid!=="function")rmList[idx++]=
oid;initialOids.removeAll(rmList);return initialOids}return null}return{addRows:function(oidList,table_id,tableRows,params){init(table_id);preventDuplicates=params&&params.preventDuplicates;initExistingOids(tableRows);params.addRows=true;add(oidList,params)},updateRows:function(oidList,table_id,params){if(isWizardWindow())PTC.wizard.saveTableData.writeAllTableRows();init(table_id);preventDuplicates=params&&params.preventDuplicates;params.updateRows=true;params.dynamicAction="U";add(oidList,params)},
removeRowsFromParentTable:function(tableItem,rbinfokey,inserts){var table_id=tableUtils.findTableID(tableItem);var selectedItems=getJCASelectedTableItems(table_id);if(!selectedItems||selectedItems.length===0)JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");else{var cont=true;if(rbinfokey!==undefined)cont=JCAConfirm(tableItem,rbinfokey,inserts);if(cont){rowHandler.removeRows(selectedItems,table_id,true);tableUtils.updateFooterCount(table_id,getJCASelectedTableItems(table_id).length)}}tableItem=
tableItem?tableItem:event;Event.stop(tableItem);return false},removeRows:function(rows,table_id,visually_remove){init(table_id);visuallyRemove=visually_remove;remove(rows)},addedOids:addedOids,getExistingOids:function(tableId,tableRows){init(tableId);initExistingOids(tableRows);return existingOids}}}();
function highlightTableRow(rowOid,highlightClassName,tableId){if(!highlightClassName)highlightClassName="tablehighlightrowbg";if(tableId){var row=tableUtils.getTableRowFromOid(tableId,rowOid);getRowHighlightClassName=function(r,idx,rowParams,ds){if(row&&row==r)return highlightClassName;return""};tableUtils.setRowClassFunction(tableId,getRowHighlightClassName)}}function highlightTreeRow(rowOid,highlightClassName,tableId){return highlightTableRow(rowOid,highlightClassName,tableId)}
function unHighlightTreeRow(tableId){if(!highlightClassName)highlightClassName="tableselectedrowbg";if(tableId){var row=tableUtils.getTableRowFromOid(tableId,rowOid);tableUtils.removeRowStyle(tableId,getRowContext(row),highlightClassName)}}var rowHighlighter=function(countDiv){return{reset:function(){},onClick:function(input,fade,selectedRowClassName,tableId,countDiv){}}}();function highlightRow(chbox){rowHighlighter.onClick(chbox)}
function highlightRowWithClass(chbox,selectedRowClassName,fade){rowHighlighter.onClick(chbox,fade,selectedRowClassName)}jsca.htmlEncodeCheckboxIdForSafety=function(value){if(value&&(typeof value=="string"||value instanceof String))return String(value).replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;");else return value};
jsca.updateHiddenCheckbox=function(table,row,tableId,isSelected){var checkboxId=getRowContext(row,table);checkboxId=jsca.htmlEncodeCheckboxIdForSafety(checkboxId);var thisCheckBox=getWindow().Ext.getDom(checkboxId);if(thisCheckBox)if(isSelected)thisCheckBox.checked=true;else thisCheckBox.parentNode.removeChild(thisCheckBox);else if(isSelected)return checkboxId};
PTC.jca.table.updateViewSelectedOnlyItemsCacheValue=function(tableId,allClickedRows,isSelected){var selectedOnlyItem=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId)+".selectedOnlyViewItem");if(!selectedOnlyItem||selectedOnlyItem.checked!==true)return;var selectedOnlyItems;if(!allClickedRows||allClickedRows.length<1){if(isSelected===false){selectedOnlyItems=[];PTC.jca.table.setObjectToSession(tableId,selectedOnlyItem.id,selectedOnlyItems)}return}selectedOnlyItems=PTC.jca.table.findInTable.getSavedSelectedOidList(tableId);
if(selectedOnlyItems===null)return;var dataLength=allClickedRows.length;for(var i=0;i<dataLength;i++)if(isSelected)selectedOnlyItems.push(allClickedRows[i].data.oid);else selectedOnlyItems.remove(allClickedRows[i].data.oid);PTC.jca.table.setObjectToSession(tableId,selectedOnlyItem.id,selectedOnlyItems)};
PTC.jca.addSelectionCheckbox=function(newBoxes,tableId,allRowsAffected){var id="checkboxesFor_"+tableId;var parent=getWindow().$(id);if(!parent)parent=Ext.DomHelper.append(getWindow().getMainForm(),{tag:"span",id:id,style:"display:none;"},true);var inputs=[];for(i=0,l=newBoxes.length;i<l;i++){var checkboxId=newBoxes[i];inputs.push('<input type="checkbox" checked="true" id="'+checkboxId+'" name="pjl_selPJLsa1__1" value="'+checkboxId+'" />')}if(allRowsAffected)Ext.DomHelper.overwrite(parent,inputs.join(""));
else Ext.DomHelper.append(parent,inputs.join(""))};
jsca.rowSelectionHandler=function(tableId,allClickedRows,rowClicked,isSelected,table,allRowsAffected){if(rowClicked||isSelected)PTC.util._setMainFormStartingElement(tableId);if(!table)table=tableUtils.getTable(tableId);if(isSelected){if(rowClicked&&!(table.isShiftSelect===true))allClickedRows=[rowClicked];if(allClickedRows&&allClickedRows.length>0){var newBoxes=[];for(var i=0,l=allClickedRows.length;i<l;i++){var row=allClickedRows[i];if(!allRowsAffected){var newSelectedCheckbox=jsca.updateHiddenCheckbox(table,
row,tableId,isSelected);if(newSelectedCheckbox)newBoxes[newBoxes.length]=newSelectedCheckbox}else newBoxes.push(getRowContext(row,table))}if(newBoxes.length>0)PTC.jca.addSelectionCheckbox(newBoxes,tableId,allRowsAffected)}}else{if(rowClicked&&!(table.isShiftSelect===true))allClickedRows=[rowClicked];if(allClickedRows&&allClickedRows.length>0){for(i=0,l=allClickedRows.length;i<l;i++){row=allClickedRows[i];jsca.updateHiddenCheckbox(table,row,tableId,isSelected)}table.isShiftSelect=false}else{var parent=
getWindow().$("checkboxesFor_"+tableId);if(parent)parent.innerHTML=""}}PTC.jca.table.updateViewSelectedOnlyItemsCacheValue(tableId,allClickedRows,isSelected)};function getJSCASelectedTableItems(tableID){var result=[];var selectedRowsDiv=getWindow().document.getElementById("checkboxesFor_"+tableID);if(selectedRowsDiv)for(var j=0,k=selectedRowsDiv.childNodes.length;j<k;j++)if(selectedRowsDiv.childNodes[j].checked)result.push(oidUtils.normalize(selectedRowsDiv.childNodes[j].value));return result}
Ext.grid.RowSelectionModel.prototype.selectRow=function(index,keepExisting,preventViewNotify,record,force){var r=null;if(record!==undefined){if(!index)index=this.grid.store.indexOf(record);r=record}if(r===null)r=this.grid.store.getAt(index);if(this.isLocked()||r&&r.isLocked()&&force!==true||index<0||index>=this.grid.store.getCount()||keepExisting&&this.isSelected(index))return;if(r&&this.fireEvent("beforerowselect",this,index,keepExisting,r)!==false){if(!keepExisting||this.singleSelect)this.clearSelections();
this.selections.add(r);this.last=this.lastActive=index;if(!preventViewNotify)this.grid.getView().onRowSelect(index);this.fireEvent("rowselect",this,index,r);this.fireEvent("selectionchange",this)}};PTC.jca.table.CheckboxSelectionModel=function(){PTC.jca.table.CheckboxSelectionModel.superclass.constructor.call(this)};
Ext.grid.RowSelectionModel.prototype.registerGridRenderInitEvents=function(){var view=this.grid.getView();view.mainBody.on("mousedown",this.onMouseDown,this);if(!this.singleSelect)Ext.fly(view.innerHd).on("mousedown",this.onHdMouseDown,this);if(view.lockedBody){view.lockedBody.on("mousedown",this.onMouseDown,this);if(!this.singleSelect)Ext.fly(view.lockedInnerHd).on("mousedown",this.onHdMouseDown,this)}};
Ext.extend(PTC.jca.table.CheckboxSelectionModel,Ext.grid.CheckboxSelectionModel,{initEvents:function(){Ext.grid.CheckboxSelectionModel.superclass.initEvents.call(this);this.grid.on("render",function(){this.registerGridRenderInitEvents()},this)},onMouseDown:function(e,t){if(e.button===0&&t.className=="x-grid3-row-checker"){e.stopEvent();var row=e.getTarget(".x-grid3-row");if(row){var index=row.rowIndex;var isSelected=this.isSelected(index);var view=this.grid.getView();if(e.shiftKey&&!this.singleSelect&&
this.last!==false){var last=this.last;if(!isSelected){this.suspendEvents(false);this.selectRange(last,index,true);this.resumeEvents();this.fireEvent("rowmassselection",this,this.selections.items);view.fireEvent("selectrange",this);view.focusRow(index)}else{this.suspendEvents(false);var deselectedRecs;if(last>index){this.deselectRange(index,last,false);deselectedRecs=this.grid.store.getRange(index,last)}else{this.deselectRange(last,index,false);deselectedRecs=this.grid.store.getRange(last,index)}this.resumeEvents();
this.fireEvent("rowmassdeselection",this,deselectedRecs);view.focusRow(index);index--}view.tracker.preventDefault=false}else if(isSelected){this.deselectRow(index);if(view.tracker)view.tracker.preventDefault=false}else if(!isSelected||this.getCount()>1){this.selectRow(index,true);view.focusRow(index)}this.last=index}}},listeners:{selectionchange:PTC.jca.table.handleSelectAllCheckbox}});
PTC.jca.table.RadioSelectionModel=function(config){PTC.jca.table.RadioSelectionModel.superclass.constructor.call(this,config)};PTC.jca.table.stopTextHighlight=function(view){this.tracker=new Ext.dd.DragTracker;view.el=view.el?view.el:new Ext.Element(view.grid.getGridEl().dom.firstChild);if(view.el){this.tracker.initEl(view.el);view.on("beforedestroy",this.tracker.destroy,this.tracker)}};Ext.ns("Ext.ux.grid");
if(Ext.ux.grid.RadioSelectionModel!==undefined)Ext.extend(PTC.jca.table.RadioSelectionModel,Ext.ux.grid.RadioSelectionModel,{initEvents:function(){Ext.ux.grid.RadioSelectionModel.superclass.initEvents.call(this);this.grid.on("render",function(){this.registerGridRenderInitEvents()},this)},onMouseDown:function(e,t){var radio_id=this.id+"_"+this.grid.id;if(e.button===0&&t.name===radio_id){e.stopEvent();var row=e.getTarget(".x-grid3-row");if(row!==undefined){var index=row.rowIndex;this.selectRow(index,
true)}}}});Ext.data.Record.prototype.lock=function(){this.locked=true};Ext.data.Record.prototype.unlock=function(){this.locked=false};Ext.data.Record.prototype.isLocked=function(){return this.locked!==undefined&&this.locked!==null&&this.locked===true};
Ext.grid.RowSelectionModel.prototype.readOnlyRow=function(record,readonly){var view=this.grid.getView();var store=this.grid.store;var rowIndex;if(Ext.isNumber(record)){rowIndex=record;record=store.getAt(rowIndex)}else rowIndex=store.indexOf(record);if(readonly)record.lock();else record.unlock();return view.getRow(rowIndex)};
Ext.grid.RowSelectionModel.prototype.disableRow=function(record,disable){var row=this.readOnlyRow(record,disable);if(!this.disableRowClassFunction){this.disableRowClassFunction=function(r,idx,rowParams,ds){if(r.isLocked())return"x-item-disabled";else return""};tableUtils.setRowClassFunction(this.grid.jcaTableConfig.tableID,this.disableRowClassFunction,true)}return row};
Ext.grid.RowSelectionModel.prototype.deselectRow=function(index,preventViewNotify,record){var r=null;if(record!==undefined){index=this.grid.store.indexOf(record);r=record}if(r===null)r=this.grid.store.getAt(index);if(r&&r.isLocked())return;if(this.isLocked())return;if(this.last==index)this.last=false;if(this.lastActive==index)this.lastActive=false;r=this.grid.store.getAt(index);if(r){this.selections.remove(r);if(this.snapshot)this.snapshot.remove(r);if(!preventViewNotify)this.grid.getView().onRowDeselect(index);
this.fireEvent("rowdeselect",this,index,r);this.fireEvent("selectionchange",this)}};PTC.jca.table.rowStrikeThrough={};PTC.jca.table.rowStrikeThrough.log=log4javascript.getLogger("PTC.jca.table.rowStrikeThrough");PTC.jca.table.rowStrikeThrough.getStrikeThroughCSS=function(){return"strikethroughRow"};
PTC.jca.table.rowStrikeThrough.getBooleanValue=function(row,columnId){if(!PTC.isDefined(columnId))return"false";var rawValue=row.get(columnId);if(rawValue.gui)if(rawValue.gui.comparable==="true"||rawValue.gui.rawValue==="TRUE")return"true";else if(rawValue.gui.comparable==="false"||rawValue.gui.rawValue==="FALSE")return"false";if(typeof rawValue==="boolean")return rawValue.toString();return rawValue==="true"?rawValue:"false"};
PTC.jca.table.rowStrikeThrough.setBooleanValue=function(row,columnId,value){if(!PTC.isDefined(columnId))return;if(!(row.strikeThroughOriginal==="true"||row.strikeThroughOriginal==="false"))row.strikeThroughOriginal=PTC.jca.table.rowStrikeThrough.getBooleanValue(row,columnId);var rawValue=row.get(columnId);if(rawValue.gui&&typeof value==="boolean"){var strValue=Boolean(value).toString();if(rawValue.gui.comparable!==undefined)rawValue.gui.comparable=strValue;else rawValue.gui.rawValue=strValue.toUpperCase()}else if(typeof rawValue===
"boolean")rawValue=value;else rawValue=Boolean(value).toString()};
PTC.jca.table.rowStrikeThrough.setRowClass=function(grid){var getRowClassName=function(r,idx,rowParams,ds){PTC.jca.table.rowStrikeThrough.log.debug("Applied strike-through CSS class for row with id: ",r.id);var value=PTC.jca.table.rowStrikeThrough.getBooleanValue(r,grid.jcaTableConfig.strikeThroughColumn);if(value=="true"){this._strikeThroughCache[idx]=true;return PTC.jca.table.rowStrikeThrough.getStrikeThroughCSS()}this._strikeThroughCache[idx]=false;return""};if(getRowClassName)tableUtils.setRowClassFunction(grid.jcaTableConfig.tableID,
getRowClassName,true)};PTC.jca.table.rowStrikeThrough.getChangedRows=function(tableId){var table=PTC.jca.table.Utils.getTable(tableId);if(!table)return null;var collection=table.store.queryBy(function(record,id){if(PTC.isDefined(record.strikeThroughOriginal)&&PTC.jca.table.rowStrikeThrough.getBooleanValue(record,table.jcaTableConfig.strikeThroughColumn)!==record.strikeThroughOriginal)return true;return false});return collection.items};
PTC.jca.table.rowStrikeThrough.setRows=function(tableId,strikeThrough,records){PTC.jca.table.rowStrikeThrough.log.debug(strikeThrough?"Strike-through rows":"Clear strike-through","for table: ",tableId);var table=PTC.jca.table.Utils.getTable(tableId);if(!table)return;var strikeThroughColumn=table.jcaTableConfig.strikeThroughColumn;if(!strikeThroughColumn){JCAAlert("com.ptc.core.ui.tableRB.STRIKETHROUGH_NOT_CONFIGURED");return}if(!records||records.length<1){records=table.getSelectionModel().getSelections();
table.getSelectionModel().clearSelections()}if(!records||records.length===0)return;PTC.jca.table.rowStrikeThrough.log.debug("Number of rows for applying strike-through: ",records.length);var refreshRows=records.length<10?true:false;for(var i=0,l=records.length;i<l;i++){var record=typeof records[i]==="string"?table.store.getById(records[i]):records[i];PTC.jca.table.rowStrikeThrough.setBooleanValue(record,strikeThroughColumn,strikeThrough);if(refreshRows)table.getView().refreshRow(record)}if(!refreshRows)table.getView().refresh();
PTC.jca.table.rowStrikeThrough.updateHiddenDivForModified(tableId)};PTC.jca.table.rowStrikeThrough.getRows=function(tableId,strikeThrough){var table=PTC.jca.table.Utils.getTable(tableId);if(!table)return null;var strikeThroughColumn=table.jcaTableConfig.strikeThroughColumn;var collection=table.store.queryBy(function(record,id){var value=PTC.jca.table.rowStrikeThrough.getBooleanValue(record,strikeThroughColumn)==="true";if(value===strikeThrough)return true;return false});return collection.items};
PTC.jca.table.rowStrikeThrough.setFocusedRow=function(tableId,strikeThrough){var table=PTC.jca.table.Utils.getTable(tableId);var records=[];var focusedRecord=PTC.jca.table.Utils.getFocusedRecord(table);if(focusedRecord)records.push(focusedRecord.id);PTC.jca.table.rowStrikeThrough.setRows(tableId,strikeThrough,records)};
PTC.jca.table.rowStrikeThrough.updateHiddenDivForModified=function(tableId){var records=PTC.jca.table.rowStrikeThrough.getChangedRows(tableId);var strikeThroughRowsDiv="strikeThroughRowsFor_"+tableId;var parent=$(strikeThroughRowsDiv);if(!parent){var div=document.createElement("div");div.id=strikeThroughRowsDiv;div.style.display="none";getMainForm(PTC.jca.table.Utils.getTable(tableId).getEl().dom).appendChild(div);parent=div}var inputs=[];if(records){var strikeThroughColumn=PTC.jca.table.Utils.getTable(tableId).store.jsca_table.jcaTableConfig.strikeThroughColumn;
for(var i=0,l=records.length;i<l;i++){var id=records[i].id;var value=PTC.jca.table.rowStrikeThrough.getBooleanValue(records[i],strikeThroughColumn);inputs.push('<input id="'+id+'" name="'+tableId+'_strikeThroughRows" value="'+id+"="+value+'" />')}}parent.innerHTML=inputs.join("")};
PTC.jca.table.rowStrikeThrough.updateRecordsAndCache=function(tableId,records){if(records&&tableId){var table=PTC.jca.table.Utils.getTable(tableId);var strikeThroughColumn=table.store.jsca_table.jcaTableConfig.strikeThroughColumn;for(var i=0,l=records.length;i<l;i++){var record=typeof records[i]==="string"?table.store.getById(records[i]):records[i];var value=PTC.jca.table.rowStrikeThrough.getBooleanValue(record,strikeThroughColumn);record.strikeThroughOriginal=value}}PTC.jca.table.rowStrikeThrough.updateHiddenDivForModified(tableId)};
function getRowItem(row){var item=null;if(row&&row.item!==undefined)item=row.item;if(!item&&row!==null&&row.data!==undefined)return row.data;if(!item)return row;return item}function getRowContext(row,table){if(row===null)return null;return row.get("jsca_context")}function getRowOid(row){if(row===null)return null;return row.get("oid")}PTC.wizard.saveTableData={};PTC.wizard.saveTableData.log=log4javascript.getLogger("PTC.wizard.saveTableData");
PTC.wizard.saveTableData._getHiddenTableDataDiv=function(){if(PTC.wizard.saveTableData.HIDDEN_TABLE_DATA===undefined||!document.getElementById("PTC_wizard_saveTableData")){var aDiv=document.createElement("div");aDiv.id="PTC_wizard_saveTableData";aDiv.style.display="none";getMainForm().appendChild(aDiv);PTC.wizard.saveTableData.HIDDEN_TABLE_DATA=aDiv}return PTC.wizard.saveTableData.HIDDEN_TABLE_DATA};
PTC.wizard.saveTableData.register=function(){setUserSubmitFunction(PTC.wizard.saveTableData.writeAllTableRows);PTC.wizard.on("beforeReloadStep",PTC.wizard.saveTableData.writeAllTableRows)};PTC.onReady(function(){if(isWizardWindow())PTC.wizard.saveTableData.register()});
PTC.wizard.saveTableData._getTableHiddenHTML=function(table){var html="";var view=table.getView();if(view instanceof Ext.ux.grid.BufferView){var store=table.getStore();var storeIsFiltered=store.isFiltered();var visibleRowCount=view.getVisibleRowCount()-3;var totalRows=store.getCount();PTC.wizard.saveTableData.log.debug("value of storeIsFiltered",storeIsFiltered);PTC.wizard.saveTableData.log.debug("visible row count is",visibleRowCount);PTC.wizard.saveTableData.log.debug("total number of rows is"+
totalRows);if(visibleRowCount<totalRows||storeIsFiltered){PTC.wizard.saveTableData.log.debug("will write out hidden table rows");var cs=view.getColumnData();var cols=table.getColumnModel();var rs=store.getRange(0,totalRows);var colCount=view.cm.getColumnCount();var origIsVisible=view.isVisible;try{view.isVisible=function(rowIndex,vr){return!this.isRowRendered(rowIndex)};if(typeof view.fastRender!=="function")view.fastRender=PTC.wizard.saveTableData.fastRender;html=view.fastRender(cs,rs,store,0,colCount,
cols)}finally{view.isVisible=origIsVisible}}}table.fireEvent("submit",table);return html};PTC.wizard.saveTableData.writeHTMLToHiddenDiv=function(html){var div=PTC.wizard.saveTableData._getHiddenTableDataDiv();PTC.util.purge(div,true);div.innerHTML=html};
PTC.wizard.saveTableData.writeAllTableRows=function(){var tables=PTC.jca.table.Utils.getTables();var html=[];tables.each(function(table){if(typeof table.submitAllTableData==="function")html.push(table.submitAllTableData())});PTC.wizard.saveTableData.writeHTMLToHiddenDiv(html.join(""));return true};Ext.grid.GridPanel.prototype.submitAllTableData=function(){return PTC.wizard.saveTableData._getTableHiddenHTML(this)};
PTC.wizard.saveTableData.doRendering=function(table,rec,rowIndex,colCount,columnConfigs,cols,store){var actionId=table.grid.initialConfig.jcaTableConfig.actionsMenuColumnId;var col;var p={};var cb=[];for(var i=0;i<colCount;i++){col=columnConfigs[i];if(cols.config[i].modifiable&&col.id!==actionId){p.id=col.id;p.attr=p.cellAttr="";p.value=col.renderer.call(col.scope,rec.get(col.name),p,rec,rowIndex,i,store);cb[cb.length]=p.value}}return cb};
PTC.wizard.saveTableData.fastRender=function(cs,rs,ds,startRow,colCount,cols){var buf=[],c,p={},r;var actionId=this.grid.initialConfig.jcaTableConfig.actionsMenuColumnId;for(var j=0,len=rs.length;j<len;j++){r=rs[j];var rowIndex=j+startRow;var needsRendering=this.isVisible(rowIndex);if(!needsRendering){PTC.wizard.saveTableData.log.debug("row for index ",rowIndex," already visible, won't render again");continue}if(needsRendering){PTC.wizard.saveTableData.log.debug("row for index ",rowIndex," is not visible, will call renderer");
var result=PTC.wizard.saveTableData.doRendering(this,r,rowIndex,colCount,cs,cols,ds);buf[buf.length]=result.join("")}}var filteredRows=PTC.wizard.saveTableData.renderFiltered(this,ds,colCount,cols,cs,actionId);buf[buf.length]=filteredRows.join("");return buf.join("")};
PTC.wizard.saveTableData.renderFiltered=function(table,ds,colCount,cols,cs,actionId){var buffer=[];var p={};var filteredOutRecords=PTC.jca.table.Utils.getFilteredOutTableRows(ds);for(var i=0,length=filteredOutRecords.length;i<length;i++){var result=PTC.wizard.saveTableData.doRendering(table,filteredOutRecords[i],-1,colCount,cs,cols,ds);buffer[buffer.length]=result.join("")}return buffer};
PTC.wizard.saveTableData.setTableValue=function(dom){var tag=dom.tagName.toLowerCase();switch(tag){case "input":case "button":var type=dom.type;if(type==="radio"||type==="checkbox"){var rg=document.getElementsByName(dom.name);$A(rg).each(function(item){if(item.checked)item.setAttribute("checked","true");else item.removeAttribute("checked");item.setAttribute("value",item.value)})}else dom.setAttribute("value",dom.value);break;case "textarea":dom.innerHTML=dom.value;break;case "select":$A(dom.options).each(function(item){if(!item.selected&&
(item.getAttribute("selected")||item.getAttribute("selected")===""))item.removeAttribute("selected");else if(item.selected)item.setAttribute("selected",true)});break;default:break}};PTC.wizard.saveTableData.saveHTMLBackToGuiComponent=function(cell,dom,parent){parent=parent||Ext.fly(dom).parent(".x-grid3-cell-inner",10);cell.gui.html=parent.innerHTML;if(cell.gui.comparable!==undefined)cell.gui.comparable=dom.value};
PTC.wizard.saveTableData.domChangeEventListener=function(evt,item){var tag=item.tagName.toLowerCase();if(tag==="input"||tag==="select"||tag==="textarea"){var table=this;var view=table.getView();var colindex=view.findCellIndex(item);if(tag==="input"){var headerElement=new Ext.Element(view.getHeaderCell(colindex),false);var applyToAllRows=headerElement.contains(item);if(applyToAllRows===true){PTC.wizard.saveTableData.saveAllRowsValues(table,colindex,item);return}}var rowindex=view.findRowIndex(item);
if(colindex>=0&&rowindex>=0){var record=table.getStore().getAt(rowindex);if(record!==undefined){var cell=record.get(table.getColumnModel().config[colindex].id);if(cell!==undefined){PTC.wizard.saveTableData.saveNewValueToCell(item,cell);table.fireEvent("domchange",table,item,record,cell)}}}}};
PTC.wizard.saveTableData.saveNewValueToCell=function(item,cell,parent){if(!Ext.isIE||Ext.fly(item).is("[type=radio]")||Ext.fly(item).is("[type=checkbox]"))PTC.wizard.saveTableData.setTableValue(item);if(typeof cell.updateCellValue==="function"){var itemValue=item.value.replace(/"/g,"&quot;");cell.updateCellValue(cell,itemValue)}else if(cell.gui)if(cell.gui.value!==undefined||cell.gui.html===undefined)cell.gui.value=item.value;else{if(cell.gui.html!==undefined)PTC.wizard.saveTableData.saveHTMLBackToGuiComponent(cell,
item,parent)}else PTC.wizard.saveTableData.log.debug("Unable to save new value to cell as cell.gui is undefined or there is no updateCellValue fn on cell",cell)};
PTC.wizard.saveTableData.saveToStore=function(item){if(!item)return;var e;if(document.createEvent){e=document.createEvent("HTMLEvents");e.initEvent("change",true,true);item.dispatchEvent(e)}else if(document.createEventObject){e=document.createEventObject();try{item.fireEvent("onclick",e)}catch(f){PTC.wizard.saveTableData.log.debug("item id value is unspecified",item.id)}}};
PTC.wizard.saveTableData.registerDomChangeEvents=function(){var component=this;var onChangeHandler=this.domChangeEventListener;var element=component.el.dom;if(component.getView==="function")element=component.getView().el.dom;var taskUpdateFunc=function(evt,item){if(item._jcaOnChangeTask===undefined)item._jcaOnChangeTask=new Ext.util.DelayedTask(onChangeHandler);item._jcaOnChangeTask.delay(50,null,component,[evt,item]);return true};Ext.EventManager.on(element,"change",function(evt,item){if(item._jcaOnChangeTask!==
undefined)item._jcaOnChangeTask.cancel();return onChangeHandler.call(component,evt,item)},component);Ext.EventManager.on(element,"keyup",taskUpdateFunc,component);if(Ext.isIE)Ext.EventManager.on(element,"click",taskUpdateFunc,component);component.on("render",function(){PTC.wizard.saveTableData.registerDomChangeEvents.call(component,element)},component)};
PTC.wizard.saveTableData.saveAllRowsValues=function(table,colindex,item){if(colindex>0){var store=table.getStore();var checkboxOn=item.checked;store.each(function(record){var cell=record.get(table.getColumnModel().config[colindex].id);PTC.wizard.saveTableData.toggleCheckboxes(cell,checkboxOn)})}};
PTC.wizard.saveTableData.toggleCheckboxes=function(cell,checkboxOn){if(cell&&cell.gui&&cell.gui.html){var cellHtml=cell.gui.html;var mid=cellHtml.indexOf('type="checkbox"');if(mid<0)return;var start=cellHtml.lastIndexOf("<input",mid);var end=cellHtml.indexOf(">",mid);var checkboxTag=cellHtml.substring(start,end+1);var checkedStr="checked";var beforeCheckBox=cellHtml.substring(0,start);var afterCheckBox=cellHtml.substring(end+1,cellHtml.length);if(checkboxOn)if(checkboxTag.indexOf(checkedStr)<0)checkboxTag=
checkboxTag.replace("<input","<input checked");else return;else checkboxTag=checkboxTag.replace(checkedStr,"");cell.gui.html=beforeCheckBox+checkboxTag+afterCheckBox}};PTC.wizard.saveTableData.callDomChangeListener=function(element){var tableId=tableUtils.findParentTableNodeId(element);var component=tableId?Ext.getCmp(tableId):PTC.attributePanel.findParentAttributePanel(element);if(component&&component.domChangeEventListener)component.domChangeEventListener(null,element)};
PTC.jca.table.scroll.SCROLL_TO_TABLE="";PTC.jca.table.scroll.SCROLL_TO_OFFSET="";PTC.jca.table.scroll.contentAreaPanel=null;PTC.jca.table.scroll.log=log4javascript.getLogger("PTC.jca.table.scroll");PTC.jca.table.scroll.updateTableWidth=function(wTablePanel,width,height){if(wTablePanel){var tableGrid=wTablePanel.getGridPanel();if(tableGrid)PTC.jca.ColumnUtils.resizeAllColumns(tableGrid,width,height)}};
PTC.jca.table.scroll.updateTableSize=function(tableId,heightOnly,width,tabRefresh){if(tableId){var cmp=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId));var newHeight;if(cmp){if(!cmp._updateSizeTask||tabRefresh===true)cmp._updateSizeTask=new Ext.util.DelayedTask(function(tableId,heightOnly,width){var cmp=Ext.getCmp(PTC.jca.table.getWTablePanelID(tableId));if(!cmp)return;var grid=cmp.getGridPanel();if(grid.getInnerWidth()>0){var oldHeight=grid.getHeight()-4;var cachedTableHeight=grid.getCachedTableHeight();
if(cachedTableHeight)newHeight=cachedTableHeight;else newHeight=PTC.jca.table.scroll.calculateTableHeight(cmp);grid.colModel.setColumnWidth(grid.colModel.getIndexById(PTC.jca.table._STRETCHER_ID),1);if(heightOnly!==true){PTC.jca.ColumnUtils.resizeAllColumns(grid,null,newHeight,true);var defaultTableHeight=cmp._defaultHeight;newHeight-=defaultTableHeight;defaultTableHeight=PTC.jca.table.scroll.getDefaultTableHeight(cmp,true);newHeight+=defaultTableHeight}if(Math.abs(newHeight-oldHeight)>15||grid.alwaysSetHeight===
true){grid.setHeight(newHeight+4);grid.alwaysSetHeight=false}PTC.jca.ColumnUtils.resizeLastColumn(grid,null,newHeight)}});cmp._updateSizeTask.delay(10,null,null,[tableId,heightOnly,width])}}};
PTC.jca.table.scroll.getDefaultTableHeight=function(wTablePanel,recalculate){if(wTablePanel._defaultHeight&&!recalculate)return wTablePanel._defaultHeight;var gPanel=wTablePanel.getGridPanel();var defaultHeight=0;var defaultScrollBarHeight=19;var headerDiv=getElementsByClassNameAndTag("x-grid3-header",gPanel.getEl().dom,"div")[0];var panels=[gPanel.tbar,Ext.fly(headerDiv),gPanel.bbar,gPanel.footer];panels.each(function(panel){if(panel)defaultHeight+=panel.getHeight()});var gView=gPanel.getView();
var tableBodyWidth=gPanel.getColumnModel().getTotalWidth(false);if(gPanel.getEl().dom){var tableWidth=gPanel.getWidth();if(tableBodyWidth>=tableWidth)defaultHeight+=defaultScrollBarHeight}if(defaultHeight>40)wTablePanel._defaultHeight=defaultHeight;return defaultHeight};PTC.navigation.on("historyChange",function(){if(PTC.jca.table.scroll.contentAreaPanel!==undefined)PTC.jca.table.scroll.contentAreaPanel=undefined});
PTC.jca.table.scroll.setContentArea=function(contentArea,component){if(component)component.contentAreaPanel=contentArea};
PTC.jca.table.scroll.getContentArea=function(element){var ca;if(element)if(element.contentAreaPanel)ca=element.contentAreaPanel;else{var parentDiv=element.findParentNode("div.x-panel");if(parentDiv!==null){PTC.jca.table.scroll.log.debug("parentDiv id: "+parentDiv.id);ca=Ext.getCmp(parentDiv.id);if(ca&&ca.getHeight()===0)ca=ca.getEl().findParentNode("div.x-panel")}if(!PTC.isDefined(ca)&&isWizardWindow())ca=Ext.get("wiz_step_contents")}else{ca=Ext.getCmp(PTC.navigation.cardManager);if(ca)ca=ca.layout.activeItem}if(ca&&
typeof ca.getEl==="function")ca=ca.getEl();PTC.jca.table.scroll.setContentArea(ca,element);return ca};PTC.jca.table.scroll.getTableMarginHeight=function(wTablePanel){var tableMargin=0;var tableId=tableUtils.getFormattedTableId(wTablePanel.getGridPanel().getId());var tableOuterFrame=Ext.get(tableId);if(tableOuterFrame)tableMargin=tableOuterFrame.getMargins("tb");return tableMargin+15};
PTC.jca.table.scroll.getMinimumTableHeight=function(wTablePanel){return PTC.jca.table.scroll.getDefaultTableHeight(wTablePanel)+wTablePanel.rowHeight*3};
PTC.jca.table.scroll.calculateTableHeight=function(wTablePanel){var defaultHeight=PTC.jca.table.scroll.getDefaultTableHeight(wTablePanel);var gPanel=wTablePanel.getGridPanel();var gridPanel_dom=gPanel.getEl().dom;var gView=gPanel.getView();var rHeight=typeof gView.getCalculatedRowHeight==="function"?gView.getCalculatedRowHeight():wTablePanel.rowHeight;var iViewRows=0;if(gPanel.tree)iViewRows=gView.getAllRenderableRows().length;else iViewRows=gPanel.store.getCount();if(iViewRows===0){defaultHeight+=
2*rHeight;return defaultHeight}var gridHeight=0;var newHeight=0;var contentArea=PTC.jca.table.scroll.getContentArea(gPanel.getEl());var contentAreaHeight=0;if(contentArea!==null||contentArea!==undefined)if(contentArea&&typeof contentArea.getInnerHeight==="function")contentAreaHeight=contentArea.getInnerHeight();else if(contentArea&&typeof contentArea.getHeight==="function")contentAreaHeight=contentArea.getHeight();else contentAreaHeight=getWindow().getWindowHeight();if(iViewRows<=10||gView.variableRowHeight)for(var i=
0;i<iViewRows;i++){var record=gView.getRowsForTableTree(i);if(record!==undefined)if(Ext.isIE)gridHeight+=record.offsetHeight;else gridHeight+=record.getHeight();else gridHeight+=rHeight;if(gridHeight>=contentAreaHeight)break}else gridHeight=iViewRows*rHeight;gView.cumulativeRowHeight=gridHeight;newHeight=gridHeight+defaultHeight;if(contentArea===null||contentArea===undefined)if(iViewRows<15){newHeight+=rHeight;return newHeight}if(gPanel.store.groupField){var firstGroupRow=gView.getGroups()[0].firstChild;
var groupRowHeight=firstGroupRow?firstGroupRow.getHeight():0;var groupingRows=gView.getGroups().length;iViewRows+=groupingRows;newHeight+=groupingRows*groupRowHeight}if(iViewRows<2){var minHeight=2*rHeight+defaultHeight;return minHeight>newHeight?minHeight:newHeight}if(iViewRows<4)return newHeight;var offsetHeight=gridPanel_dom.offsetTop;var tableMarginHeight=PTC.jca.table.scroll.getTableMarginHeight(wTablePanel);if(newHeight+offsetHeight+tableMarginHeight>contentAreaHeight){newHeight=contentAreaHeight-
offsetHeight-tableMarginHeight;var oldHeight=gPanel.getHeight();gPanel.alwaysSetHeight=oldHeight>newHeight;var minimumTableHeight=PTC.jca.table.scroll.getMinimumTableHeight(wTablePanel);if(newHeight<=minimumTableHeight)return minimumTableHeight}return newHeight};PTC.jca.table.scroll.handleScrollingGrids=function(wTablePanel,rowStore){wTablePanel.gridPanel.autoHeight=false;rowStore.on({load:function(store,records,options){if(!wTablePanel.getGridPanel().jcaTableConfig.chunk&&!wTablePanel.getGridPanel().tree)PTC.jca.table.scroll.updateTableSize(wTablePanel.getGridPanel().getId())}})};
PTC.jca.table.scroll.getFirstVisibleRowIdx=function(gridView,scrollTop){var visibleRows=gridView.getVisibleRows();var firstRowIdx=0;if(visibleRows!==null||visibleRows!==undefined)firstRowIdx=visibleRows.first;if(firstRowIdx>0)firstRowIdx=visibleRows.indexes?visibleRows.indexes[2]:firstRowIdx+2;if(firstRowIdx===0&&scrollTop>0)firstRowIdx=visibleRows.indexes?visibleRows.indexes[1]:firstRowIdx+1;return firstRowIdx};
PTC.jca.table.scroll.getVerticalScrollTipColumnId=function(gridPanel,tableId){var multiSortStr=PTC.jca.getMultiColumnSortString(tableId);var columnDisplay;var colModel=gridPanel.getColumnModel();if(multiSortStr===null||multiSortStr===undefined){var colCount=colModel.getColumnCount();var columnIndex;for(columnIndex=0;columnIndex<colCount;columnIndex++)if(!colModel.isHidden(columnIndex)){var tempColumn=colModel.getColumnId(columnIndex);if(tempColumn==="name"||tempColumn==="number"){columnDisplay=tempColumn;
break}}}else{var multiSortArray=multiSortStr.split(PTC.jca.SORT_DELIMITER);columnDisplay=multiSortArray[0]}if(columnDisplay&&colModel.getColumnById(columnDisplay)&&colModel.getColumnById(columnDisplay).modifiable===true)return null;return columnDisplay};PTC.jca.table.scroll.getWindowScrollbarWidth=function(obj){var scrollbarWidth=10;obj=PTC.util.getDom(obj);if(obj&&obj.scrollHeight>=obj.clientHeight)scrollbarWidth=Ext.getScrollBarWidth()+scrollbarWidth;return scrollbarWidth};
var executeSetAnchorTarget="true";var dataStore;function unCheckRadio(){var theElement;for(var formLen=0;formLen<getMainForm().elements.length;formLen++){theElement=getMainForm()[formLen];if(theElement.type=="radio")if(theElement.checked)theElement.checked=false}}function unCheckCheckBox(){var theElement;for(var formLen=0;formLen<getMainForm().elements.length;formLen++){theElement=getMainForm()[formLen];if(theElement.type=="checkbox")if(theElement.checked)theElement.checked=false}}
function closeLB(){searchWinsaveThisSearchLB.close()}
function postSaveSearch(searchName,oid,closePopup){var loadCall="<a href='#' onClick="+"loadAdvSearchPage('event','paste_url_here')> ";var loadURL="netmarkets/jsp/search/search.jsp?fireSearch=false&isQuerySelected=true&savedQueryList="+oid;loadCall=loadCall.replace("paste_url_here",loadURL);var fullMessage=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.SAVED_SEARCH_CREATED_TITLE");var messages=new Array(1);messages[0]=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.SAVED_SEARCH_CREATED");
messages[0]+=loadCall+searchName+"</a>";var msgObjects=new Array(1);msgObjects[0]={MessageTitle:fullMessage,Messages:messages,MessageType:"SUCCESS"};PTC.getMainWindow().PTC.messaging.showInlineMessage(msgObjects);if(!closePopup)PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Save Search Creation",isEndEvent:true});if(closePopup)window.top.close();return true}
function SavedSearchOK(){PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Save Search Creation"});var searchName=document.getElementById("searchName").value;if(searchName==null||trim(searchName)==""){JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.SAVED_SEARCH_NAME_MISSING");return false}var choice=validateSavedSearchName(searchName,"search");if(choice){var sForm=Ext.Ajax.serializeForm(getMainForm());var querySaved=true;var ajaxOptions={asynchronous:true,
method:"POST",onSuccess:function(response){var jsonData=Ext.util.JSON.decode(response.responseText.trim());var resultMessage=jsonData.message;var oid=jsonData.oid;var queryName=jsonData.queryname;if(resultMessage!="success")alert(resultMessage);else postSaveSearch(queryName,oid,false)},parameters:sForm};requestHandler.doRequest("netmarkets/jsp/search/saveQuery.jsp",ajaxOptions)}return choice}
function setAnchorTarget(anchor_target){if(executeSetAnchorTarget=="false")return;var e=document.getElementById(anchor_target);var pos=getOffsetTop(e);e=e.offsetParent;pos+=e.offsetTop;top.window.scrollTo(0,pos)}function setFocusOnKeyword(){if(typeof getElementsByIdkeywordField!="undefined"){var key=getElementsByIdkeywordField();key[0].focus()}}function getOffsetTop(el){var ot=el.offsetTop;while((el=el.offsetParent)!=null)ot+=el.offsetTop;return ot}
function deleteQuery(){soid=getSelectedItems();if(soid==null||soid.length==0){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");return false}else return JCAConfirm("com.ptc.netmarkets.util.utilResource.CONFIRM_DELETE")}
function deleteObject(event){soid=getSelectedItems();if(soid==null||soid.length==0){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");return false}else return JCAConfirm(event,"com.ptc.windchill.enterprise.search.client.searchClientResource.CONFIRM_DELETE")}PTC.search.criteriaBuilder=function(){var searchName=document.getElementById("searchName").value;parent.document.getElementById("defaultSearchName").value=searchName;closeLB.defer(500,this)};
function validateResultPerPage(){var pageName=getElementByName("pageCount");var pageValue=pageName.value;var pageMaxCount=getElementByName("maxPageCont");var arrayList=new Array(pageMaxCount);var pagemaxValue=pageMaxCount.value;pageValue=pageValue.replace(/(^\s+|\s+$)/g,"");if(pageValue==null||pageValue.length==0||pageValue<=0||isNaN(pageValue)||pageValue!=Math.round(pageValue)){JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.MESSAGE_RESULT_PER_PAGE");return false}if(pagemaxValue==
null||pagemaxValue.length==0||parseInt(pagemaxValue)<parseInt(pageValue)){JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.RESULT_PER_PAGEMAX_CAP",pagemaxValue);return false}return true}
function checkBoxValidation(){var containerName=document.getElementById("containerTypeList");var containerValue=containerName.value;var member=getElementByName("memberOfContainer");var organization=getElementByName("searchInUserOrg");var mainForm=getMainForm();var action=mainForm.action;if(containerValue==""||containerValue=="wt.inf.library.WTLibrary"||containerValue=="wt.pdmlink.PDMLinkProduct"||containerValue=="wt.projmgmt.admin.Project2"){if(member)member.disabled=false;if(organization)organization.disabled=
false;mainForm.action=removeParamFromString("containerRef",action)}else{var delim=action.indexOf("?")==-1?"?":"&";mainForm.action=action+delim+"containerRef="+containerValue;if(member){member.checked=false;member.disabled=true}if(organization){organization.checked=false;organization.disabled=true}}}
function clearExecuteLocationParam(){var mainForm=getMainForm();var action=mainForm.action;if(action!=null&&action!="undefined"&&"string"===typeof action&&action.indexOf("executeLocation")>-1)mainForm.action=removeParamFromString("executeLocation",action)}function scrollToTop(){scrollTo(0,0);if(isPicker())searchPicker.scrollTop=0}function isPicker(){if($("searchPage")==null)return false;if($("searchPage").value=="picker")return true;return false}
function preSelectSearch(){select=document.getElementById("savedQueryList");if(select.selectedIndex==0)return false;else{getMainForm().action="netmarkets/jsp/search/search.jsp?isQuerySelected=true";return true}}function closeLightBox(){var closeOptions={lbWindow:self};closeOptions.saveContent=true;PTC.lightbox.deactivate(closeOptions);return true}
function submitSearchForm(){PTC.search.performance.logger.init();PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Search Button Click"});buttons=document.getElementsByName("search");buttons[0].click()}function checkKeyPressed(e){if(e.keyCode==13){Event.stop(e);submitSearchForm()}}
function selectOnFocus(formName,elementName,elementValue){var theForm=getMainForm();var theForm_length=theForm.length;for(var i=0;i<theForm_length;i++){var element=theForm.elements[i];if(element.name&&element.name.indexOf(elementName)!=-1){var value=element.value;if(value.indexOf(elementValue)==0)element.checked=true}}}function check(elem){if(document.getElementById(elem).checked==true)eval("getMainForm()."+elem+".value = 1")}
function QBPickerCallback(objects,pickerID,attr){var myJSONObjects=objects.pickedObject;for(var i=0;i<myJSONObjects.length;i++){var oid=myJSONObjects[i].oid;eval("window.getMainForm()."+pickerID+".value="+"oid");var displayName=pickerID.replace("$OID$","");var displayAttr=eval("myJSONObjects[i]."+attr);eval("window.getMainForm()."+displayName+".value="+"displayAttr")}}
function contentsRefreshOnTVMClose(table_id){if(isSearchTable(table_id)){if(typeof getMainForm().customizeQueryPage!="undefined")window.location.href=window.location.href;else if(typeof getMainForm().executingProeSearch!="undefined"){document.location.reload();return}else if(getMainForm().searchFired)fireSearch();else{getMainForm().fireSearch.value="false";PTC.search.refreshPage()}return false}return true}
function isSearchTable(table_id){var table=document.getElementById(table_id);var searchTable=false;if(table!=undefined){var parent=table.parentNode;var count=0;while(parent!=null&&!searchTable&&count++<5){if(parent.id=="searchResultTableDiv")searchTable=true;parent=parent.parentNode}}return searchTable}
function selectSearchAction(){getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="selectSearch";getMainForm().executeLocation.value="selectSearch";var selectedQuery=document.getElementById("savedQueryList");if(selectedQuery.value!="$$$pickSearch$$$")PTC.navigation.submitForm();if(selectedQuery.value=="$$$pickSearch$$$"){var savedSearchName=getElementByName("savedSearchName");savedSearchName.value=""}}
function selectSearchActionByLink(rowid,edit){if(edit==false)getMainForm().action="netmarkets/jsp/search/search.jsp?fireSearch=true";else getMainForm().action="netmarkets/jsp/search/search.jsp?isQuerySelected=true";getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="selectSearch";var selectedQuery=document.getElementById("savedQueryList_"+rowid);var origQuery=document.getElementById("savedQueryList");origQuery.value=selectedQuery.value;if(selectedQuery.value!=
"$$$pickSearch$$$")PTC.navigation.submitForm();if(selectedQuery.value=="$$$pickSearch$$$"){var savedSearchName=getElementByName("savedSearchName");savedSearchName.value=""}}
function getSelectDateType(comboBoxId){if(comboBoxId.value=="2"){PTC.search.showElement("dateRange"+comboBoxId.id);PTC.search.hideElement("dayRange"+comboBoxId.id);return}if(comboBoxId.value=="3"){PTC.search.showElement("dayRange"+comboBoxId.id);PTC.search.hideElement("dateRange"+comboBoxId.id);return}PTC.search.hideElement("dayRange"+comboBoxId.id);PTC.search.hideElement("dateRange"+comboBoxId.id);return}
PTC.search.hideElement=function(id){var elem=document.getElementById(id);if(elem)if(elem.style)elem.style.display="none";else elem.display="none"};PTC.search.showElement=function(id){var elem=document.getElementById(id);if(elem)if(elem.style)elem.style.display="inline";else elem.display="inline"};function confirmRowDelete(){return JCAConfirm("com.ptc.netmarkets.util.utilResource.CONFIRM_DELETE")}
function validateSearch(){PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Validate Search"});if(searchButton.disabled==true)return false;var emptySearchFired=false;var validationResult=false;searchButton.setDisabled(true);try{$("searchButtonLoaderDiv").show();populateContainerRefForActions();validationResult=PTC.search.validateSpecialTypes(dataStore);var isEmptyQuertValidationEnabled=document.getElementById("isEmptyQuertValidationEnabled");if(PTC.isDefined(isEmptyQuertValidationEnabled)&&
isEmptyQuertValidationEnabled.value=="true"){emptySearchFired=PTC.search.checkForEmptySearch();if(emptySearchFired==true){PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Validate Search",isEndEvent:true});return false}}if(validationResult==false){PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Validate Search",isEndEvent:true});return false}}finally{if(validationResult==false||emptySearchFired==true)enableSarchButton();else setTimeout("enableSarchButton()",
1E4)}PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Validate Search",isEndEvent:true});return true}function enableSarchButton(){if($("searchButtonLoaderDiv")){$("searchButtonLoaderDiv").hide();searchButton.setDisabled(false)}}function lightBoxCloseandRefreshParent(event){var contentWin=PTC.lightbox.getActivatingWindow();PTC.lightbox.deactivate({lbWindow:self});var url="netmarkets/jsp/search/historySavedSearchDisplay.jsp";contentWin.PTC.navigator.setActiveSubTab(0,0,url)}
function deleteSavedQuery(oid){var option=confirmRowDelete();if(option){getMainForm().action="netmarkets/jsp/search/historySavedSearchDisplay.jsp?oid="+oid;getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="deleteRowQuery";PTC.navigation.submitForm()}}function forceLoadUrl(target,event){PTC.navigation.loadContent(target.href,true);Event.stop(event);return false}
function getContainerTypeList(){if(document.getElementById("containerTypeList")==null)return"";else return document.getElementById("containerTypeList").value}function populateContainerRefForActions(){addToMainFormAction(getContainerTypeList())}
function validateSavedSearchName(searchName,currentPage){var choice=true;var ajaxOptions={asynchronous:false,method:"GET",onSuccess:function(result,options){var jsonData=Ext.util.JSON.decode(result.responseText.trim());var resultMessage=jsonData.message;var validationResult=jsonData.validationResult;if(validationResult==false)choice=JCAConfirm("com.ptc.windchill.enterprise.search.client.searchClientResource.SAVEDSEARCHNAMEALERT")},parameters:{searchName:searchName,currentPage:currentPage}};requestHandler.doRequest("netmarkets/jsp/search/savedSearchNameValidation.jsp",
ajaxOptions);return choice}
function hideComponents(){if(document.getElementById("advancedSearchDiv")!=null)document.getElementById("advancedSearchDiv").style.display="none";if(document.getElementById("keywordDiv")!=null)document.getElementById("keywordDiv").style.display="none";if(document.getElementById("searchButtonDiv")!=null)document.getElementById("searchButtonDiv").style.display="none";if(document.getElementById("savedQueryName")!=null)document.getElementById("savedQueryName").style.display="none"}
function showComponenets(){if(document.getElementById("editSearchCriteriaLink")!=null)document.getElementById("editSearchCriteriaLink").style.display="";if(document.getElementById("startNewSearchLink")!=null)document.getElementById("startNewSearchLink").style.display="inline";if(document.getElementById("searchFor")!=null)document.getElementById("searchFor").style.display="";if(document.getElementById("hideAdvanceSCriteria")!=null)document.getElementById("hideAdvanceSCriteria").style.display="none";
if(document.getElementById("searchResultTableDiv")!=null)document.getElementById("searchResultTableDiv").style.display=""}var menuShowResults;
function initializeShowResultsMenu(lbl_searchRangeAnd,lbl_searchRangeOr){var myMenuShowResults=Ext.getCmp("menuShowResults");if(myMenuShowResults!=null)myMenuShowResults.destroy();menuShowResults=new Ext.menu.Menu({id:"menuShowResults",floating:true,autoWidth:true});menuShowResults.addItem(new Ext.menu.Item({text:lbl_searchRangeAnd,data:"&",handler:updateShowResultsAnchorHeader}));menuShowResults.addItem(new Ext.menu.Item({text:lbl_searchRangeOr,data:"|",handler:updateShowResultsAnchorHeader}))}
function updateShowResultsAnchorHeader(Item){var anchorHeader=document.getElementById("showResultsHeader");anchorHeader.innerHTML=Item.text;document.getElementById("showResults").value=Item.data}function launchShowResultsMenu(){menuShowResults.show(Ext.get("showResultsHeader"))}function startNewSearch(){loadAdvSearchPage(null,"wtcore/jsp/com/ptc/windchill/search/Search.jsp")}function loadSearchPage(maintab,subtab,event,url){openNavigator.defer(5,this,[maintab,subtab,url])}
function openNavigator(maintab,subtab,url){PTC.navigator.setActiveSubTab(maintab,subtab,url,true)}
function loadAdvSearchPage(event,url){if(typeof resultParams!="undefined"&&!Ext.isEmpty(resultParams.searchResultsViewId)){PTC.jca.table.stickiness.clearTableStickiness(resultParams.searchResultsViewId);var viewArray=resultParams.searchResultsViewId.split(".searchInListTextBox");if(viewArray.length>0)PTC.jca.table.clearObjectFromSession(viewArray[0],"searchInListTextBox")}loadSearchPage("object_search_navigation","advancedNavigation",event,url)}
function validateNumericValue(event,textBoxName){var tb=$(textBoxName);var value=Ext.util.Format.trim(tb.value);var result=/^-?\d+$/.test(value);if(result)if(value<0)result=false;result=result||value=="";if(!result){JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.INVALID_NUMBER");var isIE=navigator.userAgent.indexOf("MSIE")>-1;if(isIE)event.cancelBubble=true;else event.stopPropagation();setTimeout(function(){tb.focus();tb.select()},20)}}Ext.namespace("PTC.search");
PTC.search.RemovableCheckbox=Ext.extend(Ext.form.Checkbox,{onRemoveFunction:function(){},onMouseEnterFunction:function(e,t,o){deleteDiv=Ext.get(this.getId()+"_deleteDiv");deleteDiv.show();if(this.qtip)t.title=PTC.search.decodeForHTMLContent(this.qtip)},onMouseLeaveFunction:function(e,t,o){deleteDiv=Ext.get(this.getId()+"_deleteDiv");deleteDiv.hide()},onAfterRenderFunction:function(elem){enclosingElem=elem.getResizeEl();enclosingElem.addClassOnOver("removableCheckboxHover");enclosingElem.on("mouseenter",
this.onMouseEnterFunction,elem);enclosingElem.on("mouseleave",this.onMouseLeaveFunction,elem)},constructor:function(config){if(config.boxLabel.indexOf("_deleteDiv")==-1)config.boxLabel=config.boxLabel+"  <span class='removeActionStyle' id='"+config.id+"_deleteDiv' style='display:block;float:right;padding-top:5px;padding-right:5px;'>"+"<a href=\"javascript:PTC.search.RemoveCheckboxCallback('"+config.id+"');\">"+"<img src='netmarkets/images/cancel9x9.gif' /></a></span>";if(config.listeners){listeners=
config.listeners;listeners.afterrender={fn:this.onAfterRenderFunction},config.listeners=listeners}else config.listeners={afterrender:{fn:this.onAfterRenderFunction}};config.style="float:left; width:20px;";config.labelStyle="float:left; width:140px; white-space: nowrap;";PTC.search.RemovableCheckbox.superclass.constructor.call(this,config);if(config.onRemoveFunction)this.onRemoveFunction=config.onRemoveFunction}});
PTC.search.RemoveCheckboxCallback=function(id){var checkbox=Ext.getCmp(id);checkbox.setValue(false);checkbox.onRemoveFunction()};PTC.search.RemoveContextCheckbox=function(){this.suspendEvents(false);if(this.getValue()){this.setValue(false);this.fireEvent("check",this,false)}var id=this.getId();PTC.search.recentlyUsedContexts.removeKey(id);this.destroy();Ext.Ajax.request({url:"netmarkets/jsp/search/removeContextFromList.jsp",params:{contextToRemove:id},mode:"POST"});PTC.search.setMyFavAndAllContextStatus()};
PTC.search.RemoveContextForUnCheck=function(removeContext){Ext.Ajax.request({url:"netmarkets/jsp/search/removeContextForUnCheck.jsp",params:{contextToRemove:removeContext},mode:"POST"})};PTC.search.callContextChangeListenerOnServer=function(targetContext,value){Ext.Ajax.request({url:"netmarkets/jsp/search/contextChangeListener.jsp",params:{context:targetContext,state:value},mode:"POST"})};
PTC.search.checkForEmptySearch=function(){var sForm=Ext.Ajax.serializeForm(getMainForm());var isEmptySearch=true;var ajaxOptions={asynchronous:false,method:"POST",onSuccess:function(response){var jsonData=Ext.util.JSON.decode(response.responseText.trim());var resultMessage=jsonData.message;var emptySearchFired=jsonData.emptySearchFired;var typesList=jsonData.removeTypesMessage;isEmptySearch=emptySearchFired;var title=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.PARENT_TYPE_SELECTED_MESSAGE_TITLE");
var message=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.PARENT_TYPE_SELECTED_MESSAGE");if(typesList.length>0)PTC.search.showBannerMessage(title,[message+" : "+typesList],"WARNING");if(isEmptySearch==true&&resultMessage!="Do Nothing")alert(resultMessage)},parameters:sForm};requestHandler.doRequest("netmarkets/jsp/search/checkForEmptySearch.jsp",ajaxOptions);return isEmptySearch};
function launchSearchPage(evt){var event="";var url="netmarkets/jsp/search/search.jsp?currentPage=search&searchType=wt.workflow.work.WorkItem&append=true";submitSearchToNavigator(url,event)}function submitSearchToNavigator(url,event){var serializedForm=Form.serialize(getMainForm());url+="&"+serializedForm;loadSearchPage("object_search_navigation","advancedNavigation",event,url)}Ext.ComponentMgr.onAvailable("object_search_navigation",checkSearchTabChanged);
function checkSearchTabChanged(){var cmp=Ext.getCmp("object_search_navigation");cmp.on("tabchange",generateSearchHelpUrl)}
function generateSearchHelpUrl(){var helpUrl="";var subTabId=PTC.navigator.getActiveSubTab().id;if(subTabId==="advancedNavigation")helpUrl=PTC.search.advSearchHelpUrl;else helpUrl=PTC.search.searchHistoryHelpUrl;var help=null;if(PTC.navigator.helpIcons["object_search_navigation"])help=PTC.help.getHelpButtonConfig(PTC.navigator.helpIcons["object_search_navigation"]);if(help)help.url=helpUrl}
PTC.search.callUpdateAllContextOnServer=function(callName,context){Ext.Ajax.request({url:"netmarkets/jsp/search/contextChangeListener.jsp",params:{contextName:context,callName:callName},mode:"POST"})};PTC.search.getIndexOfOptionFromValue=function(selectBox,value){var index=-1;for(i=0;i<selectBox.options.length;i++)if(selectBox.options[i].value==value){index=i;break}return index};
function setupJSONDataSource(){dataStore=new Ext.data.JsonStore({autoDestroy:true,idProperty:"internalValue",fields:["internalValue","imagePath","displayValue",{name:"checked",type:"boolean"},"parentType",{name:"allowMultiSelection",type:"boolean"},{name:"attributePanel",type:"boolean"},"callback",{name:"enabled",type:"boolean"},"enableIcon","disableIcon","toolTip"]});dataStore.loadData(target);dataStore.sort("displayValue")}
PTC.search.removeTypeCheckbox=function(){this.inRemove=true;var firstItem=true;var firstPreselectItem=true;document.getElementById("searchType").value="";getMainForm().preSelectionItems.value="";if(dataStore.getCount()==1)Ext.getCmp("wt.fc.Persistable").setValue(true);for(var i=0;i<dataStore.getCount();i++)if(dataStore.getAt(i).data.internalValue!==this.getId()){if(firstPreselectItem){getMainForm().preSelectionItems.value=dataStore.getAt(i).data.internalValue;firstPreselectItem=false}else getMainForm().preSelectionItems.value+=
","+dataStore.getAt(i).data.internalValue;if(dataStore.getAt(i).data.checked)if(firstItem==true){document.getElementById("searchType").value=""+dataStore.getAt(i).data.internalValue;firstItem=false}else document.getElementById("searchType").value=document.getElementById("searchType").value+","+dataStore.getAt(i).data.internalValue}dataStore.remove(dataStore.getById(this.id));this.destroy();selectMyFavTypes();PTC.search.checkAllTypesChecked();refreshQB()};
function showCheckBox(){var icon;var label=this.data.displayValue;if(this.data.attributePanel==true&&this.data.enabled==true&&this.data.checked==true)icon='<img  src="'+this.data.imagePath+'" /> '+label+"<img onmouseover=\"timeLag=setInterval('"+this.data.callback+';\', 600);" onmouseout="clearInterval(timeLag);" src="'+this.data.enableIcon+'"   /> ';else if(this.data.attributePanel==true&&this.data.enabled==false&&this.data.checked==false||this.data.attributePanel==true&&this.data.enabled==false&&
this.data.checked==true||this.data.attributePanel==true&&this.data.enabled==true&&this.data.checked==false)icon='<img  src="'+this.data.imagePath+'" /> '+label+'<img src="'+this.data.disableIcon+'"   /> ';else icon='<img  src="'+this.data.imagePath+'" /> '+label;icon="<div class='removableCheckBoxLabel' >"+icon+"</div>";if(PTC.isDefined(Ext.getCmp(this.data.internalValue))){var oldItem=Ext.getCmp(this.data.internalValue);oldItem.destroy()}var item=new PTC.search.RemovableCheckbox({name:this.data.internalValue,
id:this.data.internalValue,boxLabel:icon,checked:this.data.checked,labelStyle:"font-weight:bold;",renderTo:"typePickerItems",qtip:label,listeners:{check:function(checkbox,checked){checkListenerForNormalTypes.defer(100,this,[checkbox,checked])}},onRemoveFunction:PTC.search.removeTypeCheckbox});item.wrap.addClass("chk-same-line");item.wrap.addClass("removableCheckBoxItem");if(item.checked)if(firstSearchType==true){document.getElementById("searchType").value=""+this.data.internalValue;firstSearchType=
false}else document.getElementById("searchType").value=document.getElementById("searchType").value+","+this.data.internalValue;if(i==true){getTypePickerItemsElement().value=""+this.data.internalValue;i=false}else getTypePickerItemsElement().value=getTypePickerItemsElement().value+","+this.data.internalValue}
function showAllTypesnMyFavCheckbox(allTypesLabel,myFavLabel,addTypeLabel){var checkAllTypes=false;var checkMyFavTypes=false;if(PTC.isDefined(Ext.getCmp("wt.fc.Persistable"))){var oldItem=Ext.getCmp("wt.fc.Persistable");checkAllTypes=Ext.getCmp("wt.fc.Persistable").checked;oldItem.destroy()}if(PTC.isDefined(Ext.getCmp("myFavTypes"))){var oldItem=Ext.getCmp("myFavTypes");checkMyFavTypes=Ext.getCmp("myFavTypes").checked;oldItem.destroy()}var chkItem=new Ext.form.Checkbox({name:"wt.fc.Persistable",id:"wt.fc.Persistable",
checked:checkAllTypes,boxLabel:'<img src="netmarkets/jsp/search/small_blank_value.gif">'+allTypesLabel,renderTo:"allTypesDiv",qtip:allTypesLabel,listeners:{check:checkListenerForAllTypes}});var chkItem1=new Ext.form.Checkbox({name:"myFavTypes",id:"myFavTypes",checked:checkMyFavTypes,boxLabel:'<img src="netmarkets/jsp/search/small_blank_value.gif">'+myFavLabel+'&nbsp;&nbsp;&nbsp;&nbsp;<a href="javascript:launchTypePicker();">'+addTypeLabel+"</a>",renderTo:"myFavTypesDiv",qtip:myFavLabel,listeners:{check:checkListenerForMyFavTypes}})}
function checkListenerForMyFavTypes(){if(PTC.isDefined(Ext.getCmp("wt.fc.Persistable"))&&Ext.getCmp("wt.fc.Persistable").checked){var oldItem=Ext.getCmp("wt.fc.Persistable");oldItem.setValue("false")}var value="";document.getElementById("searchType").value="";if(Ext.getCmp("myFavTypes").checked)document.getElementById("searchType").value=changeStateOfCheckbox(true);else{changeStateOfCheckbox(false);changeStateOfAllTypesCheckBox(true)}refreshQB()}
function changeStateOfAllTypesCheckBox(state){var allTypesCheckBox=Ext.getCmp("wt.fc.Persistable");allTypesCheckBox.suspendEvents();allTypesCheckBox.setValue(state);allTypesCheckBox.resumeEvents();if(state==true)document.getElementById("searchType").value="wt.fc.Persistable"}
function changeStateOfCheckbox(state){var value="";for(var i=0;i<dataStore.getCount();i++){var comboVarToSet=Ext.getCmp(dataStore.getAt(i).data.internalValue);comboVarToSet.suspendEvents();dataStore.getAt(i).data.checked=state;comboVarToSet.setValue(""+state);comboVarToSet.resumeEvents();value=value+","+dataStore.getAt(i).data.internalValue}return value.substring(1)}
function displayTypePickerCheckBox(){var allTypes=dataStore.getById("wt.fc.Persistable");dataStore.remove(allTypes);dataStore.each(showCheckBox);if(!allTypes.get("checked")&&Ext.getCmp("wt.fc.Persistable").checked)changeStateOfAllTypesCheckBox(false);var checkMyFavTypes=true;if(dataStore.getCount()==0)checkMyFavTypes=false;else for(var i=0;i<dataStore.getCount();i++){var comboVarToSet=Ext.getCmp(dataStore.getAt(i).data.internalValue);if(dataStore.getById(dataStore.getAt(i).data.internalValue).get("checked")==
false){checkMyFavTypes=false;break}}Ext.getCmp("myFavTypes").suspendEvents();Ext.getCmp("myFavTypes").setValue(checkMyFavTypes);Ext.getCmp("myFavTypes").resumeEvents();if(allTypes.get("checked")&&!checkMyFavTypes)changeStateOfAllTypesCheckBox(true)}
function refreshQB(){if(PTC.getMainWindow()&&PTC.getMainWindow().PTC&&PTC.getMainWindow().PTC.performance)PTC.getMainWindow().PTC.performance.startComponentTimer("CheckUncheckType","Type Clicked");var searchtypes=document.getElementById("searchType").value;if(searchtypes==""||!searchtypes)searchtypes="wt.fc.Persistable";handleOtherCriteriaOnPage();var mform=Ext.Ajax.serializeForm(getMainForm());mform=mform+"&searchtypes="+searchtypes;Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/search/renderQB.jsp",
success:renderQB,params:mform});showBusySign();$("savedQueryName").update("")}function handleOtherCriteriaOnPage(){handleArchive();handleSourcingContext()}
function handleSourcingContext(){if($("sourcingContextWrapperDiv")){var searchtypes=document.getElementById("searchType").value;if(searchtypes==""||!searchtypes)searchtypes="wt.fc.Persistable";Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/search/displaySourcingContextFlag.jsp",success:displaySourcingContext,params:{searchtypes:searchtypes}})}}
function displaySourcingContext(response,options){var enableSourcingContext=eval(response.responseText);if(enableSourcingContext)$("sourcingContextWrapperDiv").show();else $("sourcingContextWrapperDiv").hide()}function handleArchive(){if($("archiveWrapperDiv")){var searchtypes=document.getElementById("searchType").value;if(searchtypes==""||!searchtypes)searchtypes="wt.fc.Persistable";if(searchtypes=="wt.dataops.archive.Archive")$("archiveWrapperDiv").show();else $("archiveWrapperDiv").hide()}}
function renderQB(response,options){hideBusySign();var queryBuilderContentDiv=Ext.get("queryBuilderContentDiv");queryBuilderContentDiv.update(response.responseText,true);if(PTC.getMainWindow()&&PTC.getMainWindow().PTC&&PTC.getMainWindow().PTC.performance)PTC.getMainWindow().PTC.performance.stopComponentTimer("CheckUncheckType")}
function checkListenerForAllTypes(){allTypesClicked=true;if(Ext.getCmp("wt.fc.Persistable").checked){document.getElementById("searchType").value="wt.fc.Persistable";if(PTC.isDefined(Ext.getCmp("myFavTypes"))&&Ext.getCmp("myFavTypes").checked){var myFavTypes=Ext.getCmp("myFavTypes");myFavTypes.suspendEvents();myFavTypes.setValue("false");myFavTypes.resumeEvents()}for(var i=0;i<dataStore.getCount();i++){var comboVarToSet=Ext.getCmp(dataStore.getAt(i).data.internalValue);comboVarToSet.suspendEvents();
dataStore.getAt(i).data.checked=false;comboVarToSet.setValue(false);comboVarToSet.resumeEvents()}}allTypesClicked=false;if(callTypeChange)refreshQB()}
function checkListenerForNormalTypes(checkbox,checked){if(allTypesClicked)return;if(checkbox.inRemove)return;if(!checked)if(PTC.isDefined(Ext.getCmp("myFavTypes"))&&Ext.getCmp("myFavTypes").checked){var oldItem=Ext.getCmp("myFavTypes");oldItem.suspendEvents();oldItem.setValue("false");oldItem.resumeEvents()}var firstItem=true;var enableAllTypes=false;var ind=dataStore.indexOfId(this.initialConfig.name);dataStore.getAt(ind).data.checked=!dataStore.getAt(ind).data.checked;document.getElementById("searchType").value=
"";var allObjecTypesAreChecked=true;for(var i=0;i<dataStore.getCount();i++)try{var chkBox=Ext.getCmp(dataStore.getAt(i).data.internalValue);if(chkBox.getValue()){enableAllTypes=true;if(firstItem==true){document.getElementById("searchType").value=""+dataStore.getAt(i).data.internalValue;firstItem=false}else document.getElementById("searchType").value=document.getElementById("searchType").value+","+dataStore.getAt(i).data.internalValue}}catch(ex){alert(ex)}selectMyFavTypes();PTC.search.checkAllTypesChecked();
if(enableAllTypes){Ext.getCmp("wt.fc.Persistable").suspendEvents();Ext.getCmp("wt.fc.Persistable").setValue(false);Ext.getCmp("wt.fc.Persistable").resumeEvents()}refreshQB()}
function selectMyFavTypes(){var allObjecTypesAreChecked=true;for(var i=0;i<dataStore.getCount();i++){var chkBox=Ext.getCmp(dataStore.getAt(i).data.internalValue);if(!chkBox.checked){allObjecTypesAreChecked=false;break}}if(allObjecTypesAreChecked&&dataStore.getCount()){Ext.getCmp("myFavTypes").suspendEvents();Ext.getCmp("myFavTypes").setValue(true);Ext.getCmp("myFavTypes").resumeEvents()}}
PTC.search.checkAllTypesChecked=function(){var allObjectTypesAreChecked=true;for(var i=0;i<dataStore.getCount();i++){var chkBox=Ext.getCmp(dataStore.getAt(i).data.internalValue);if(chkBox.checked){allObjectTypesAreChecked=false;break}}if(allObjectTypesAreChecked){var cb=Ext.getCmp("wt.fc.Persistable");cb.suspendEvents();cb.setValue(true);cb.resumeEvents()}};function setTypeChange(value){callTypeChange=value}function launchTypePicker(){$("typePickerLaunchAction").click()}
function item1Handler(item){var lastUiID=0;if(qbCriteriaStore.getCount()>0)lastUiID=qbCriteriaStore.getAt(qbCriteriaStore.getCount()-1).data.UiID+1;var required=false;var recs=qbCriteriaStore.query("beanID",item.internalValue);if(recs.length>0)required=recs.get(0).get("required");Ext.Ajax.request({url:getBaseHref()+"netmarkets/jsp/search/addNewQBRow.jsp",success:loadTable,params:{searchtypes:document.getElementById("searchType").value,isAdd:"true",criteria:item.internalValue,containerTypeList:getContainerTypeList(),
rownum:lastUiID,required:required,displayVal:item.text,displayUnit:item.displayUnit,dataType:item.dataType,searchCompAttrId:item.searchCompAttrId}})}
function loadTable(response,options){var responseJSON=Ext.util.JSON.decode(response.responseText);var storeRowJson=Ext.util.JSON.decode(responseJSON.storeRow);var rowElement=document.getElementById("qbtable").insertRow(-1);Element.update(rowElement,responseJSON.htmlRow);rowElement.id="qbrow"+options.params["rownum"];rowElement.onmouseover=highlightRow;rowElement.onmouseout=deHighlightRow;qbCriteriaStore.add(new qbCriteriaStore.recordType({UiID:storeRowJson.UiID,beanID:storeRowJson.beanID,required:storeRowJson.required,
displayVal:storeRowJson.displayVal,displayUnit:storeRowJson.displayUnit,dataType:storeRowJson.dataType,searchCompAttrId:storeRowJson.searchCompAttrId}));document.getElementById("criteriaJSON").value=jsonEncodeStore(qbCriteriaStore)}
function highlightRow(){this.childNodes[0].className="QBRowHighlight";this.childNodes[1].className="QBRowHighlight";this.childNodes[2].childNodes[0].className="QBRowHighlight";if(this.childNodes[2].childNodes[0].lastChild.tagName=="SPAN")this.childNodes[2].childNodes[0].lastChild.style.visibility="visible"}
function deHighlightRow(){this.childNodes[0].className="";this.childNodes[1].className="";this.childNodes[2].childNodes[0].className="";if(this.childNodes[2].childNodes[0].lastChild.tagName=="SPAN")this.childNodes[2].childNodes[0].lastChild.style.visibility="hidden"}
function deleteMyRow(rowId,uiId){var mytable=document.getElementById("qbtable");var rowElement=document.getElementById(rowId);var rowindex=rowElement.rowIndex;mytable.deleteRow(rowindex);qbCriteriaStore.removeAt(rowindex);document.getElementById("criteriaJSON").value=jsonEncodeStore(qbCriteriaStore)}var searchButton;
function renderSearchButton(buttonLabel){searchButton=Ext.getCmp("searchExt");if(searchButton!=null)searchButton.destroy();searchButton=new Ext.Button({id:"searchExt",text:buttonLabel,handler:function(button,event){submitSearchForm()}});searchButton.render("extSearchButtonDiv",0)}function disableCombo(){if(document.mainform.isGlobalSearch.checked)document.mainform.containerScope.disabled=false;else document.mainform.containerScope.disabled=true}
function searchCallBackForSuggestion(grid){grid.store.on("DSLoadingInterupted",enablePickerSearchButton);if(document.getElementsByName("pickerSearch").length>0){var pickerSearchButton=document.getElementsByName("pickerSearch")[0];pickerSearchButton.disabled=true}grid.store.on("customfeedbackavailable",handleFeedback);PTC.jca.table.Utils.getTable(grid).on("datarendered",enablePickerSearchButton)}
function enablePickerSearchButton(){if(document.getElementsByName("pickerSearch").length>0){var pickerSearchButton=document.getElementsByName("pickerSearch")[0];pickerSearchButton.disabled=false}}
function handleFeedback(feedbacks){var lblSuggestMessage=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.QUERY_SUGGESTION_MESSAGE",null,true);var suggest="";var aLink;var suggestionFound=false;for(i=0;i<feedbacks.length;i++){var feedback=feedbacks[i];if(PTC.isDefined(feedback)&&PTC.isDefined(feedback.message))if(feedback.message.indexOf("SpellSuggest:")>-1){var suggestWord=feedback.message.substr(13);suggestionFound=true;aLink="<a href='javascript:executeSuggestionQuery(\""+
escape(suggestWord)+"\")'> <I>"+suggestWord+" </I></a>";suggest=suggest+aLink+"&nbsp;"}else if(feedback.message.indexOf("ResultIncomplete:")>-1){var msg=feedback.message.substr(17);alert(msg)}else if(feedback.message.indexOf("Performance:")>-1){var performanceData=eval(feedback.message.substr(12));console.log(performanceData);PTC.search.performance.logger.processServerData(performanceData)}else if(feedback.message.indexOf(PTC.search.feedback.IndexServerDown)>-1){var msg=feedback.message.substr(PTC.search.feedback.IndexServerDown.length);
var title=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.WARN_INDEX_SERER_DOWN_FALLBACK_TO_DB_SEAR_TITLE");PTC.search.showBannerMessage(title,[msg],"WARNING")}}if(suggestionFound==true&&$("suggestionDiv")!=null)$("suggestionDiv").update(lblSuggestMessage+suggest)}Ext.namespace("PTC.search.feedback");PTC.search.feedback.IndexServerDown="IndexServerDown:";
PTC.search.showBannerMessage=function(title,messages,msgType){var msgObjects=new Array(1);msgObjects[0]={MessageTitle:title,Messages:messages,MessageType:msgType};PTC.getMainWindow().PTC.messaging.showInlineMessage(msgObjects)};PTC.search.updateMemberShipMessage=function(){var displayMsg="";var memberShipMsg=getmemberShipMessage();if(memberShipMsg!="")displayMsg="|&nbsp;&nbsp;"+memberShipMsg;$("moreMessage").update(displayMsg)};
function getmemberShipMessage(){var memberOfContainerMsg=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.PRIVATE_CONSTANT_24");var searchInUserOrgMsg=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.PRIVATE_CONSTANT_25");memberOfCheckbox=$("memberOfContainer");inOrgCheckbox=$("searchInUserOrg");var displayMsg;if(memberOfCheckbox.checked&&inOrgCheckbox.checked)displayMsg=" "+memberOfContainerMsg+"&nbsp;&nbsp;|&nbsp;&nbsp;"+searchInUserOrgMsg;
else if(memberOfCheckbox.checked)displayMsg=memberOfContainerMsg;else if(inOrgCheckbox.checked)displayMsg=searchInUserOrgMsg;else if(!(memberOfCheckbox.checked&&inOrgCheckbox.checked))displayMsg="";return displayMsg}
function showFavContextCheckBox(){var displayName=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.MY_FAVOURITE_CONTEXT_LBL");var chkItem1=new Ext.form.Checkbox({name:"myFavContext",id:"myFavContext",checked:false,boxLabel:'<img src="netmarkets/jsp/search/small_blank_value.gif">'+displayName,renderTo:"myFavContextDiv"})}PTC.search.addSearchResultsTableListeners=function(searchResultsTable){searchCallBackForSuggestion(searchResultsTable)};
PTC.search.decodeForHTMLContent=function(value){var regexps=new Array("&amp;","&lt;","&gt;","&quot;","&#38;","&nbsp;","&#039;","&#39;");var replace=new Array("&","<",">",'"',"&"," ","'","'");var reg;for(var i=0;i<regexps.length;i++){reg=new RegExp(regexps[i]);reg.compile(regexps[i],"g");value=value.replace(reg,replace[i])}return value};
function checkEmptyQuery(){var isEmptySearch=false;var isCriteriaEmpty=true;var keywordUiID="keywordField";var keywordElement=eval("getElementsById"+keywordUiID+"()");var keywordValue=keywordElement[0].value;var isEmptySearch=false;var isCriteriaEmpty=true;var context="";if(searchJSObject.isNetworkSearch||searchJSObject.isRelatedItemSearch)context="";else context=$(searchJSObject.idContainerTypeList).value;var searchType=$(searchJSObject.idSearchType).value;if(searchType==""){isEmptySearch=true;JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.EMPTY_CRITERAI_MESSAGE");
return false}if(context=="")if(searchType.toLowerCase()=="wt.fc.persistable"||searchType.indexOf(",")>-1){if(!isEmptySearch)if(!checkCriteria(keywordValue)&&isCriteriaEmpty)isCriteriaEmpty=false;if(isCriteriaEmpty){isEmptySearch=true;JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.EMPTY_CRITERAI_MESSAGE");return false}}if(!isEmptySearch)return true}
function checkCriteria(inputVar){var singleWildCard=PTC.search.singleWildCard;var whitespace=" \t\n\r*%"+singleWildCard;var i;inputVar=inputVar.replace(/(^\s+|\s+$)/g,"");if(inputVar==null||inputVar.length==0)return false;for(i=0;i<inputVar.length;i++){var c=inputVar.charAt(i);if(whitespace.indexOf(c)==-1)return false}return true}setBusyCursor=function(){try{}catch(ex){}};Ext.namespace("PTC.search.folder");Ext.apply(PTC.search.folder,new Ext.util.Observable);PTC.search.folder.folderSearch=function(table){PTC.search.folder._installSIFGuiComponents(table)};
PTC.search.folder._installSIFGuiComponents=function(table){var sif_EmptySearchText=bundleHandler.get("com.ptc.windchill.enterprise.search.client.searchClientResource.SEARCH_IN_FOLDER_PROMPT");var sifSearchStatusText=PTC.jca.table.findInTable.getFindStatusText();var sifTextFieldWidth=Math.max(Math.min(table.container.getWidth()-90,200),80);if(table.container.getWidth()===0)sifTextFieldWidth=200;var sifTextField=new Ext.form.TwinTriggerField({width:sifTextFieldWidth,emptyText:getUnescapedText(sif_EmptySearchText),
value:"",selectOnFocus:true,id:table.getId()+".sifTextField",tableName:table.getId(),table:table,enableKeyEvents:true,trigger1Class:"x-form-clear-trigger",trigger2Class:"global-search-trigger",hideTrigger1:true,cls:"invalidDrag",listeners:{render:function(){this.clearTrigger=this.getTrigger(0);this.searchTrigger=this.getTrigger(1)},specialkey:function(textField,e){PTC.search.folder.displayClearTrigger(table);var keyValue=0+e.getKey();if(keyValue==e.ESC){this.clearTrigger.hide();PTC.search.folder.clearText(table)}},
keypress:function(textField,e){var keyValue=0+e.getKey();if(keyValue==e.ENTER){e.preventDefault();textField.onTrigger2Click()}},beforeDestroy:function(){this.table=undefined;Ext.destroy(this.searchTrigger,this.clearTrigger)}},onTrigger1Click:function(){this.clearTrigger.hide();PTC.search.folder.clearText(table)},onTrigger2Click:function(event){PTC.search.folder.fireSearch(table,event)}});var sifComponents=[sifTextField];var sifInstalled=false;if(table.actionsToolBar){var toolBarItemsLen=table.actionsToolBar.items.getCount();
for(var i=0;i<toolBarItemsLen;i++)if(table.actionsToolBar.getComponent(i).isFill){PTC.search.folder.insertIntoToolbar(table,sifComponents,i);sifInstalled=true;break}}if(!sifInstalled)table.searchInFolderToolBar=new Ext.Toolbar({id:table.getId()+".searchInFolderToolBar",renderTo:table.tbar,cls:"ecaToolbar",items:["->"].concat(sifComponents)});table.sifTextField=sifTextField;table.sifSearchStatus=sifSearchStatusText};PTC.search.folder.clearText=function(table){table.sifTextField.reset();table.sifTextField.setValue("")};
PTC.search.folder.displayClearTrigger=function(table){var searchTerm=table.sifTextField.getValue();if(searchTerm==="")table.sifTextField.clearTrigger.hide();else table.sifTextField.clearTrigger.show()};PTC.search.folder.SIF_containerContext="";
PTC.search.folder.getSelected=function(table){var returnString;var folderOid=table.store.highlightContext;if(PTC.isDefined(folderOid))if(folderOid.indexOf("Cabinet")!==-1)returnString="&globalKey=context&containerRef=OR:"+PTC.search.folder.SIF_containerContext+"&contextKeyword=";else returnString="&globalKey=folder&oid="+folderOid+"&folderKeyword=";else returnString="&globalKey=context&containerRef="+PTC.search.folder.SIF_containerContext+"&contextKeyword=";return returnString};
PTC.search.folder.checkValid=function(searchTerm){var checkValidInput=false;var ajaxOptions={asynchronous:false,method:"POST",onSuccess:function(response){var jsonData=Ext.util.JSON.decode(response.responseText.trim());var message=jsonData.message;var result1=jsonData.result;checkValidInput=result1;if(!checkValidInput)alert(message)},parameters:{keyword:searchTerm}};requestHandler.doRequest("ptc1/foldersearch/validateKeyword",ajaxOptions);return checkValidInput};
PTC.search.folder.fireSearch=function(table,event){var searchTerm=table.sifTextField.getValue();var checkValid=PTC.search.folder.checkValid(searchTerm);if(checkValid){searchTerm=encodeURIComponent(searchTerm);var urlString="wtcore/jsp/com/ptc/windchill/search/Search.jsp?folderSearchTextBox=true&fireSearch=true";var additionalSearchParam=PTC.search.folder.getSelected(table);var url=urlString+"&searchType=wt.fc.Persistable"+additionalSearchParam+searchTerm;loadAdvSearchPage(event,url)}else return false};
PTC.search.folder.insertIntoToolbar=function(table,SIFComponents,index){var SIFComponentLen=SIFComponents.length;for(var compIndex=SIFComponentLen-1;compIndex>-1;compIndex--)table.actionsToolBar.insert(index+1,SIFComponents[compIndex]);table.actionsToolBar.doLayout()};PTC.search.folder.enableSifComponent=false;
Ext.ComponentMgr.onAvailable("folderbrowser_tree",function(){if(PTC.search.folder.enableSifComponent){var fbTree=Ext.getCmp("folderbrowser_tree");if(PTC.isDefined(fbTree))fbTree.on("afterRender",function(){try{var shouldRenderSearch=PTC.search.renderSearch;if(shouldRenderSearch)PTC.search.folder.folderSearch(fbTree)}catch(e){console.log(e)}})}});var searchPageInfo={};searchPageInfo.contentPane="searchInfo_centerContentPane";searchPageInfo.url=getBaseHref()+"app/#netmarkets/jsp/search/searchInfoPage.jsp";
searchPageInfo.delayedShow=new Ext.util.DelayedTask;searchPageInfo.delayedClose=new Ext.util.DelayedTask(function(){searchPageInfo.win.hide()});searchPageInfo.defaultHideDelay=-1;searchPageInfo.queueMiniInfo=function(oid,mouseEvent,delay){delay=1E3;searchPageInfo.cancelled=false;var targetObject=mouseEvent.target||mouseEvent.srcElement;searchPageInfo.delayedShow.delay(delay,searchPageInfo.show,null,[oid,targetObject,mouseEvent])};
searchPageInfo.cancelMiniInfo=function(hideDelay){if(hideDelay===undefined)searchPageInfo.defaultHideDelay=500;else if(hideDelay!==searchPageInfo.defaultHideDelay)searchPageInfo.defaultHideDelay=hideDelay;searchPageInfo.delayedShow.cancel();searchPageInfo.cancelled=true};
searchPageInfo.show=function(oid,targetObject,event){if(PTC.getMainWindow()&&PTC.getMainWindow().PTC&&PTC.getMainWindow().PTC.performance)PTC.getMainWindow().PTC.performance.startTimeGauge("SearchMiniInfoPage","Page Displayed");if(!searchPageInfo.win){searchPageInfo.win=new Ext.Window({header:false,id:"searchInfoWindow",cls:"searchInfoWindowStyle",width:400,autoHeight:true,shadow:true,shadowOffset:6,plain:true,draggable:false,closable:false,resizable:false,items:new Ext.Panel({id:"searchInfo_centerContentPanel",
html:'<div id="'+searchPageInfo.contentPane+'"></div>'})});searchPageInfo.win.on("resize",function(){searchPageInfo.win.syncShadow()},this,{delay:2});searchPageInfo.win.on("move",function(){searchPageInfo.win.syncShadow()},this,{delay:2});searchPageInfo.win.on("show",function(){searchPageInfo.win.syncShadow()},this,{delay:2})}Ext.fly(targetObject).on("mouseout",function(){searchPageInfo.delayedClose.delay(searchPageInfo.defaultHideDelay)},this,{single:true});var params="oid="+encodeURIComponent(oid);
PTC.navigation.addOpenRequest(getElementHtml(params,"searchInfo_centerContentPane",true,searchPageInfo.url,false,function(response){PTC.navigation.onSuccessRequest(response);searchPageInfo.delayedClose.cancel();if(!searchPageInfo.cancelled){searchPageInfo.win.on("show",function(){var dx=Ext.EventObject.getPageX();var dy=Ext.EventObject.getPageY();var iwHeight=0;if(window.innerHeight)iwHeight=window.innerHeight;else if(document.documentElement&&document.documentElement.clientHeight)iwHeight=document.documentElement.clientHeight;
else if(document.body)iwHeight=document.body.clientHeight;var wy=window.screenY;var foHeight=searchPageInfo.win.getHeight();var shift=0;if(iwHeight<foHeight+dy)shift=foHeight+dy-iwHeight;searchPageInfo.win.setPosition(dx+6,dy-shift)},this,{delay:100,single:true});searchPageInfo.win.show();var x=Ext.EventObject.getPageX();var y=Ext.EventObject.getPageY();searchPageInfo.win.setPosition(x+6,y);var win=Ext.fly("searchInfoWindow");win.on("mouseenter",function(){searchPageInfo.delayedClose.cancel()},this,
{single:true});win.on("mouseleave",function(){searchPageInfo.win.hide()},this,{single:true})}if(PTC.getMainWindow()&&PTC.getMainWindow().PTC&&PTC.getMainWindow().PTC.performance)PTC.performance.stopTimeGauge("SearchMiniInfoPage","Page Displayed",true,1)},function(response){jsca.error("Error with search info request for object",oid,response)}))};
function executeSuggestionQuery(suggestedQuery){var keywordUiID="keywordField";var keywordElement=eval("getElementsById"+keywordUiID+"()");keywordElement[0].value=suggestedQuery;if(typeof getMainForm().executeLocation!="undefined")getMainForm().executeLocation.value="search";fireSearch()}function fireSearch(){if(typeof validateSearch!="undefined")if(validateSearch())setFireSearchAndRefresh()}
function setFireSearchAndRefresh(){getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="search";getMainForm().fireSearch.value="true";if(typeof getMainForm().executeLocation!="undefined")getMainForm().executeLocation.value="search";PTC.search.refreshPage()}PTC.search.refreshPage=function(){PTC.navigation.submitForm()};function getAllPages(){if(!resultParams.quickSearch)return;changeTotalcount();sendSearchRequest()}
function sendSearchRequest(){var url="/"+resultParams.webappName+"/netmarkets/jsp/search/executeSearch.jsp";var params="FullSearch=true&fireSearch=true&executeLocation=search&pgNo="+Math.random();var onSuccess1=processResultsTable;new Ajax.Request(url,{method:"get",parameters:params,onSuccess:onSuccess1})}
function processResultsTable(transport){var START_TITLE_BAR="<!--START_TITLE_BAR--\>";var END_TITLE_BAR="<!--END_TITLE_BAR--\>";var START_PAGING_SECTION="<!--START_PAGING_SECTION--\>";var END_PAGING_SECTION="<!--END_PAGING_SECTION--\>";var titleDivId="table__"+resultParams.searchResultsViewId;var responseText=transport.responseText;var titleBarText=asyncResponseHandler.stripText(responseText,titleDivId,true,START_TITLE_BAR,END_TITLE_BAR);$("table__wt.fc.Persistable.defaultSearchView").innerHTML=titleBarText;
var footerDivId="paging_"+resultParams.searchResultsViewId+"_paging";var footerText=asyncResponseHandler.stripText(responseText,footerDivId,true,START_PAGING_SECTION,END_PAGING_SECTION);$("paging_wt.fc.Persistable.defaultSearchView_paging").innerHTML=footerText;resultParams.detectPaging()}function postTableRefreshHandler(tableId){try{if(typeof resultParams!=="undefined")resultParams.postTableRefreshHandler(tableId)}catch(e){}}function changeTotalcount(){$("totalRows").innerHTML="?"}
function searchSortTable(){resultParams.preSortTable();oldSortTable.apply(this,arguments)}function searchSubmitIt(){resultParams.preSubmitIt.apply(resultParams,arguments);oldSubmitIt.apply(this,arguments)}var oldSortTable;var oldSubmitIt;
function SearchResultsJSParams(){this.searchResultsViewId="";this.isSortAction=false;this.webappName="";this.quickSearch=false;this.isPagingExists=false;this.pagedListAction=false;this.initDone=false;this.pagingAction=false;this.fullListAction=false;this.currentTime=(new Date).getTime();this.detectPaging=function(){if($("table__"+this.searchResultsViewId+"_TABLE_nextButton"))this.isPagingExists=true};this.isTwoPassAction=function(){if(this.pagingAction||this.fullListAction)return false;if(!this.isPagingExists)return false;
return true};this.reset=function(){this.isSortAction=false;this.pagedListAction=false;this.pagingAction=false;this.fullListAction=false};this.preSubmitIt=function(){this.reset();var actionName=arguments[0];if("seeAll"==actionName){var i=0;var doPaging=false;while(i<arguments.length)if(arguments[i++]=="doPaging"&&arguments[i]=="true"){doPaging=true;break}this.isPagingExists=doPaging;this.pagedListAction=doPaging}else{var i=0;var pagingOffsetParam=this.searchResultsViewId+"fi";var pagingCountParam=
this.searchResultsViewId+"lmt";var pageOffset=0;var pageCount=0;var pagingAction=false;while(i<arguments.length){if(arguments[i]==pagingOffsetParam){pageOffset=arguments[i+1];pagingAction=true}else if(arguments[i]==pagingCountParam)pageCount=arguments[i+1];i++}if(pagingAction)if(pageCount>0)this.pagingAction=true;else if(pageCount=="-1")this.fullListAction=true}};this.init=function(){if(!this.quickSearch||this.initDone)return;this.detectPaging();oldSortTable=sortTable;sortTable=searchSortTable;oldSubmitIt=
submitIt;submitIt=searchSubmitIt;this.initDone=true};this.postTableRefreshHandler=function(tableId){var newTime=(new Date).getTime();if(tableId==this.searchResultsViewId&&$(this.searchResultsViewId+"_table_empty").visible())if(getMainForm().clear1.value=="false"&&getMainForm().actionMethod.value!="typeChange")if((newTime-this.currentTime)/6E4>20)JCAAlert("com.ptc.windchill.enterprise.search.client.searchClientResource.SESSION_EXPIRED_MSG");this.currentTime=newTime;if(!this.quickSearch)return;if(tableId==
this.searchResultsViewId){this.detectPaging();if(this.isTwoPassAction())getAllPages()}this.reset()};this.preSortTable=function(){this.reset();resultParams.isSortAction=true}}Ext.namespace("PTC.search.performance");Ext.apply(PTC.search.performance,new Ext.util.Observable);PTC.search.performance.addEvents("logPerformanceEvent");
PTC.search.performance.logger=function(){var loggingEnabled=false;var startTime;var serverOffset=0;var timeLineStore;var TimeLineRecord=Ext.data.Record.create([{name:"id",mapping:"id"},{name:"eventName",mapping:"eventName"},{name:"startTime",mapping:"startTime",type:"date",allowBlank:false},{name:"endTime",mapping:"endTime",type:"date",allowBlank:true},{name:"totalTime",mapping:"totalTime",allowBlank:true},{name:"offset",mapping:"offset",allowBlank:true,type:"number"},{name:"serverTime",mapping:"serverTime",
allowBlank:true}]);return{initEvents:function(){if(loggingEnabled)PTC.search.performance.on("logPerformanceEvent",PTC.search.performance.logger.recordTime)},init:function(){if(loggingEnabled)PTC.search.performance.logger.findServerOffset();timeLineStore=new Ext.data.JsonStore({autoDestroy:true,storeId:"timeLineStore",root:"timeLineData",idProperty:"eventName",fields:["eventName",{name:"startTime",type:"date"},{name:"endTime",type:"date"},"totalTime","offset","serverTime"],sortInfo:{field:"offset",
direction:"DESC"}})},findServerOffset:function(){var clientTime;var serverTime;var ajaxOptions={asynchronous:false,method:"POST",onSuccess:function(response){var rawTime=response.responseText.trim();serverTime=Date.parseDate(rawTime,"g:i:s u");serverOffset=serverTime.getElapsed(clientTime);var tmpDate=serverTime.add(Date.MILLI,serverOffset);var offset=tmpDate.getElapsed(clientTime);if(offset>0)serverOffset=serverOffset*-1}};clientTime=new Date;requestHandler.doRequest("/Windchill/netmarkets/jsp/search/getServerTime.jsp",
ajaxOptions)},fire:function(eventName,obj){if(loggingEnabled)PTC.search.performance.fireEvent(eventName,obj)},recordTime:function(obj){var eventName=obj.eventName;var existingRecord=timeLineStore.getById(eventName);if(existingRecord!=undefined&&obj.isEndEvent){existingRecord.set("endTime",new Date);existingRecord.endEdit()}else{var evtStartTime=new Date;var timeingRecord=new TimeLineRecord({id:eventName,eventName:eventName,startTime:evtStartTime},eventName);if(timeLineStore.getCount()==0)startTime=
evtStartTime;timeingRecord.set("serverTime",false);timeingRecord.endEdit();timeLineStore.addSorted(timeingRecord)}},doCalculations:function(){timeLineStore.each(function(item){var totalTime=0;if(item.get("endTime")!=undefined)totalTime=item.get("endTime").getElapsed(item.get("startTime"));item.set("totalTime",totalTime);var offset=item.get("startTime").getElapsed(startTime);item.set("offset",offset);item.endEdit()})},getTimeLineStore:function(){PTC.search.performance.logger.doCalculations();var copyStore=
new Ext.data.JsonStore({recordType:timeLineStore.recordType,sortInfo:{field:"offset",direction:"DESC"}});copyStore.addSorted(timeLineStore.getRange());copyStore.sort("offset","DESC");return copyStore},processServerData:function(serverObj){for(i=0;i<serverObj.length;i++){var origStartTime=Date.parseDate(serverObj[i].startTime,"g:i:s u");var origEndTime=Date.parseDate(serverObj[i].endTime,"g:i:s u");var adjustedStartTime;var adjustedEndTime;if(origStartTime!=undefined)adjustedStartTime=origStartTime.add(Date.MILLI,
serverOffset);if(origEndTime!=undefined)adjustedEndTime=origEndTime.add(Date.MILLI,serverOffset);var timeingRecord=new TimeLineRecord({id:serverObj[i].eventName,eventName:serverObj[i].eventName,startTime:adjustedStartTime,endTime:adjustedEndTime},serverObj[i].eventName+PTC.util.getUniqueId());if(timeLineStore.getCount()==0)startTime=timeingRecord.get("startTime");timeingRecord.set("serverTime",true);timeingRecord.endEdit();timeLineStore.addSorted(timeingRecord)}},showResults:function(){var lineChart=
new Ext.chart.LineChart({store:PTC.search.performance.logger.getTimeLineStore(),xField:"eventName",yField:"totalTime"});var grid=new Ext.grid.GridPanel({store:PTC.search.performance.logger.getTimeLineStore(),columns:[{header:"Event Name",dataIndex:"eventName",sortable:true,width:125},{header:"Start Time",width:125,dataIndex:"startTime",xtype:"datecolumn",format:"g:i:s u"},{header:"End Time",width:125,dataIndex:"endTime",xtype:"datecolumn",format:"g:i:s u"},{header:"Total Time (ms)",width:100,dataIndex:"totalTime"},
{header:"Offset",width:100,dataIndex:"offset"},{header:"Server Time",width:100,dataIndex:"serverTime"}],height:350,width:700});var stackedBarChart=new Ext.Panel({width:600,height:400,autoScroll:true,title:'Experimental time line graph. Client to server time sync: <font color="red"> <b>'+serverOffset+" (ms) <font></b>",items:{xtype:"stackedbarchart",store:PTC.search.performance.logger.getTimeLineStore(),yField:"eventName",xAxis:new Ext.chart.NumericAxis({stackingEnabled:true,title:"Time line (ms)"}),
series:[{xField:"offset",displayName:"Start Offset (Time before actual event start.)",style:{visibility:"hidden"}},{xField:"totalTime",displayName:"Total time taken (ms)",style:{color:5555569}}]}});var win1=(new Ext.Window({title:"Performance analysis data",width:750,height:400,items:[grid],autoScroll:true})).show();var win=(new Ext.Window({title:"Performance analysis time line graph",width:750,height:500,items:[stackedBarChart],autoScroll:true})).show()},enableLogging:function(logging){loggingEnabled=
logging}}}();Ext.onReady(function(){PTC.search.performance.logger.init()});try{Event.observe(window,"load",function(){try{initSelects(document)}catch(e){setTimeout("initSelects(document);",1E3);throw new Error("prototype.js needs to be included before main.js");}})}catch(e){}
function selectChanged(theElement){var theSelect;if(theElement&&theElement.value)theSelect=theElement;else theSelect=this;if(!theSelect.changed)return false;theSelect.changed=false;theSelect.initValue=theSelect.value;if(theSelect.onchangeOriginal)theSelect.onchangeOriginal.defer(1,theSelect);return true}
function selectKeyed(e){var theEvent=e?e:event;var keyCodeEnter="13";var keyCodeEsc="27";this.changed=false;if(theEvent.keyCode==keyCodeEnter&&this.value!=this.initValue){this.changed=true;selectChanged(this)}else if(theEvent.keyCode==keyCodeEsc)this.value=this.initValue;return true}function selectFocussed(){this.initValue=this.value;return true}function selectBlurred(){if(this.value!=this.initValue){this.changed=true;selectChanged(this)}}function selectClicked(){this.changed=true}
initSelects=function(parent){if(typeof isWfTrl==="function"&&isWfTrl()||Ext.isSafari)return true;var theSelects=parent.getElementsByTagName("select");if(theSelects){var alength=theSelects.length;for(var i=0;i<alength;i++){var theSelect=theSelects[i];if(theSelect.className&&theSelect.className.match("accessibleChange")&&!theSelect.alreadyInitialized){theSelect.changed=false;theSelect.initValue=theSelect.value;theSelect.onchangeOriginal=theSelect.onchange;theSelect.onchange=selectChanged;theSelect.onkeydown=
selectKeyed;theSelect.onclick=selectClicked;theSelect.onfocus=selectFocussed;theSelect.onblur=selectBlurred;theSelect.alreadyInitialized=true}}}return true};Ext.namespace("PTC.security");Ext.namespace("PTC.agreements");PTC.security.validateSelectRequired=function(evt){var sels=PTC.jca.table.Utils.getSelectedItmesByEvent(evt);var alength=sels.length;if(sels.length===0){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");Event.stop(evt);return false}return true};PTC.selenium={};
PTC.selenium.isDataRendered=PTC.automation.table.isReady;PTC.selenium.isWizardReady=PTC.automation.wizard.isReady;PTC.selenium.isNavReady=PTC.automation.nav.isReady;
function setConfigurableLinkType(type,actionName,event){var linkType=document.getElementById("configurableLinkType");if(linkType==null){var newLinkType=document.createElement("input");newLinkType.setAttribute("type","hidden");newLinkType.setAttribute("name","configurableLinkType");newLinkType.setAttribute("id","configurableLinkType");newLinkType.setValue(type);document.getElementById("mainform").appendChild(newLinkType)}else linkType.setValue(type);return onClickValidation(event,actionName)}
function doSignOut(signoutUrl){window.location=getBaseHref()+signoutUrl}jsca.columns.simpleRenderer_internal=function(table,column,row,rendererFunc,getRowFunc,getCellFunc){var result="";var data=row.get(column.id);if(!data&&typeof data!=="boolean"&&typeof data!=="number")return result;if(typeof data==="string")return data;else if(typeof data==="number"||typeof data==="boolean")return""+data;result=rendererFunc(data,table,column,row,getRowFunc,getCellFunc);return result};
jsca.columns.simpleRenderer=function(table,column,row){return jsca.columns.simpleRenderer_internal(table,column,row,multiRendererJSCA)};jsca.columns.simpleRenderer.searchFunc=function(table,column,row){var result=jsca.columns.simpleRenderer_internal(table,column,row,multiRendererJSCA.searchFunc);if(Ext.isString(result))result=getUnescapedText(result);return result};jsca.columns.simpleRenderer.groupFunc=function(table,column,row){return jsca.columns.simpleRenderer_internal(table,column,row,multiRendererJSCA.groupFunc)};
jsca.columns.simpleExportRenderer=function(table,column,row,getRowFunc,getCellFunc){return jsca.columns.simpleRenderer_internal(table,column,row,multiExportRendererJSCA,getRowFunc,getCellFunc)};
jsca.columns.spinnerFieldRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);if(data.enabled){if(typeof row.get==="function"&&row.get(column.id))row.get(column.id).updateCellValue=jsca.columns.textBoxRenderer.updateCellValue;var id=data.id?data.id:row.get("oid")+"_spinnerField";var name=data.name?data.name:id;var width=data.width&&data.width!=="auto"?data.width:10;if(data.incrementValue)data.incrementValue=parseFloat(data.incrementValue);if(data.alternateIncrementValue)data.alternateIncrementValue=
parseFloat(data.alternateIncrementValue);if(data.maxValue)data.maxValue=parseFloat(data.maxValue);if(data.minValue)data.minValue=parseFloat(data.minValue);result="<input id='"+id+"' name='"+name+"' size="+width+"></input>";var extFieldStr=Ext.util.JSON.encode(data);var script="<script>jsca.columns.renderSpinnerField('"+id+"', "+extFieldStr+");<\/script>";var oldSpinnerComp=Ext.getCmp(data.id);if(oldSpinnerComp)oldSpinnerComp.destroy();PTC.jca.table.Utils.evalCellContent(table,script)}return result};
jsca.columns.renderSpinnerField=function(id,extField){if($(id)&&extField){extField.applyTo=id;extField.validator=jsca.columns.spinnerFieldValidator;extField.validationDelay=750;var oldSpinnerComp=Ext.getCmp(extField.id);if(!oldSpinnerComp)Ext.ComponentMgr.create(extField)}};jsca.columns.spinnerFieldValidator=function(value){if(value!==""){value=parseFloat(value);if(isNaN(value)&&this.minValue>=0)this.setValue("");else if(value>this.maxValue)this.setValue(this.maxValue);else if(value<this.minValue)this.setValue(this.minValue)}return true};
Ext.ns("Ext.ux.form");
Ext.ux.form.SpinnerField=Ext.extend(Ext.form.NumberField,{actionMode:"wrap",deferHeight:true,autoSize:Ext.emptyFn,onBlur:Ext.emptyFn,adjustSize:Ext.BoxComponent.prototype.adjustSize,constructor:function(config){var spinnerConfig=Ext.copyTo({},config,"incrementValue,alternateIncrementValue,accelerate,defaultValue,triggerClass,splitterClass");this.spinner=new Ext.ux.Spinner(spinnerConfig);var spl=this.spinner;var plugins=config.plugins?Ext.isArray(config.plugins)?config.plugins.push(spl):[config.plugins,
spl]:spl;Ext.ux.form.SpinnerField.superclass.constructor.call(this,Ext.apply(config,{plugins:plugins}))},getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},alignErrorIcon:function(){if(this.wrap)this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])},validateBlur:function(){return true}});Ext.reg("spinnerfield",Ext.ux.form.SpinnerField);Ext.form.SpinnerField=Ext.ux.form.SpinnerField;
Ext.ux.Spinner=Ext.extend(Ext.util.Observable,{incrementValue:1,alternateIncrementValue:5,triggerClass:"x-form-spinner-trigger",splitterClass:"x-form-spinner-splitter",alternateKey:Ext.EventObject.shiftKey,defaultValue:0,accelerate:false,constructor:function(config){Ext.ux.Spinner.superclass.constructor.call(this,config);Ext.apply(this,config);this.mimicing=false},init:function(field){this.field=field;field.afterMethod("onRender",this.doRender,this);field.afterMethod("onEnable",this.doEnable,this);
field.afterMethod("onDisable",this.doDisable,this);field.afterMethod("afterRender",this.doAfterRender,this);field.afterMethod("onResize",this.doResize,this);field.afterMethod("onFocus",this.doFocus,this);field.beforeMethod("onDestroy",this.doDestroy,this)},doRender:function(ct,position){this.el=this.field.getEl();var el=this.el;var f=this.field;if(!f.wrap)f.wrap=this.wrap=el.wrap({cls:"x-form-field-wrap"});else this.wrap=f.wrap.addClass("x-form-field-wrap");this.trigger=this.wrap.createChild({tag:"img",
src:Ext.BLANK_IMAGE_URL,cls:"x-form-trigger "+this.triggerClass});if(!f.width)this.wrap.setWidth(el.getWidth()+this.trigger.getWidth());this.splitter=this.wrap.createChild({tag:"div",cls:this.splitterClass,style:"width:13px; height:2px;"});this.splitter.setRight(Ext.isIE?1:2).setTop(10).show();this.proxy=this.trigger.createProxy("",this.splitter,true);this.proxy.addClass("x-form-spinner-proxy");this.proxy.setStyle("left","0px");this.proxy.setSize(14,1);this.proxy.hide();this.dd=new Ext.dd.DDProxy(this.splitter.dom.id,
"SpinnerDrag",{dragElId:this.proxy.id});this.initTrigger();this.initSpinner()},doAfterRender:function(){var y;if(Ext.isIE&&this.el.getY()!=(y=this.trigger.getY())){this.el.position();this.el.setY(y)}},doEnable:function(){if(this.wrap)this.wrap.removeClass(this.field.disabledClass)},doDisable:function(){if(this.wrap){this.wrap.addClass(this.field.disabledClass);this.el.removeClass(this.field.disabledClass)}},doResize:function(w,h){if(typeof w=="number")this.el.setWidth(this.field.adjustWidth("input",
w-this.trigger.getWidth()));this.wrap.setWidth(this.el.getWidth()+this.trigger.getWidth())},doFocus:function(){if(!this.mimicing){this.wrap.addClass("x-trigger-wrap-focus");this.mimicing=true;Ext.get(Ext.isIE?document.body:document).on("mousedown",this.mimicBlur,this,{delay:10});this.el.on("keydown",this.checkTab,this)}},checkTab:function(e){if(e.getKey()==e.TAB)this.triggerBlur()},mimicBlur:function(e){if(!this.wrap.contains(e.target)&&this.field.validateBlur(e))this.triggerBlur()},triggerBlur:function(){this.mimicing=
false;Ext.get(Ext.isIE?document.body:document).un("mousedown",this.mimicBlur,this);this.el.un("keydown",this.checkTab,this);this.field.beforeBlur();this.wrap.removeClass("x-trigger-wrap-focus");this.field.onBlur.call(this.field)},initTrigger:function(){this.trigger.addClassOnOver("x-form-trigger-over");this.trigger.addClassOnClick("x-form-trigger-click")},initSpinner:function(){this.field.addEvents({spin:true,spinup:true,spindown:true});this.keyNav=new Ext.KeyNav(this.el,{up:function(e){e.preventDefault();
this.onSpinUp()},down:function(e){e.preventDefault();this.onSpinDown()},pageUp:function(e){e.preventDefault();this.onSpinUpAlternate()},pageDown:function(e){e.preventDefault();this.onSpinDownAlternate()},scope:this});this.repeater=new Ext.util.ClickRepeater(this.trigger,{accelerate:this.accelerate});this.field.mon(this.repeater,"click",this.onTriggerClick,this,{preventDefault:true});this.field.mon(this.trigger,{mouseover:this.onMouseOver,mouseout:this.onMouseOut,mousemove:this.onMouseMove,mousedown:this.onMouseDown,
mouseup:this.onMouseUp,scope:this,preventDefault:true});this.field.mon(this.wrap,"mousewheel",this.handleMouseWheel,this);this.dd.setXConstraint(0,0,10);this.dd.setYConstraint(1500,1500,10);this.dd.endDrag=this.endDrag.createDelegate(this);this.dd.startDrag=this.startDrag.createDelegate(this);this.dd.onDrag=this.onDrag.createDelegate(this)},onMouseOver:function(){if(this.disabled)return;var middle=this.getMiddle();this.tmpHoverClass=Ext.EventObject.getPageY()<middle?"x-form-spinner-overup":"x-form-spinner-overdown";
this.trigger.addClass(this.tmpHoverClass)},onMouseOut:function(){this.trigger.removeClass(this.tmpHoverClass)},onMouseMove:function(){if(this.disabled)return;var middle=this.getMiddle();if(Ext.EventObject.getPageY()>middle&&this.tmpHoverClass=="x-form-spinner-overup"||Ext.EventObject.getPageY()<middle&&this.tmpHoverClass=="x-form-spinner-overdown");},onMouseDown:function(){if(this.disabled)return;var middle=this.getMiddle();this.tmpClickClass=Ext.EventObject.getPageY()<middle?"x-form-spinner-clickup":
"x-form-spinner-clickdown";this.trigger.addClass(this.tmpClickClass)},onMouseUp:function(){this.trigger.removeClass(this.tmpClickClass)},onTriggerClick:function(){if(this.disabled||this.el.dom.readOnly)return;var middle=this.getMiddle();var ud=Ext.EventObject.getPageY()<middle?"Up":"Down";this["onSpin"+ud]()},getMiddle:function(){var t=this.trigger.getTop();var h=this.trigger.getHeight();var middle=t+h/2;return middle},isSpinnable:function(){if(this.disabled||this.el.dom.readOnly){Ext.EventObject.preventDefault();
return false}return true},handleMouseWheel:function(e){if(!this.wrap.hasClass("x-trigger-wrap-focus"))return;var delta=e.getWheelDelta();if(delta>0){this.onSpinUp();e.stopEvent()}else if(delta<0){this.onSpinDown();e.stopEvent()}},startDrag:function(){this.proxy.show();this._previousY=Ext.fly(this.dd.getDragEl()).getTop()},endDrag:function(){this.proxy.hide()},onDrag:function(){if(this.disabled)return;var y=Ext.fly(this.dd.getDragEl()).getTop();var ud="";if(this._previousY>y)ud="Up";if(this._previousY<
y)ud="Down";if(ud)this["onSpin"+ud]();this._previousY=y},onSpinUp:function(){if(!this.isSpinnable())return;if(Ext.EventObject.shiftKey){this.onSpinUpAlternate();return}else this.spin(false,false);this.field.fireEvent("spin",this);this.field.fireEvent("spinup",this)},onSpinDown:function(){if(!this.isSpinnable())return;if(Ext.EventObject.shiftKey){this.onSpinDownAlternate();return}else this.spin(true,false);this.field.fireEvent("spin",this);this.field.fireEvent("spindown",this)},onSpinUpAlternate:function(){if(!this.isSpinnable())return;
this.spin(false,true);this.field.fireEvent("spin",this);this.field.fireEvent("spinup",this)},onSpinDownAlternate:function(){if(!this.isSpinnable())return;this.spin(true,true);this.field.fireEvent("spin",this);this.field.fireEvent("spindown",this)},spin:function(down,alternate){var v=parseFloat(this.field.getValue());var incr=alternate===true?this.alternateIncrementValue:this.incrementValue;if(down)v-=incr;else v+=incr;v=isNaN(v)?this.defaultValue:v;v=this.fixBoundries(v);this.field.setRawValue(v)},
fixBoundries:function(value){var v=value;if((this.field.minValue||this.field.minValue===0)&&v<this.field.minValue)v=this.field.minValue;if((this.field.maxValue||this.field.minValue===0)&&v>this.field.maxValue)v=this.field.maxValue;return this.fixPrecision(v)},fixPrecision:function(value){var nan=isNaN(value);if(!this.field.allowDecimals||this.field.decimalPrecision==-1||nan||!value)return nan?"":value;return parseFloat(parseFloat(value).toFixed(this.field.decimalPrecision))},doDestroy:function(){if(this.trigger)this.trigger.remove();
if(this.wrap){this.wrap.remove();delete this.field.wrap}if(this.splitter)this.splitter.remove();if(this.dd){this.dd.unreg();this.dd=null}if(this.proxy)this.proxy.remove();if(this.repeater)this.repeater.purgeListeners()}});Ext.form.Spinner=Ext.ux.Spinner;
PTC.jca.SpinnerField=Ext.extend(Ext.ux.form.SpinnerField,{showValidateMsg:false,constructor:function(config){PTC.jca.SpinnerField.superclass.constructor.call(this,config)},initComponent:function(){PTC.jca.SpinnerField.superclass.initComponent.apply(this,arguments);this.on("afterrender",this.onAfterRender)},onAfterRender:function(v){this.wrap.dom.style.width="auto"},markInvalid:function(msg){if(this.showValidateMsg)return Ext.form.NumberField.superclass.markInvalid.call(this,msg);return true},setRawValue:function(v){PTC.jca.SpinnerField.superclass.setRawValue.call(this,
v);var input=Ext.getDom(this.id);if(is_ie)input.fireEvent("onkeyup");else{var evtObj=document.createEvent("HTMLEvents");evtObj.initEvent("keyup",true,true);input.dispatchEvent(evtObj)}}});Ext.reg("ptcspinnerfield",PTC.jca.SpinnerField);Ext.ns("PTC.folderBrowser");Ext.ns("PTC.folderBrowser.tableIds");Ext.ns("PTC.folderBrowser.callbacks");PTC.folderBrowser.table=null;PTC.folderBrowser.tree=null;PTC.folderBrowser._agreementsCabinet="_agreementsCabinet";PTC.folderBrowser._highlightStyle="x-grid3-row-selected";
PTC.folderBrowser._isAgreementFolder=false;PTC.folderBrowser._isTreeRendered=false;PTC.folderBrowser._lastFolderAccessed={};PTC.folderBrowser._processDelay=300;PTC.folderBrowser._folderCache=function(){var fCache=new Ext.util.MixedCollection;return{getAncsestors:function(){return fCache.first()},addToCache:function(oid,ancesstors){fCache.clear();fCache.add(oid,ancesstors)},appendCache:function(oid,children){if(!fCache.get(oid))fCache.add(oid,[]);fCache.get(oid).concat(children)}}}();
PTC.folderBrowser.handleListFiles=function(href){if(!href)return true;var isAgreementFolder=href.indexOf("/listAgreements?")>0?true:false,originalHref=href;var oid=PTC.folderBrowser.getCorrectOid(href);var isContainer=PTC.util.isAContainer(oid);if(href&&(href.indexOf("/listFiles?")>0||href.indexOf("/list.jsp?")>0||isAgreementFolder&&isContainer)){if(isContainer){if(isAgreementFolder)oid+=PTC.folderBrowser._agreementsCabinet;var lastFolderAccessedHref=PTC.folderBrowser.getLastFolderAccessed(oid);if(lastFolderAccessedHref)href=
lastFolderAccessedHref}if(isAgreementFolder)PTC.navigation.initiateRequest(originalHref.substring(0,originalHref.indexOf("?"))+href.substring(href.indexOf("?")));else PTC.folderBrowser.goTo(href.substring(href.indexOf("?")));return false}return true};PTC.folderBrowser.getLastFolderAccessed=function(containerOid){if(containerOid){containerOid=decodeURIComponent(containerOid);return PTC.folderBrowser._lastFolderAccessed[containerOid]}return null};
function remapFolderLinks(evt){return PTC.folderBrowser.remapLinks(evt,PTC.folderBrowser.isFolderBrowserPageContext)}function remapAgreementFolderLinks(evt,renderInPaneFunc){PTC.folderBrowser._isAgreementFolder=true;return PTC.folderBrowser.remapLinks(evt,PTC.folderBrowser.isFolderBrowserPageContext,renderInPaneFunc)}
PTC.folderBrowser.goTo=function(queryString){var leftPaneQueryStr="ptc1/comp/folderbrowser_tree"+queryString;var leftPaneSize=25;var rightPaneSize=75;PTC.navigation.loadTwoPanes(leftPaneQueryStr,"ptc1/comp/folderbrowser_table"+queryString,remapFolderLinks,"horizontal",{left:leftPaneSize,right:rightPaneSize,header:25},"ptc1/comp/folderbrowser_details"+queryString);var tp=Ext.getCmp("contentPanel_twoPanes_horizontal");if(tp)tp.on("deactivate",PTC.folderBrowser.clearLastContainer);PTC.search.folder.enableSifComponent=
true};PTC.folderBrowser.clearLastContainer=function(){PTC.folderBrowser._lastContainer=null};PTC.folderBrowser.isFolderBrowserPageContext=function(oidString){var context=/folder\.SubFolder|pdmlink\.PDMLinkProduct|admin\.Project|library\.WTLibrary|container\.OrgContainer|folder\.Cabinet/;return PTC.util.oidStringMatches(oidString,context)};
PTC.folderBrowser.remapLinks=function(evt,showInRightPane){evt=evt?evt:event;var target=evt.target?evt.target:evt.srcElement;var href=getParentNodeByTag(target,"A").href;if(!PTC.folderBrowser.doRemap(href,showInRightPane))return true;PTC.folderBrowser.loadNewFolder(href);if(PTC.folderBrowser._isAgreementFolder){href=combineURL(href,"agreementCabinet=true");PTC.folderBrowser._isAgreementFolder=false}var oid=extractParamValue(href,"oid");oid=decodeURIComponent(oid);var fb=PTC.folderBrowser;var fbStore=
fb.tree?fb.tree.getStore():null;var navNode=tableUtils.getTableRowFromOid(fb.tableIds.tree,oid);if(fbStore&&fb._isTreeRendered===true&&(!navNode||!fbStore.isVisibleNode(navNode))){fbStore.on("handlecanceltreeds",PTC.folderBrowser.setPostCancelHandlerInfo);var contextOid=fb.table?fb.table.getStore().baseParams.oid[0]:oid;var contextRecord=tableUtils.getTableRowFromOid(fb.tableIds.tree,contextOid);if(!contextRecord||!fbStore.isVisibleNode(contextRecord)){var parents=PTC.folderBrowser._folderCache.getAncsestors();
for(var i=0,j=parents.length;i<j;i++)if(fbStore.isVisibleNode(parents[i])){contextRecord=parents[i];contextRecord.ux_maximgb_tg_loaded=false;break}}if(contextRecord===undefined){var ele=Ext.select("."+PTC.folderBrowser._highlightStyle,true,PTC.folderBrowser.tree.getEl().dom);if(ele&&ele.elements[0]){var index=ele.elements[0].dom.rowIndex;contextRecord=PTC.folderBrowser.tree.getStore().getAt(index)}}if(contextRecord){PTC.jca.expandNode(contextRecord,fbStore);var subfolders=contextRecord.store.data.keys;
for(i=0;i<subfolders.length;i++){var found=subfolders[i].indexOf(oid)>-1;if(found)break}}if(!found)return true}jsca.unSelectAll();PTC.folderBrowser.dynamicUpdateRightPaneAndDetails(href);Event.stop(evt);return false};PTC.folderBrowser.doRemap=function(href,showInRightPane){var doTheRemap=false;if(href){var pVal=extractParamValue(href,"FB.showInfoPage");var showInfoPage=pVal&&pVal=="true";doTheRemap=!showInfoPage&&href.indexOf("tcomp/infoPage")>0&&href.indexOf(PTC.jslint.SCRIPT_URL_STRING)<0&&showInRightPane(href)}return doTheRemap};
PTC.folderBrowser.loadNewFolder=function(url){var containerOid,oid=PTC.folderBrowser.getCorrectOid(url);if(PTC.util.isAContainer(oid)){containerOid=oid;if(PTC.folderBrowser._isAgreementFolder)containerOid+=PTC.folderBrowser._agreementsCabinet;var lastFolderAccessedHref=PTC.folderBrowser.getLastFolderAccessed(containerOid);if(lastFolderAccessedHref)if(lastFolderAccessedHref.indexOf(getBaseHref())<0)url=url.substring(0,url.indexOf("?"))+lastFolderAccessedHref;else url=lastFolderAccessedHref}else{containerOid=
PTC.folderBrowser.getContainerOid(url);if(PTC.folderBrowser._isAgreementFolder)containerOid+=PTC.folderBrowser._agreementsCabinet}if(containerOid){var queryString=url;var index=queryString.indexOf("#");if(index>0)queryString=queryString.substring(index);index=queryString.indexOf("?");if(index>0)queryString=queryString.substring(index);containerOid=decodeURIComponent(containerOid);if(PTC.folderBrowser._lastContainer&&containerOid.match(/folder\.SubFolder|folder\.Cabinet/))PTC.folderBrowser.setLastFolderAccessed(PTC.folderBrowser._lastContainer,
queryString);else{PTC.folderBrowser._lastContainer=containerOid;PTC.folderBrowser.setLastFolderAccessed(containerOid,queryString)}}setNewFolder(url)};PTC.folderBrowser.getContainerOid=function(url){var oid=extractParamValue(url,"ContainerOid");if(!oid&&PTC.folderBrowser.table&&PTC.folderBrowser.table.store){oid=PTC.folderBrowser.table.store.baseParams.ContainerOid;if(!oid)oid=PTC.folderBrowser.table.store.baseParams.oid;if(Ext.isArray(oid))oid=oid[0]}return oid};
PTC.folderBrowser.setLastFolderAccessed=function(containerOid,queryString){if(containerOid)PTC.folderBrowser._lastFolderAccessed[containerOid]=queryString;return null};
PTC.folderBrowser.dynamicUpdateRightPaneAndDetails=function(href){var qs=href.substring(href.indexOf("?"));var url=PTC.navigation.getRightPaneUrl();url=url.substring(0,url.indexOf("?"));var hurl=PTC.navigation.getHeaderPaneUrl();if(hurl){hurl=hurl.substring(0,hurl.indexOf("?"));PTC.navigation.loadHeaderPane(hurl+qs,true)}PTC.navigation.tempFunc=function(url){if(href.indexOf(url)>=0){PTC.navigation.removeListener("historyChange",PTC.navigation.tempFunc);return false}};PTC.navigation.on("historyChange",
PTC.navigation.tempFunc);PTC.navigation.loadContent(href);PTC.navigation.loadRightPane(url+qs,false)};
PTC.folderBrowser.onAvailable=function(table){table.onAfterAction=table.onAfterAction.wrap(function(original,formResult){var clonedFormResult=new PTC.action.FormResult(JCAClone(formResult));PTC.folderBrowser.processDynamicRefreshInfoForTable(clonedFormResult);var result;if(formResult.getAddedCabinetCount()>1||formResult.extraData&&formResult.extraData.refreshTableToExposeNewLatest){PTC.jca.table.Utils.reload(this);result=true}else result=original.call(this,clonedFormResult)&&!formResult.hasAnyOids();
formResult.afterActionHandled=clonedFormResult.afterActionHandled;return result})};
PTC.folderBrowser.processDynamicRefreshInfoForTable=function(dynamicRefreshInfo){var i=0;var fb=PTC.folderBrowser;var tableId=dynamicRefreshInfo.tableID;if(fb.table&&!(tableId===undefined||tableId===null)&&tableId===fb.table.id){var tableOid=fb.table.getStore().baseParams.oid[0];var isContainer=PTC.util.isAContainer(tableOid);fb.table.filteredRows=[];var filterTableRefreshInfo=function(oids,dynamicRefreshInfo,oidcategory){var keysToRemove=[];i=oids.length;while(i--){var key=oids[i];if(key.indexOf("folder.SubFolder")>
0||key.indexOf("folder.Cabinet")>0)if(tableOid.indexOf(key)==-1)if(isContainer===false||key.indexOf("folder.Cabinet")<0)keysToRemove.push(key)}for(i=0;i<keysToRemove.length;i++)delete oidcategory[keysToRemove[i]]};filterTableRefreshInfo(dynamicRefreshInfo.getLocations(),dynamicRefreshInfo,dynamicRefreshInfo.A)}};
PTC.folderBrowser.onAvailableTree=function(tree){tree.onObjectsAffected=tree.onObjectsAffected.wrap(function(original,formResult){var result=original.call(tree,formResult);PTC.folderBrowser.handleNewFolders(formResult);return result})};
PTC.folderBrowser.handleNewFolders=function(frConfig){var oidsToAdd=[];var locations=[];PTC.util.propertyIterator(frConfig.A,this,PTC.folderBrowser._isFolderFilterIterator,[oidsToAdd,locations]);locations=locations.uniq();if(oidsToAdd.length>0)if(locations.length===1)PTC.folderBrowser.addInTree(oidsToAdd,locations[0]);else;return true};
PTC.folderBrowser._isFolderFilterIterator=function(property,value,oidsToAdd,locations){value=PTC.util.extractAllValues(value);var i=value.length;while(i--)if(PTC.util.isAFolder(value[i])){oidsToAdd.push(value[i]);locations.push(property)}};
PTC.folderBrowser.addInTree=function(params,containerOid){var fb=PTC.folderBrowser;if(fb.table===null||fb.tree===null)return;if(Object===undefined||Object===null||Ext.isString===undefined||Ext.isString===null||Ext.isArray===undefined||Ext.isArray===null)return;if(!Ext.isString(containerOid))return;var oids=[];if(Ext.isArray(params)){for(var i=0;i<params.length;i++){var param=params[i];if(Ext.isString(param))oids.push(param)}if(oids.length!==params.length)return}else if(Ext.isString(params))oids.push(params);
else return;var isTreeAddNeeded=fb.tree!==null&&fb._isTreeRendered===true;if(isTreeAddNeeded){fb=PTC.folderBrowser;var fbTreeStore=fb.tree.getStore();var containerOidIndex=fbTreeStore.findExact("oid",containerOid);var isContainerChildrenLoaded=false;if(containerOidIndex>-1){var containerRecord=fbTreeStore.getAt(containerOidIndex);isContainerChildrenLoaded=fbTreeStore.isLoadedNode(containerRecord)}var folders=[];oids.each(function(oid){if(PTC.util.isAFolder(oid))folders.push(oid)});var modifyRowsInTree=
function(folders){rowHandler.addRows(folders,fb.tree.id,null,{doAjaxUpdate:false,parentOid:containerOid,addSorted:true});if(containerRecord)PTC.jca.tree.forceServerSideExpand(containerRecord,fb.tree,false)};if(folders.length>0&&isContainerChildrenLoaded)modifyRowsInTree(folders);else{var modifyRowsInTreeWrap=modifyRowsInTree.wrap(function(parentMethod,folders){if(fbTreeStore.isLoading!==undefined&&Ext.isFunction(fbTreeStore.isLoading)&&!fbTreeStore.isLoading())return parentMethod.call(parentMethod,
folders);else{var modifyRowsInTreeWrapDelegate=modifyRowsInTreeWrap.createDelegate(this,[folders],0);fb.tree.getView().on("refresh",modifyRowsInTreeWrapDelegate,this,{buffer:fb._processDelay,single:true})}});var modifyRowsInTreeWrapDelegate=modifyRowsInTreeWrap.createDelegate(this,[folders],0);fb.tree.getView().on("refresh",modifyRowsInTreeWrapDelegate,this,{buffer:fb._processDelay,single:true});if(containerRecord)PTC.jca.expandNode(containerRecord,fbTreeStore)}}};
PTC.folderBrowser.hideTree=function(){var leftPane=Ext.getCmp(PTC.navigation.contentTabID+"_twoPanes_left");var cp=Ext.getCmp(PTC.navigation.cardManager);if(leftPane){leftPane.hide();cp.layout.paneSizes={left:0,right:100,header:25}}cp.doLayout(false,true)};PTC.folderBrowser.showTree=function(){var leftPane=Ext.getCmp(PTC.navigation.contentTabID+"_twoPanes_left");var cp=Ext.getCmp(PTC.navigation.cardManager);if(leftPane&&!leftPane.isVisible())leftPane.show();cp.doLayout(false,true)};
PTC.folderBrowser.setPostCancelHandlerInfo=function(store){if(PTC.folderBrowser.tree&&PTC.folderBrowser.tree.id===store.jscaTableID){var oidToExpand={};var fb=PTC.folderBrowser;if(!store.postCancelHandlerInfo)store.postCancelHandlerInfo={};if(fb.table)store.postCancelHandlerInfo.oid=fb.table.getStore().baseParams.oid[0]}};
PTC.folderBrowser.callbacks.beforeRenderTable=function(table){var fb=PTC.folderBrowser;fb.table=table;var wTableId=PTC.jca.table.getWTablePanelID(table.id);var wTable=Ext.getCmp(wTableId);if(wTable)wTable.updateData=wTable.updateData.wrap(function(proceed,data){if(Ext.isArray(this.gridPanel.filteredRows)){var validRows=[];for(var ir=0;ir<data.rows.length;ir++)if(this.gridPanel.filteredRows.indexOf(data.rows[ir].oid)===-1)validRows.push(data.rows[ir]);data.rows=validRows}if(data.rows.length>0)return proceed.call(this,
data);return});var afterDestroy=function(){fb.table=null};fb.table.on("destroy",afterDestroy);if(fb._isTreeRendered===true)fb.callbacks.onRenderTree()};
PTC.folderBrowser.callbacks.onRenderTree=function(){var fb=PTC.folderBrowser;fb._isTreeRendered=true;if(fb.table!==null){var contextOid=fb.table.getStore().baseParams.oid[0];var separator=contextOid.indexOf("~");if(separator>0)contextOid=contextOid.substring(0,separator);fb.contextFocusNode(fb.tree,contextOid,PTC.folderBrowser._highlightStyle);fb.tree.on("sortchange",PTC.folderBrowser.setTreeFocusAfterSort)}};
PTC.folderBrowser.contextFocusNode=function(tree,param,highlightStyle){var store=tree.getStore();var view=tree.getView();view.getRowClass=function(record,index,rowParams,store){if(!(store===undefined||store===null)){var oid=record.get("oid");if(!(oid===undefined||oid===null)&&store.highlightContext===oid)return highlightStyle}};var oid;if(!Ext.isString(param))return;else oid=param;var index=store.findExact("oid",oid);var kludgeResult=PTC.folderBrowser._kludge(index,oid);index=kludgeResult.index;oid=
kludgeResult.oid;var isRenderedRow=false;if(index>-1){var row=view.getRow(index);isRenderedRow=!(row===undefined||row===null);if(store.highlightContext!==undefined&&store.highlightContext!==null)var oldIndex=store.findExact("oid",store.highlightContext);store.highlightContext=oid}if(isRenderedRow){var record=store.getAt(index);store.expandToNode(record);view.focusRowCenter(record);PTC.folderBrowser._folderCache.addToCache(oid,store.getNodeAncestors(record));if(!store.isExpandedNode(record))PTC.folderBrowser._folderCache.appendCache(oid,
PTC.folderBrowser.table.getStore().data.items);if(!(oldIndex===null||oldIndex===undefined))view.refreshRow(oldIndex);view.refreshRow(index)}else if(store.isLoading===undefined||Ext.isFunction(store.isLoading)&&store.isLoading()||index>-1&&!isRenderedRow||index===-1){var contextFocusNodeDelegate=PTC.folderBrowser.contextFocusNode.createDelegate(this,[tree,param,highlightStyle],0);view.on("refresh",contextFocusNodeDelegate,this,{buffer:PTC.folderBrowser._processDelay,single:true})}else;};
PTC.folderBrowser._kludge=function(index,oid){if(PTC.folderBrowser.table&&PTC.folderBrowser.tree){var tableStore=PTC.folderBrowser.table.getStore();var treeStore=PTC.folderBrowser.tree.getStore();if(index===-1&&tableStore.baseParams.ContainerOid===undefined&&treeStore.baseParams.ContainerOid===undefined&&treeStore&&treeStore.isLoading!==undefined&&treeStore&&Ext.isFunction(treeStore.isLoading)&&!treeStore.isLoading()){var contextOid=treeStore.baseParams.oid[0];if(oid===contextOid){index=0;if(treeStore.getAt(0)===
undefined)index=-1;else oid=treeStore.getAt(0).get("oid")}}}return{oid:oid,index:index}};
PTC.folderBrowser.setTreeFocusAfterSort=function(){var fb=PTC.folderBrowser;var view=fb.tree.getView();var store=fb.tree.getStore();if(!PTC.isDefined(store.highlightContext))return;var oldIndex=Ext.select("."+PTC.folderBrowser._highlightStyle,true,fb.tree.getEl().dom).elements[0].dom.rowIndex;if(oldIndex>-1)Ext.fly(view.getRow(oldIndex)).removeClass(PTC.folderBrowser._highlightStyle);var newIndex=store.findExact("oid",store.highlightContext);if(newIndex>-1)Ext.fly(view.getRow(newIndex)).addClass(PTC.folderBrowser._highlightStyle)};
PTC.folderBrowser.callbacks.beforeRenderTree=function(tree){var fb=PTC.folderBrowser;fb.tree=tree;var afterDestroy=function(){fb._isTreeRendered=false;fb.tree=null};fb.tree.on("render",fb.callbacks.onRenderTree);fb.tree.on("destroy",afterDestroy);PTC.folderBrowser.loadNewFolder(window.location.href);var treeStore=fb.tree.getStore();treeStore.on("handlecanceltreeds",PTC.folderBrowser.setPostCancelHandlerInfo);treeStore.getNotRemovedIDs=function(store){var index=Ext.select("."+PTC.folderBrowser._highlightStyle,
true,fb.tree.getEl().dom).elements[0].dom.rowIndex;var retainElements=[];retainElements.push(store.getAt(index));return retainElements}};PTC.navigation.on("historychange",PTC.folderBrowser.handleListFiles);Ext.ComponentMgr.onAvailable("folderbrowser_PDM",PTC.folderBrowser.onAvailable);Ext.ComponentMgr.onAvailable("folderbrowser_PJL",PTC.folderBrowser.onAvailable);Ext.ComponentMgr.onAvailable("folderbrowser_Program",PTC.folderBrowser.onAvailable);
Ext.ComponentMgr.onAvailable("folderbrowser_OrgSite",PTC.folderBrowser.onAvailable);Ext.ComponentMgr.onAvailable("folderbrowser_tree",PTC.folderBrowser.onAvailableTree);PTC.action.FormResult.prototype.getAddedCabinetCount=function(){var locations=this.getAddedLocations();var count=0;for(var i=0;i<locations.size();i++)if(locations[i].indexOf("Cabinet")>=0)count++;return count};
PTC.folderBrowser.getCorrectOid=function(url){var oid=getOidFromURL(url);var oidCabinet=jsca.isCabinetOid(oid);if(oidCabinet===true&&url.indexOf("folderNavigatorParameter")!==-1)oid=PTC.folderBrowser.getContainerOid(url);return oid};if(!PTC.cat)PTC.cat={};
PTC.cat.StructureComponentLauncher={appNames:{},appNameByIdOfDivToMatch:{},getGWTTab:function(tabPanel){if(!tabPanel||!tabPanel.items)return undefined;var i=tabPanel.items.items.length;while(i--){var tab=tabPanel.items.items[i];if(tab.id&&tab.id.endsWith("StructureGWT"))return tab}return undefined},launch:function(appName,iframeId,iframeJSPRelativeURL,idOfDivToMatch,containerOid,organizationOid){PTC.cat.StructureComponentLauncher.appNames[appName]=iframeId;PTC.cat.StructureComponentLauncher.appNameByIdOfDivToMatch[idOfDivToMatch]=
appName;if(!PTC.cat.StructureComponentLauncher[appName]||PTC.cat.StructureComponentLauncher[appName+"LastLoadedOrg"]!=organizationOid){if(PTC.cat.StructureComponentLauncher[appName])PTC.cat.StructureComponentLauncher.removeIframe(appName,iframeId);PTC.cat.StructureComponentLauncher[appName+"LastLoadedOrg"]=organizationOid;PTC.cat.StructureComponentLauncher.loadSC(appName,iframeId,iframeJSPRelativeURL,idOfDivToMatch)}else{if(!PTC||!PTC.infoPage||!PTC.infoPage["scConfigLoadComplete"+appName]){PTC.cat.StructureComponentLauncher.refreshPage(idOfDivToMatch,
iframeId);return}try{checkAndLoadSC(appName,containerOid)}catch(err){PTC.cat.StructureComponentLauncher.refreshPage(idOfDivToMatch,iframeId);return}}PTC.cat.StructureComponentLauncher.bringToFront(appName,iframeId,iframeJSPRelativeURL,idOfDivToMatch)},refreshPage:function(idOfDivToMatch,iframeId){var ifrm=document.getElementById(iframeId);if(!ifrm)return;var message="Last structure was not completely loaded, the page will be refreshed momentarily.";try{message=ifrm.contentWindow["PTC_GWTBUNDLE_com_ptc_cat_gxt_client_GXTMessages"]["KSTRUCTURE_PAGE_REFRESHING"]}catch(err){}var elementOfDivToMatch=
document.getElementById(idOfDivToMatch);if(elementOfDivToMatch&&elementOfDivToMatch.firstChild){while(elementOfDivToMatch.firstChild)elementOfDivToMatch.removeChild(elementOfDivToMatch.firstChild);var blockingDiv=document.createElement("div");blockingDiv.style.width="100%";blockingDiv.style.height="100%";blockingDiv.style.textAlign="center";blockingDiv.innerHTML="<BR><BR><BR><BR><BR><BR><BR><BR>"+message;elementOfDivToMatch.appendChild(blockingDiv);setInterval(function(){location.reload()},3E3);return}},
bringToFront:function(appName,iframeId,iframeJSPRelativeURL,idOfDivToMatch){if(PTC.cat.StructureComponentLauncher[appName]){var scIFrame=document.getElementById(iframeId);if(scIFrame){scIFrame.style.display="block";scIFrame.style.visibility="visible"}var element_of_content_div=Ext.getCmp(idOfDivToMatch);if(!PTC.cat.StructureComponentLauncher[idOfDivToMatch])PTC.cat.StructureComponentLauncher[idOfDivToMatch]=function(component,adjWidth,adjHeight,rawWidth,rawHeight){scIFrame.setAttribute("width",adjWidth+
"px");scIFrame.setAttribute("height",adjHeight+"px");var position=component.getPosition();scIFrame.style.left=position[0]+"px";scIFrame.style.top=position[1]+"px"};else element_of_content_div.un("resize",PTC.cat.StructureComponentLauncher[idOfDivToMatch]);element_of_content_div.on("resize",PTC.cat.StructureComponentLauncher[idOfDivToMatch]);if(element_of_content_div.isVisible()&&element_of_content_div.getWidth()>0){scIFrame.setAttribute("width",element_of_content_div.getWidth()+"px");scIFrame.setAttribute("height",
element_of_content_div.getHeight()+"px");var position=element_of_content_div.getPosition();scIFrame.style.left=position[0]+"px";scIFrame.style.top=position[1]+"px"}if(PTC.cat.StructureComponentLauncher["restart"+appName])PTC.cat.StructureComponentLauncher["restart"+appName]()}},sendToBack:function(clear){for(appName in PTC.cat.StructureComponentLauncher.appNames){if(PTC.cat.StructureComponentLauncher.appNames[appName]){var scIFrame=document.getElementById(PTC.cat.StructureComponentLauncher.appNames[appName]);
if(scIFrame){if(Ext.isChrome)scIFrame.style.display="none";scIFrame.style.visibility="hidden"}}if(clear&&PTC.cat.StructureComponentLauncher["clear"+appName])PTC.cat.StructureComponentLauncher["clear"+appName]()}},loadSC:function(appName,iframeId,iframeJSPRelativeURL,idOfDivToMatch,containerOid,OrganizationOid){ifrm=document.createElement("IFRAME");ifrm.setAttribute("id",iframeId);var element_of_content_div=Ext.getCmp(idOfDivToMatch);ifrm.setAttribute("width",element_of_content_div.getWidth()+"px");
ifrm.setAttribute("height",element_of_content_div.getHeight()+"px");ifrm.setAttribute("marginwidth","0");ifrm.setAttribute("marginheight","0");ifrm.setAttribute("hspace","0");ifrm.setAttribute("vspace","0");ifrm.setAttribute("frameborder","0");ifrm.setAttribute("scrolling","no");ifrm.style.position="absolute";var position=element_of_content_div.getPosition();ifrm.style.left=position[0]+"px";ifrm.style.top=position[1]+"px";var main_base_element=document.getElementById("basehref");document.body.appendChild(ifrm);
var iframe_document=ifrm.document;if(!iframe_document)iframe_document=ifrm.contentDocument;var base_element=iframe_document.createElement("base");base_element.id="basehref";base_element.href=main_base_element.href;iframe_document.getElementsByTagName("head")[0].appendChild(base_element);var ifrm_base_element=iframe_document.getElementById("basehref");var split_url=window.location.href.split("?");if(split_url.length==3)split_url[1]=split_url[1]+"?"+split_url[2];var debug_portion="";var amp="";var jsDebugFlag=
extractParamValue(window.location.href,"jsDebug");if(jsDebugFlag&&!(jsDebugFlag=="")){debug_portion="jsDebug="+jsDebugFlag;amp="&"}var gwt_codesvr=extractParamValue(window.location.href,"gwt.codesvr");if(gwt_codesvr&&!(gwt_codesvr==""))debug_portion=debug_portion+amp+"gwt.codesvr="+gwt_codesvr;if(debug_portion&&!(debug_portion==""))debug_portion="?"+debug_portion;ifrm.setAttribute("src",iframeJSPRelativeURL+debug_portion);PTC.cat.StructureComponentLauncher[appName]=true},removeIframe:function(appName,
iframeId){PTC.navigation.fireEvent("removeIframe",parent.document);try{var iframeEl=document.getElementById(iframeId);var iframeWin=iframeEl.contentWindow;if(iframeWin&&iframeWin.PTC)iframeWin.PTC.navigation.removeIframes.call(iframeWin,iframeWin.document,true,true);if(iframeWin&&iframeWin.document)PTC.util.purge(iframeWin.document);iframeEl.src=""}catch(e){PTC.log.error("removeDuplicateIframe() Error occurred while removing iframe:",e)}Ext.removeNode(iframeEl)},removeApp:function(appName,iframeId,
idOfDivToMatch){delete PTC.cat.StructureComponentLauncher[appName];var scIFrame=document.getElementById(iframeId);scIFrame.id="hiddenMSRFrame";PTC.navigation.removeIframes(scIFrame,false,false);scIFrame.style.visibility="hidden"}};
PTC.infoPage.on("afterRender",function(){var tabSwitchListener=function(tabpanel,newTab,old){if(newTab&&newTab.id.indexOf("GWT")>0){if(newTab.id!="infoPage_myTab_msr_modelStructureGWT"||!PTC.cat.StructureComponentLauncher.isESR){var appName=PTC.cat.StructureComponentLauncher.appNameByIdOfDivToMatch[newTab.id];var iframe=PTC.cat.StructureComponentLauncher.appNames[appName]}if(!PTC||!PTC.infoPage||!PTC.infoPage["scConfigLoadComplete"+appName]){PTC.cat.StructureComponentLauncher.refreshPage(newTab.id,
iframe);return}PTC.cat.StructureComponentLauncher.bringToFront(appName,iframe,null,newTab.id)}else PTC.cat.StructureComponentLauncher.sendToBack(false)};var tabPanel=PTC.infoPage.getTabPanel();if(tabPanel){var gwtTab=PTC.cat.StructureComponentLauncher.getGWTTab(tabPanel);if(gwtTab)gwtTab.on("afterAction",function(formResult){var oldReload=gwtTab._reloadContents;gwtTab._reloadContents=function(){gwtTab._reloadContents=oldReload};formResult.hasInfoPageBeenProcessed=true;return!formResult.hasAnyOids()});
tabPanel.on("beforetabchange",tabSwitchListener)}tabPanel=Ext.getCmp("newEPMDocObjectUtilityinfoPanelID");if(tabPanel)tabPanel.on("beforetabchange",tabSwitchListener)});PTC.navigation.on("afterLoadContent",function(){PTC.cat.StructureComponentLauncher.sendToBack(true)});var checkAndLoadSCIntervalID=null;
var checkAndLoadSC=function(appName,containerOid){var newContainer="";if(PTC.cat.StructureComponentLauncher[appName+"LastLoadedContainer"]!=containerOid)newContainer=containerOid;PTC.cat.StructureComponentLauncher[appName+"LastLoadedContainer"]=containerOid;if(typeof PTC.cat.StructureComponentLauncher["launch"+appName]=="function"){if(checkAndLoadSCIntervalID!=null)clearInterval(checkAndLoadSCIntervalID);PTC.cat.StructureComponentLauncher["launch"+appName](newContainer)}else if(checkAndLoadSCIntervalID==
null)checkAndLoadSCIntervalID=setInterval(checkAndLoadSC,500)};if(!PTC.cat)PTC.cat={};
PTC.cat.StructureComponentTestHarness={runStatements:function(statementsJSONArray){PTC.cat.StructureComponentTestHarness.statementArray=JSON.parse(statementsJSONArray);PTC.cat.StructureComponentTestHarness.statementIndex=-1;PTC.cat.StructureComponentTestHarness.runningStatements=true;PTC.cat.StructureComponentTestHarness.runNextStatement()},runNextStatement:function(){PTC.cat.StructureComponentTestHarness.statementIndex++;if(PTC.cat.StructureComponentTestHarness.statementIndex<PTC.cat.StructureComponentTestHarness.statementArray.length){eval(PTC.cat.StructureComponentTestHarness.statementArray[PTC.cat.StructureComponentTestHarness.statementIndex]);
var intervalId=null;function earlyCompleteCheck(){clearInterval(intervalId);PTC.cat.callbackToTestHarnessIfNecessary()}intervalId=setInterval(earlyCompleteCheck,1)}else{PTC.cat.StructureComponentTestHarness.runningStatements=false;PTC.cat.StructureComponentTestHarness.failedTestStatement=false;PTC.cat.StructureComponentTestHarness.failureMessage=false;PTC.cat.StructureComponentTestHarness.statementArray=false}},onSuccess:function(){if(PTC.cat.StructureComponentTestHarness.runningStatements)PTC.cat.StructureComponentTestHarness.runNextStatement()},
onFailure:function(failureMessage){if(!PTC.cat.StructureComponentTestHarness.failureExpected){PTC.cat.StructureComponentTestHarness.failedTest=true;PTC.cat.StructureComponentTestHarness.runningStatements=false;if(PTC.cat.StructureComponentTestHarness.statementArray!=false)PTC.cat.StructureComponentTestHarness.failedTestStatement=PTC.cat.StructureComponentTestHarness.statementArray[PTC.cat.StructureComponentTestHarness.statementIndex];PTC.cat.StructureComponentTestHarness.statementArray=false}PTC.cat.StructureComponentTestHarness.failureMessage=
failureMessage},getRunningStatements:function(){return PTC.cat.StructureComponentTestHarness.runningStatements},getFailedTestStatement:function(){return PTC.cat.StructureComponentTestHarness.failedTestStatement},getFailedTest:function(){return PTC.cat.StructureComponentTestHarness.failedTest},hasStructureLoadCompeleted:function(){return window.parent.PTC.cat.StructureComponentTestHarness.scStartComplete&&window.parent.PTC.cat.StructureComponentTestHarness.scStarted},getFailureMessage:function(){return PTC.cat.StructureComponentTestHarness.failureMessage},
testResults:function(){var testFailedOn=PTC.cat.StructureComponentTestHarness.failedTestStatement;var testFailInformation=PTC.cat.StructureComponentTestHarness.failureMessage;if(testFailedOn==false&&testFailInformation==false)alert("Test Passed");else alert("The current test failed on test statement: "+testFailedOn+"\n"+testFailInformation);PTC.cat.StructureComponentTestHarness.failedTestStatement=false;PTC.cat.StructureComponentTestHarness.failureMessage=false},setDebugger:function(statement,failureMessage){PTC.cat.StructureComponentTestHarness.failedTestStatement=
statement;PTC.cat.StructureComponentTestHarness.failureMessage=failureMessage},debugInformation:function(){var testFailedOn=PTC.cat.StructureComponentTestHarness.failedTestStatement;var testFailInformation=PTC.cat.StructureComponentTestHarness.failureMessage;if(testFailedOn==false&&testFailInformation==false)alert("***DEBUGGER***\nDebug Test Passed!");else alert("***DEBUGGER***\nSTATEMENET: "+testFailedOn+"\nFailure Message: "+testFailInformation);PTC.cat.StructureComponentTestHarness.failedTestStatement=
false;PTC.cat.StructureComponentTestHarness.failureMessage=false},setFailureExpected:function(){PTC.cat.StructureComponentTestHarness.failureExpected=true},clearFailureExpected:function(){PTC.cat.StructureComponentTestHarness.failureExpected=false;PTC.cat.StructureComponentTestHarness.failureMessage=false},failureExpected:false,failedTest:false,failedTestStatement:false,failureMessage:false,statementArray:false,runningStatements:false,scStartComplete:false,scStarted:false};Ext.namespace("PTC.subscription");
function getNextColumn(newRowHTML){var TH_TAG="<th";var TD_TAG="<td";var TH_END_TAG="</th>";var TD_END_TAG="</td>";var CLASS_FLAG='class="';var NOWRAP="NOWRAP";var SCOPE='scope="';var newColumn=[];newColumn.className="";newColumn.noWrap=false;newColumn.scope="";newColumn.innerHTML="";newColumn.remainingHTML=newRowHTML;var tempHTML=newColumn.remainingHTML.toLowerCase();var indexth=tempHTML.indexOf(TH_TAG);var indextd=tempHTML.indexOf(TD_TAG);if(indexth<0)indexth=1E4;if(indextd<0)indextd=1E4;if(indexth<=
indextd)indextd=indexth;var indextdend=newColumn.remainingHTML.indexOf(">");var innerTag=newColumn.remainingHTML.substring(indextd+1,indextdend);var attrIndex=innerTag.indexOf(NOWRAP);if(attrIndex>=0)newColumn.noWrap=true;var endIndex;attrIndex=innerTag.indexOf(CLASS_FLAG);if(attrIndex>=0){attrIndex=attrIndex+CLASS_FLAG.length;endIndex=innerTag.indexOf('"',attrIndex);newColumn.className=innerTag.substring(attrIndex,endIndex)}attrIndex=innerTag.indexOf(SCOPE);if(attrIndex>=0){attrIndex=attrIndex+SCOPE.length;
endIndex=innerTag.indexOf('"',attrIndex);newColumn.scope=innerTag.substring(attrIndex,endIndex)}newColumn.remainingHTML=newColumn.remainingHTML.substring(indextd);newColumn.remainingHTML=newColumn.remainingHTML.substring(newColumn.remainingHTML.indexOf(">")+1);tempHTML=newColumn.remainingHTML.toLowerCase();indexth=tempHTML.indexOf(TH_END_TAG);indextd=tempHTML.indexOf(TD_END_TAG);if(indexth<0)indexth=1E4;if(indextd<0)indextd=1E4;if(indexth<=indextd&&indexth!=1E4)indextd=indexth;newColumn.innerHTML=
newColumn.remainingHTML.substring(0,indextd);newColumn.remainingHTML=newColumn.remainingHTML.substring(indextd+TD_END_TAG.length);return newColumn}
insertNewRowHTMLForIE=function(newNode,newRowHTML){var hasMore=true;var childIndex=0;while(hasMore){var newColumn=getNextColumn(newRowHTML);newRowHTML=newColumn.remainingHTML;if(!newRowHTML||newRowHTML.length<5)hasMore=false;if(newColumn.innerHTML){var newEle=document.createElement("td");newEle.className=newColumn.className;newEle.noWrap=newColumn.noWrap;newEle.scope=newColumn.scope;newNode.appendChild(newEle);newEle.innerHTML=newColumn.innerHTML}}return newNode};
PTC.jca.table.SessionProvider=function(){this.provider=new PTC.jca.state.ClientStateProvider({domstorage:"session"})};PTC.jca.table.SessionProvider.instance=null;PTC.jca.table.SessionProvider.getInstance=function(){if(!PTC.jca.table.SessionProvider.instance)PTC.jca.table.SessionProvider.instance=new PTC.jca.table.SessionProvider;return PTC.jca.table.SessionProvider.instance};PTC.jca.table.SessionProvider.prototype.get=function(uniqueKey){return this.provider.get(uniqueKey,"")};
PTC.jca.table.SessionProvider.prototype.set=function(uniqueKey,object){this.provider.set(uniqueKey,object)};PTC.jca.table.SessionProvider.prototype.clear=function(uniqueKey){this.provider.clear(uniqueKey)};PTC.jca.table.setObjectToSession=function(tableId,elementName,object){var provider=PTC.jca.table.SessionProvider.getInstance();var uniqueKey=PTC.jca.table.findInTable.findUniqueKey(tableId,elementName);provider.set(uniqueKey,object)};
PTC.jca.table.getObjectFromSession=function(tableId,elementName){var provider=PTC.jca.table.SessionProvider.getInstance();var uniqueKey=PTC.jca.table.findInTable.findUniqueKey(tableId,elementName);return provider.get(uniqueKey)};PTC.jca.table.clearObjectFromSession=function(tableId,elementName){var provider=PTC.jca.table.SessionProvider.getInstance();var uniqueKey=PTC.jca.table.findInTable.findUniqueKey(tableId,elementName);provider.clear(uniqueKey)};PTC.jca.table.log=log4javascript.getLogger("PTC.jca.table");
function unSelectAll(sels){jsca.unSelectAll(sels,null)}function getJCASelectedTableItems(tableID,isChecked){return PTC.jca.table.Utils.getTableSelectedRowsById(tableID,isChecked)}
function getSelectedItems(isChecked,useTables){var soid=[];var sels;var i;var l;if(useTables!==false){var allTables=PTC.jca.table.Utils.getTables();for(i=0,l=allTables.length;i<l;i++){sels=getJCASelectedTableItems(allTables[i].id,isChecked);for(var index=0,len=sels.length;index<len;++index)soid.push(sels[index])}}else{sels=document.getElementsByTagName("input");var j=0;if(sels){var alength=sels.length;for(i=0;i<alength;i++)if(sels[i].checked&&sels[i].name.indexOf("pjl_sel")>=0&&sels[i].name!="selectAll"&&
sels[i].value!="select_all"&&sels[i].name!="checkbox3"&&!sels.disabled)soid[j++]=sels[i]}}return soid}function isSomethingChecked(tableID){var sels=null;if(tableID)sels=getJCASelectedTableItems(tableID,true);else sels=getSelectedItems(true);if(sels){var alength=sels.length;for(var i=0;i<alength;i++)if(typeof sels[i].checked==="undefined"||sels[i].checked&&sels[i].name.indexOf("pjl_sel")>=0)return true}return false}
PTC.jca.table.Utils=function(){var TABLE_ROW_CLASS="JCA_tablerow";var TABLE_PREFIX="table__";var TABLE_SUFFIX="_TABLE";var INITIAL_ROWS_PREFIX="initialRows_";var ADDED_ROWS_PREFIX="addRows_";var REMOVED_ROWS_PREFIX="rmRows_";var selectedTreeNode=null;var PULLDOWN_SUFFIX="filterSelect";var MENU_SUFFIX="-hctx";function getElements(rowClass,parent){return getElementsByClassNameAndTag(rowClass,parent,"input")}function getTableRow(table,attValue,attValue2){if(typeof table==="string")table=this.getTable(table);
if(!table||!table.store)return null;var matchIndex=table.store.findBy(function(item){return item.data.jsca_context===attValue||item.data.oid===attValue||item.data.oid===attValue2});return table.store.getAt(matchIndex)}return{_getTableRow:getTableRow,cachedIsTrail:null,getTableRows:function(tableId){if(typeof tableId!=="string"&&tableId.id)tableId=tableId.id;var table=PTC.jca.table.Utils.getTable(tableId);return this.getRowData(table)},getCachedSelectedTreeNode:function(){return selectedTreeNode},
setCachedSelectedTreeNode:function(obj){selectedTreeNode=obj},isJSCA:function(tableId){return false},isForceTrail:function(){if(this.cachedIsTrail!==null)return this.cachedIsTrail;if(typeof getWindow().location.href.parseQuery().forceTrail!=="undefined"){this.cachedIsTrail=true;return true}if(PTC.trail.isTrailEnabled()){this.cachedIsTrail=true;return true}this.cachedIsTrail=false;return false},fixStrForTrail:function(id){if(typeof id==="string")return id.replace(/[\|\.~]/g,"_");return id},convertIdWhenTrailEnabled:function(id){if(this.isForceTrail())return this.fixStrForTrail(id);
return id},getTableRowsByID:function(tableID,getOnlyVisible){var parent=this.getTable(tableID);var rows=this.getRowData(parent);return rows},getTreeRows:function(parent){alert("getTreeRows deprecated")},getTableRowFromContext:function(tableid,context){return this._getTableRow(tableid,context,getRowContext,function(a){return a})},getTableRowFromOid:function(tableid,or_oid,vr_oid){return this._getTableRow(tableid,or_oid,vr_oid)},setRowClassFunction:function(tableId,getRowClassFunction,refreshNeeded){var gridId=
this.getUnformattedTableId(tableId);var grid=Ext.ComponentMgr.get(gridId);if(grid){grid.getView().getRowClass=grid.getView().getRowClass.wrap(function(proceed,rec,idx,rowParams,store){var result=proceed.call(this,rec,idx,rowParams,store);var thisResult=getRowClassFunction.call(this,rec,idx,rowParams,store);if(result)return result+" "+thisResult;return thisResult});if(refreshNeeded===undefined||refreshNeeded)grid.getView().refresh();grid=null}},addRowStyle:function(tableid,context,style){PTC.jca.table.log.info("addRowStyle deprecated and replaced by setRowClassFunction")},
removeRowStyle:function(tableid,row,style){PTC.jca.table.log.info("removeRowStyle deprecated and replaced by setRowClassFunction")},findTableID:function(evt){var result;var node;evt=evt?evt:event;if(evt.jcacontainer)return evt.jcacontainer.id;node=evt.srcElement||evt.target;result=this.findParentTableNodeId(node);if(!result&&window.MENU_PARENT_ID&&Ext.getDom(window.MENU_PARENT_ID))result=this.findParentTableNodeId(Ext.getDom(window.MENU_PARENT_ID));if(!result){var contextString=getCurrentActionContextString();
var row=this.getTableRowFromContext(null,contextString);if(row)if(row.parentTableID)result=row.parentTableID;else result=this.findParentTableNodeId(row)}return result},findParentTableNodeId:function(node){var result;if(node){if(node.parentTableID)return node.parentTableID;while(node){var nodeID=node.id;if(nodeID&&typeof nodeID==="string"){var startIdx=nodeID.indexOf(TABLE_PREFIX);if(startIdx!=-1){startIdx+=TABLE_PREFIX.length;var endIdx=nodeID.lastIndexOf(TABLE_SUFFIX);if(endIdx==-1)endIdx=nodeID.length;
result=nodeID.substring(startIdx,endIdx);break}}node=node.parentNode}}return result},findRecord:function(evt,table){var record;evt=evt?evt:event;var node=evt.srcElement||evt.target;var row=this._findTableRow(node);table=table||this.getTable(this.findTableID(evt));if(table&&Ext.isString(table))table=this.getTable(table);if(row&&table)record=table.getStore().getAt(row.rowIndex);return record},_findTableRow:function(node){var result;while(node){var el=Ext.get(node);if(el&&el.hasClass("x-grid3-row")){result=
node;break}node=node.parentNode}return result},getInitialRows:function(tableID){return Ext.getDom(INITIAL_ROWS_PREFIX+tableID)},getAddedRows:function(tableID){return Ext.getDom(ADDED_ROWS_PREFIX+tableID)},getRemovedRows:function(tableID){return Ext.getDom(REMOVED_ROWS_PREFIX+tableID)},getParentTR:function(node){return getParentNodeByTag(node,"TR")},removeParentRow:function(oid,node,tableID,skipTableUpdates,isDeleteOpt,contextMap){this.removeRow(tableID,oid)},removeAll:function(tableId){var table=
PTC.jca.table.Utils.getTable(tableId);if(table)table.getStore().removeAll();var addRows=document.getElementById(ADDED_ROWS_PREFIX+tableId);if(addRows)addRows.value="";var rmRows=document.getElementById(REMOVED_ROWS_PREFIX+tableId);if(rmRows)rmRows.value="";initialRows=document.getElementById(INITIAL_ROWS_PREFIX+tableId);if(initialRows)initialRows.value=""},isTableCheckBox:function(node){return node.className.match(new RegExp("(^|\\s)"+TABLE_ROW_CLASS+"(\\s|$)"))},deSelectOtherTableRows:function(tableID,
isActionsMenu){var tables=this.getTables();tableID=this.getUnformattedTableId(tableID);for(var i=0,l=tables.length;i<l;i++){var item=tables[i];if(isActionsMenu||item.id!==tableID){var clearAllButton=Ext.getCmp(item.id+"_clearacrosspg");if(clearAllButton&&!clearAllButton.disabled)clearAllButton.fireEvent("click",clearAllButton);else item.getSelectionModel().clearSelections()}}},toggleDisabledSelectedRows:function(tableID,disable){var tables=this.getTables();tableID=this.getUnformattedTableId(tableID);
tables.each(function(item){if(item.id!==tableID){var selectionModel=item.getSelectionModel();if(disable)selectionModel.lock();else if(selectionModel.isLocked())selectionModel.unlock();var selectedItems=null;if(item.getSelectionModel()&&typeof item.getSelectionModel().getSelections=="function")selectedItems=item.getSelectionModel().getSelections();if(selectedItems){var selectedRows=PTC.jca.table.Utils.getTableSelectedRowsById(item.id,false,true);for(var i=0,l=selectedRows.length;i<l;i++)selectedRows[i].disabled=
disable;for(i=0,l=selectedItems.length;i<l;i++){selectedItems[i].disabled=disable;var domObject=Ext.fly(selectedItems[i].id);if(domObject)domObject.disabled=disable}}}})},getMenuSuffix:function(){return MENU_SUFFIX},getComponentIDForMenu:function(menuId){var mID=menuId;if(menuId.indexOf(MENU_SUFFIX)!=-1){endIdx=mID.indexOf(MENU_SUFFIX);mID=mID.substring(0,endIdx)}return mID},getUnformattedTableId:function(tableID){if(!tableID)return tableID;var tID=tableID;var startIdx;var endIdx;if(tableID.indexOf(TABLE_PREFIX)!=
-1){startIdx=tableID.indexOf(TABLE_PREFIX);startIdx+=TABLE_PREFIX.length;tID=tableID.substring(startIdx,tableID.length)}if(tableID.indexOf(TABLE_SUFFIX)!=-1){endIdx=tID.indexOf(TABLE_SUFFIX);tID=tID.substring(0,endIdx)}return tID},getTableIdFromViewPullDown:function(unFormattedTableId){if(!unFormattedTableId)return unFormattedTableId;var tID=unFormattedTableId;var endIdx;if(unFormattedTableId.indexOf(PULLDOWN_SUFFIX)!=-1){endIdx=tID.indexOf(PULLDOWN_SUFFIX);tID=tID.substring(0,endIdx)}return tID},
getTableViewComboBox:function(tableID){return Ext.getCmp(tableID+PULLDOWN_SUFFIX)},getFormattedTableId:function(tableID){if(!tableID)return tableID;var tID=tableID;if(tableID.indexOf(TABLE_PREFIX)==-1)tID=TABLE_PREFIX+tID;if(tableID.indexOf(TABLE_SUFFIX)==-1)tID=tID+TABLE_SUFFIX;return tID},updateFooterCount:function(){},updateHeader:function(){},retainSelection:function(tableId){var tableDesc=this.getTable(tableId);if(tableDesc)tableDesc.retainSelection=true;return true},selectRow:function(table,
row,selectValue){var index=-1;if(typeof table==="string")table=this.getTable(table);if(typeof row==="string")row=this._getTableRow(table,row);if(selectValue)table.getSelectionModel().selectRecords([row],true);else{index=table.store.indexOfId(row.id);if(index>-1)table.getSelectionModel().deselectRow(index)}},focusRow:function(grid,rowIndex,isSelected,noCacheUpdate){var view=grid.getView();if(!view.removefocusedRowClasses)return;var prevFocusRowIndex=PTC.jca.table.Utils.getFocusedRowIndex(grid);if(typeof prevFocusRowIndex!==
"undefined"&&prevFocusRowIndex>-1)view.removefocusedRowClasses(prevFocusRowIndex);view.removefocusedRowClasses(rowIndex);view.addRowClass(rowIndex,view.focusedRowClass);if(isSelected)view.addRowClass(rowIndex,view.focusedRowCheckerClass);var record=grid.getStore().getAt(rowIndex);if(noCacheUpdate!==true&&record){grid.scrollIndex=PTC.jca.table.Utils.getRowUniqueIdentifier(record.id,record.data.oid);PTC.jca.table.stickiness.setFocusRow(grid.id,grid.scrollIndex);var visibleRowCount=view.getVisibleRowCount();
if(view._visible_answer){var OFFSET=PTC.jca.table.stickiness.getBufferViewOffset();var scrollPos=view._visible_answer.last-rowIndex-OFFSET;if(rowIndex-view._visible_answer.first<OFFSET)scrollPos=scrollPos-OFFSET;if(scrollPos>0&&scrollPos<=visibleRowCount)PTC.jca.table.stickiness.setFocusOffset(grid.id,scrollPos);else PTC.jca.table.stickiness.setFocusOffset(grid.id,null)}}},getFocusedRecord:function(grid){var focusedRowIndex=PTC.jca.table.Utils.getFocusedRowIndex(grid);if(focusedRowIndex>-1)return grid.getStore().getAt(focusedRowIndex)},
getFocusedRowIndex:function(grid){if(grid&&grid.scrollIndex)return PTC.jca.table.Utils.getRowByUniqueIdentifier(grid.getStore(),grid.scrollIndex);return-1},scrollToFocusRow:function(grid,rowIndex){if(!grid)return;if(rowIndex===undefined)rowIndex=PTC.jca.table.Utils.getFocusedRowIndex(grid);if(rowIndex>-1&&grid.store.getCount()>0){var offset=PTC.jca.table.stickiness.getFocusOffset(grid.id);var scrollTo=offset?rowIndex+offset:rowIndex;var indexTo=scrollTo>0&&scrollTo<grid.store.getCount()?scrollTo:
rowIndex;if(grid.tree)grid.getView().ensureVisibleTree(indexTo,0,false);else grid.getView().ensureVisible(indexTo,0,false)}},unfocusRow:function(grid,noCacheUpdate){var focusedRowIndex=PTC.jca.table.Utils.getFocusedRowIndex(grid);if(focusedRowIndex>-1){if(noCacheUpdate!==true){grid.scrollIndex=null;PTC.jca.table.stickiness.clearFocusRow(grid.id)}grid.getView().removefocusedRowClasses(focusedRowIndex);PTC.jca.table.stickiness.clearFocusOffset(grid.id)}},getRowUniqueIdentifier:function(rowId,recordOid){var result=
rowId;if(recordOid&&recordOid.indexOf("$")>0){if(rowId)result=PTC.jca.table.Utils.parseRowIdentifierWithDoller(rowId)}else if(rowId){var idx=rowId.lastIndexOf("$");if(idx>-1)result=rowId.substring(idx+1)}return result},getRecordByUniqueIdentifier:function(store,uniqueString){var recordIndex=PTC.jca.table.Utils.getRowByUniqueIdentifier(store,uniqueString);if(recordIndex>-1)return store.getAt(recordIndex)},getRowByUniqueIdentifier:function(store,uniqueString){if(store&&uniqueString)return store.findBy(function(record,
id){var rowOid=record.data.oid;var rowContext=PTC.jca.table.Utils.getRowUniqueIdentifier(record.data.jsca_context,rowOid);if(uniqueString===record.id||uniqueString===rowContext||uniqueString===rowOid)return true;return false})},applyColumnLock:function(gridPanel,sticky){var cm=gridPanel.getColumnModel();var lockedColumnIndex=-1;if(sticky===true){var lockedColumnId=PTC.jca.table.stickiness.getLockedColumnId(gridPanel.id);if(PTC.isDefined(lockedColumnId))lockedColumnIndex=cm.getIndexById(lockedColumnId)}else{var jcaTableConfig=
gridPanel.jcaTableConfig;var lockColIndex=jcaTableConfig.LockColIndex;if(lockColIndex>0&&!jcaTableConfig.tree&&typeof gridPanel.getView().processColumnLock==="function")lockedColumnIndex=gridPanel.jcaTableConfig.selectable?lockColIndex:lockColIndex-1;else lockedColumnIndex=-1}if(lockedColumnIndex>-1){if(lockedColumnIndex>-1&&cm.isLocked(lockedColumnIndex))return;var llen=cm.getLockedCount();gridPanel.getView().processColumnLock(lockedColumnIndex,cm,llen)}},scrollToChangedTable:function(table){if(!table.container||
!table.container.contentAreaPanel)return;if(!PTC.jca.table.scroll.SCROLL_TO_OFFSET)return;var storedXYScroll=PTC.jca.table.scroll.SCROLL_TO_OFFSET;var contentAreaPanel=Ext.getCmp(table.container.contentAreaPanel.id);var currentXYScroll=contentAreaPanel.body.getScroll();if(currentXYScroll.top-storedXYScroll.top!==0)contentAreaPanel.body.scroll("bottom",storedXYScroll.top-currentXYScroll.top);PTC.jca.table.scroll.SCROLL_TO_OFFSET=""},getFilteredOutTableRows:function(store){if(!store.isFiltered())return[];
var allData=store.snapshot;var storeData=store.data;var filteredOutRows=allData.filterBy(function(value){return!storeData.contains(value)});return filteredOutRows.items},wrapContent:function(grid,colIndex){var cm=grid.getColumnModel();cm.addEvents("afterWrap");var view=grid.getView();if(cm.getColumnAt(colIndex).isWrapped){cm.getColumnAt(colIndex).isWrapped=false;if(view._variableRowHeightCache!==undefined)view.variableRowHeight=view._variableRowHeightCache}else{cm.getColumnAt(colIndex).isWrapped=
true;view._variableRowHeightCache=view.variableRowHeight;view.variableRowHeight=true}view.refresh();cm.fireEvent("afterWrap");PTC.jca.table.scroll.updateTableSize.defer(50,PTC.jca.table.scroll,[grid.id])}}}();var tableUtils=PTC.jca.table.Utils;
function removeSelectedRows(tableID){var soids=getJCASelectedTableItems(tableID);if(!soids||soids.length===0)JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");else{var alength=soids.length;for(var i=0;i<alength;i++){var value=getOidFromRowValue(soids[i].value);PTC.jca.table.Utils.removeParentRow(value,soids[i],tableID,true)}}}
PTC.jca.table.Utils.getTableSelectedRowsById=function(jcaTableId,isChecked,addDisabled){var jscaRows=[];var tableId=this.getUnformattedTableId(jcaTableId);var selectedRowsDiv=getWindow().document.getElementById("checkboxesFor_"+tableId);if(selectedRowsDiv){var count=0;var selectedNodes=selectedRowsDiv.childNodes;for(var i=0,k=selectedNodes.length;i<k;i++){var selected=selectedNodes[i];if(selected.checked&&(!selected.disabled||addDisabled)){jscaRows[count++]=selected;if(isChecked)return jscaRows}}}return jscaRows};
PTC.jca.table.Utils.getSelectedItmesByEvent=function(evt){var tableId=PTC.jca.table.Utils.findTableID(evt);return getJCASelectedTableItems(tableId)};PTC.jca.table.Utils.getTableSelectedRowsCountById=function(jcaTableId){var jscaRows=this.getTableSelectedRowsById(jcaTableId);var rowCount=jscaRows.length;return rowCount};PTC.jca.table.Utils.getTables=function(){return this.getExtTables()};
PTC.jca.table.Utils.isComponentVisible=function(store){var compId=store.jscaTableID;var isComponentVisble=false;isComponentVisble=tableUtils.isComponentPresentOnActiveTab(compId);if(isComponentVisble===null)isComponentVisble=true;if(isWizardWindow())isComponentVisble=tableUtils.isComponentPresentOnWizard(compId);return isComponentVisble};
PTC.jca.table.Utils.isComponentPresentOnWizard=function(compId){var length=0;var result=false;var currentStep=getCurrentStep();var currentStepDom=Ext.DomQuery.select("div[id='"+currentStep+"']");var tables=tableUtils.getExtTables(currentStepDom);if(tables===null||tables===undefined||tables.length===0)return false;length=tables.length;for(var cnt=0;cnt<length;cnt++)if(tables[cnt].getId()==compId){result=true;break}return result};
PTC.jca.table.Utils.isComponentPresentOnActiveTab=function(compId){var grid=tableUtils.getTable(compId);var element=grid.getEl();var parentDiv=element.findParentNode("div[class*='x-panel x-panel-noborder']");if(parentDiv===null)return null;if(Ext.isIE)return PTC.isDefined(parentDiv)?!$(parentDiv).hasClassName("x-hide-display"):false;else return PTC.isDefined(parentDiv)?!parentDiv.hasClassName("x-hide-display"):false};
PTC.jca.table.Utils.renderPageNcomponentLevelFeedback=function(store,msg1,key1,key2){var isComponentVisble=tableUtils.isComponentVisible(store);if(msg1)store.fireEvent("DSLoadingInterupted",msg1);if(isComponentVisble)PTC.jca.DataSourceRegistry.showIncompleteDataWarning(key1,key2)};
PTC.jca.table.Utils.getTable=function(id){if(typeof id!=="string")return id;id=PTC.jca.table.Utils.getUnformattedTableId(id);if(typeof Ext!=="undefined"){var t=Ext.getCmp(id);if(t!==undefined&&t instanceof Ext.grid.GridPanel)return t}var table=null;var tables=PTC.jca.table.Utils.getTables();for(var i=0,l=tables.length;i<l;i++){var item=tables[i];if(item&&id===item.id)table=item}return table};
function OLD_getTableById(tableId){for(var i=0,l=tableArray.length;i<l;i++)if(tableArray[i].id==tableId)return tableArray[i];return null}getTableById=PTC.jca.table.Utils.getTable;PTC.jca.table.Utils.isExt=function(){if(typeof Ext!=="undefined"){var divs=Ext.DomQuery.select("div[class*='x-grid-panel']");if(divs&&divs.length>0)return true}return false};
PTC.jca.table.Utils.getExtTables=function(root){var tables=[];if(typeof Ext!=="undefined"){var divs=Ext.DomQuery.select("div[class*='x-grid-panel']",root);for(var i=0,l=divs.length;i<l;i++){var item=divs[i];var tableGrid=Ext.getCmp(item.id);if(tableGrid!==undefined)tables.push(tableGrid)}}return tables};
PTC.jca.table.Utils.getDataLoadUserConfirmation=function(store,key,tableId){if(store===undefined||store===null){var table=tableUtils.getTable(tableId);store=table.getStore()}if(store.resultLimitReached||store.resultLimitCrossed){var proceed=JCAConfirm(key);store.showPopUp=proceed;if(!proceed)return false;else{store.resultLimitCrossed=true;return true}}return true};PTC.jca.table.Utils.getRowData=function(table){if(table&&table.store)return table.store.queryBy(TRUE_FUNC)};
PTC.jca.table.Utils.getFilteredRowData=function(table){if(table&&table.store)return table.store.query()};PTC.jca.table.Utils.getColumns=function(table){if(table.colModel)return table.colModel.config};PTC.jca.table.Utils.getColumnObject=function(column){return column};PTC.jca.table.Utils.getHeaderLabel=function(column){var label=PTC.util.unescapeHTML(this.getColumnObject(column).header);if(!label)return null;return label.trim()};PTC.jca.table.Utils.isTablePaged=function(tableId){return false};
PTC.jca.table.Utils.addRow=function(table,data){rowHandler.addRows([data.oid],table.id,null,{refresh:false,doAjaxUpdate:false});var row=PTC.jca.table.createRecord(table.wtableRef,data);return table.store.add(row)};PTC.jca.table.Utils.updateRow=function(table,data,location){var row=PTC.jca.table.Utils.removeRow(table,location);PTC.jca.table.Utils.addRow(table,data)};
PTC.jca.table.Utils.addTreeRow=function(table,data,parent,hasChildren){data._parent=parent;data._is_leaf=hasChildren;return this.addRow(table,data)};PTC.jca.table.Utils.updateTreeRow=function(table,data,parent,hasChildren){data._parent=parent;data._is_leaf=hasChildren;return this.updateRow(table,data,location)};
PTC.jca.table.Utils.removeRow=function(table,att){if(typeof table==="string")table=this.getTable(table);if(table){var currentRecord=this._getTableRow(table,att);if(currentRecord){jsca.unSelectAll(null,table.id);return table.store.remove(currentRecord)}}};PTC.jca.table.Utils.removeRows=function(table,oids){oids=$A(oids);oids.each(function(item){PTC.jca.table.Utils.removeRow(table,item)})};
PTC.jca.table.Utils.getTableUrl=function(id){var table=this.getTable(id);var url=null;if(table&&table.store!==undefined&&table.store.proxy!==undefined&&table.store.proxy.url!==undefined)url=Ext.urlAppend(table.store.proxy.url,Ext.urlEncode(table.store.baseParams));if(!url&&table&&table.jcaTableConfig!==undefined)url=Ext.urlAppend(table.jcaTableConfig.storeURL.url,Ext.urlEncode(table.store.baseParams));return url};
PTC.jca.table.Utils.cleanUp=function(root){var ts=this.getExtTables(root);if(root&&root.id){var rootTable=tableUtils.getTable(root.id);if(rootTable)ts.push(rootTable)}if(ts&&ts.length>0){for(var i=0,l=ts.length;i<l;i++){var item=ts[i];PTC.jca.table.Utils.destroyTable(item)}Ext.garbageCollect()}PTC.jca.deleteAllCmpsWithCls(root,".attribute-apanel")};
PTC.jca.table.Utils.destroyTable=function(table){if(table.updateSizeTask){if(table.updateSizeTask.cancel)table.updateSizeTask.cancel();delete table._updateSizeTask}if(table.updateSelCountMsg){if(table.updateSelCountMsg.task){table.updateSelCountMsg.task.cancel();delete table.updateSelCountMsg.task}delete table.updateSelCountMsg}if(table.view&&table.view.syncHeaderScroll){if(table.view.syncHeaderScroll.task){table.view.syncHeaderScroll.task.cancel();delete table.view.syncHeaderScroll.task}delete table.view.syncHeaderScroll}if(table._heightFuncTimer){clearTimeout(table._heightFuncTimer);
delete table._heightFuncTimer}if(Ext.isIE8){PTC.util.deleteComponentWithBackgroundSrc(Ext.getCmp(table.id+"_toggle"));PTC.util.deleteComponentWithBackgroundSrc(Ext.getCmp("footer_"+table.id+"_cancelDataSourceButton"));PTC.util.deleteComponentWithBackgroundSrc(Ext.getCmp("header_"+table.id+"_cancelDataSourceButton"));if(table.el.dom){var buttons=table.el.dom.getElementsByTagName("BUTTON");var i=buttons.length;while(i--)buttons[i].outerHTML=""}}Ext.state.Manager.clear(table.id);var wTableId=PTC.jca.table.getWTablePanelID(table.id);
var wTable=table.wtableRef;if(!wTable)wTable=Ext.getCmp(wTableId);var store=table.store;if(store&&store.chunk)if(typeof store.isLoading==="function"&&store.isLoading()===true)PTC.jca.DataSourceRegistry.cancelServerDataSources([store.chunk.id]);if(store&&store.dataChangeTask){if(store.dataChangeTask.cancel)store.dataChangeTask.cancel();delete store.dataChangeTask}if(store&&store.selectPreSelectOids){if(store.selectPreSelectOids.cancel)store.selectPreSelectOids.cancel();delete store.selectPreSelectOids}if(table.vtip){table.vtip.destroy();
delete table.vtip}if(table.gsm){table.gsm.destroy();delete table.gsm}table.destroy();var selModel=table.getSelectionModel();if(selModel){if(selModel._handleSelectAllCheckboxTask){if(selModel._handleSelectAllCheckboxTask.cancel)selModel._handleSelectAllCheckboxTask.cancel();delete selModel._handleSelectAllCheckboxTask}selModel.destroy()}if(wTable){if(wTable.updateTitle&&wTable.updateTitle.task){wTable.updateTitle.task.cancel();delete wTable.updateTitle.task;delete wTable.updateTitle}Ext.ComponentMgr.unregister(wTable);
if(table.toolbars&&table.toolbars.length)for(i=0,l=table.toolbars.length;i<l;i++){if(table.toolbars[i])table.toolbars[i].destroy();delete table.toolbars[i]}PTC.action.un("objectsaffected",table.onObjectsAffected,table);wTable.destroy();Ext.destroy(wTable.searchInListToolbar,wTable.help,wTable.helpButton,wTable.pickView,wTable.titleBar,wTable.pagingBar,wTable.optionsButton,wTable.toolBar,wTable.menuBar,wTable.viewsCombo,wTable.gridPanel,wTable.tbar,wTable.fbar,wTable.appFiltersCombo);delete wTable.searchInListToolbar;
delete wTable.help;delete wTable.helpButton;delete wTable.pickView;delete wTable.titleBar;delete wTable.pagingBar;delete wTable.optionsButton;delete wTable.toolBar;delete wTable.menuBar;delete wTable.viewsCombo;delete wTable.appFiltersCombo;delete wTable.gridPanel}};
PTC.jca.table.getColumnBooleanStringValue=function(row,columnId,defaultValue){var rawValue=row.get(columnId);if(rawValue&&rawValue.gui)rawValue=rawValue.gui.comparable;else if(typeof rawValue==="boolean")rawValue=rawValue.toString();else if(typeof rawValue==="string")rawValue=rawValue;else rawValue=defaultValue;return rawValue};
PTC.jca.table.isRowSelectable=function(record,rowStore,grid){if(!record)return true;var nonSelectableColumn=null;if(rowStore){if(!grid){grid=rowStore.jsca_table;if(!grid)grid=PTC.jca.table.Utils.getTable(rowStore.jscaTableID)}if(grid){var jcaTableConfig=grid.jcaTableConfig;nonSelectableColumn=jcaTableConfig.nonSelectRowColumn?PTC.jca.table.getColumnBooleanStringValue(record,jcaTableConfig.nonSelectRowColumn,"false"):nonSelectableColumn}}if(nonSelectableColumn==="true"||record.get("selectableRow")===
false){if(grid)grid.hasNonSelectableRow=true;return false}return true};PTC.jca.table.Utils.getToolbar=function(tableID){return Ext.getCmp(tableID+".toolBar")};
PTC.jca.table.Utils.reload=function(id,params,removeStaleData){if(removeStaleData===undefined)removeStaleData=true;var table=tableUtils.getTable(id);if(table!==null){var selectedOnlyMenu=Ext.getCmp(PTC.jca.table.getWTablePanelID(table.id)+".selectedOnlyViewItem");if(selectedOnlyMenu&&selectedOnlyMenu.checked===true)selectedOnlyMenu.setChecked(false);table.getStore().load_complete=false;table.getStore().totalLength=0;var form=PTC.jca.table.Utils.getTableFormData(table);var formData=Ext.urlDecode(form);
formData.tableID=table.id;formData.refreshTable=PTC.jca.table.Utils.getFormattedTableId(table.id);Ext.apply(formData,params);if(!table.store.chunkEnabled)table.store.on("reload",PTC.jca.table.Utils.reloadProgressMask);if(removeStaleData){table.store.removeAll();jsca.unSelectHiddenCheckboxes(id)}table.store.fireEvent("reload");table.store.on("exception",PTC.jca.table.Utils.reloadLegacyTable,null,{single:true});table.store.reload({params:formData,reload:true})}};
PTC.jca.table.Utils.reloadProgressMask=function(){var el=document.getElementById(this.jscaTableID);var mask=Ext.fly(el).child(".x-grid3-scroller");Ext.fly(mask).addClass("contentloading");this.on("load",function(){Ext.fly(mask).removeClass("contentloading")})};PTC.jca.table.Utils.reloadLegacyTable=function(){refreshCurrentElement(this.jscaTableID,true,false)};
PTC.jca.table.Utils.evalCellContent=function(table,cellContent){var observable=null;var evt=null;if(typeof table.getStore==="function"){observable=table.getStore();if(observable.getCount()<=0)evt="load";else{observable=null;evt="eval?"}}else if(table.attributeGroupId!==undefined){observable=Ext.getCmp(table.attributeGroupId);evt="afterlayout"}if(observable&&(evt==="afterlayout"||!table.getView().hasRows()||evt==="load"&&typeof observable.getCount!=="undefined"&&observable.getCount()<=0))observable.on(evt,
function(){PTC.util._evalHTML(cellContent)},observable,{single:true});else PTC.util._evalHTML.defer(1,this,[cellContent])};
PTC.jca.table.Utils.updateInitialRows=function(id,oids){var hiddenRows=Ext.getDom("initialRows_"+id);if(hiddenRows===undefined||hiddenRows===null)return;var oidList=[];if(oids!==undefined)oids.split("#").each(function(oid){oidList.push(oid)});var table=PTC.jca.table.Utils.getTable(id);if(!table)return;if(oidList.length===0){var store=table.getStore();store.each(function(item){oidList.push(item.get("oid"))})}hiddenRows.value=oidList.join("#");table=null;store=null;hiddenRows=null};
PTC.jca.table.Utils.handleColumnDataChange=function(table,updatedColumns){table=PTC.jca.table.Utils.getTable(table);var store=table.getStore(),isSortColumn=false;var multiSortString=PTC.jca.getMultiColumnSortString(table.id);if(multiSortString&&updatedColumns){var multiSortArray=multiSortString.split(PTC.jca.SORT_DELIMITER);for(var i=0,len=updatedColumns.length;i<len;i++)if(multiSortArray.indexOf(updatedColumns[i])>=0){isSortColumn=true;break}}if(isSortColumn===true)store.applySort();store.fireEvent("datachanged",
store)};PTC.jca.table.Utils.getTableFormData=function(table){var domEl;if(table&&table.el)domEl=table.el.dom;var params=getFormData(domEl);return PTC.jca.table.Utils.addTableRefreshParams(table,params)};PTC.jca.table.Utils.addTableRefreshParams=function(table,params){table=PTC.jca.table.Utils.getTable(table);params=removeParamFromString("AjaxEnabled",params);params=removeParamFromString("tableID",params);params=params+"&tableID="+tableUtils.getUnformattedTableId(table.id);return params};
PTC.jca.table.Utils.makeExtPagingLink=function(config){var link=new Ext.menu.TextItem({text:config.text,id:config.id,handler:config.handler,itemCls:"extLink",activeClass:"extLink"});link.on("afterrender",function(){return new Ext.ToolTip({target:link.el.id,html:config.tooltip})});return link};PTC.jca.table.Utils.clearSelectAllCheckbox=function(table){var hd=Ext.fly(table.getView().innerHd).child(".x-grid3-hd-checker-on");if(hd)hd.removeClass("x-grid3-hd-checker-on");table.selectedOnlyChecked=false};
PTC.jca.table.Utils.getTableVisibleColumnsServerIds=function(table){var columnModel=table.getColumnModel();var visibleColumns=PTC.jca.ColumnUtils.getVisibleColumns(columnModel);var visibleColumnIDs=[];var nVisible=visibleColumns.length;for(var i=0;i<nVisible;i++)visibleColumnIDs.push(visibleColumns[i].origId);return visibleColumnIDs.join(",")};
PTC.jca.table.Utils.getTableColumnServerParameters=function(table){var serverParameters={};serverParameters.fitVisibleCols=PTC.jca.table.Utils.getTableVisibleColumnsServerIds(table);var sortInfo=PTC.jca.table.Utils.getTableSortInfo(table);var nSortedColumns=sortInfo.length;var colIndex=null;for(var i=0;i<nSortedColumns;i++){colIndex=i===0?"":i+1;serverParameters[table.id+"sc"+colIndex]=sortInfo[i].columnID;serverParameters[table.id+"sd"+colIndex]=sortInfo[i].sortDirection}return serverParameters};
PTC.jca.table.Utils.getTableSortInfo=function(table){var sortInfo=[];var sortState=PTC.jca.getMultiColumnSortString(table.id);if(sortState===null||sortState===""){var jscaSortInfo=table.getStore().jsca_table;if(typeof jscaSortInfo!=="undefined"&&typeof jscaSortInfo.jcaTableConfig!=="undefined")sortState=jscaSortInfo.jcaTableConfig.serverSortInfo}if(!sortState)return sortInfo;var sortColumnData=sortState.split(PTC.jca.SORT_DELIMITER);var nFields=sortColumnData.length;if(nFields%2==1)nFields--;for(var i=
0;i<nFields;i+=2){var columnSortDescription={};columnSortDescription.columnID=sortColumnData[i];columnSortDescription.sortDirection=sortColumnData[i+1];sortInfo.push(columnSortDescription)}return sortInfo};
PTC.jca.table.Utils.isAllDataLoaded=function(table){if(!table)return true;var store=table.getStore();var nDisplayedRows=store.getCount();if(nDisplayedRows===0)if(store.DATA_RENDERED!==true)return false;else return true;var config=table.jcaTableConfig;if(config.tree)return PTC.jca.table.Utils.isAllDataLoadedTree(table);else return PTC.jca.table.Utils.isAllDataLoadedTable(table)};
PTC.jca.table.Utils.isAllDataLoadedTree=function(tree){var store=tree.getStore();if(store.loadContinue===false)return false;var records=store.getRange();var nRecords=records.length;if(!records[nRecords-1].get("_is_leaf"))return false;var previousNode=records[0];var currentNode=null;for(var i=1;i<nRecords;i++){currentNode=records[i];if(!previousNode.get("_is_leaf"))if(currentNode.get("_parent")!==previousNode.id)return false;previousNode=currentNode}return true};
PTC.jca.table.Utils.isAllDataLoadedTable=function(table){var store=table.getStore();var config=table.jcaTableConfig;if(Ext.isEmpty(config.chunk))return true;if(store.load_complete!==true)return false;if(config.pageOffset&&config.pageOffset!==0)return false;return!store.moreData};
PTC.jca.table.Utils.adjustTableHeight=function(contentAreaDiv){var tables=null;if(contentAreaDiv)tables=tableUtils.getExtTables(contentAreaDiv);else tables=PTC.jca.table.Utils.getTables();if(tables&&tables.length>0)for(var i=0,l=tables.length;i<l;i++)PTC.jca.table.scroll.updateTableSize(tables[i].id,false)};PTC.jca.table.Utils.compareOid=function(record,oid){if(record.data.oid===oid)return true;return false};
PTC.jca.table.Utils.getNotMatchedOids=function(matchedOids,oids){var notMatched=[];for(var m=0,n=oids.length;m<n;m++){var flag=false;for(var o=0,p=matchedOids.length;o<p;o++)if(matchedOids[o]===oids[m]){flag=true;break}if(!flag)notMatched.push(oids[m])}return notMatched};
PTC.jca.TableGrid.prototype._onUpdateIterator=function(oid,value,formResult,rowsToAdd){var grid=this;if(oid&&typeof oid==="string"){var newOid=value[0];var rec=PTC.jca.table.Utils.getTableRowFromOid(grid,oid,formResult.convertOidReference(oid,formResult));if(!rec)rec=PTC.jca.table.Utils.getTableRowFromOid(grid,newOid,formResult.convertOidReference(oid,formResult));if(rec){var rowOid=rec.data.oid;rowHandler.removeRows([rowOid],grid.id);if(rowOid.indexOf("OR:")!==newOid.indexOf("OR:")&&rowOid.indexOf("VR:")!==
newOid.indexOf("VR:")){newOid=formResult.convertOidReference(newOid,formResult);if(!newOid)newOid=value[0]}rowsToAdd.push(newOid)}}};PTC.jca.table.Utils._getRecordsFromOids=function(table,oids,formResult){var rec,recs=[],i=oids.length;while(i--){rec=PTC.jca.table.Utils.getTableRowFromOid(table,oids[i],formResult.convertOidReference(oids[i],formResult));if(rec)recs.push(rec)}return recs};
PTC.jca.table.Utils.onObjectsAffected=function(formResult){var table=this;if(table&&formResult&&(!formResult.afterActionHandled||formResult.afterActionHandled[table.id]!==true)){table._handleUpdateObjects(formResult);table._handleDeleteObjects(formResult)}return true};PTC.jca.TableGrid.prototype.onObjectsAffected=PTC.jca.table.Utils.onObjectsAffected;PTC.jca.TreeGrid.prototype.onObjectsAffected=PTC.jca.table.Utils.onObjectsAffected;
PTC.jca.TableGrid.prototype._handleUpdateObjects=function(formResult){if(formResult.U){var added_new_rows=[];this.getStore()._updateInProgress=true;PTC.util.propertyIterator(formResult.U,this,this._onUpdateIterator,[formResult,added_new_rows]);if(added_new_rows.length>0){clearActionFormData();this._addRows(added_new_rows)}this.getStore()._updateInProgress=undefined}};
PTC.jca.TableGrid.prototype._addRows=function(added_new_rows){rowHandler.addRows(added_new_rows,this.id,null,{doAjaxUpdate:true,preventDuplicates:typeof this.preventDuplicates=="undefined"?false:this.preventDuplicates})};PTC.jca.TableGrid.prototype._handleAddObjects=function(formResult){var oids=formResult.getAddedOids();if(oids.length>0)this._addRows(oids)};
Ext.grid.GridPanel.prototype._handleDeleteObjects=function(formResult){var oids=formResult.getDeletedOids();var recs=PTC.jca.table.Utils._getRecordsFromOids(this,oids,formResult);var containerOid=decodeURIComponent(PTC.folderBrowser.getContainerOid(window.location.href));var lastAccessedFolder=decodeURIComponent(PTC.folderBrowser.getLastFolderAccessed(containerOid));var deletedOidlenght=oids.length;if(lastAccessedFolder)while(deletedOidlenght--)if(jsca.isFolderOid(oids[deletedOidlenght])&&lastAccessedFolder.indexOf(oids[deletedOidlenght])!=
-1){PTC.folderBrowser.setLastFolderAccessed(containerOid,window.location.href);break}if(recs.length>0&&this.getStore())this.getStore().remove(recs)};PTC.jca.table.Utils.handleViewChange=function(tableId,newView){var tableDiv=tableUtils.getFormattedTableId(tableId);var formData=this._formDataForHandleViewChange(tableId);getTableHtml("refreshTable="+tableDiv+"&viewchange=true&tv."+tableId+"="+newView+"&sv="+newView+formData,tableDiv,true)};
PTC.jca.table.Utils.addSubmitFormParam=function(tableId){var table=PTC.jca.table.Utils.getTable(tableId);table.getStore().setBaseParam("submitForm",true)};PTC.jca.table.Utils._formDataForHandleViewChange=function(tableId){var formData="";var url=tableUtils.getTableUrl(tableId);var submit=false;if(url.indexOf("submitForm=true")!==-1)submit=true;if(isWizardWindow()||submit)formData="&"+Ext.lib.Ajax.serializeForm(getMainForm());return formData};
PTC.jca.table.Utils.parseRowIdentifierWithDoller=function(context){var rowId=context;var idx=rowId.lastIndexOf("$");if(idx>0){var temprowId=rowId;rowId=rowId.substring(0,idx);temprowId=temprowId.substring(idx+1);idx=rowId.lastIndexOf("$");if(idx>0)context=rowId.substring(idx+1)+"$"+temprowId}return context};Ext.ns("PTC.team");
PTC.team.utils={selectRequiredAndConfirmation:function(event,target,table,message){if(target.ownerCt.id!=="gridRowContextMenu"&&table&&!table.getSelectionModel().hasSelection()){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");return false}return JCAConfirm(event,"com.ptc.netmarkets.util.utilResource.CONFIRM_REMOVE")}};PTC.templateProcessor={};
PTC.templateProcessor.initHtmlcomps=function(){if(typeof initAllCollectionComponentsOnLoad!=="undefined")initAllCollectionComponentsOnLoad();if(typeof generateAllJSTables!=="undefined")generateAllJSTables()};
PTC.templateProcessor.init_page=function(tableId){var asynchRender=false;if("isWildfire"in window&&"isWorkspaceActive"in window&&isWildfire&&isWorkspaceActive){var init_page=PTC.templateProcessor.init_page[tableId];if(typeof init_page!=="undefined"){asynchRender=init_page.AsynchRenderTable&&true;if(asynchRender)init_page(function(){PTC.jst.extu.renderTable(tableId)});else init_page()}}if(!asynchRender)PTC.jst.extu.renderTable(tableId)};
PTC.templateProcessor.initCommonForms=function(){var commonForms=$("CommonFormsDiv");if(!commonForms){var url=getBaseHref()+"servlet/WindchillAuthGW/wt.enterprise.URLProcessor/URLTemplateAction?action=CommonForms";var options={asynchronous:false,method:"get",parameters:PTC.util.extractAllParams(window.location.href)};var response=requestHandler.doRequest(url,options);var responseText=response.responseText;commonForms=document.createElement("div");commonForms.style.display="none";commonForms.id="CommonFormsDiv";
commonForms.innerHTML=responseText;$(PTC.navigation.activeContentID).appendChild(commonForms);PTC.navigation.evalPageScripts(responseText)}};
PTC.templateProcessor.displayMessages=function(){if(messages.length>0){var strs=messages.split(";$#");for(var i=0;i<strs.length;i++){var lines=strs[i].split("^#@");var messWithLineFeeds="";for(var j=0;j<lines.length;j++)messWithLineFeeds=messWithLineFeeds+lines[j]+"\n";if(PTC.automation!="undefined"&&PTC.automation.isAutomationTest()){messWithLineFeeds=trim(messWithLineFeeds.replace("\n"," "));setTimeout("wfalert('"+messWithLineFeeds+"')",2E3)}else wfalert(messWithLineFeeds)}}};
PTC.templateProcessor.refreshOpener=function(actionPerformed,refreshType,refreshOid,message){displayMessages()};PTC.templateProcessor.childWindowComplete=function(redirectUrl,message,actionPerformed,success){if(redirectUrl==null||redirectUrl.length==0)window.location.reload();else window.location.href=redirectUrl};
PTC.templateProcessor.deleteWindowComplete=function(redirectUrl,message,action,success,oid){displayMessages();if(redirectUrl)top.window.location=redirectUrl;else refreshOpener(action,null,oid,message)};PTC.templateProcessor.reloadContentArea=function(){PTC.navigation.loadContent(window.location.href)};displayMessages=PTC.templateProcessor.displayMessages;refreshOpener=PTC.templateProcessor.refreshOpener;childWindowComplete=PTC.templateProcessor.childWindowComplete;deleteWindowComplete=PTC.templateProcessor.deleteWindowComplete;
PTC.templateProcessor.getTPContentWindow=function(){var iframe=getWindow().document.getElementById("the_tpIFrame");return iframe?iframe.contentWindow:null};
jsca.columns.textAreaRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);if(data.enabled){if(typeof row.get==="function"&&row.get(column.id))row.get(column.id).updateCellValue=jsca.columns.textAreaRenderer.updateCellValue;result="<textarea "+jsca.columns.idStr(data.id)+jsca.columns.nameStr(data.name)+'rows="'+data.rows+'" cols="'+data.cols+'" '+jsca.columns.disabledStr(data.disabled)+jsca.columns.readOnlyStr(data.readOnly)+jsca.columns.tooltipStr(data.tooltip)+
jsca.columns.jsActionsStr(data.jsActions)+'style="'+data.style+'" '+data.styleClasses+" />"+data.displayValue+"</textarea>"+'<input type="hidden" '+jsca.columns.idStr(data.id+jsca.columns.OLDSTR)+jsca.columns.nameStr(data.name+jsca.columns.OLDSTR)+jsca.columns.valueStr(data.value)+"/>"}else result=data.value;result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};
jsca.columns.textAreaRenderer.updateCellValue=function(cell,value){cell.gui.value=value;cell.gui.displayValue=value;cell.gui.comparable=value};jsca.columns.textAreaRenderer.searchFunc=function(table,column,row){var data=jsca.columns.getCellValue(column,row);return data.displayValue};jsca.columns.textAreaRenderer.exportRenderer=function(table,column,row){return PTC.util.HTMLEncoder.encodeForHTMLContent(jsca.columns.textAreaRenderer.searchFunc(table,column,row))};PTC.textarea={};
PTC.textarea.replaceWithRichTextEditor=function(componentId,toolbarConfig){setTimeout(function(){var editor=CKEDITOR.replace(componentId,{height:"200",width:"650",resize_minHeight:310,resize_minWidth:650,entities_processNumerical:true,enterMode:"div",toolbarStartupExpanded:true,format_tags:"div;p;h1;h2;h3;h4;h5;h6",pasteFromWordRemoveFontStyles:false,pasteFromWordRemoveStyles:false,skin:"kama",font_names:"Arial;Comic Sans MS;Courier New;Tahoma;Times New Roman;Verdana",font_defaultLabel:"Arial",fontSize_defaultLabel:"12px",
menu_groups:"clipboard,form,tablecell,tablecellproperties,tablerow,tablecolumn,table,anchor,link,flash,checkbox,radio,textfield,hiddenfield,imagebutton,button,select,textarea",removePlugins:"elementspath",uiColor:"#F1F1F1",keystrokes:[[CKEDITOR.CTRL+CKEDITOR.ALT+13,"maximize"],[CKEDITOR.CTRL+CKEDITOR.ALT+108,"maximize"],[CKEDITOR.CTRL+90,"undo"],[CKEDITOR.CTRL+89,"redo"],[CKEDITOR.CTRL+CKEDITOR.SHIFT+90,"redo"],[CKEDITOR.CTRL+66,"bold"],[CKEDITOR.CTRL+73,"italic"],[CKEDITOR.CTRL+76,"link"],[CKEDITOR.CTRL+
85,"underline"]],toolbar:toolbarConfig||""})},2E3)};
jsca.columns.textBoxRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);var oid=data.oid||getRowItem(row).oid;if(data.enabled){if(typeof row.get==="function"&&row.get(column.id))row.get(column.id).updateCellValue=jsca.columns.textBoxRenderer.updateCellValue;result="<input ";if(data.id)result+=jsca.columns.idStr(data.id);if(data.trailId&&PTC.trail.isTrailEnabled())result+=' trlId="'+data.trailId+'" ';result+=jsca.columns.typeStr(data.type)+jsca.columns.nameStr(data.name)+
jsca.columns.jsActionsStr(data.jsActions)+jsca.columns.valueStr(data.value);if(data.readOnly)result+=jsca.columns.readOnlyStr(data.readOnly);result+=jsca.columns.disabledStr(data.disabled);if(data.tooltip)result+=jsca.columns.tooltipStr(data.tooltip);if(data.styleClasses)result+=data.styleClasses;if(data.width)result+=jsca.columns.sizeStr(data.width);if(data.maxlength)result+=jsca.columns.maxlengthStr(data.maxlength);result+="/>";result+="<input "+jsca.columns.typeStr("hidden")+jsca.columns.idStr(data.id+
jsca.columns.OLDSTR)+jsca.columns.nameStr(data.name+jsca.columns.OLDSTR)+jsca.columns.valueStr(data.value);if(data.size)result+=jsca.columns.sizeStr(data.size);if(data.width)result+=jsca.columns.sizeStr(data.width);if(data.maxlength)result+=jsca.columns.maxlengthStr(data.maxlength);result+="/>"}else{result+="<input "+jsca.columns.typeStr("hidden")+jsca.columns.idStr(data.id)+jsca.columns.nameStr(data.name)+jsca.columns.valueStr(data.value);if(data.size)result+=jsca.columns.sizeStr(data.size);if(data.width)result+=
jsca.columns.sizeStr(data.width);if(data.maxlength)result+=jsca.columns.maxlengthStr(data.maxlength);result+="/>"}result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};jsca.columns.textBoxRenderer.updateCellValue=function(cell,value){cell.gui.value=value;cell.gui.displayValue=value;cell.gui.comparable=value};
jsca.columns.textDisplayComponentRenderer=function(table,column,row){var result="";var data=jsca.columns.getCellValue(column,row);if(data.id||data.tooltip||data.styleClasses){result+="<span ";result+=jsca.columns.idStr(data.id);if(data.styleClasses){result+=data.styleClasses;result+=" "}if(data.tooltip)result+=jsca.columns.tooltipStr(data.tooltip);result+=">";if(data.value)result+=data.value;result+="</span>"}else if(data.value)result=data.value;if(data.needToUseMore&&data.needToTruncate||data.containsNewLine)result=
jsca.columns.textDisplayComponentRenderer.addMoreLink(data,data.truncatedValue,data.escapedValue,data.containsNewLine,data.moreLink);result=result+jsca.columns.getHiddenInputs(data.hiddenData);return result};
jsca.columns.getHiddenInputs=function(hiddenData){var result="";if(hiddenData&&hiddenData.hiddenFields)for(var property in hiddenData.hiddenFields)if(property){var value=hiddenData.hiddenFields[property];var name=property.escapeHTML().replace('"',"&quot;");if(hiddenData.objectHandle&&name.indexOf(hiddenData.objectHandle)<0)name=hiddenData.objectHandle+name;var id=hiddenData.isHiddenId?'id="'+name+'" ':"";var css=hiddenData.hiddenClass?'class="'+hiddenData.hiddenClass+'" ':"";result=result+'<input type="hidden" name="'+
name+'" value="'+value+'" '+id+css+"/>"}return result};jsca.columns.textDisplayComponentRenderer.addMoreLink=function(data,visibleText,fullText,containsNewLine,linkTitle){data.truncationURL=PTC.jslint.SCRIPT_URL_STRING+"showFullText('"+escape(fullText)+"', true)";data.truncationTitle=linkTitle;data.addDotLink=true;if(containsNewLine)return visibleText+'<a title="'+linkTitle+'" href="#" onClick="showFullText(\''+escape(fullText)+"', true); return false;\">"+"..."+"</a>";return fullText};
PTC.theme={};PTC.theme.applyTheme=function(){};PTC.theme.swapStyleSheet=function(id,href){Ext.util.CSS.swapStyleSheet(id,href);PTC.theme.applyTheme()};
jsca.columns.treeColumnRenderer=function(table,column,row){var data=getRowItem(row)[column.id];var result="";var cellRenderer=data.cellRenderer;var renderStr="<SPAN class=tree_span_one>";var renderst=renderTDTreeNodeImage(table,column,row);if(renderst.search("blank")==-1)renderStr+="<SPAN class=tree_span_two>";else renderStr+="<SPAN class=trr_span_two_set>";renderStr+=renderst;renderStr+="</SPAN></SPAN>";if(cellRenderer){data.gui=data.cellValue;if(renderStr.search("collapse3")==-1&&renderStr.search("expand3")==
-1&&table.showTreeLine=="true")renderStr+="<SPAN class=tree_span_three>";else renderStr+="<SPAN class=tree_span_four>";var cellRend=cellRenderer(table,column,row);if(cellRend.search("img")!=-1&&renderStr.search("trr_span_two_set")!=-1||renderStr.search("blank")!=-1)if(renderStr.search("collap")!=-1||renderStr.search("expand")!=-1)renderStr+="<SPAN class=tree_span_six>";else if(table.showTreeLine=="false")renderStr+="<SPAN class=tree_span_five>";else renderStr+="<SPAN class=tree_span_seven>";renderStr+=
cellRend;renderStr+="</SPAN>"}return renderStr};
var treeHandler=function(){return{processExpandCollapseNode:function(param,oidString,conString,contextString,extraparams,uniqueCompKey){var url="netmarkets/jsp/object/collapse.jsp";var bparams=param+"="+encodeURIComponent(oidString)+"&conString="+encodeURIComponent(conString)+"&contextString="+encodeURIComponent(contextString)+extraparams;if(uniqueCompKey!==undefined)bparams=bparams+"&uniqueCompKey="+encodeURIComponent(uniqueCompKey);if(!extraparams)extraparams="";var options={parameters:bparams};
requestHandler.doRequest(url,options)},asyncCollapse:function(oidString,conString,contextString,extraparams,uniqueCompKey){treeHandler.processExpandCollapseNode("c",oidString,conString,contextString,extraparams,uniqueCompKey)},expandNode:function(oidString,conString,contextString,extraparams,uniqueCompKey){treeHandler.processExpandCollapseNode("e",oidString,conString,contextString,extraparams,uniqueCompKey)}}}();
function JSCATrailId(column,row,image){var cell={};var cellValue=getRowItem(row)[column.id].cellValue;if(cellValue)if(typeof cellValue.gui!=="undefined")cell=cellValue.gui;else if(typeof cellValue[0]!=="undefined")cell=cellValue[0].gui;else cell=cellValue;else cell=getRowItem(row)[column.id][0].gui;jsca.columns.addTrailId(column,row,cell);if(cell&&cell.id)if(image.indexOf("collapsed")>0)cell.id+="__"+"collapsed";else cell.id+="__"+"expanded";return jsca.columns.trailIdStr(column,cell)}
var busySign=null;function clearCriteria(){getMainForm().clear1.value="true"}
function setSearchType(Objects,pickerID,targetId){getMainForm().searchType.value="";var elements=Objects.pickedObjects;var pickedSelection=elements.length;for(i=0;i<pickedSelection;i++){if(elements[i].theType.indexOf("wt.fc.Persistable")>-1){getMainForm().searchType.value="wt.fc.Persistable";break}var theType=elements[i].theType;if(theType.indexOf("|")>0&&theType.indexOf("WCTYPE")==-1)theType="WCTYPE|"+theType;if(i==0)getMainForm().searchType.value=theType;else getMainForm().searchType.value=getMainForm().searchType.value+
","+theType}clearCriteria();getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="typeChange";getMainForm().executeLocation.value="inbegin";if(getMainForm().fireSearch)getMainForm().fireSearch.value="false";if($("refreshByAction"))$("refreshByAction").value="false";if(isPicker())refreshCurrentStep();else{setActionNumber();PTC.navigation.submitForm()}}
function setSearchTypeOnSearchPage(Objects,pickerID,targetId){var searchType=getMainForm().searchType.value;if(searchType.search(/wt.fc.Persistable/)>-1)searchType=searchType.replace("wt.fc.Persistable","");getMainForm().searchType.value=searchType;var elements=Objects.pickedObjects;var pickedSelection=elements.length;for(i=0;i<elements.length;i++){var theType=elements[i].theType;if(theType=="wt.fc.Persistable"){getMainForm().searchType.value="wt.fc.Persistable";break}else{var chkItem=new Ext.form.Checkbox({name:""+
theType,boxLabel:"",checked:true,renderTo:"typePickerItems",hidden:true});chkItem.wrap.addClass("chk-same-line");if(theType.indexOf("|")>0&&theType.indexOf("WCTYPE")==-1)theType="WCTYPE|"+theType;if(getMainForm().searchType.value==="")getMainForm().searchType.value=theType;else getMainForm().searchType.value=getMainForm().searchType.value+","+theType;if(getMainForm().preSelectionItems.value==="")getMainForm().preSelectionItems.value=theType;else getMainForm().preSelectionItems.value=getMainForm().preSelectionItems.value+
","+theType}}clearCriteria();getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="typeChange";getMainForm().executeLocation.value="inbegin";if(getMainForm().fireSearch)getMainForm().fireSearch.value="false";if($("refreshByAction"))$("refreshByAction").value="false";if(isPicker())refreshCurrentStep();else{setActionNumber();PTC.navigation.submitForm();showBusySign()}}
function ddTypeChange(){var theType=$("searchType_display").value;if(theType.indexOf("|")>0&&theType.indexOf("WCTYPE")==-1)theType="WCTYPE|"+theType;$("searchType").value=theType;getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="typeChange";getMainForm().executeLocation.value="inbegin";if(getMainForm().fireSearch)getMainForm().fireSearch.value="false";if(isPicker())refreshCurrentStep();else PTC.navigation.submitForm()}
function beforeSelectType(combo,record,index){var selectionOptionVal=record.get("value");if(selectionOptionVal=="Full Result List"){launchJCAPopupAction.defer(50,this,["typePicker"]);combo.collapse();return false}return true}function onTypeChanged(){if(callTypeChange){getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="typeChange";PTC.navigation.submitForm();showBusySign()}}
function callTypeChange(){var oldval=getMainForm().searchType.value;var newval=$("searchForTypes$lable$").value;if(oldval==newval)return;if(newval!="undefined"&&newval=="Full Result List")m=launchJCAPopupAction("typePicker");else{getMainForm().actionClass.value="com.ptc.netmarkets.search.NmSearchCommands";getMainForm().actionMethod.value="typeChange";getMainForm().searchType.value=newval;PTC.navigation.submitForm()}}
launchJCAPopupAction=function(actionNameToLaunch){var actionVar=document.getElementsByName(actionNameToLaunch);if(actionVar!="undefined"&&actionVar[0]!="undefined")actionVar[0].click()};PTC.search.pageLoading=false;
function showBusySign(){PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Type Change"});PTC.search.pageLoading=true;$("loaderDiv").show();$("menuLoaderSpan").show();$("attrMenuAdd").setStyle({color:"gray"});$("enabledAttrMenuIcon").hide();$("disabledAttrMenuIcon").show();toggleDisabled(document.getElementById("queryBuilderContentDiv"))}
function hideBusySign(){$("loaderDiv").hide();$("menuLoaderSpan").hide();$("disabledAttrMenuIcon").hide();toggleDisabled(document.getElementById("queryBuilderContentDiv"));PTC.search.pageLoading=false;$("savedQueryName").update("");PTC.search.performance.logger.fire("logPerformanceEvent",{eventName:"Type Change",isEndEvent:true})}
function toggleDisabled(el){try{if(el.tagName=="INPUT"||el.tagName=="SELECT"){el.readOnly=el.readOnly?false:true;el.setAttribute("class","disabled-textbox")}}catch(E){}if(el.childNodes&&el.childNodes.length>0)for(var x=0;x<el.childNodes.length;x++)toggleDisabled(el.childNodes[x])}jsca.columns.urlDisplayComponentRenderer=jsca.columns.defaultRenderer;
jsca.columns.urlDisplayComponentRenderer.exportRenderer=function(table,column,row,getRowFunc,getCellFunc){var result="";var data=jsca.columns.getCellValue(column,row);if(data&&typeof data.export_value!=="undefined")result=data.export_value;else result=getJSCASearchTextForCell(data);return result};jsca.columns.urlDisplayComponentRenderer.groupFunc=jsca.columns.urlDisplayComponentRenderer;
function validateText(event,rejectTheseChars){var myCode=event.keyCode;if(myCode===0||myCode===undefined)myCode=event.which;var myChar=String.fromCharCode(myCode);var valid=rejectTheseChars.indexOf(myChar)==-1;event.returnValue=valid;return valid}
function validateCreateLocation(evt){var oidString="nothing selected";var sels=PTC.jca.table.Utils.getSelectedItmesByEvent(evt);if(sels){var alength=sels.length;if(alength==1)oidString=sels[0].value;else if(alength>=2){JCAAlert("com.ptc.netmarkets.util.utilResource.TOO_MANY_SELECTED");try{evt=evt?evt:event;Event.stop(evt)}catch(e){}return false}}if(oidString!="nothing selected"&&!PTC.util.isAFolder(oidString)){JCAAlert("com.ptc.netmarkets.util.utilResource.NO_FOLDER_SELECTED");try{evt=evt?evt:event;
Event.stop(evt)}catch(ex){}return false}return true}
function validateSelection(evt,action){evt=evt?evt:event;var validObjSelected=false;var invalidObjSelected=false;var partsSelected=false;var epmDocsSelected=false;var baselinesSelected=false;var target=evt.target?evt.target:evt.srcElement;var divnode=getParentNodeByTag(target,"DIV");divnode=getParentNodeByTag(divnode.parentNode,"DIV");if(!containsClass(divnode,"frame")&&divnode.parentNode)divnode=getParentNodeByTag(divnode.parentNode,"DIV");var tableid=tableUtils.findTableID(evt);if(!tableid)tableid=
tableUtils.findParentTableNodeId(divnode);var sels=getJCASelectedTableItems(tableid);if(sels.length===0){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");Event.stop(evt);return false}if(sels){var alength=sels.length;for(var i=0;i<alength;i++)if(sels[i].checked&&sels[i].name.indexOf("pjl_sel")>=0){var rowVal=getOidFromRowValue(sels[i].value);var partNames=[].concat(PTC.attributeHelper.get("partClasses"));var thisRowIsAPart=false;var j=partNames.length;while(j--)if(rowVal.indexOf(partNames[j])>=
0)thisRowIsAPart=true;if(thisRowIsAPart)partsSelected=true;else if(rowVal.indexOf("wt.epm.EPMDocument")>-1)epmDocsSelected=true;else if(rowVal.indexOf("wt.vc.baseline.ManagedBaseline")>-1)baselinesSelected=true;else invalidObjSelected=true}}validObjSelected=partsSelected||epmDocsSelected||baselinesSelected;var msgKey="";if(validObjSelected&&invalidObjSelected){if(action=="saveas")msgKey="com.ptc.windchill.enterprise.folder.folderResource.MULTI_SAVEAS_INVALID";else if(action=="checkout")msgKey="com.ptc.windchill.enterprise.folder.folderResource.MULTI_CHECKOUT_INVALID";
else msgKey="com.ptc.windchill.enterprise.folder.folderResource.MULTI_ADDTOWORKSPACE_INVALID";if(!JCAConfirm(msgKey)){Event.stop(evt);return false}}if(!validObjSelected){if(action=="saveas")msgKey="com.ptc.windchill.enterprise.folder.folderResource.MULTI_SAVEAS_ALL_INVALID";else if(action=="checkout")msgKey="com.ptc.windchill.enterprise.folder.folderResource.MULTI_CHECKOUT_ALL_INVALID";else msgKey="com.ptc.windchill.enterprise.folder.folderResource.MULTI_ADDTOWORKSPACE_ALL_INVALID";JCAAlert(msgKey);
Event.stop(evt)}return validObjSelected}function validateMultiSaveAsSelection(evt){return validateSelection(evt,"saveas")}function validateMultiCheckoutSelection(evt){return validateSelection(evt,"checkout")}function validateAddToWorkspaceSelection(evt){return validateSelection(evt,"addToWS")}
function validateSomethingSelected(evt){evt=evt?evt:event;if(tableUtils.isJSCA(tableUtils.findTableID(evt))){if(!isSomethingChecked()){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");Event.stop(evt);return false}return true}else{var target=evt.target?evt.target:evt.srcElement;var divnode=getParentNodeByTag(target,"DIV");divnode=getParentNodeByTag(divnode.parentNode,"DIV");if(!containsClass(divnode,"frame")&&divnode.parentNode)divnode=getParentNodeByTag(divnode.parentNode,"DIV");var table_id=
tableUtils.findTableID(evt);var sels=getJCASelectedTableItems(table_id);if(sels.length===0){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");Event.stop(evt);return false}return true}}function ddlDummyPickerCallBack(objects){}
function PickerInputComponentCallback(objects,pickerID,attr,displayFieldId){var updateHiddenField=document.getElementsByName(pickerID)[0];var updateDisplayField=document.getElementsByName(displayFieldId)[0];if(updateDisplayField)PTC.util._setMainFormStartingElement(updateDisplayField);var myJSONObjects=objects.pickedObject;for(var i=0;i<myJSONObjects.length;i++){var oid=myJSONObjects[i].oid;var displayAttr=myJSONObjects[i][attr];updateHiddenField.value=oid;updateDisplayField.value=displayAttr}}
function CreateEditPickerInputComponentCallback_UpdateOnly(objects,pickerID,attr,displayFieldId){var updateHiddenField=document.getElementsByName(pickerID)[0];var updateDisplayField=document.getElementsByName(displayFieldId)[0];var myJSONObjects=objects.pickedObject;for(var i=0;i<myJSONObjects.length;i++){var oid=myJSONObjects[i].typeInstanceId;var displayAttr=myJSONObjects[i][attr];updateHiddenField.value=oid;updateDisplayField.value=displayAttr}}
function CreateEditPickerInputComponentCallback(objects,pickerID,attr,displayFieldId){CreateEditPickerInputComponentCallback_UpdateOnly(objects,pickerID,attr,displayFieldId);PTC.driverAttributes.onChangeHandler()}
function SearchPickerInputComponentCallback(objects,pickerID,attr){var updateHiddenField=document.getElementById(pickerID);var updateDisplayField=document.getElementById(pickerID+"$label$");var myJSONObjects=objects.pickedObject;for(var i=0;i<myJSONObjects.length;i++){var oid=myJSONObjects[i].oid;var displayAttr=myJSONObjects[i][attr];updateHiddenField.value=oid;updateDisplayField.value=displayAttr;if(isWizardWindow())PTC.wizard.saveTableData.saveToStore(updateDisplayField)}}
function confirmAndClosePopup(msg){if(!JCAConfirm(msg)){if(window.opener)closePopupAndRefreshOpener();return false}return true}
function JsonForm(formName,action,jsonFields,target){var myForm;var formFields=jsonFields;this.submit=function submit(){myForm=createForm();addFields();document.body.appendChild(myForm);myForm.submit();document.body.removeChild(myForm)};function createForm(){var retForm=new Element("Form",{name:formName,id:formName,action:action,method:"post",target:target});return retForm}function addFields(){var value;for(var key in formFields)if(formFields.hasOwnProperty(key)){value=formFields[key];AddElement(key,
value)}}function AddElement(xName,xValue){var theNewElem=new Element("input",{type:"hidden",name:xName,value:xValue});myForm.appendChild(theNewElem)}}PTC.validation.doOnClickValidation=function(mform,isPopup){var retval=true;if(mform){if(mform.onClickValidationTemp!==undefined&&!mform.onClickValidationTemp(isPopup))retval=false;if(mform.onClickValidationTemp!==undefined)mform.onClickValidationTemp=undefined}return retval};var __userSubmitFunction=[];
function setUserSubmitFunction(func){__userSubmitFunction[__userSubmitFunction.length]=func}function removeUserSubmitFunction(func){if(__userSubmitFunction){var __userSubmitFunction_length=__userSubmitFunction.length;for(var i=0;i<__userSubmitFunction_length;i++)if(__userSubmitFunction[i]===func)__userSubmitFunction.splice(i,1)}}
function callUserSubmitFunction(){if(__userSubmitFunction){var __userSubmitFunction_length=__userSubmitFunction.length;for(var i=0;i<__userSubmitFunction_length;i++)if(__userSubmitFunction[i]()===false)return false}return true}
function createDocName(){var docName=getMainForm().file.value;if(getMainForm().name.value===""){var sepChar="\\";if(docName.lastIndexOf("/")>=0)sepChar="/";if(docName.lastIndexOf(".")>0)docName=docName.substring(docName.lastIndexOf(sepChar)+1,docName.lastIndexOf("."));else docName=docName.substring(docName.lastIndexOf(sepChar)+1,docName.length);getMainForm().name.value=docName}}
function trim(String2Trim){if(typeof String2Trim!=="string"&&typeof String2Trim!=="undefined")return String2Trim;return String2Trim.strip()}leftTrim=trim;rightTrim=trim;function validateName(){var name=getMainForm().name.value;name=trim(name);if(name===""){wfalert(ERROR_MSG);getMainForm().name.value=name;getMainForm().name.focus();return false}return true}function validateName2(){var name=getMainForm().name.value;name=trim(name);if(name===""){wfalert(ERROR_MSG);return false}return true}
function validateNAME(){var name=getMainForm().NAME.value;name=trim(name);if(name===""){wfalert(ERROR_MSG);getMainForm().NAME.value=name;getMainForm().NAME.focus();return false}return true}function getNamedSelect(name){var select;var i;var selects=document.getElementsByTagName("select");var len=selects.length;for(i=0;i<len;i++){select=selects.item(i);if(select.name==name)return select}return null}
function validateType(){var select=getNamedSelect("type");var type=select.value;type=trim(type);if(!type||type===""){select.focus();wfalert(TYPE_ERROR_MSG);return false}return true}function validateTypeAndName(){var typed=validateType();if(!typed)return false;return validateName()}function validateNameLength(){if(getMainForm().NAME.value&&getMainForm().NAME.value.length*4>4E3){wfalert(ERROR_MSG2);return false}return true}
function validateDescLength(){if(getMainForm().DESCRIPTION.value&&getMainForm().DESCRIPTION.value.length>4E3){wfalert(ERROR_MSG3);return false}return true}function validateStatusDescLength(){if(getMainForm().STATUS_DESCRIPTION)if(getMainForm().STATUS_DESCRIPTION.value&&getMainForm().STATUS_DESCRIPTION.value.length>4E3){wfalert(ERROR_MSG4);return false}return true}
function validateTemplateFileAndName(){var fileName=getMainForm().file.value;if(fileName){var fileNameLen=fileName.length;if(fileNameLen>4){var lastFour=fileName.substring(fileNameLen-4);if(!(lastFour===".xml"||lastFour===".zip"||lastFour===".jar")){wfalert(FILE_ERROR_MSG);return false}}}return validateName()}function validateFileAndName(){var fileName=getMainForm().file.value;fileName=trim(fileName);if(!fileName||fileName===""){wfalert(FILE_ERROR_MSG);return false}return validateName()}
function validateFile(){var fileName=getMainForm().file.value;fileName=trim(fileName);if(!fileName||fileName===""){wfalert(FILE_ERROR_MSG);return false}return true}function validateNumeric(event){var myCode=event.keyCode;if(myCode===0||myCode===undefined)myCode=event.which;if(myCode>=48&&myCode<=57||myCode===13)event.returnValue=true;else event.returnValue=false;return event.returnValue}
function validateImportFile(){var fileName=getMainForm().file.value;if(fileName){var fileNameLen=fileName.length;if(fileNameLen>4){var lastFour=fileName.substring(fileNameLen-4);if(!(lastFour===".zip"||lastFour===".jar")){wfalert(FILE_ERROR_MSG);return false}}}else{wfalert(FILE_ERROR_MSG);return false}return true}function validateCreatePosting(){var message=getMainForm().message.value;if(message===""){wfalert(MESSAGE_ERROR_MSG);return false}return true}
function validateTemplateAndName(){var template=getMainForm().template.value;if(template===""){wfalert(TEMPLATE_ERROR_MSG);return false}return validateName()}function validateProjectTemplateAndName(){var template=getMainForm().projectTemplate.value;if(template===""){wfalert(TEMPLATE_ERROR_MSG);return false}return validateName()}
function validateTemplateName(){var name=getMainForm().templateName.value;name=trim(name);if(name===""){wfalert(ERROR_MSG);getMainForm().templateName.value=name;getMainForm().templateName.focus();return false}return true}function validateSelected(isSelectRequired,tableID,elemAddress){if(elemAddress&&elemAddress!=="none")return true;if(isSelectRequired&&!isSomethingChecked(tableID)&&tableID&&tableID!=="null"){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");return false}return true}
function validate_Checkout_Action(){if(this.req.readyState==4)if(this.req.status==200){var resText=this.req.responseText;if(resText.indexOf("NON_LATEST_ITERATION")>=0)this.shouldContinue=JCAConfirm("com.ptc.windchill.enterprise.wip.WIPResource.NON_LATEST_ITERATION")}return shouldContinue}
PTC.validation.deleteObjectsValidation=function(event){var selRows=PTC.jca.table.Utils.getSelectedItmesByEvent(event);if(selRows===null||selRows.length===0){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");return false}else return JCAConfirm(event,"com.ptc.netmarkets.util.utilResource.CONFIRM_DELETE_WITH_NUM",[selRows.length])};
var VARIANTSPEC=function(){return{validateSpecCompareAction:function(event){var tID=tableUtils.findTableID(event);var sels=[];if(tID)sels=getJCASelectedTableItems(tID);if(sels.length!=2){JCAAlert("com.ptc.windchill.option.variantspec.variantspecResource.COMPARESPEC_SELECTERROR");try{Event.stop(event)}catch(e){}return false}return true},resetCompareSpecTitle:function(){PTC.onReady(function(){document.title=getBundleStringAndInserts("com.ptc.wpcfg.wpcfgActionsRB.PRIVATE_CONSTANT_81",[])})}}}();
var LOGIC_COMPARE=function(){return{validateLogicCompareAction:function(event){var result=true;var tableID=tableUtils.findTableID(event);if(tableID!==null&&tableID!=="undefined"&&tableID!==undefined){var selections=getJCASelectedTableItems(tableID);result=selections.length==2;if(!result){JCAAlert("com.ptc.windchill.option.variantspec.variantspecResource.COMPARELOGIC_SELECTERROR");try{Event.stop(event)}catch(e){}}}return result}}}();
PTC.jca.verticalScrollTip=function(config){this.gridPanel=config.gridPanel;this.verticalScrollTip=new Ext.ToolTip({target:this.gridPanel.getView(),width:150,dismissDelay:700,scrollTip:""});this.gridPanel.vtip=this;this.verticalScrollTip.on("beforeshow",PTC.jca.verticalScrollTip.onBeforeShow);this.verticalScrollTip.on("render",PTC.jca.verticalScrollTip.onRender)};
PTC.jca.verticalScrollTip.onRender=function removeAnchorCls(){var anchorEI=this.anchorEl;if(anchorEI)anchorEI.removeClass(["x-tip-anchor",this.anchorCls])};PTC.jca.verticalScrollTip.onBeforeShow=function updateTipBody(tip){if(tip.body===undefined||tip.body===null)tip.html=tip.scrollTip;else tip.body.dom.innerHTML=tip.scrollTip};
PTC.jca.verticalScrollTip.getTipTextFromCell=function(table,columnId,row,cell){var visibleCellGui=cell.gui;var cellValue=visibleCellGui?visibleCellGui.html||visibleCellGui.comparable:jsca.getComparable(cell);if(!cellValue||!Ext.isString(cellValue))cellValue=jsca.columns.getJSCASearchText(table,columnId,row);return cellValue};
PTC.jca.verticalScrollTip.prototype.updateVerticalScrollTip=function(scrollLeft,scrollTop){var MAX_TOOLTIP_SIZE=150;if(this.gridPanel.vtip.verticalScrollTip.disabled||scrollTop<1)return;var gridView=this.gridPanel.getView();var rowStore=this.gridPanel.getStore();var visibleRowsCount=gridView.getVisibleRowCount();var totalRows=rowStore.getCount();var scroller=gridView.scroller;if(gridView.isLocked)scroller=gridView.lockedScroller;var adjScrollTop=scroller.getHeight()/this.gridPanel.getInnerHeight();
scrollTop=scrollTop*adjScrollTop;var adjScrollTopFactor=totalRows/(visibleRowsCount-1);var scrollTopToIncrease=0;if(adjScrollTopFactor>0)scrollTopToIncrease=scrollTop/adjScrollTopFactor;var firstVisibleRowIdx=PTC.jca.table.scroll.getFirstVisibleRowIdx(gridView,scrollTop);var columnDisplay=PTC.jca.table.scroll.getVerticalScrollTipColumnId(this.gridPanel,this.gridPanel.initialConfig.jcaTableConfig.tableID);if(columnDisplay===null)return;var visibleRow=this.gridPanel.getStore().getAt(firstVisibleRowIdx);
if(!visibleRow)return;var visibleCell=visibleRow.get(columnDisplay);if(!visibleCell)return;var cellValue=PTC.jca.verticalScrollTip.getTipTextFromCell(this.gridPanel,columnDisplay,visibleRow,visibleCell);if(!cellValue||!Ext.isString(cellValue))return;var unescapeHTMLCellValue=PTC.util.unescapeHTML(cellValue);if(unescapeHTMLCellValue&&unescapeHTMLCellValue.length>MAX_TOOLTIP_SIZE)cellValue=unescapeHTMLCellValue.substring(0,MAX_TOOLTIP_SIZE);this.verticalScrollTip.scrollTip=cellValue;var toolTipx=scroller.getX()+
this.gridPanel.getOuterSize().width-170;var toolTipy=scroller.getY()+scrollTopToIncrease;this.verticalScrollTip.showAt([toolTipx,toolTipy])};PTC.jca.verticalScrollTip.prototype.destroy=function(){this.gridPanel=undefined;Ext.destroy(this.verticalScrollTip);delete this.verticalScrollTip};var vizObj={};function createVisNav(parentDiv){var parent=document.getElementById(parentDiv);var returned=false;if(parent!=null)returned=true;return returned}
function createVisNavWithIframe(parentDiv,frameId){var parent=document.getElementById(parentDiv);var returned=false;if(parent!=null){var iframe=document.getElementById(frameId);if(iframe==null)parent.innerHTML='<iframe style="width: 100%;height: 100%;" id="'+frameId+'" name="'+frameId+'" frameBorder="0" scrolling="no"  ></iframe>';returned=true}return returned}
function visNavAjaxCall(url){var xmlhttp=newHttp();xmlhttp.open("POST",url,false);setHeaders(xmlhttp);xmlhttp.send(null);return xmlhttp.responseText}
function loadInPVPanel(parentDiv,url){var response=visNavAjaxCall(url);var parent=document.getElementById(parentDiv);if(parent!=null){var vizPanel="vizPanel";vizObj[vizPanel]=parent.id;parent.innerHTML=response;var scripts,scriptsFinder="<script[^>]*>([\\S\\s]*?)<\/script>";var myregexp=new RegExp(scriptsFinder,"gi");while(scripts=myregexp.exec(response)){var jsBlock=scripts[1];eval(jsBlock)}}}
function loadInPVPanelInIframe(frameId,url){var response=visNavAjaxCall(url);var frame=document.getElementById(frameId);frame.src="netmarkets/jsp/cat/viz.jsp?"+url}PTC.wip={};PTC.wip.actions=["checkout","checkin","editcheckin","undocheckout"];
PTC.wip.checkoutsTableObjectsAffectedWrapper=function(original,formResult){if(formResult&&(!formResult.afterActionHandled||formResult.afterActionHandled[this.id]!==true))if(formResult.actionName==="undocheckout"||formResult.actionName==="list_undocheckout"||formResult.actionName==="checkin"||formResult.actionName==="editCheckin"){var oids=formResult.getUpdatedOids();oids=oids.concat(formResult.getLocations());oids=oids.uniq();var recs=PTC.jca.table.Utils._getRecordsFromOids(this,oids,formResult);
if(recs.length>0&&this.getStore())this.getStore().remove(recs);return true}else if(formResult.actionName==="checkout"){var added_new_rows=formResult.getUpdatedOids();if(added_new_rows.length>0){clearActionFormData();rowHandler.addRows(added_new_rows,this.id,null,{doAjaxUpdate:true,addSorted:true})}return true}return original.call(this,formResult)};
PTC.wip.checkoutsTableAfterActionWrapper=function(original,formResult){PTC.wip.checkoutsTableObjectsAffectedWrapper.call(this,original,formResult);var handled=PTC.wip.actions.indexOf(formResult.actionName)>=0;formResult.afterActionHandled=formResult.afterActionHandled||{};formResult.afterActionHandled[this.id]=handled;return!handled};
PTC.wip.addCheckoutTableListeners=function(table){table.onObjectsAffected=table.onObjectsAffected.wrap(PTC.wip.checkoutsTableObjectsAffectedWrapper);table.onAfterAction=table.onAfterAction.wrap(PTC.wip.checkoutsTableAfterActionWrapper)};PTC.wip.validateMultiCheckout=function(event){return PTC.wip.validateMultiWIPAction(event,"com.ptc.windchill.enterprise.wip.WIPResource.CHECK_OUT_CONFIRM")};PTC.wip.validateMultiUndoCheckout=function(event){return PTC.wip.validateMultiWIPAction(event,"com.ptc.windchill.enterprise.wip.WIPResource.UNDO_CHECK_OUT_CONFIRM")};
PTC.wip.validateMultiWIPAction=function(event,confirmationKey){var nItemsSelected=event.jcacontainer.getSelectionModel().selections.getCount();if(nItemsSelected==0){JCAAlert("com.ptc.netmarkets.util.utilResource.NONE_CHECKED");return false}else return JCAConfirm(event,confirmationKey)};PTC.onAvailable("checkedout.work.table",PTC.wip.addCheckoutTableListeners);
function setFormEncTypeIfFile(mform){var sels=mform.getElementsByTagName("input");if(sels){var alength=sels.length;for(var i=0;i<alength;i++)if(sels[i].type=="file"){var docName=sels[i].value;if(docName&&docName.length>2&&!sels[i].disabled){mform.enctype="multipart/form-data";mform.encoding="multipart/form-data"}}}}
function gotoStep(step){if(callUserSubmitFunction()){clearActionFormData();clearDialogFormData();var mform=getMainForm();mform.new_wizard_step.value=step;setFormEncTypeIfFile(mform);mform.submit()}}function JCADChangeAButton(button,disabledvalue){if(typeof button==="string")button=Ext.getCmp(button);if(button){if(disabledvalue)button.disable();else button.enable();button.needsReset=false}}
function disableButtons(newValue){if(newValue===null||newValue===undefined)newValue=true;var buttons=["PJL_wizard_ok","PJL_wizard_apply","PJL_wizard_cancel","PJL_wizard_previous","PJL_wizard_next","PJL_wizard_revert"];buttons.each(function(item){JCADChangeAButton(item,newValue)})}function okClicked(){if(getMainForm().okButton.disabled)return false;else{disableButtons();return true}}function enableButtons(){disableButtons(false)}function clearIt(){this.getMainForm().APPLY.value="yes"}var locationSelectHiddenElem;
var folderLocation;function executeCancel(anEvent){if(window.opener&&window.opener!=window&&currentStepStrName){PTC.action.setWindowSizeCookie();PTC.jca.table.stickiness.clearAllTablesStickiness()}}
function launchFolderPickerCallbackFunction(contextValues){var dispLocation=contextValues.displayLocation;var context=contextValues.contextName;var contextId=contextValues.contextId;var folderOID=contextValues.folderOID;PTC.wizard.log.debug("launchFolderPickerCallbackFunction - folder picker picked context values: ",Ext.encode(contextValues));locationSelectHiddenElem.value=folderOID.substr(3);folderLocation.value=dispLocation;PTC.wizard.saveTableData.saveToStore(folderLocation);folderLocation.setAttribute("ext:qtip",
dispLocation)}function createLocationPickerURL(url){var newUrl="";if(document.getElementById("containerRef")&&url.indexOf("containerVisibilityMask")<0)newUrl+="&containerVisibilityMask="+document.getElementById("containerRef").value;var locationSelectVal=document.getElementsByName(locationSelectHiddenElem.name)[0];if(locationSelectVal)newUrl+="&LocationSelect="+locationSelectVal.value;return newUrl}
function launchFolderPicker(url,myLoc,locationSelectHiddenFieldName){var fields=document.getElementsByName(locationSelectHiddenFieldName);folderLocation=myLoc;if(fields)locationSelectHiddenElem=fields[0];var urlStr=createLocationPickerURL(url);PTC.wizard.log.debug("launchFolderPicker - folder picker URL: ",urlStr);launchABrowseMenu(url,myLoc,launchFolderPickerCallbackFunction,urlStr)}var IFRAME_BEGIN_ID="popCreateWizard_";
PTC.wizardIframes=function(){var iframeId="";var useOrigIframeId=false;var restoreIframeOnClose=false;var getAcionURLParams=function(options){var url=options.form.action;return Ext.urlDecode(URL_utils.getParams(url))};var iframeExist=function(){var iframe=getIframe();if(iframe&&iframe!==null)return true;return false};var setDeactivateOptions=function(){var iframeExists=iframeExist();restoreIframeOnClose=iframeExists;PTC.lightbox.setDeactivateOptions({afterJs:PTC.wizardIframes.closeHandler,reloadParent:false,
saveContent:iframeExists,cleanUpTables:false})};var beforeWizardLoad=function(){setDeactivateOptions();if(restoreIframeOnClose){var win=PTC.wizardIframes.getIframeWindow();PTC.wizardIframes.historyManager.saveWizardState(win)}};var getIframe=function(){var isLightBox=PTC.lightbox.isLightbox(self);var win=self;if(isLightBox)win=PTC.lightbox.getParentWindow();var iframe=win.document.getElementById(iframeId);return iframe};var getIframeId=function(origFunction){if(useOrigIframeId)return origFunction();
if(iframeId!=="")return iframeId;var activateOptions=PTC.lightbox.activateOptions;if(activateOptions&&activateOptions.form){var params=getAcionURLParams(activateOptions);if(params&&params.isIframeWizard==="true"){if(params.resizeIframeWizard==="false")resizeIframeWizard=false;if(params.mode==="CREATE")iframeId=IFRAME_BEGIN_ID+"CREATE"+(new Date).getTime();else if(params.oid){var oid=params.oid.length===2?params.oid[0]:params.oid;oid=encodeURIComponent(oid);iframeId=addIframeIdPrefix(oid)}if(iframeId!==
""){beforeWizardLoad();return iframeId}}}return origFunction()};var addIframeIdPrefix=function(iframeId){return iframeId.indexOf(IFRAME_BEGIN_ID)===0?iframeId:IFRAME_BEGIN_ID+iframeId};var wrapSetOptions=function(original,options){var iframeOptions={};if(options)Object.extend(iframeOptions,options);iframeOptions.closable=true;var params=getAcionURLParams(iframeOptions);if(params&&params.resizeIframeWizard==="false"){var parentHeight=getWindowHeight();iframeOptions.height=parentHeight*0.98;var parentWidth=
getWindowWidth();iframeOptions.width=parentWidth*0.98;iframeOptions.resizable=false;iframeOptions.positionInCenter=true;PTC.lightbox.resizeOptions.resizingParentWindow=true;PTC.lightbox.resizeOptions.resizeHeightWithWindow=true;PTC.lightbox.resizeOptions.resizeWidthWithWindow=true}original(iframeOptions)};return{isSubmit:false,removeIframes:function(original){PTC.lightbox.lbContentWindow.clear();PTC.navigation.removeIframes(document,false,false);Ext.garbageCollect();if(original)original()},initStoreIframes:function(){clearInterval(Ext.Element.collectorThreadId);
PTC.lightbox.getLightboxWindowId=PTC.lightbox.getLightboxWindowId.wrap(getIframeId);PTC.lightbox.setOptions=PTC.lightbox.setOptions.wrap(wrapSetOptions);PTC.lightbox.handleSubmitResult=PTC.lightbox.handleSubmitResult.wrap(PTC.wizardIframes.handleSubmitResult);wfWindowClose=wfWindowClose.wrap(PTC.wizardIframes.removeIframes);deleteDownstreamFormContent=deleteDownstreamFormContent.wrap(PTC.wizardIframes.submitHandler.deleteDownstreamFormContent)},getWizardIframeId:function(){return iframeId},handleSubmitResult:function(originalHandle,
status,nextAction,js,URL,dynamicRefreshInfo){if(PTC.lightbox&&!PTC.lightbox.isLightbox(getWindow())&&iframeId==="")useOrigIframeId=true;originalHandle(status,nextAction,js,URL,dynamicRefreshInfo);useOrigIframeId=false},closeHandler:function(){if(restoreIframeOnClose&&!PTC.wizardIframes.isSubmit){var win=PTC.wizardIframes.getIframeWindow();PTC.wizardIframes.historyManager.restoreWizardState(win)}iframeId="";useOrigIframeId=false;restoreIframeOnClose=false;PTC.wizardIframes.isSubmit=false},getIframeWindow:function(){var iframe=
getIframe();var iframeWindow=null;if(iframe&&iframe!==null)iframeWindow=iframe.contentWindow;return iframeWindow},setInitialStepActive:function(win){if(win.steps)win.PTC.wizard.setActiveStep(win.steps[0])},removeIframe:function(oid){var currentIframeId=iframeId;iframeId=oid;if(oid.indexOf(":")>0)iframeId=encodeURIComponent(oid);iframeId=addIframeIdPrefix(iframeId);var iframe=Ext.getDom(iframeId);if(iframe&&iframe.contentWindow)PTC.lightbox.deactivate({lbWindow:iframe.contentWindow,saveContent:false});
iframeId=currentIframeId}}}();
PTC.wizardIframes.submitHandler=function(){var wizardProperties={storeIframes:false};var serializeIframes=function(iframes){var iframeDiv=appendIframeDiv("wizardIframesDiv");var level=0;var html="";for(var i=0,l=iframes.length;i<l;i++)if(isIframeWizard(iframes[i])){level++;var params=submitIframeForm(iframes[i],level,html);html=getChildIframes(params.iframeDoc,level,params.html)}PTC.navigation.overwrite(iframeDiv,html)};var getChildIframes=function(iframeDoc,level,html){if(iframeDoc){var innerIframes=iframeDoc.getElementsByTagName("iframe");
var newLevel=0;for(var i=0,l=innerIframes.length;i<l;i++)if(isIframeWizard(innerIframes[i])){newLevel++;var params=submitIframeForm(innerIframes[i],level+"."+newLevel,html);html=params.html}}return html};var isIframeWizard=function(element){var id=element.id;var iframeDoc="";if(id){var index=id.indexOf(IFRAME_BEGIN_ID);if(index===0&&element.tagName==="IFRAME")return true}return false};var submitIframeForm=function(element,level,html){var id=element.id;var params=[];params.iframeDoc="";params.html=
"";if(id){var index=id.indexOf(IFRAME_BEGIN_ID);if(index===0&&element.tagName=="IFRAME"){params.iframeDoc=element.contentWindow.document;var inputId=level+"_"+id;var v=params.iframeDoc.getElementById("iframeId");if(v)v.setAttribute("name",v.id);var mform=params.iframeDoc.getElementById("mainform");params.html=html+getIframeHiddenInput(inputId,Ext.lib.Ajax.serializeForm(mform))}}return params};var getIframeHiddenInput=function(id,value){var html='<input type="hidden" name="'+id+'" id="'+id+'" value="'+
value+'">';return html};var appendIframeDiv=function(id){var div=$(id);if(!div){var newDiv=document.createElement("div");newDiv.id=id;newDiv.style.display="none";var mform=getMainForm();mform.appendChild(newDiv);return $(id)}return div};var wrapWfWindowClose=function(){var closeOptions={lbWindow:self};if(parent.PTC.wizardIframes.isSubmit)closeOptions.saveContent=true;PTC.lightbox.deactivate(closeOptions)};return{initWizard:function(options){var params=location.search.parseQuery();var storeIframes=
params.isIframeWizard?true:false;if(storeIframes){clearInterval(Ext.Element.collectorThreadId);wizardProperties={storeIframes:storeIframes,updateRow:true,updateRowParentForm:false};if(options)Object.extend(wizardProperties,options);wfWindowClose=wfWindowClose.wrap(wrapWfWindowClose);isWizardWindow=TRUE_FUNC;PTC.wizard.focusOnReadyFunc()}},storeFormAsIframe:function(){return wizardProperties.storeIframes},submitIframe:function(){goProgress();clearActionFormData();resetIEButtons();var parentWin=PTC.lightbox.getParentWindow();
var iframeId=parentWin.PTC.wizardIframes.getWizardIframeId();var mform=getMainForm();appendFormHiddenInput(mform,"iframeId",iframeId);stopProgress();enableButtons();resetNextBackButton(currentStepStrName);isApply=false;PTC.wizardIframes.setInitialStepActive(self);var iframeForm=Ext.lib.Ajax.serializeForm(mform);parentWin.PTC.wizardIframes.submitHandler.handleUpdate(iframeForm,wizardProperties.updateRow,wizardProperties.updateRowParentForm);wfWindowClose();return false},handleUpdate:function(wizardForm,
updateRow,updateRowParentForm){var iframeId=PTC.wizardIframes.getWizardIframeId();var list=[this.convertURLIframeOid(iframeId)];var tableId=iframeTableId;var params;if(updateRowParentForm){var openerForm=Ext.lib.Ajax.serializeForm(getMainForm());params={doAjaxUpdate:true,preventDuplicates:true,iframeForm:openerForm}}else params={doAjaxUpdate:true,preventDuplicates:true,iframeForm:wizardForm};if(updateRow)PTC.wizardIframes.submitHandler.updateIframeRow(list,tableId,params);PTC.wizardIframes.isSubmit=
true},updateIframeRow:function(list,tableId,params){rowHandler.updateRows(list,tableId,params)},removeIframeRowElement:function(oid,tableID,deleteIframe){rowHandler.removeRows([oid],tableID,true);if(deleteIframe)PTC.wizardIframes.removeIframe(oid)},checkForIframes:function(){var iframes=getWindow().document.getElementsByTagName("iframe");if(iframes&&iframes.length>0)serializeIframes(iframes)},deleteDownstreamFormContent:function(orig){var status=orig();var iframes=getWindow().document.getElementsByTagName("iframe");
if(iframes&&iframes.length>0)for(var i=0,l=iframes.length;i<l;i++){var iframe=iframes[i];if(isIframeWizard(iframe))PTC.wizardIframes.removeIframe(iframe.id)}return status},convertURLIframeOid:function(iframe_id){var oid=iframe_id;if(oid.indexOf(IFRAME_BEGIN_ID)===0&&oid.indexOf("CREATE")<0){oid=oid.substring(IFRAME_BEGIN_ID.length);if(oid.indexOf("%3A")>0)oid=decodeURIComponent(oid)}return oid}}}();
PTC.wizardIframes.historyManager=function(){var TAGS=["INPUT","SELECT","TEXTAREA"];var DRIVER_ATTRIBUTES_PANE="driverAttributesPane";var READ_ONLY_DRIVER_ATTRIBUTES_PANE="readOnlyDriverAttributesPane";var formFields=new Ext.util.MixedCollection;var savedTables=new Ext.util.MixedCollection;var getId=function(obj){var id=obj.name&&obj.name!==null&&obj.name!==""?obj.name:obj.id;return id};var copyFromElement=function(dest,element,propMap){dest={readOnly:{},props:{}};propMap.props.each(function(prop){dest.props[prop]=
element[prop]});propMap.readOnly.each(function(prop){dest.readOnly[prop]=element[prop]});return dest};var copyToElement=function(element,source){for(var prop in source.props)if(source.props.hasOwnProperty(prop))element[prop]=source.props[prop];return element};var disableDriverAttributes=function(win){var objectHandle=win.PTC.wizard.getCurrentObjectHandle();var div=win.document.getElementById(objectHandle+DRIVER_ATTRIBUTES_PANE);var readOnlyId=objectHandle+READ_ONLY_DRIVER_ATTRIBUTES_PANE;if(div&&
!win.document.getElementById(readOnlyId)){div.style.display="none";var url=win.PTC.wizardIframes.historyManager.readonlyDriverAttributeURL;if(url){var newDiv=win.document.createElement("div");newDiv.id=readOnlyId;div.parentNode.insertBefore(newDiv,div);if(objectHandle)url+="?currentObjectHandle="+objectHandle;win.refreshElement(readOnlyId,url)}}};var saveFormFields=function(doc){var formFieldMap=new Ext.util.MixedCollection;TAGS.each(function(tag){var inputs=doc.getElementsByTagName(tag);var inputs_length=
inputs.length;for(var i=0;i<inputs_length;i++){var input=inputs[i];var readOnlyProps=["type","id","name"];var props=["value"];if(tag==="INPUT"&&input.type&&(input.type==="checkbox"||input.type==="radio"))props.push("checked");else if(tag==="SELECT")props.push("selectedIndex");var obj=copyFromElement({},input,{readOnly:readOnlyProps,props:props});var id=getId(obj.readOnly);if(id&&id!==null&&id!=="")if(formFieldMap.containsKey(id)){var currentObject=formFieldMap.get(id);if(!Ext.isArray(currentObject)){var objects=
[];objects.push(currentObject);currentObject=objects}currentObject.push(obj);formFieldMap.replace(id,currentObject)}else formFieldMap.add(id,obj)}});return formFieldMap};var restoreFormFields=function(doc,formFieldMap,doCleanUp){TAGS.each(function(tag){var inputs=doc.getElementsByTagName(tag);var inputs_length=inputs.length;for(var i=0;i<inputs_length;i++){var input=inputs[i];var id=getId(input);if(id&&formFieldMap.containsKey(id)){var obj=formFieldMap.get(id);if(Ext.isArray(obj)){var temp=obj.shift();
formFieldMap.replace(id,obj);if(obj.length===0)formFieldMap.removeKey(id);obj=temp}else formFieldMap.removeKey(id);input=copyToElement(input,obj)}else if(doCleanUp&&input.type&&input.type==="hidden")input.value=""}})};var saveTableState=function(win){var tables=win.PTC.jca.table.Utils.getExtTables();tables.each(function(table){table.getSelectionModel().clearSelections();var dataItems=[];var rowData=win.PTC.jca.table.Utils.getRowData(table);rowData.each(function(item){dataItems.push(item)});var isFullList=
true;var isPagedList=true;var fullList=getFullList(table,table.jcaTableConfig.fullList);if(fullList)isFullList=fullList.hidden;var pagedList=getPagedList(table,table.jcaTableConfig.pagedList);if(pagedList)isPagedList=pagedList.hidden;var savedTable={dataItems:dataItems,pageSize:0,totalRecords:0,start:0,savedData:null,hiddenFullList:isFullList,hiddenPagedList:isPagedList};var toolBar=table.getBottomToolbar();if(toolBar){savedTable.pageSize=toolBar.pageSize?toolBar.pageSize:-1;savedTable.totalRecords=
toolBar.store?toolBar.store.totalLength:0;savedTable.start=toolBar.cursor&&toolBar.cursor!==0?toolBar.cursor:0}var tableElement=win.document.getElementById(table.id);var savedData=[];if(tableElement.SAVE_DIV){var saveObj=tableElement.SAVE_DIV;var savedNodes=saveObj.childNodes;savedNodes.each(function(node){savedData.push(node)})}savedTable.savedData=savedData;savedTables.add(table.id,savedTable)})};var restoreTableState=function(win){var tables=win.PTC.jca.table.Utils.getExtTables();tables.each(function(table){if(savedTables.containsKey(table.id)&&
table.id!=="attributesTable"){var params={win:win,table:table,savedTable:savedTables.get(table.id)};restorePagedData(win,table,params);restoreRows(params)}})};var restorePagedData=function(win,table,params){if(params.savedTable.savedData){var tableElement=win.document.getElementById(table.id);if(tableElement.SAVE_DIV){var saveObj=tableElement.SAVE_DIV;var savedNodes=saveObj.childNodes;savedNodes.each(function(node){if(node)saveObj.removeChild(node)});var restoreData=params.savedTable.savedData;restoreData.each(function(node){saveObj.appendChild(node)})}}};
var restoreRows=function(params){var table=params.table;var savedTable=params.savedTable;var win=params.win;var clonedTableData=null;table.getSelectionModel().clearSelections();if(savedTable.pageSize>0){var o={records:savedTable.dataItems,success:true,totalRecords:savedTable.totalRecords};var toolBar=table.getBottomToolbar();var options={params:{limit:savedTable.pageSize,start:savedTable.start,aquire:"row"},callback:function(){var fullList=getFullList(table,table.jcaTableConfig.fullList);if(fullList)if(savedTable.hiddenFullList)fullList.hide();
else fullList.show();var pagedList=getPagedList(table,table.jcaTableConfig.pagedList);if(pagedList)if(savedTable.hiddenPagedList)pagedList.hide();else pagedList.show()}};toolBar.pageSize=savedTable.pageSize;table.store.loadRecords(o,options,true)}else{table.store.removeAll();table.store.fireEvent("remove",table.store,[],0);table.store.add(savedTable.dataItems)}};var getFullList=function(table){return getList(table,table.jcaTableConfig.fullList)};var getPagedList=function(table){return getList(table,
table.jcaTableConfig.pagedList)};var getList=function(table,config){var toolBar=table.getBottomToolbar();var list;if(config){var idx=config.id||config.tooltip;if(toolBar.items.containsKey(idx))list=toolBar.items.get(idx)}return list};var reset=function(){formFields.clear();savedTables.clear()};var clearTableRows=function(win){var tables=win.PTC.jca.table.Utils.getExtTables();tables.each(function(table){if(savedTables.containsKey(table.id)&&table.id!=="attributesTable")table.store.removeAll()})};var cleanUpTable=
function(win){var tables=win.PTC.jca.table.Utils.getExtTables();tables.each(function(table){table.getSelectionModel().clearSelections()})};return{readonlyDriverAttributeURL:null,saveWizardState:function(win){goProgress();reset();disableDriverAttributes(win);formFields=saveFormFields(win.document);saveTableState(win);clonedTableData=win.PTC.util.tableDataManager.cloneTableData();stopProgress()},restoreWizardState:function(win){goProgress();clearTableRows(win);PTC.wizardIframes.setInitialStepActive(win);
restoreTableState(win);restoreFormFields(win.document,formFields,true);cleanUpTable(win);win.PTC.util.tableDataManager.replaceTableData(clonedTableData);reset();stopProgress()}}}();PTC.wizard.isReady=true;PTC.wizard.log=log4javascript.getLogger("PTC.wizard");PTC.wizard.ITIID="itemTypeInstanceId";PTC.wizard.loadAttributeTableURL=null;PTC.wizard.attributePanelMask=null;if(!("wizardSteps"in window))wizardSteps=[];PTC.wizard.finished=false;incompleteSteps=0;isApply=false;currentStepStrName="";
var nextStep=null;var stepIndex=0;var startStep;var formSubmitted=false;var isWizardType=false;var wizardTypeValue="";PTC.wizard.NEW_ROW_OBJ="newRowObj";PTC.wizard.addNewRow=function(tableId){var oids=[PTC.wizard.NEW_ROW_OBJ+PTC.util.getUniqueId()];rowHandler.addRows(oids,tableId,null,{doAjaxUpdate:true})};Ext.apply(PTC.wizard,new Ext.util.Observable);
PTC.wizard.addEvents("wizardLoadComplete","wizardStepReady","beforeReloadStep","afterReloadStep","afterTypePickerChange","afterHandleDynamicRefreshInfo","beforeLoadAttributeTable","afterLoadAttributeTable");function doNothing(){return true}
anyEditableFields=function(parent){var tagNames=["select","input","textarea","button"];var lengthJ=tagNames.length;for(var j=0;j<lengthJ;j++){var elements=parent.getElementsByTagName(tagNames[j]);if(elements){var length=elements.length;for(var i=0;i<length;i++){var element=elements[i];if(!containsClass(element,"hidden")&&element.type!="hidden"&&!element.disabled)return true}}}elements=parent.getElementsByTagName("a");if(elements){length=elements.length;for(i=0;i<length;i++){element=elements[i];if(containsClass(element,
"toolbariconfont")&&!containsClass(element,"hidden"))return true}}return false};
function getWindowHeight(){var windowHeight=0;var win=getWindow();try{if(typeof win.innerHeight=="number")windowHeight=win.innerHeight;else if(win.document.documentElement&&win.document.documentElement.clientHeight)windowHeight=win.document.documentElement.clientHeight;else if(win.document.body&&win.document.body.clientHeight)windowHeight=win.document.body.clientHeight}catch(e){PTC.wizard.log.debug("JS Exception calling getWindowHeight",e)}PTC.wizard.log.debug("getWindowHeight: height: ",windowHeight);
return windowHeight}PTC.wizard.getWizardStepBodyHeight=function(){var windowHeight=getWindowHeight()*0.98;var embeddedHelpHeight=$("embeddedHelp")?$("embeddedHelp").offsetHeight:0;windowHeight=Math.floor(windowHeight);if(windowHeight<400)windowHeight-=4;var wizardPaddingHeight=PTC.wizard.getContentAreaPaddingHeight();var calculatedHeight=windowHeight-wizardPaddingHeight-embeddedHelpHeight;return calculatedHeight};
function adjustWizardContentAreaHeight(){if(window.steps){var contentAreaDiv=$(currentStepStrName);var calculatedHeight=PTC.wizard.getWizardStepBodyHeight();if(calculatedHeight>0&&contentAreaDiv)contentAreaDiv.style.height=parseInt(calculatedHeight,10)+"px";PTC.jca.table.Utils.adjustTableHeight(contentAreaDiv);PTC.wizard.StepLinksPanelUtil.fireBodyResizeEvent()}}
function updateWizardContentHeader(){var step=$(currentStepStrName+"stepTitleDiv");if(step&&$("wizardContentHeader")){var stepTitle=step.innerText?step.innerText:step.textContent;$("wizardContentHeader").innerHTML=stepTitle}}function getStyleFromId(id){var object=$(id);if(object&&object.style)return object.style;else if(object)return object}
function wizardStep(json){this.isAsync=false;if(json.preloadJS)json.preloadJS=PTC.util.convertStringToFunc(json.preloadJS);else json.preloadJS=doNothing;if(json.postloadJS)json.postloadJS=PTC.util.convertStringToFunc(json.postloadJS);else json.postloadJS=doNothing;if(json.afterJS)json.afterJS=PTC.util.convertStringToFunc(json.afterJS);else json.afterJS=doNothing;Ext.applyIf(this,json);if(this.required===true){this.isComplete=false;incompleteSteps++}else this.isComplete=true;this.visited=false;this.isDirty=
!json.preloadPage;this.label=json.label;this.embeddedHelp=json.embeddedHelp}
function updateEmbeddedText(){var steps_length=steps.length;for(var i=0;i<steps_length;i++)if(currentStepStrName==steps[i]){var embeddedHelpDiv=document.getElementById("embeddedHelp");if(wizardSteps[steps[i]].embeddedHelp=="null"){embeddedHelpDiv.style.visibility="hidden";getStyleFromId("embeddedHelp").display="none"}else{embeddedHelpDiv.style.visibility="visible";getStyleFromId("embeddedHelp").display="block";embeddedHelpDiv.innerHTML=wizardSteps[steps[i]].embeddedHelp}}}
function getWindowWidth(){var windowWidth=0;var win=getWindow();if(typeof win.innerWidth=="number")windowWidth=win.innerWidth;else if(win.document.documentElement&&win.document.documentElement.clientWidth)windowWidth=win.document.documentElement.clientWidth;else if(win.document.body&&win.document.body.clientWidth)windowWidth=win.document.body.clientWidth;return windowWidth}
PTC.wizard.getContentAreaPaddingHeight=function(){var totalHeight=0;var title=Ext.getDom("titleBar");var titleHeight=title?title.offsetHeight:0;var stepHeader=Ext.getDom("stephdr");var stepHeight=stepHeader?stepHeader.offsetHeight:0;var frame=Ext.query("#contentArea .x-box-tl")[0];var frameHeight=frame?frame.offsetHeight+2:0;var footer=Ext.getDom("footerPanel");var footerHeight=footer?footer.offsetHeight:0;totalHeight=stepHeight+titleHeight+footerHeight+frameHeight*2;return totalHeight};
function firstPreload(){return wizardSteps[steps[0]].preloadJS()}function lastAfterJS(){return wizardSteps[steps[stepIndex]].afterJS()}var findButtonByActionID=function(btnActionID){var footerPanel=Ext.getCmp("footerPanel");if(footerPanel)return footerPanel.fbar.findById(btnActionID)};function setBackButton(stepId){if(stepId==steps[0]){var prevBtn=findButtonByActionID("PJL_wizard_previous");prevBtn.disable()}else{prevBtn=findButtonByActionID("PJL_wizard_previous");prevBtn.enable()}}
function findStepIndex(id){var i=0;if("steps"in window){var steps_length=steps.length;for(i=0;i<steps_length;i++)if(steps[i]==id)return i}return-1}
function recalcIncomplete(){incompleteSteps=0;var steps_length=steps.length;for(var i=0;i<steps_length;i++)if(!wizardSteps[steps[i]].hidden)if(wizardSteps[steps[i]].required&&!wizardSteps[steps[i]].isComplete||wizardSteps[steps[i]].isDirty&&wizardSteps[steps[i]].required)incompleteSteps++;else if(wizardSteps[steps[i]].isAsync&&!wizardSteps[steps[i]].isComplete)incompleteSteps++;return incompleteSteps}
function disableOkButton(){var okButton=findButtonByActionID("PJL_wizard_ok");var applyButton=findButtonByActionID("PJL_wizard_apply");if(okButton)okButton.disable();if(applyButton)applyButton.disable()}function enableOkButton(){var okButton=findButtonByActionID("PJL_wizard_ok");var applyButton=findButtonByActionID("PJL_wizard_apply");if(okButton)okButton.enable();if(applyButton)applyButton.enable()}
function resetOkButton(){var incompleteSteps=recalcIncomplete();if(incompleteSteps>0)disableOkButton();else enableOkButton()}function resetNextBackButton(stepId){var stepState=PTC.wizard.getNextPrevious(stepId);var nextButton=findButtonByActionID("PJL_wizard_next");var prevButton=findButtonByActionID("PJL_wizard_previous");if(nextButton)if(!stepState.hasNext)nextButton.disable();else nextButton.enable();if(prevButton)if(!stepState.hasPrevious)prevButton.disable();else prevButton.enable()}
PTC.wizard.getNextPrevious=function(stepId){var stepState={hasPrevious:false,hasNext:false};var foundCurrent=false;var steps_length=steps.length;for(var i=0;i<steps_length;i++)if(!wizardSteps[steps[i]].hidden)if(stepId==steps[i])foundCurrent=true;else if(!foundCurrent)stepState.hasPrevious=true;else if(foundCurrent)stepState.hasNext=true;return stepState};var ajax={};
function getFormData(dom){var curUrl=window.location.href;var wizStepParams="";if(currentStepStrName)wizStepParams=URL_utils.getParams(wizardSteps[currentStepStrName].url);var returnData="";var mform=getMainForm(dom);if(mform){returnData=Ext.lib.Ajax.serializeForm(mform);returnData+=URL_utils.getParams(PTC.util.getFormAction(mform))}else returnData+=URL_utils.getParams(curUrl);returnData+=wizStepParams;return returnData}
function requestParamExists(param,url){if(param&&(url.indexOf("?"+param+"=")>=0||url.indexOf("&"+param+"=")>=0))return true;else return false}
function removeParamFromString(origParam,url){var param=origParam;var newURL=url;var withoutQMark=false;if(newURL&&newURL.indexOf("?")<0)withoutQMark=true;while(requestParamExists(origParam,url)){if(url.indexOf("?"+origParam+"=")>=0)param="?"+origParam+"=";else param="&"+origParam+"=";newURL=url.substring(0,url.indexOf(param));var afterParam=url.substring(url.indexOf(param)+1);if(afterParam){var endIndex=afterParam.indexOf("&");if(endIndex>0)if(newURL==="")newURL="?"+afterParam.substring(endIndex+
1);else if(newURL.indexOf("?")<0)if(withoutQMark)newURL="?"+newURL+"&"+afterParam.substring(endIndex+1);else newURL=newURL+"?"+afterParam.substring(endIndex+1);else newURL+=afterParam.substring(endIndex)}url=newURL}return newURL}
function getPageUrl(url,stepId,curUrl){if(!curUrl)curUrl=window.location.href;var originalParams=url.substring(url.indexOf("?")+1).toQueryParams();var additionalParams=curUrl.substring(curUrl.indexOf("?"));additionalParams=URL_utils.removeAnchor(additionalParams);if(originalParams.oid)additionalParams=removeParamFromString("oid",additionalParams);if(originalParams.portlet)additionalParams=removeParamFromString("portlet",additionalParams);CADX_PARAMS.each(function(param){if(originalParams[param])additionalParams=
removeParamFromString(param,additionalParams)});additionalParams=additionalParams.substring(additionalParams.indexOf("?")+1);if(additionalParams.endsWith("&"))additionalParams.substring(0,additionalParams.length-2);url=URL_utils.removeAnchor(url);var base=getBaseHref();if(url.charAt(0)==="/")url=url.substring(1);url=url.indexOf(base)===0?url:base+url;url=Ext.urlAppend(url,additionalParams);url=Ext.urlAppend(url,"stepId="+stepId+"&dynamicStepLoad=true");return url}
function reloadPane(div,stepId,iframeForm,successFunc,doAsync){if(div&&stepId&&wizardSteps&&stepId in wizardSteps)if(PTC.wizard.fireEvent("beforeReloadStep",stepId)!==false){var params=getFormData();if(iframeForm&&iframeForm.length>0)params=params+iframeForm;params=params+"&isWizard=true";if(typeof doAsync==="undefined")doAsync=false;var deferredSuccessFunc;if(typeof successFunc==="function")deferredSuccessFunc=function(){successFunc.defer(1,this,arguments)};getElementHtml(params,div,doAsync,getPageUrl(wizardSteps[stepId].url,
stepId),false,deferredSuccessFunc);PTC.wizard.fireEvent("afterReloadStep",stepId)}}
function getDownstreamFormElements(){var elementArr=[];var currentIdx=findStepIndex(currentStepStrName);var nSteps=steps.length;var tagNames=["select","input","textarea"];var nTags=tagNames.length;for(var si=currentIdx+1;si<nSteps;si++){var stepDiv=$(steps[si]);if(stepDiv)for(var ti=0;ti<nTags;ti++){var children=stepDiv.getElementsByTagName(tagNames[ti]);if(children){var nChildren=children.length;for(var ci=0;ci<nChildren;ci++)elementArr.push(children[ci])}}}return elementArr}
function setDownstreamFormElementsDisabled(val){if(isWizardType&&wizardTypeValue=="wizard"){var downstreamElements=getDownstreamFormElements();var nElements=downstreamElements.length;for(var ele=0;ele<nElements;ele++){downstreamElements[ele].cachedDisabledVal=downstreamElements[ele].disabled;downstreamElements[ele].disabled=val}}}
function resetDownstreamFormElementsDisabled(){if(isWizardType&&wizardTypeValue=="wizard"){var downstreamElements=getDownstreamFormElements();var nElements=downstreamElements.length;for(var ele=0;ele<nElements;ele++){if((downstreamElements[ele].disabled||downstreamElements[ele].disabled===false)&&(downstreamElements[ele].cachedDisabledVal||downstreamElements[ele].cachedDisabledVal===false))downstreamElements[ele].disabled=downstreamElements[ele].cachedDisabledVal;downstreamElements[ele].cachedDisabledVal=
null}}}function goProgress(){if(!("progressMessage"in window)||progressMessage==="")progressMessage=bundleHandler.get("com.ptc.core.ui.navigationRB.LOADING");var config={msg:progressMessage};PTC.wizard.loadMask=new Ext.LoadMask("wiz_step_contents",config);PTC.wizard.loadMask.show()}
function stopProgress(){steps.each(function(item){if(getStyleFromId(item+"Pane").display==="inline"){if(item!==currentStepStrName)getStyleFromId(item+"Pane").display="none"}else if(item===currentStepStrName)getStyleFromId(item+"Pane").display="inline"});if(PTC.wizard.loadMask)PTC.wizard.loadMask.hide();PTC.performance.stopWizardTimer(currentStepStrName)}
function resetIEButtons(){var buttons=document.getElementsByTagName("button");for(var i=0;i<buttons.length;i++)if(typeof buttons[i].needsReset!=="undefined"&&buttons[i].needsReset===true){buttons[i].disabled=false;buttons[i].needsReset=null}if(isApply)window.focus()}
function disableIEButtonsOnSubmit(){if(Ext.isIE6||Ext.isIE7){var buttons=document.getElementsByTagName("button");for(var i=0;i<buttons.length;i++)if(!buttons[i].disabled){buttons[i].disabled=true;buttons[i].needsReset=true}setTimeout(resetIEButtons,200)}}
PTC.wizard.enableWizardSpecificFields=function(){var i,wizardSpecificFormFields=[],form=getMainForm();var wizardSpecificParams=["wizardActionClass","wizardActionMethod","wizardValidationKey"];var wizardStepDelegates=Ext.DomQuery.jsSelect("input[name*=FormProcessorDelegate]");i=wizardStepDelegates.length;while(i--)wizardSpecificFormFields.push(wizardStepDelegates[i]);i=wizardSpecificParams.length;while(i--)if(form[wizardSpecificParams[i]])wizardSpecificFormFields.push(form[wizardSpecificParams[i]]);
i=wizardSpecificFormFields.length;while(i--)wizardSpecificFormFields[i].disabled=false;return wizardSpecificFormFields};PTC.wizard.setFormEncoding=function(){var mform=getMainForm(),sels=document.getElementsByTagName("input");var alength=sels.length;for(i=0;i<alength;i++)if(sels[i].type=="file"){var docName=sels[i].value;if(docName&&docName.length>2&&!sels[i].disabled){mform.enctype="multipart/form-data";mform.encoding="multipart/form-data"}}};
function isOKEnabled(){var okButton=findButtonByActionID("PJL_wizard_ok");if(okButton)return okButton.disabled===false;else return true}
function checkSubmitStatus(skipRequiredFieldValidation){var status=true;if(!skipRequiredFieldValidation)if(steps.length==1||wizardTypeValue=="wizard")status=PTC.wizard.checkRequired(false);else status=PTC.wizard.checkClerkRequired(false);if(!wizardSteps[currentStepStrName].afterJS("SUBMIT",status))status=false;if(status&&wizardSteps[currentStepStrName].afterServerVK)if(!PTC.validation.callAJAXValidation(wizardSteps[currentStepStrName].afterServerVK))status=false;if(status&&!callUserSubmitFunction())status=
false;return status}
PTC.wizard.submitWizard=function(config){config=config||{};Ext.applyIf(config,{finished:true,skipAllValidation:false,skipRequiredFieldValidation:false});var i,skipAllValidation=config.skipAllValidation,skipRequiredFieldValidation=config.skipRequiredFieldValidation,finished=config.finished;prepareToSubmitPopupForm(null);var mform=getMainForm();var savedEnctype=mform.enctype;var savedEncoding=mform.encoding;PTC.wizard.setFormEncoding();PTC.wizard.setURLForSubmit(mform);disableButtons();disableIEButtonsOnSubmit();
var status;var form=getMainForm();try{var wizardSpecificFormFields=PTC.wizard.enableWizardSpecificFields();if(skipAllValidation)status=true;else status=checkSubmitStatus(skipRequiredFieldValidation);PTC.wizard.finished=finished;if(typeof config.successFunc==="function")PTC.wizard.actionHandler=config.successFunc;else delete PTC.wizard.actionHandler;var isSubbmittingIframe=false;if(status&&PTC.wizardIframes.submitHandler.storeFormAsIframe()){PTC.wizardIframes.submitHandler.submitIframe();isSubbmittingIframe=
true}else if(status){goProgress();PTC.wizardIframes.submitHandler.checkForIframes();form.submit()}else{enableButtons();resetNextBackButton(currentStepStrName);isApply=false;PTC.wizard.finished=false;clearActionFormData()}}finally{mform.enctype=savedEnctype;mform.encoding=savedEncoding;i=wizardSpecificFormFields.length;if(!isSubbmittingIframe)while(i--)wizardSpecificFormFields[i].disabled=true}return status};
function onSubmitMain(skipAllValidation,skipRequiredFieldValidation){var params={skipAllValidation:skipAllValidation,skipRequiredFieldValidation:skipRequiredFieldValidation};return PTC.wizard.submitWizard(params)}
PTC.wizard.setURLForSubmit=function(mform){if(mform&&!mform.addedUrlWizardParams){var curUrl=getWindow().location.href;var curIdx=curUrl.indexOf("?");if(curIdx!=-1){var formAction=PTC.util.getFormAction(mform);if(formAction.indexOf("soid")>0)curUrl=removeParamFromString("soid",curUrl);curUrl=removeParamFromString("CSRF_NONCE",curUrl);if(!isIE||formAction.length+curUrl.length<2070){formAction+="&"+curUrl.substring(curIdx+1);PTC.util.setFormAction(mform,formAction)}else{var curlParams=$H(curUrl.substring(curIdx+
1).toQueryParams());curlParams.each(function(item){var value=item.value;var key=decodeURIComponent(item.key);if(typeof value==="string")appendFormHiddenInput(mform,key,decodeURIComponent(value));else if(value&&value.length&&value.length>0)for(var i=0,l=value.length;i<l;i++)appendFormHiddenInput(mform,key,decodeURIComponent(value[i]));else appendFormHiddenInput(mform,key,"")})}}mform.addedUrlWizardParams=true}};
function onSubmit(skipAllValidation,skipRequiredFieldValidation){PTC.getMainWindow().PTC.performance.restartTimer();PTC.getMainWindow().PTC.performance.startComponentTimer("WizardSubmit","Wizard Action Completed");isApply=false;if(isIE&&event)Event.stop(event);formSubmitted=onSubmitMain(skipAllValidation,skipRequiredFieldValidation);return formSubmitted}
PTC.wizard.isEnterKeyPressed=function(){if(Ext.EventObject!==null){var keyValue=Ext.EventObject.getKey();var isEnabled=isOKEnabled();if(!isEnabled&&keyValue===Ext.EventObject.ENTER)return false}return true};onSubmit=onSubmit.wrap(function(p,a,b,c){if(!PTC.wizard.isEnterKeyPressed())return false;p.defer(1,this,[a,b,c]);return false});
function updateRequiredLabel(){var requiredField=Ext.getDom("requiredfieldDisplay");var stepDom=Ext.getDom(currentStepStrName);if(currentStepStrName&&requiredField&&stepDom){var required=Ext.DomQuery.selectNode(".required",stepDom);if(required)requiredField.style.display="inline";else requiredField.style.display="none"}}
PTC.wizard.setActiveStepSuccessHandler=function(stepId,wizardAction){if(isWizardType&&wizardTypeValue=="wizard")resetOkButton();if(isWizardType&&wizardTypeValue=="wizard"){resetNextBackButton(currentStepStrName);setBackButton(stepId)}stepIndex=findStepIndex(currentStepStrName);try{wizardSteps[stepId].postloadJS(wizardAction)}catch(e){PTC.log.error("Error occurred calling postloadJS function: ",e)}stopProgress();updateEmbeddedText();updateRequiredLabel();wizardSteps[stepId].isActive=true;PTC.wizard.StepLinksPanelUtil.alignActiveStep();
PTC.wizard.StepLinksPanelUtil.attachOnClickHandlers();adjustWizardContentAreaHeight();PTC.wizard.fireEvent("wizardStepReady",stepId)};
PTC.wizard.setActiveStep=function(stepId,wizardAction){wizardSteps[currentStepStrName].visited=true;if(stepId==currentStepStrName)return;if(!wizardSteps[stepId])return;if(!currentStepStrName){currentStepStrName=steps[stepIndex];stepIndex=findStepIndex(currentStepStrName)}var newStepIndex=findStepIndex(stepId);if(newStepIndex<stepIndex)wizardAction="BACK";var isBackButton=wizardAction=="BACK";if(isWizardType&&wizardTypeValue=="wizard"){var requiredFieldsComplete=PTC.wizard.checkRequired(isBackButton);
if(!requiredFieldsComplete)if(!isBackButton)return;else wizardSteps[currentStepStrName].isComplete=false}if(isWizardType&&wizardTypeValue=="clerk")enableOkButton();if(!wizardSteps[currentStepStrName].afterJS(wizardAction))return;goProgress();if(wizardSteps[currentStepStrName].afterServerVK){setDownstreamFormElementsDisabled(true);if(!PTC.validation.callAJAXValidation(wizardSteps[currentStepStrName].afterServerVK,wizardAction))if(isWizardType&&wizardTypeValue=="clerk"||!isBackButton){stopProgress();
resetDownstreamFormElementsDisabled();return}else wizardSteps[currentStepStrName].isComplete=false;resetDownstreamFormElementsDisabled()}if(stepId!=nextStep&&nextStep!==null){stepId=nextStep;nextStep=null}if(!wizardSteps[stepId].preloadJS(wizardAction)){stopProgress();return}if(wizardSteps[stepId].beforeServerVK)if(!PTC.validation.callAJAXValidation(wizardSteps[stepId].beforeServerVK)){stopProgress();return}wizardSteps[currentStepStrName].isActive=false;currentStepStrName=stepId;if(wizardSteps[stepId].isDirty){wizardSteps[stepId].isDirty=
false;getStyleFromId(stepId+"Pane").display="inline";reloadPane(stepId,stepId,null,PTC.wizard.setActiveStepSuccessHandler.createCallback(stepId,wizardAction),typeof wizardAction!=="undefined")}else if(!wizardSteps[stepId].isAsync){wizardSteps[stepId].isComplete=true;wizardSteps[stepId].isDirty=false;PTC.wizard.setActiveStepSuccessHandler(stepId,wizardAction)}else PTC.wizard.setActiveStepSuccessHandler(stepId,wizardAction)};setActiveStep=PTC.wizard.setActiveStep;
PTC.wizard.goNext=function(){var origNextStep=null;if(nextStep===null){nextStep=PTC.wizard.getNextStep();origNextStep=nextStep}PTC.performance.startWizardTimer(nextStep);try{PTC.wizard.setActiveStep(nextStep,"NEXT")}finally{if(origNextStep==nextStep)nextStep=null}};goNext=PTC.wizard.goNext;function getStepTextLink(stepName){return $("setActiveStep_"+stepName)}function getStepBoxLink(stepName){return $("img_href."+stepName)}
function setupWizardNavigationObservers(navObserveFunction,ready){if(ready!==true){PTC.onReady(function(){setupWizardNavigationObservers(navObserveFunction,true)});return}if(!("steps"in window))return;var steps_length=steps.length;for(var i=0;i<steps_length;i++){var _step=getStepTextLink(steps[i]);var _div=getStepBoxLink(steps[i]);if(_step)Event.observe(_step,"click",navObserveFunction);if(_div)Event.observe(_div,"click",navObserveFunction)}var nextButton=findButtonByActionID("PJL_wizard_next");var prevButton=
findButtonByActionID("PJL_wizard_previous");nextButton.on("click",navObserveFunction);prevButton.on("click",navObserveFunction)}PTC.wizard.getNextStep=function(){var tmp;if(steps.length<=stepIndex+1)return null;if(!currentStepStrName||!nextStep)tmp=steps[stepIndex+1];else tmp=nextStep;var i=0;while(wizardSteps[tmp].hidden&&stepIndex+i<steps.length){i++;tmp=steps[stepIndex+i]}return tmp};
function setStepDirty(stepId){if(wizardSteps[stepId].isDirty===false){wizardSteps[stepId].isDirty=true;wizardSteps[stepId].visited=false;resetOkButton()}}function setNextStepDirty(){var tmp=PTC.wizard.getNextStep();if(tmp&&tmp.length>0)setStepDirty(tmp);return true}function goBack(){var backStep=PTC.wizard.getPreviousStep();PTC.performance.startWizardTimer(backStep);nextStep=null;PTC.wizard.setActiveStep(backStep,"BACK")}
PTC.wizard.getPreviousStep=function(stepId){var backStep,backStepIndex;if(stepId)backStepIndex=findStepIndex(stepId)-1;else if(!currentStepStrName||!nextStep)currentStepStrName=steps[stepIndex];if(!backStepIndex)backStepIndex=stepIndex-1;if(backStepIndex<0)backStepIndex+=1;backStep=steps[backStepIndex];var i=0;while(wizardSteps[backStep].hidden&&backStepIndex>0){i++;backStep=steps[backStepIndex-i]}if(wizardSteps[backStep].hidden)backStep=steps[backStepIndex+1];return backStep};
PTC.wizard.isPreviousStepActive=function(stepId){var previousStep=PTC.wizard.getPreviousStep(stepId);if(previousStep&&wizardSteps[previousStep]){var val=wizardSteps[previousStep].isActive;if(val)return val}return false};
function updateClerkTabClass(){var steps_length=steps.length;for(var i=0;i<steps_length;i++)if(currentStepStrName==steps[i]){var activeStep=window.document.getElementById("setActiveStep_"+steps[i]);activeStep.className="banTabSel"}else if(activeStep)activeStep.className="banTabNSel"}function setCurrentStep(stepId){currentStepStrName=stepId;stepIndex=findStepIndex(stepId)}function setNextStep(stepId){nextStep=stepId}
function setStepClean(stepId){if(wizardSteps[stepId].isDirty===true){wizardSteps[stepId].isDirty=false;resetOkButton()}}function setStepIncomplete(stepId){if(wizardSteps[stepId].isComplete===true){wizardSteps[stepId].isComplete=false;PTC.wizard.StepLinksPanelUtil.updateStepImages();resetOkButton()}}
function setStepComplete(stepId){if(wizardSteps[stepId].isComplete===false){wizardSteps[stepId].isComplete=true;wizardSteps[stepId].isAsync=false;PTC.wizard.StepLinksPanelUtil.updateStepImages();resetOkButton()}}function setStepRequired(stepId){if(wizardSteps[stepId].required===false){wizardSteps[stepId].required=true;wizardSteps[stepId].isComplete=false;resetOkButton()}}
function setStepOptional(stepId){if(wizardSteps[stepId].required===true){wizardSteps[stepId].required=false;wizardSteps[stepId].isComplete=true;resetOkButton()}}function removeStep(astepId){wizardSteps[astepId].hidden=true;PTC.wizard.StepLinksPanelUtil.repaintStepPanel();PTC.wizard.StepLinksPanelUtil.attachOnClickHandlers();resetOkButton();resetNextBackButton(currentStepStrName)}
function insertStep(astepId){wizardSteps[astepId].hidden=false;PTC.wizard.StepLinksPanelUtil.repaintStepPanel();PTC.wizard.StepLinksPanelUtil.attachOnClickHandlers();resetOkButton();resetNextBackButton(currentStepStrName)}function setStepImageStyle(astepId,style){var stepImage=$("img."+astepId);if(stepImage)stepImage.style.display=style}
function showAll(){var i=0;var steps_length=steps.length;for(i=0;i<steps_length;i++){getStyleFromId(steps[i]+"Pane").display="inline";if(wizardSteps[steps[i]].isDirty)reloadPane(steps[i],steps[i])}}function showOnlyCurrent(){var i=0;var steps_length=steps.length;for(i=0;i<steps_length;i++)if(steps[i]!=currentStepStrName)getStyleFromId(steps[i]+"Pane").display="none"}function doSubmit(){getMainForm().submit()}function getCurrentStep(){return currentStepStrName}
function refreshCurrentStep(iframeForm){if(currentStepStrName)reloadPane(currentStepStrName,currentStepStrName,iframeForm)}function refreshStep(stepId,iframeForm){reloadPane(stepId,stepId,iframeForm)}function getAbsoluteUrl(url){var base=window.document.getElementById("basehref");url=base.href.substring(0,base.href.length-11)+url;return url}
function isWizardWindow(){var wiz_window=getWindow();var portletPoppedUp=wiz_window.location.href.indexOf("portlet=poppedup")>-1;if(!portletPoppedUp&&getMainForm()){var formAction=PTC.util.getFormAction(getMainForm());portletPoppedUp=formAction.indexOf("portlet=poppedup")>-1}var returnVal=false;try{if(typeof popupWindow!=="undefined"||portletPoppedUp)if(wiz_window.opener&&typeof wiz_window.opener.getBaseHref!=="undefined"&&wiz_window.opener.getBaseHref()===wiz_window.getBaseHref())returnVal=true;
else if(isWizardType)returnVal=true}catch(e){return false}return returnVal}
function handleWizWindow(status){switch(status){case 0:case 2:if(!isApply&&getPopupOpenerWindow()&&getWindow().location.href.indexOf("portlet=poppedup")>=0)if(PTC.lightbox.isLightbox(window))PTC.lightbox.deactivate({cancelAction:true,reloadParent:false});else wfWindowClose1();else if(parent&&parent.currentStepStrName){parent.stopProgress();parent.enableButtons();parent.resetNextBackButton(currentStepStrName);if(PTC.lightbox.isLightbox(window))PTC.wizard.loadMask.hide()}break;case 1:PTC.wizard.finished=
false;if(parent&&parent.currentStepStrName){parent.stopProgress();parent.enableButtons();parent.resetNextBackButton(currentStepStrName);if(PTC.lightbox.isLightbox(window))PTC.wizard.loadMask.hide()}break;default:throw new Error("Unknown wizard status");}}
PTC.wizard.initializeFormResult=function(status,nextAction,js,URL,frConfig){frConfig=frConfig||{};if(!(frConfig===undefined||frConfig===null))frConfig.tableID=tableUtils.getUnformattedTableId(frConfig.tableID);frConfig.status=status;frConfig.nextAction=nextAction;frConfig.URL=URL;frConfig.js=js;frConfig.ajaxEnabled=extractParamValue(window.location.href,"AjaxEnabled");var formResult=new PTC.action.FormResult(frConfig);return formResult};
function handleSubmitResult(status,nextAction,js,URL,frConfig){var table,continueProcessing=true;if(PTC.getMainWindow()&&PTC.getMainWindow().PTC&&PTC.getMainWindow().PTC.performance)PTC.getMainWindow().PTC.performance.startComponentTimer("handleSubmitResult","Update from Wizard Completed");clearActionFormData();var customEventHandler=PTC.wizard.actionHandler;delete PTC.wizard.actionHandler;var formResult=PTC.wizard.initializeFormResult(status,nextAction,js,URL,frConfig);if(typeof customEventHandler===
"function")continueProcessing=customEventHandler(formResult);continueProcessing=PTC.wizard.fireOnAfterAction(formResult)&&continueProcessing;var formResultEnum=PTC.cat.FormResult;var callback=PTC.cat.WizardHelper.getCallback(getWindow());if(PTC.wizard.finished&&nextAction===formResultEnum.REFRESH_OPENER&&callback){try{callback.call(this,formResult)}catch(ecallback){PTC.log.warn("CAT callback returned an error message, this can mean the page has started refreshing and lost its scope",ecallback)}handleWizWindow(status);
return}if(!continueProcessing){if(PTC.wizard.finished)handleWizWindow(status);return}PTC.action.log.warn("Legacy Handler is being used, the action ",formResult.actionName," should return a formResult with oids or have components handle the action specifically.",formResult);switch(nextAction){case formResultEnum.REFRESH_OPENER:var refreshed=false;if(parent){if(PTC.wizard.finished){if(status!==1)refreshOpenerOnly();refreshed=true}if((parent.currentStepStrName||window.currentStepStrName)&&(PTC.wizard.finished||
status===1)){handleWizWindow(status);refreshed=true}else if(PTC.lightbox.isLightbox(window)&&window.currentStepStrName&&window.PTC.wizard.finished){handleWizWindow(status);refreshed=true}}if(!refreshed){table=tableUtils.getTable(formResult.getTableId());if(table)PTC.jca.table.Utils.reload(table)}break;case 3:if(status==1)handleWizWindow(status);try{eval(js)}catch(evalexception){PTC.wizard.log.error(evalexception)}break;case 4:if(PTC.wizard.finished)handleWizWindow(status);else if(!parent.currentStepStrName){table=
tableUtils.getTable(formResult.getTableId());if(table)PTC.jca.table.Utils.reload(table)}break;case 5:refreshOpenerOnly();eval(js);handleWizWindow(status);break;case 2:if(parent.currentStepStrName&&PTC.wizard.finished){handleWizWindow(status);refreshed=true}break;case 6:case 7:break;case 8:PTC.navigation.submitForm();break;default:throw new Error("Next wizard action unknown");}if(status===1&&PTC.wizard.loadMask&&PTC.wizard.loadMask.el&&PTC.wizard.loadMask.el.isVisible&&PTC.wizard.loadMask.el.isVisible())stopProgress();
if(PTC.getMainWindow()&&PTC.getMainWindow().PTC&&PTC.getMainWindow().PTC.performance)PTC.getMainWindow().PTC.performance.stopComponentTimer("handleSubmitResult",null,"deltaTime")}function onApply(){isApply=true;return onSubmitMain()}function DebugCallback(){wfalert(this.url+" has responded, content dump : \n\n"+this.req.responseText)}function innerFrameTarget(){document.getElementById("result").innerHTML=this.req.responseText}
function fetchRawPage(url){var loader=new ajax.ContentLoader(url,DebugCallback,null,"post","")}function fetchPage(url){var loader=new ajax.ContentLoader(url,innerFrameTarget,null,"post","")}PTC.validation.onClickValidation=function(evt,validation_key){var mform=getMainForm();mform.onClickValidationTemp=PTC.validation._onClickInternal;mform.onClickValidationTemp=mform.onClickValidationTemp.curry(validation_key);return true};onClickValidation=PTC.validation.onClickValidation;
PTC.validation._onClickInternal=function(validation_key,isPopupAction){var mform=this;var cc=mform.compContext.value;var ea=mform.elemAddress.value;var el=mform.executeLocation.value;var setvars=false;if(isPopupAction!==false&&mform.popupCompContext.value&&mform.popupCompContext.value.length>0){setvars=true;mform.compContext.value=mform.popupCompContext.value;mform.elemAddress.value=mform.popupElemAddress.value;mform.executeLocation.value=mform.popupExecuteLocation.value}try{return PTC.validation.callAJAXValidation(validation_key)}finally{if(setvars){mform.compContext.value=
cc;mform.elemAddress.value=ea;mform.executeLocation.value=el}}};PTC.validation.AJAXPostSelectValidation=function(evt,validation_key){return PTC.validation.onClickValidation(evt,validation_key+"&PostSelectValidation=true")};postSelectValidation=PTC.validation.AJAXPostSelectValidation;PTC.validation.AJAXValidateFormSubmission=function(validation_key,sucFunc,async){return callAJAXValidation(validation_key,null,sucFunc,async)};
function AJAXValidationCallback(){this.shouldContinue=true;var string=this.req.responseText;if(string==="")return;string=string.substring(0,string.lastIndexOf("}")+1);var regexp=new RegExp("\n","g");string=string.replace(regexp,"<!--N--\>");var regexp2=new RegExp("\r","g");string=string.replace(regexp2," ");var resp=Ext.decode(string);var skey=resp.response[0].secret_key;if(resp.response[0].status=="ERROR"||resp.response[0].status=="DISABLE"||resp.response[0].status=="DENIED")this.shouldContinue=
false;if(isWizardType&&wizardTypeValue=="clerk"||typeof this.wizardAction=="undefined"||this.wizardAction!="BACK"){var msg="";var resp_response_length=resp.response.length;for(var i=0;i<resp_response_length;i++){var feedback=eval(resp.response[i].feedback);if(feedback){var type=feedback[0].type;var message=feedback[0].message;if(type=="CONFIRMATION")this.shouldContinue=confirm(message);else{var newMsg=message;if(!newMsg)newMsg="";regexp=new RegExp("<!--N--\>","g");newMsg=newMsg.replace(regexp,"\n");
msg+=newMsg}}}if(msg.length>1)wfalert(msg);if(this.shouldContinue){var input=document.getElementById("SSVK");if(input)input.value=skey;else appendFormHiddenInput(getMainForm(),"SSVK",skey)}}return this.shouldContinue}
PTC.validation.AJAXValidateFormAndSubmit=function(validation_key,async){if(!async){if(PTC.validation.AJAXValidateFormSubmission(validation_key))return onSubmit()}else{var successFunc=function(){stopProgress();if(AJAXValidationCallback())onSubmit()};goProgress();return PTC.validation.AJAXValidateFormSubmission(validation_key,successFunc,async)}return false};
PTC.validation.callAJAXValidation=function(validation_key,wizardAction,successFunc,async){var input=document.getElementById("CSVK");var ckey=(new Date).getTime();if(input)input.value=ckey;else appendFormHiddenInput(getMainForm(),"CSVK",ckey);var shouldContinue=false;var url="servlet/UIValidationAJAXServlet";if(!successFunc)successFunc=function(transport){this.req=transport;this.shouldContinue=shouldContinue;AJAXValidationCallback(this);shouldContinue=this.shouldContinue};var params="validation_key="+
validation_key;var options={onSuccess:successFunc,method:"post",asynchronous:async?async:false,parameters:getFormData()+"&"+params};var transport=requestHandler.doRequest(url,options);return shouldContinue};callAJAXValidation=PTC.validation.callAJAXValidation;
ajax.ContentLoader=function(url,onload,onerror,method,params,wizardAction){this.url=url;this.req=null;this.shouldContinue=true;this.onload=onload;this.onerror=onerror?onerror:this.defaultError;this.wizardAction=wizardAction;this.shouldContinue=this.loadXMLDoc(url,method,params);return this.shouldContinue};
ajax.ContentLoader.prototype={loadXMLDoc:function(url,method,params){if(!method)method="get";var options={method:method,asynchronous:false,parameters:getFormData()+"&"+params};try{this.req=requestHandler.doRequest(url,options);this.onReadyState()}catch(e){jsca.error(e)}return this.shouldContinue},onReadyState:function(){var req=this.req;var ready=req.readyState;var httpStatus=req.status;if(httpStatus===200||httpStatus===0)this.onload.call(this);else{this.onerror.call(this);this.shouldContinue=false}},
defaultError:function(){var responseText=this.req.responseText;var errorMsg;var beginMsgIndex=responseText.indexOf("<pre>");if(beginMsgIndex>=0){var endMsgIndex=responseText.indexOf("</pre>",beginMsgIndex);if(endMsgIndex<0)endMsgIndex=responseText.length;errorMsg=responseText.substring(beginMsgIndex+5,endMsgIndex)}else errorMsg=responseText;Ext.Msg.alert("",errorMsg)}};
function getStepRequiredInputs(stepID,formElements){if(!stepID)stepID=currentStepStrName;var required=[];var tags=["INPUT","SELECT","TEXTAREA"];var stepObj=$(stepID)||getMainForm();if(formElements)stepObj=formElements;tags.each(function(tag){var inputs=stepObj.getElementsByTagName(tag);var inputs_length=inputs.length;for(var i=0;i<inputs_length;i++)if(inputs[i].className&&inputs[i].className.indexOf("required")>=0)required.push(inputs[i])});return required}
PTC.wizard.checkRequired=function(skipErrorMsg,skipHighlight,stepID){var required=getStepRequiredInputs(stepID);return PTC.wizard.validateRequiredInputs(required,skipErrorMsg,skipHighlight)===null};checkRequired=PTC.wizard.checkRequired;PTC.wizard.removeSelectHighlight=function(evt,item){var el=Ext.get(item);el.stopFx();el.un("mousedown",PTC.wizard.removeSelectHighlight);return true};
PTC.wizard.validateRequiredInputs=function(required,skipErrorMsg,skipHighlight){var pass=true;var lastFailedElement=null;var regExp=/[^ ]/;var alreadyCheckedRadioButtons=[];var required_length=0;if(required)required_length=required.length;PTC.wizard.log.debug("PTC.wizard.validateRequiredInputs: Required inputs count: ",required_length);for(var i=0;i<required_length;i++){var element=required[i];var extEl=Ext.get(element);if(extEl.isVisible(true)||!currentStepStrName||extEl.parent("//DIV[@id="+currentStepStrName+
"]")===null)if(element.type&&element.type==="radio"){if(!PTC.wizard.checkRequiredRadioButton(element,alreadyCheckedRadioButtons)){PTC.wizard.log.debug("PTC.wizard.validateRequiredInputs: Required radio group ",$(element).readAttribute("name")," is not checked?");pass=false;lastFailedElement=element}}else if(element.value!==null&&(element.value.length<=0||!element.value.match(regExp))){PTC.wizard.log.debug("PTC.wizard.validateRequiredInputs: Required input field ",$(element).readAttribute("id")," is empty?");
pass=false;lastFailedElement=element;if(!skipHighlight)try{Ext.get(element).highlight(undefined,{duration:5});if(element.tagName.toLowerCase()==="select")Ext.get(element).on("mousedown",PTC.wizard.removeSelectHighlight)}catch(e){}}}if(!pass&&!skipErrorMsg){var message=$("requiredMessage");wfalert(message.value);clearActionFormData()}return lastFailedElement};
PTC.wizard.checkClerkRequired=function(skipErrorMsg,skipHighlight){var steps_length=steps.length;var pass=true;for(stepIterator=0;stepIterator<steps_length;stepIterator++){if(!pass){PTC.wizard.setActiveStep(steps[stepIterator-1]);break}var required=getStepRequiredInputs(steps[stepIterator]);pass=PTC.wizard.validateRequiredInputs(required,skipErrorMsg,skipHighlight)===null}return pass};
PTC.wizard.checkRequiredRadioButton=function(radioButton,alreadyCheckedRadioButtons){var pass=true;var radioButtonName=radioButton.name;if(alreadyCheckedRadioButtons.indexOf(radioButtonName)==-1){if(!PTC.wizard.checkRequiredForRadioButtonGroup(radioButtonName)){pass=false;try{Ext.get(radioButton.parentNode).highlight(undefined,{duration:5})}catch(e){}}alreadyCheckedRadioButtons.push(radioButtonName)}return pass};
PTC.wizard.checkRequiredForRadioButtonGroup=function(radioButtonGroupName){var radioButtonsInGroup=document.getElementsByName(radioButtonGroupName);if(radioButtonsInGroup&&radioButtonsInGroup.length>0&&radioButtonsInGroup[0].type=="radio"){var radioButtonsInGroup_length=radioButtonsInGroup.length;for(var i=0;i<radioButtonsInGroup_length;i++)if(radioButtonsInGroup[i].checked)if(radioButtonsInGroup[i].value)return true}return false};
PTC.wizard.launchCheckinWizard=function(formResult){if(formResult.extraData.checkinURL){var url=formResult.extraData.checkinURL;url=Ext.urlAppend(url,"oid="+formResult.extraData.checkinOid);url=Ext.urlAppend(url,"portlet=poppedup");url=Ext.urlAppend(url,"tableID="+extractParamValue(window.location.href,"tableID"));url=Ext.urlAppend(url,"skipInit=true");if(formResult.extraData.wizardResponseHandler)url=Ext.urlAppend(url,"wizardResponseHandler="+encodeURIComponent(formResult.extraData.wizardResponseHandler));
var postForm=getWindow().document.createElement("FORM");postForm.name="checkinWizardForm";postForm.method="POST";postForm.action=url;getWindow().document.body.appendChild(postForm);if(Ext.getDom("externalFormData"))JCAappendFormHiddenInput(postForm,"externalFormData",Ext.getDom("externalFormData").value);PTC.getMainWindow().PTC.cat.WizardHelper.setCallbackAfterWindowReload(window);postForm.submit();return false}return true};
function onEditSubmit(actionName){JCAappendFormHiddenInput(getMainForm(),"editButtonClicked",actionName);var params={successFunc:PTC.wizard.launchCheckinWizard,finished:actionName=="saveButton"};PTC.wizard.submitWizard(params)}
function addWhichButtonClickedField(buttonName){var input=Ext.get("whichCreateButtonClicked");if(!input){input=document.createElement("INPUT");input.type="hidden";input.name="whichCreateButtonClicked";input.id="whichCreateButtonClicked";getMainForm().appendChild(input)}input.value=buttonName}
PTC.wizard.onSaveInCreate=function(buttonName,submitResultHandler){input=Ext.get("skipRequiredFieldValidation");if(!input){input=document.createElement("INPUT");input.type="hidden";input.name="skipRequiredFieldValidation";input.id="skipRequiredFieldValidation";getMainForm().appendChild(input)}input.value="true";addWhichButtonClickedField(buttonName);var originalHandleSubmitResultFunction=handleSubmitResult;handleSubmitResult=function(){try{submitResultHandler.apply(this,arguments)}finally{handleSubmitResult=
originalHandleSubmitResultFunction}};onSubmit(false,true);var field=Ext.get("skipRequiredFieldValidation");field.remove();field=Ext.get("whichCreateButtonClicked");field.remove()};function editCancelPrepare(){wfWindowClose1();return false}
function markDownstreamNonPreloadedWizStepsDirty(){var currentIdx=findStepIndex(currentStepStrName)+1;var length=steps.length;for(var si=currentIdx;si<length;si++){var stepId=steps[si];if(!wizardSteps[stepId].preloadPage)setStepDirty(stepId)}PTC.wizard.StepLinksPanelUtil.updateStepImages()}
function deleteDownstreamFormContent(){var currentIdx=findStepIndex(currentStepStrName);var length=steps.length;for(var si=currentIdx+1;si<length;si++){var step=$(steps[si]);if(wizardSteps[steps[si]].isDirty){var stepContent=window.document.getElementById(step.id);PTC.navigation.overwrite(stepContent,"")}}}
function resetTypeInstanceId(elementVal,currentObjectHandle,template){if(!elementVal)return;var params="pickerVal="+elementVal;if(template){var element=document.getElementsByName("templateOid")[0];element.value=elementVal;element=document.getElementsByName("PrePopulateObjectList")[0];element.value=elementVal;params+="&template="+template}var options={asynchronous:false,parameters:params};var url="netmarkets/jsp/components/resetItemTypeInstanceId.jsp";var transport=requestHandler.doRequest(url,options);
var newTypeInstanceId=transport.responseText;element=document.getElementById(currentObjectHandle+PTC.wizard.ITIID);element.value=newTypeInstanceId}function pickerGo(value,currentObjectHandle,template){if(!value)return;resetTypeInstanceId(value,currentObjectHandle,template);if(isWizardType&&wizardTypeValue=="wizard")markDownstreamNonPreloadedWizStepsDirty();deleteDownstreamFormContent();PTC.wizard.fireEvent("afterTypePickerChange")}
function markDownstreamWizStepsDirty(){var currentIdx=findStepIndex(currentStepStrName)+1;var length=steps.length;for(var si=currentIdx;si<length;si++)setStepDirty(steps[si]);PTC.wizard.StepLinksPanelUtil.updateStepImages()}
function onContextChange(pickerId,strContainerRef){var pickerObjHandle="";var indexOfPickerId=pickerId.lastIndexOf("containerRef");var objHandle=pickerId.slice(0,indexOfPickerId);if(objHandle&&objHandle.length>0)pickerObjHandle=objHandle;var eleContainerRef=document.getElementById(pickerObjHandle+"containerRef");eleContainerRef.value=strContainerRef;var handles=[];if(pickerObjHandle===""){var domElements=document.getElementsByName("objectHandle");if(domElements&&domElements.length)for(var idx=0,len=
domElements.length;idx<len;++idx)handles.push(domElements[idx].value);handles.push("")}else handles[0]=pickerObjHandle;for(var i=0,j=handles.length;i<j;i++){var handle=handles[i];var eleTypeInstanceID=document.getElementById(handle+"itemTypeInstanceId");if(!eleTypeInstanceID){PTC.wizard.log.debug('Not able to find a type picker with the handle "'+handle+'"');continue}var eleDefaultType=document.getElementsByName(handle+"typePickerInitValue")[0];var eleBaseTypeID=document.getElementsByName(handle+
"baseTypeIdentifier")[0];var params="BaseTypeID="+eleBaseTypeID.value+"&ContainerRef="+strContainerRef;var options={asynchronous:false,parameters:params};var url="netmarkets/jsp/components/recomputeDefaultType.jsp";var transport=requestHandler.doRequest(url,options);var responseArray=transport.responseText.split("&");if(responseArray[0]&&responseArray[0].indexOf("DefaultType")===0)eleDefaultType.value=responseArray[0].substring(12);if(responseArray[1]&&responseArray[1].indexOf("TypeInstanceID")===
0)eleTypeInstanceID.value=responseArray[1].substring(15)}markDownstreamNonPreloadedWizStepsDirty();deleteDownstreamFormContent()}function contextChanged(objects,pickerId){if(document.getElementById(pickerId+"$label$").options)contextPickerCallBackJCACombo(objects,pickerId);var strContainerRef=objects.pickedObject[0].oid;var strContainerRefValue=objects.pickedObject[0].name;onContextChange(pickerId,strContainerRef,strContainerRefValue)}
function callContextChange(pickerId){var test=$(pickerId+"$label$").value;$(pickerId).value=$(pickerId+"$label$").value;onContextChange(pickerId,$(pickerId).value)}PTC.util.isLimitCharsMsgShowing=false;
PTC.wizard.isNotGreaterThanMax=function(strLength,maxLength,e,key){key=key||"com.ptc.core.ui.errorMessagesRB.NEW_TEXT_AREA_LENGTH_EXCEED_CHARACTER";var strL=parseInt(strLength,10);var maxL=parseInt(maxLength,10);if(!isNaN(strL)&&!isNaN(maxL)&&maxL!==0)if(strL>maxL)if(!PTC.util.isLimitCharsMsgShowing){PTC.util.isLimitCharsMsgShowing=true;Event.stop(e);var params=[strLength,maxLength];JCAAlert(key,"",params);PTC.util.isLimitCharsMsgShowing=false;return false}return true};
PTC.wizard.getElementValueByName=function(fieldName){var elems=document.getElementsByName(fieldName);if(!elems||elems.length===0||!elems[0])return null;var el=elems[0];return el.value};
PTC.wizard.limitCharsOnKeyPress=function(fieldName,maxByteLength,maxStringLength,e){var result=true;if(fieldName&&e){var keynum=e.keyCode?e.keyCode:e.which;if(PTC.util.isCharInputKey(e)){if(PTC.util.eventTargetHasSelection(e))return true;var elVal=PTC.wizard.getElementValueByName(fieldName);if(elVal===null)return true;var newChar=String.fromCharCode(keynum);var fieldStringLength=elVal.length;var toAddStringLength=newChar.length;result=PTC.wizard.isNotGreaterThanMax(fieldStringLength+toAddStringLength,
maxStringLength,e);if(!result)return result;var newTotalByteLength=PTC.util.getByteLength(elVal)+PTC.util.getByteLength(newChar);var key="com.ptc.core.ui.errorMessagesRB.NEW_TEXT_AREA_LENGTH_EXCEED_BYTE";result=PTC.wizard.isNotGreaterThanMax(newTotalByteLength,maxByteLength,e,key)}}return result};
PTC.wizard.limitChars=function(fieldName,maxByteLength,maxStringLength,e){var result=true;if(fieldName){var elVal=PTC.wizard.getElementValueByName(fieldName);if(elVal===null)return result;result=PTC.wizard.isNotGreaterThanMax(elVal.length,maxStringLength,e);if(!result)return result;var key="com.ptc.core.ui.errorMessagesRB.NEW_TEXT_AREA_LENGTH_EXCEED_BYTE";result=PTC.wizard.isNotGreaterThanMax(PTC.util.getByteLength(elVal),maxByteLength,e,key)}return result};
function validateForNaN(elem,errorMsgRB,regEx){var value=elem.value;var result=PTC.wizard.validateValueForNaN(value,errorMsgRB,regEx,elem);return result}PTC.wizard.validateValueForNaN=function(value,errorMsgRB,regEx,elem){var re=new RegExp(regEx);if(value)if(re.test(value)){JCAAlert(errorMsgRB);setTimeout('PTC.wizard.setSelect("'+elem.name+'");',0);return false}return true};
PTC.wizard.setSelect=function(field){var elems=document.getElementsByName(field);if(!elems||elems.length<1)return false;var elem=elems[0];elem.focus();elem.select();return false};setSelect=PTC.wizard.setSelect;
function populatedependentAttributeValue(refAttrElement,hiddenAttrName,dependentAttrColumnId){var dependantAttrElement=document.getElementById(dependentAttrColumnId);var refAttrvalue=refAttrElement.value;var hiddenElements=document.getElementsByName(hiddenAttrName);if(hiddenElements&&hiddenElements.length>0){var hiddenElement=hiddenElements[0];hiddenElement.value=refAttrvalue}if(dependantAttrElement&&refAttrvalue&&refAttrvalue.indexOf(":")>0){var displayValue=refAttrvalue.substring(0,refAttrvalue.indexOf(":"));
dependantAttrElement.value=displayValue}}function loadNonRequiredSteps(doAsync){var params=getFormData();var steps_length=steps.length;for(var i=0;i<steps_length;i++){var stepId=steps[i];var s=wizardSteps[stepId];if(s)if(s.preloadPage===false&&s.isDirty===true&&!s.required){s.isDirty=s.isDirty?false:s.isDirty;if(doAsync)s.isAsync=true;getElementHtml(params,stepId,doAsync,getPageUrl(s.url,stepId))}}return true}
function loadAllRemainingNonRequiredSteps(){PTC.performance.setPageReady();return loadNonRequiredSteps(true)}
function doResubmit(url,hiddenInputName){var postForm=document.createElement("FORM");postForm.id="postFormForwarder";postForm.name="postFormForwarder";postForm.method="POST";postForm.action=url;var hiddenInput=document.createElement("INPUT");hiddenInput.type="hidden";hiddenInput.name=hiddenInputName;hiddenInput.id=hiddenInputName;hiddenInput.value=$("externalFormData").value;postForm.appendChild(hiddenInput);document.body.appendChild(postForm);$("postFormForwarder").submit()}
function defaultWizardKeyUpListener(event){var target=Event.element(event);if(event.keyCode==Event.KEY_RETURN||event.which==Event.KEY_RETURN)if(!target||target.tagName!=="SELECT"&&target.tagName!=="TEXTAREA")if(isOKEnabled())if(!formSubmitted){var okButton=findButtonByActionID("PJL_wizard_ok");if(okButton)okButton.onclick.call(event);else return onSubmit()}}
PTC.wizard.initialize=function(data){wizardTypeValue=data.wizardType;isWizardType=true;var stepData=data.steps;for(var i=0;i<stepData.length;i++){var stepId=stepData[i].stepId;wizardSteps[stepId]=new wizardStep(stepData[i])}};PTC.wizard.unloadWizard=function(){steps=null;wizardSteps=null;PTC.navigation.unloadShell();try{if(opener&&opener.actionwin)opener.actionwin=null}catch(e){}Ext.EventManager.un(window,"unload",PTC.wizard.unloadWizard);PTC.wizard.unloadWizard=null};
PTC.wizard.loadWizard=function(data){PTC.performance.startWizardTimer(data[4].steps[0].stepId,true);var wizStepContents=Ext.get("wiz_step_contents");wizStepContents.setVisible(false);PTC.wizard.initialize(data[4]);if(Ext.isIE)Ext.EventManager.on(window,"unload",PTC.wizard.unloadWizard);Ext.onReady(function(){var titleBarButtons=[{xtype:"tbtext",text:data[0]},"->"];var helpButton=PTC.help.getHelpButtonConfig(data[1]);if(helpButton)titleBarButtons.push(helpButton);var titleBar=new Ext.Toolbar({id:"titleBar",
cls:"x-panel-header wizard-title-text",items:titleBarButtons});var stepHeader=new PTC.wizard.StepLinksPanel({id:"stephdr",border:false,cls:"stepHeader",steps:window.steps});var embeddedHelpDiv={border:false,xtype:"panel",cls:"clear_float",html:data[2]};var footerItems=[{xtype:"tbtext",id:"requiredfieldDisplay",text:data[3].requiredfieldDisplay},"->"];data[3].items.each(function(item){footerItems.push(item)});var footer=new Ext.Panel({id:"footerPanel",border:false,buttonAlign:"left",fbar:footerItems});
var contentArea=new PTC.jca.table.TableContainer({id:"contentArea",contentEl:wizStepContents.dom,frame:true,baseCls:"x-box",bufferResize:100});var wizardPanel=new Ext.Panel({renderTo:"wizard_viewport",baseCls:"wizardPanel",items:[stepHeader,embeddedHelpDiv,contentArea,footer],tbar:titleBar});wizStepContents.setVisible(true);PTC.wizard.firstPostLoad();if(Ext.isGecko)setTimeout(function(){window.focus()},100)})};
PTC.wizard.attributePanelLoader=function(){function getAttributePanel(){return Ext.get(PTC.wizard.getCurrentObjectHandle()+"setAttributesTablePane")}return{clearAttributePanelDiv:function(){var attributePanelDiv=getAttributePanel();if(attributePanelDiv&&attributePanelDiv.dom)PTC.navigation.overwrite(attributePanelDiv.dom,"")},loadAttributeTable:function(){PTC.wizard.fireEvent("beforeLoadAttributeTable");if(PTC.wizard.loadAttributeTableURL!==null)try{disableOkButton();var objectHandle=PTC.wizard.getCurrentObjectHandle();
var status=PTC.wizard.checkRequired(true,true,objectHandle+"driverAttributesPane");PTC.wizard.log.debug("PTC.wizard.checkRequired returned ",status);this.clearAttributePanelDiv();var validationId="defineItem";var callAJAXValidation=true;var shouldValidate=objectHandle+"_loadAttributeTableCalled";if(status&&PTC.wizard.attributePanelLoader[shouldValidate]){callAJAXValidation=PTC.validation.callAJAXValidation(validationId,"BACK");PTC.wizard.log.debug("PTC.validation.callAJAXValidation returned ",callAJAXValidation)}else PTC.wizard.log.debug("PTC.validation.callAJAXValidation skipped since this is the first load of attributes table");
PTC.wizard.attributePanelLoader[shouldValidate]=true;status=status===true&&callAJAXValidation;if(status===true){PTC.wizard.attributePanelLoader.goAttributeTableProgress();PTC.wizard.log.debug("PTC.wizard.loadAttributeTable URL: ",PTC.wizard.loadAttributeTableURL);var url=PTC.wizard.loadAttributeTableURL;if(objectHandle)url=PTC.wizard.loadAttributeTableURL+"?currentObjectHandle="+objectHandle;refreshElement(objectHandle+"setAttributesTablePane",url,false,true,PTC.wizard.attributePanelLoader.loadAttributeTableOnSuccessful)}else{PTC.wizard.log.debug("status is false. Masking attribute panel.");
PTC.wizard.attributePanelLoader.stopAttributeTableProgress();PTC.wizard.attributePanelLoader.maskAttributePanel()}}catch(e){PTC.wizard.log.debug("Exception encountered while loading attributes table ",e)}return true},loadAttributeTableOnSuccessful:function(){resetOkButton();PTC.wizard.attributePanelLoader.unmaskAttributePanel();PTC.wizard.fireEvent("afterLoadAttributeTable")},goAttributeTableProgress:function(){var attributePanelDiv=getAttributePanel();if(attributePanelDiv&&attributePanelDiv.dom){var newHTML=
'<div style="background: url(netmarkets/javascript/ext/resources/images/default/shared/blue-loading.gif) no-repeat center center; height: 100px">&nbsp;</div>';PTC.navigation.overwrite(attributePanelDiv.dom,newHTML)}},stopAttributeTableProgress:function(){var attributePanelDiv=getAttributePanel();if(attributePanelDiv&&attributePanelDiv.dom)PTC.navigation.overwrite(attributePanelDiv.dom,"")},reloadAttributesTable:function(){if(PTC.wizard.loadAttributeTableURL!==null)PTC.wizard.attributePanelLoader.loadAttributeTable();
else PTC.wizard.log.debug("reloadAttributesTable was not done as PTC.wizard.loadAttributeTableURL is null")},maskAttributePanel:function(){var attributePanelDiv=getAttributePanel();if(attributePanelDiv&&attributePanelDiv.dom.hasChildNodes())attributePanelDiv.mask(getBundleString("com.ptc.netmarkets.util.utilResource.MISSING_REQUIRED_DRIVER_ATTRIBUTES"),"panel-mask")},unmaskAttributePanel:function(){var attributePanelDiv=getAttributePanel();if(attributePanelDiv&&attributePanelDiv.dom.hasChildNodes())attributePanelDiv.unmask()}}}();
PTC.wizard.StepLinksPanelUtil=function(data){function getStepHeader(){return Ext.getCmp("stephdr")}return{repaintStepPanel:function(){getStepHeader().repaintStepLinkPanel()},fireBodyResizeEvent:function(){var sh=getStepHeader();if(sh)sh.fireEvent("bodyresize",40)},updateStepImages:function(){if(wizardTypeValue==="wizard")getStepHeader().updateStepIcons()},alignActiveStep:function(){var header=getStepHeader();if(wizardTypeValue==="wizard")header.updateStepIcons();else if(wizardTypeValue==="clerk")header.setActiveTab(currentStepStrName);
header.positionActiveStep(currentStepStrName)},attachOnClickHandlers:function(){var header=getStepHeader();if(header)header.attachOnClickHandler()}}}();
PTC.wizard.StepLinksPanel=Ext.extend(Ext.Panel,{scrollEnabled:false,startPos:0,scrollPosition:0,scrollWidth:0,stepComponents:null,stepIndex:0,stepLinksPanel:null,leftScroller:null,rightScroller:null,firstStep:null,lastStep:null,constructor:function(config){PTC.wizard.StepLinksPanel.superclass.constructor.call(this,config);this.stepNames=config.steps;this.on("render",function(headerPanel){PTC.wizard.StepLinksPanel.superclass.render.apply(this,arguments);if(!this.wizard_ItemTpl){var wizard_tt=new Ext.Template("<li class={stepLinkCls} id={stepLinkId} tabindex=0>"+
"<div class={stepIconCls} id={stepIconId}>{stepNumber}</div>{stepName}</li>");wizard_tt.disableFormats=true;wizard_tt.compile();this.wizard_ItemTpl=wizard_tt}if(!this.clerk_ItemTpl){var clerk_tt=new Ext.Template('<li id="{stepTabId}">'+'<a class="x-tab-right" onclick="PTC.wizard.setActiveStep(\'{stepId}\');return false;"> <em class="x-tab-left">'+'<span class="x-tab-strip-inner {stepTabCls}"><span class="x-tab-strip-text">{stepName}</span></span>'+"</em></a></li>");clerk_tt.disableFormats=true;clerk_tt.compile();
this.clerk_ItemTpl=clerk_tt}this.renderLinkPanel(headerPanel)},this);this.attachOnClickHandler=PTC.util.delayAllCalls(this.attachOnClickHandler,250);this.updateStepIcons=PTC.util.delayAllCalls(this.updateStepIcons,250);this.afterLayoutHandler=PTC.util.delayAllCalls(this.afterLayoutHandler,250);this.on("afterlayout",this.afterLayoutHandler,this,{delay:200});this.on("afterlayout",function(){if(wizardTypeValue==="wizard"){this.attachOnClickHandler();PTC.wizard.StepLinksPanelUtil.updateStepImages()}},
this,{single:true});this.on("bodyresize",function(){this.checkIfScrollButtonsNeeded();if(this.scrollEnabled&&this.scrollPosition<this.getMaxScrollPosition())this.scrollHeaderPanel()},this)},afterLayoutHandler:function(){this.strip=this.el;this.cacheStepComponentData()},renderLinkPanel:function(){if(steps.length===1){this.addClass("empty");return}var components=[];this.scrollWidth=0;this.stepComponents=components;this.stripWrapHolder=this.el.createChild({id:"stripWrapHolder",cls:"stepPanel"});if(wizardTypeValue===
"wizard"){this.stripWrap=this.stripWrapHolder.createChild({id:"stripWrap",cls:"x-header-strip-wrap",cn:{tag:"ul",id:"stripTabWrap",cls:"header-strip",html:this.getStepComponentsHtml()}});var firstStep=PTC.wizard.getStepLink(this.stepNames[0]);var lastStep=this.findLastVisibleStep();if(firstStep===lastStep)firstStep.addClass("single");else{if(firstStep)firstStep.addClass("first");if(lastStep)lastStep.addClass("last")}}else if(wizardTypeValue==="clerk")this.stripWrap=this.stripWrapHolder.createChild({id:"stripWrap",
cls:"x-tab-strip-wrap",cn:{tag:"ul",id:"stripTabWrap",cls:"x-tab-strip x-tab-strip-top",html:this.getStepComponentsHtml()}});this.strip=this.el;this.checkIfScrollButtonsNeeded();this.cacheStepComponentData();this.positionActiveStep(currentStepStrName);if(wizardTypeValue==="clerk")this.setActiveTab(this.activeTab)},findLastVisibleStep:function(){var i=this.stepNames.length-1;var lastStep=null;while(i>=0&&lastStep===null){var stepName=this.stepNames[i];var step=wizardSteps[stepName];if(step&&!step.hidden)lastStep=
PTC.wizard.getStepLink(stepName);i--}return lastStep},getStepComponentsHtml:function(stepId){var html="";var template;if(wizardTypeValue==="wizard"){this.stepIndex=0;template=this.wizard_ItemTpl}else if(wizardTypeValue==="clerk")template=this.clerk_ItemTpl;this.stepNames.each(function(stepId){if(!wizardSteps[stepId].hidden){this.stepIndex++;var stepCmp={};this.stepComponents[stepId]=stepCmp;var args=this.getTemplateArgs(stepId);html=html+template.apply(args);if(wizardTypeValue==="clerk"&&wizardSteps[stepId].isActive)this.activeTab=
stepId}},this);return html},getTemplateArgs:function(stepId){if(wizardTypeValue==="wizard"){var stepIconCls=this.getClsClassForIcon(stepId);this.stepComponents[stepId].iconCls=stepIconCls;return{stepId:stepId,stepLinkId:stepId+"_link",stepIconId:stepId+"_icon",stepLinkCls:"wizardstepLinks",stepIconCls:stepIconCls,stepNumber:this.stepIndex,stepName:wizardSteps[stepId].label}}else if(wizardTypeValue==="clerk")return{stepId:stepId,stepTabId:stepId+"_tab",stepTabCls:"stepClerkTab",stepName:wizardSteps[stepId].label}},
getClsClassForIcon:function(stepId){var stepIconCls;if(wizardSteps[stepId].isActive)stepIconCls="stepIcon-active";else if(wizardSteps[stepId].visited)stepIconCls="stepIcon-visited";else stepIconCls="stepIcon-nonVisited";return stepIconCls},getHeaderPanel:function(){return Ext.get("stripTabWrap")},repaintStepLinkPanel:function(){this.stepIndex=0;Ext.get("stripWrapHolder").remove();this.renderLinkPanel();this.updateStepIcons()},onScrollRight:function(){var len=this.stepNames.length;var scroll=this.scrollWidth/
len;this.scrollPosition=this.scrollPosition-scroll;this.scrollHeaderPanel()},onScrollLeft:function(){var len=this.stepNames.length;var scroll=this.scrollWidth/len;this.scrollPosition=this.scrollPosition+scroll;this.scrollHeaderPanel()},createScrollBars:function(el){var height=el.getHeight();this.leftScroller=el.insertFirst({id:"stepLeftScroller",tag:"div",cls:"stepLeftScroller"});this.leftScroller.on({click:this.onScrollLeft,scope:this});this.leftScroller.addClassOnOver("ele-mouse-over");this.leftScroller.setHeight(height);
this.rightScroller=el.insertFirst({id:"stepRightScroller",tag:"div",cls:"stepRightScroller"});this.rightScroller.on({click:this.onScrollRight,scope:this});this.rightScroller.addClassOnOver("ele-mouse-over");this.rightScroller.setHeight(height)},hideScrollBars:function(){this.scrollEnabled=false;var sw=Ext.get("stripWrap");if(sw){Ext.get("stripWrap").dom.style.left=this.startPos+"px";var scrollLeftCmp=Ext.get("stepLeftScroller");if(scrollLeftCmp!=="undefined"&&scrollLeftCmp!==null)scrollLeftCmp.hide();
var scrollRightCmp=Ext.get("stepRightScroller");if(scrollRightCmp!=="undefined"&&scrollRightCmp!==null)scrollRightCmp.hide()}},showScrollBars:function(){this.scrollEnabled=true;var scrollLeftCmp=Ext.get("stepLeftScroller");var scrollRightCmp=Ext.get("stepRightScroller");if(scrollLeftCmp!=="undefined"&&scrollLeftCmp!==null||scrollRightCmp!=="undefined"&&scrollRightCmp!==null){scrollLeftCmp.show();scrollRightCmp.show()}else{this.createScrollBars(this.strip);this.scrollPosition=this.startPos;this.scrollHeaderPanel()}},
scrollHeaderPanel:function(){if(this.scrollPosition<=this.getMaxScrollPosition())this.scrollPosition=this.getMaxScrollPosition();if(this.scrollPosition>=this.startPos)this.scrollPosition=this.startPos;this.updateScrollButtons();Ext.get("stripWrap").dom.style.left=this.scrollPosition+"px"},getMaxScrollPosition:function(){var windowWidth=getWindowWidth();return windowWidth-this.scrollWidth-80},isStepIconClickable:function(stepId){var value=!wizardSteps[stepId].hidden&&(stepId===currentStepStrName||
isOKEnabled()||wizardSteps[stepId].visited||PTC.wizard.isPreviousStepActive(stepId));return value},updateStepIcon:function(stepId){if(wizardTypeValue=="wizard"){var stepIcon=Ext.get(stepId+"_icon");if(stepIcon){var stepIconCls=this.getClsClassForIcon(stepId);stepIcon.replaceClass(this.stepComponents[stepId].iconCls,stepIconCls);this.stepComponents[stepId].iconCls=stepIconCls}var stepLink=PTC.wizard.getStepLink(stepId);if(stepLink){if(wizardSteps[stepId].isActive)stepLink.addClass("active");else stepLink.removeClass("active");
if(this.isStepIconClickable(stepId)){stepLink.isClickable=true;stepLink.addClass("enabled")}else{stepLink.isClickable=false;stepLink.removeClass("enabled")}}}},updateStepIcons:function(){this.stepNames.each(function(stepId){this.updateStepIcon(stepId)},this)},attachOnClickHandler:function(){var thisItem=this;this.stepNames.each(function(stepId){if(!wizardSteps[stepId].hidden){var stepLink;stepLink=PTC.wizard.getStepLink(stepId);if(stepLink){stepLink.stepId=stepId;PTC.wizard.registerClickHandler(stepLink,
stepId)}}})},checkIfScrollButtonsNeeded:function(){if(getWindowWidth()<this.scrollWidth+10)this.showScrollBars();else this.hideScrollBars()},updateScrollButtons:function(){var pos=this.scrollPosition;if(pos===0){this.leftScroller.addClass("scroller-disabled");this.rightScroller.removeClass("scroller-disabled")}else if(pos===this.getMaxScrollPosition()){this.leftScroller.removeClass("scroller-disabled");this.rightScroller.addClass("scroller-disabled")}else{this.leftScroller.removeClass("scroller-disabled");
this.rightScroller.removeClass("scroller-disabled")}},cacheStepComponentData:function(){var compSize=0;var components=this.stepComponents;this.stepNames.each(function(item){var stepDiv;if(wizardTypeValue==="wizard")stepDiv=PTC.wizard.getStepLink(item);else if(wizardTypeValue==="clerk")stepDiv=Ext.get(item+"_tab");if(stepDiv!==undefined&&stepDiv!==null){compSize+=stepDiv.getWidth();components[item].Xaxis=stepDiv.getX()-this.scrollPosition;components[item].YAxis=stepDiv.getY();components[item].width=
stepDiv.getWidth()}},this);this.scrollWidth=compSize;this.positionActiveStep(currentStepStrName)},setActiveTab:function(stepId){var activeTabLink=Ext.get(this.activeTab+"_tab");if(activeTabLink!=="undefined"&&activeTabLink!==null)activeTabLink.removeClass("x-tab-strip-active");var stepLink=Ext.get(stepId+"_tab");stepLink.addClass("x-tab-strip-active");this.activeTab=stepId},positionActiveStep:function(stepId){if(stepId==="")return;if(this.scrollEnabled){var x=this.stepComponents[stepId].Xaxis+this.stepComponents[stepId].width;
var leftCornerPoint=this.scrollPosition*-1;var rightCornerPoint=this.scrollPosition*-1+(getWindowWidth()-20);if(x-this.stepComponents[stepId].width<leftCornerPoint||x>rightCornerPoint){this.scrollPosition=getWindowWidth()/2-x;this.scrollHeaderPanel()}}return true},disableSelection:function(){var target=$("stephdr");if(typeof target.onselectstart!="undefined")target.onselectstart=function(){return false};else if(typeof target.style.MozUserSelect!="undefined")target.style.MozUserSelect="none";else target.onmousedown=
function(){return false};target.style.cursor="default"}});PTC.wizard.registerClickHandler=function(stepLink,stepId){stepLink.un("click",PTC.wizard.stepLinkClickHandler);stepLink.on("click",PTC.wizard.stepLinkClickHandler,stepLink);stepLink.un("keypress",PTC.wizard.stepLinkKeyPressHandler);stepLink.on("keypress",PTC.wizard.stepLinkKeyPressHandler,stepLink)};PTC.wizard.stepLinkClickHandler=function(event,target){if(this.isClickable)PTC.wizard.setActiveStep(this.stepId);else return false};
PTC.wizard.stepLinkKeyPressHandler=function(event,target){var keynum=event.getKey();if(keynum===event.RETURN)PTC.wizard.stepLinkClickHandler.call(this,event,target)};PTC.wizard.getCurrentObjectHandle=function(){var step=wizardSteps[getCurrentStep()];if(step&&step.objectHandle)return step.objectHandle;return""};
PTC.wizard.firstPostLoad=function(){try{if(!steps)return;if(steps.length===1){var nextButton=findButtonByActionID("PJL_wizard_next");if(nextButton)nextButton.hide();var prevButton=findButtonByActionID("PJL_wizard_previous");if(prevButton)prevButton.hide()}PTC.external.init();initPopupForm();if(startStep)stepIndex=findStepIndex(startStep);var steps_length=steps.length;for(var i=0;i<steps_length;i++)if(steps.length>1&&wizardTypeValue=="wizard")wizardSteps[steps[i]].isComplete=false;else{wizardSteps[steps[i]].required=
true;wizardSteps[steps[i]].isAsync=true;wizardSteps[steps[i]].isComplete=true;wizardSteps[steps[i]].isDirty=false}currentStepStrName=steps[stepIndex];wizardSteps[currentStepStrName].preloadJS();wizardSteps[currentStepStrName].postloadJS();wizardSteps[currentStepStrName].isComplete=true;wizardSteps[currentStepStrName].isDirty=false;recalcIncomplete();if(steps.length>1)if(wizardTypeValue==="wizard"){if(incompleteSteps>0&&steps.length>1)disableOkButton();else enableOkButton();resetNextBackButton(currentStepStrName)}getStyleFromId(currentStepStrName+
"Pane").display="inline";updateWizardContentHeader();updateEmbeddedText();adjustWizardContentAreaHeight();PTC.wizard.isReady=true;PTC.checkAndFireReady()}finally{updateRequiredLabel.defer(10);PTC.wizard.isReady=true;PTC.wizard.fireEvent("wizardLoadComplete")}};PTC.wizard.getStepLink=function(stepName){return Ext.get(stepName+"_link")};
PTC.wizard.focusFirstInput=function(){var inputs=Ext.DomQuery.jsSelect(".required",Ext.getDom(currentStepStrName));for(var i=0,l=inputs.length;i<l;i++){var item=inputs[i];var tagname=item.tagName.toLowerCase();var fly=Ext.fly(item);if((tagname==="input"||tagname==="select"||tagname==="textarea")&&fly.isVisible(true)){fly.focus(50);return true}}return false};
PTC.wizard.focusOnReadyFunc=function(trycount){if(!trycount||trycount<=0)trycount=1;var focused=PTC.wizard.focusFirstInput();PTC.wizard.log.debug("Try "+trycount+" focusFirstInput "+focused);if(!focused&&trycount<10){trycount++;PTC.wizard.focusOnReadyFunc.defer(200,null,[trycount])}};PTC.onReady(function(){if(isWizardWindow())PTC.wizard.focusOnReadyFunc()});
PTC.wizard.showSplitPaneOnWizardStep=function(panelIdToRenderTo,panelSize,orientation){var panel=Ext.getCmp(panelIdToRenderTo);if(!panel)return;panel.doLayout();var twoPanesId=PTC.navigation.contentTabID+"_twoPanes_"+orientation;var resized=PTC.navigation.resizePanes(Ext.getCmp(twoPanesId),panelSize,orientation);if(resized)panel.doLayout()};
PTC.wizard._fireOnAfterAction=function(formResult,windowName,forwardedToNewURL){var result=true;if(!forwardedToNewURL){var target=PTC.action.actionTarget||PTC.action.getActionTarget(windowName);if(!target&&formResult)target=formResult.getTableId();PTC.wizard.log.debug("action target is: ",target);if(typeof target==="string"){var table=PTC.util.getCmpInAllPTCnameSpaces(target);if(!table)table=PTC.util.getCmpInAllPTCnameSpaces(PTC.jca.table.Utils.getUnformattedTableId(target));target=table}if(!target){var dom=
Ext.get(getMainForm()).up(".x-panel");if(dom&&dom.id)target=PTC.util.getCmpInAllPTCnameSpaces(dom.id)}if(target&&!target.doc)target=PTC.util.getCmpInAllPTCnameSpaces(target.id);if(target){result=target.fireEvent("afteraction",formResult);if(!result)result=false}else PTC.action.log.warn("Could not find a target object for the afterAction Event",formResult.actionName,windowName,formResult)}PTC.action.actionTarget=null;PTC.action.removeActionTarget(windowName);var allWindows=PTC.util.getAllPTCWindows();
var iframes=PTC.util.getAllPTCIframes();allWindows=allWindows.concat(iframes);var i=allWindows.length;while(i--){var win=allWindows[i];if(win)win.PTC.action.fireEvent("objectsaffected",formResult)}return result};
PTC.wizard.fireOnAfterAction=function(formResult){var wizOpener=getPopupOpenerWindow();try{if(wizOpener&&typeof wizOpener.getWindow==="function")wizOpener=wizOpener.getWindow()}catch(ex){}var forwarded=PTC.wizard._handleForwardFormResult(formResult,wizOpener);try{if(PTC.wizard.finished&&isWizardWindow()&&wizOpener&&wizOpener.PTC)return wizOpener.PTC.wizard._fireOnAfterAction(formResult,window.name,"LOAD_OPENER_URL"===forwarded);else return PTC.wizard._fireOnAfterAction(formResult,window.name,"FORWARD"===
forwarded)}catch(e){PTC.log.error(e)}return true};
PTC.wizard._handleForwardFormResult=function(formResult,wizOpener){var result=false;var nextAction=formResult.nextAction;if((nextAction===2||nextAction===6)&&formResult.URL){var win=getWindow();result="FORWARD";if(nextAction===2&&wizOpener&&isWizardWindow()){win=wizOpener;result="LOAD_OPENER_URL"}var url=formResult.URL;if(url.indexOf("redirectRecipient")<0)win.PTC.navigation.loadContent(url,true);else win.location.href=url;if(formResult.getTableId())jsca.unSelectAll(null,formResult.getTableId());
else unSelectAll()}formResult.URL=undefined;formResult.nextAction=undefined;return result};PTC.wizard.close=function(){if(PTC.lightbox.isLightbox(window))PTC.lightbox.deactivate({lbWindow:self});else wfWindowClose()};Ext.ns("PTC.workflowTask");PTC.workflowTask.onObjectsAffected=function(formResult){if(formResult.hasUpdatedOids())PTC.navigation.submitForm();return true};Ext.ns("PTC.wvs");
PTC.wvs=function(){return{getWVSGatewayURL:function(serverClass,methodToInvoke){var pageNoParam="";var queryString=location.search.substring(1);if(PTC.isDefined(location.search)&&queryString.length>0){var params=queryString.split("&");for(var i=0;i<params.length;i++)if(params[i].indexOf("unique_page_number=")==0)pageNoParam=params[i]+"&"}return getBaseHref()+"netmarkets/jsp/wvs/wvsGW.jsp?"+pageNoParam+"class="+serverClass+"&method="+methodToInvoke},validateIsInteger:function(component,value,errorMsgRB){var isInteger_re=
/^\s*(\+|-)?\d+\s*$/;var testValue;if(value!=null){if(String(value).search(isInteger_re)==-1){JCAAlert(errorMsgRB);return false}}else if(component.value!=null){if(String(component.value).search(isInteger_re)==-1){JCAAlert(errorMsgRB);setTimeout('setSelect("'+component.name+'");',0);return false}}else return false;return true},validateIsGreaterThanEqualZero:function(component,value,errorMsgRB){var aValue;if(value!=null){aValue=parseFloat(value);if(aValue<1||isNaN(aValue)){JCAAlert(errorMsgRB);return false}}else if(component!=
null){aValue=parseFloat(component.value);if(aValue<1||isNaN(aValue)){JCAAlert(errorMsgRB);setTimeout('setSelect("'+component.name+'");',0);return false}}else return false;return true},log:function(message){jsca.log(message)},error:function(message){jsca.error(message)}}}();PTC.wvs.ListRepFiles={};
PTC.wvs.ListRepFiles.ContentMenu=Ext.extend(Ext.menu.Item,{initComponent:function(){var theOid=null;var t=Ext.getCmp("repsAndMarkupsTableId");if(typeof t=="undefined")t=Ext.getCmp("clipboardList");if(typeof t!="undefined"){var rowIndex=PTC.jca.table.Utils.getFocusedRowIndex(t);if(!isNaN(rowIndex)&&rowIndex>=0){var record=t.getStore().getAt(rowIndex);theOid=record.data.oid}}var params="";if(theOid!=null)params=params+"?oid="+theOid;else PTC.wvs.log("ERROR PTC.wvs.ListRepFiles.ContentMenu UNABLE to find Representation");
var options={parameters:params};this.menu=new PTC.menu.DynamicMenu({id:"listRepFilesMenu",loadOnce:true,bubbleEvents:["remove"],requestOptions:options,requestUrl:getBaseHref()+"ptc1/listRepFiles/"});PTC.wvs.ListRepFiles.ContentMenu.superclass.initComponent.call(this)}});Ext.reg("listRepFiles",PTC.wvs.ListRepFiles.ContentMenu);
PTC.wvs.ListRepFiles.ContentMenuItem=Ext.extend(Ext.menu.Item,{mClickUrl:null,initComponent:function(){this.listeners={click:function(item,e){if(item.mClickUrl!=null)if(!Ext.isChrome){var newwindow=wfWindowOpen(item.mClickUrl,"_blank","resizable=1,height=690,width=780,scrollbars=0,toolbar=0,menubar=0,location=0,directories=0,status=0");newwindow.focus()}else window.location.href=item.mClickUrl;else alert("ERROR: url for click is missing")}};PTC.wvs.ListRepFiles.ContentMenuItem.superclass.initComponent.call(this)}});
Ext.reg("listRepFilesInput",PTC.wvs.ListRepFiles.ContentMenuItem);PTC.trail={};PTC.trail.GENERATED_ID="jcaGen_";PTC.trail.navigation={};PTC.trail.navigation.listener=function(){};PTC.trail.isTrailEnabled=function(){var isTrail=typeof isWfTrl==="function"&&isWfTrl();PTC.trail.isTrailEnabled=function(){return isTrail};return isTrail};
PTC.trail._loadSupport=function(forceLoad){if(extractParamValue(document.location.href,"isWfTrl")==="true"){isWfTrl=TRUE_FUNC;PTC.trail.isTrailEnabled=TRUE_FUNC}if(PTC.trail.isTrailEnabled()||forceLoad)PTC.navigation.loadScript("netmarkets/javascript/util/trail/core.js",true)};
if(!("domDump"in PTC.trail))PTC.trail.domDump={execute:function(){return this.initialize()?PTC.trail.domDump.execute():null},write:function(){return this.initialize()?PTC.trail.domDump.write():null},initialize:function(){if(!PTC.trail.domDump.loaded){PTC.trail._loadSupport(true);if(!PTC.trail.domDump.loaded)PTC.log.error("error trying to load domDump.js namespace");return PTC.trail.domDump.loaded}PTC.log.error("there should not be any calls to initialize after domDump namespace is loaded");return false}};
PTC.trail._loadSupport();PTC.trail.DomDumpHandlers=[];PTC.trail.addDomDumpHandler=function(handlerId,handlerFunctionName,jsFile){var handlers=PTC.trail.DomDumpHandlers;for(var i=0,l=handlers.length;i<l;i++){var handler=handlers[i];if(handlerId===handler.id){handler.func=handlerFunctionName;handler.jsFile=jsFile;return}}PTC.trail.DomDumpHandlers[handlers.length]={id:handlerId,func:handlerFunctionName,jsFile:jsFile}};
PTC.trail.addDomDumpHandler("Info_Page_Dom_Dump","PTC.trail.infoPage.domDumpHandler","/netmarkets/javascript/util/trail/domDump/infoPage.js");PTC.trail.addDomDumpHandler("Table_Dom_Dump","PTC.trail.table.domDumpHandler","/netmarkets/javascript/util/trail/domDump/table.js");PTC.trail.addDomDumpHandler("AttributePanel_Dom_Dump","PTC.trail.attributes.domDumpHandler","/netmarkets/javascript/util/trail/domDump/attributesPanel.js");var _mtIsIE=false;var _mtIsChrome=false;var _mtIsWin=true;
if(navigator.appVersion.indexOf("MSIE")!=-1||navigator.appVersion.indexOf("Trident")!=-1)_mtIsIE=true;if(navigator.appVersion.indexOf("Chrome")!=-1)_mtIsChrome=true;if(navigator.platform.indexOf("Win")==-1)_mtIsWin=false;var _mtTimeOut=null;var _mtTimeOutImg=null;var _mtImageHash=null;var _mtImageHashSize=0;function wvs_clear_cache(){var s=_mtImageHashSize;if(s>1E3){_mtImageHash=null;_mtImageHashSize=0;PTC.navigation.un("historyChange",wvs_clear_cache)}return true}
function wvs_cache_size(){var count=0;if(_mtImageHash==null)return count;for(var prop in _mtImageHash)if(typeof _mtImageHash[prop]!=="function")count++;return count}
function wvsimt(icon,obj){icon.onload=null;if(icon.parentNode==null)return;if(!_mtImageHash){_mtImageHash={};PTC.navigation.on("historyChange",wvs_clear_cache)}var cimg=_mtImageHash[obj];if(cimg){if(cimg.src==""){wvs_add_icon_actions(icon,obj);return}try{icon.src=cimg.src}catch(e){}wvs_add_icon_actions(icon,obj);return}var image=new Image(24,16);image.onload=function(){if(_mtImageHash[obj]==null)_mtImageHashSize++;_mtImageHash[obj]=image;try{icon.src=image.src}catch(e){}wvs_add_icon_actions(icon,
obj);image.onload=null;image.onerror=null};image.onerror=function(){image.onerror=null;if(obj.indexOf("ClashToClashReportLink")>0)image.src="wt/clients/images/wvs/thumbnailnavclash.png";else image.src="wt/clients/images/wvs/thumbnailnav.png"};image.src="servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getMThumb?oid="+obj}
function wvs_add_icon_actions(icon,obj){var OR=obj.indexOf("OR:")!==0&&obj.indexOf("VR:")!==0?"OR:":"";icon.setAttribute("oid",OR+obj);icon.onmouseover=wvs_mt_mouseover;icon.onmouseout=wvs_mt_mouseout}function wvs_mt_mouseover(){if(WVSPopup.stuck)return;_mtTimeOutImg=this;if(WVSPopup.win&&WVSPopup.win.isVisible())wvs_do_show_popup();else _mtTimeOut=setTimeout(wvs_do_show_popup,500)}function wvs_mt_mouseout(){if(_mtTimeOut)clearTimeout(_mtTimeOut)}
function wvs_mt_click(){if(WVSPopup.stuck)return;_mtTimeOutImg=this;wvs_do_show_popup()}function wvs_do_show_popup(){var i=_mtTimeOutImg;if(i==null)return;var pos=Ext.get(i).getXY();WVSPopup.show(i.getAttribute("oid"),pos[0]+i.clientWidth+5,pos[1],false,true,true)}
function MTaddDependencies(cc,title,mtp,panel){var ret="";var numItems=0;if(cc!=null&&cc.length>0){numItems=cc.length;for(var i=0;i<cc.length;i++){var c=cc[i];var nnv=PTC.util.HTMLEncoder.encodeForHTMLContent(c.getAttribute("n"));var oid=c.getAttribute("o");var count=c.getAttribute("c");if(count==null)count=0;var imo=count==-1?"":" ";var mo=" onmouseover=MTmouseOverImg(this,'"+oid+"',"+count+") onmouseout=MTmouseOutImg(this,'"+oid+"',"+count+") id='cmt"+oid+"' cmt='"+count+"' xtitle='"+nnv+"' mtp='"+
mtp+"'";ret+='<span style="display:inline-block; white-space:nowrap">';ret+="<img src='"+c.getAttribute("i")+"' id='imt"+oid+"' class='miniInfoTableIcon' onclick=MTnavigateTo('"+oid+"')"+imo+">";var ad=c.getAttribute("ad");var imgsrc=ad!=null?"servlet/WindchillAuthGW/wt.content.ContentHttp/viewContent/mt.jpg?u8&HttpOperationItem="+ad+"&ContentHolder="+c.getAttribute("ch"):WVSPopup.type=="clashreport"&&WVSPopup.use3D&&mtp=="0"?"wt/clients/images/wvs/thumbnailnavclash.png":"wt/clients/images/wvs/thumbnailnav.png";
ret+="<img src='"+imgsrc+"' class='miniInfoThumbnail' onclick=MTnavigateTo('"+oid+"')"+mo+">";ret+="&nbsp;";ret+="</span>"}}var objectsStr=PTC.jca.miniTableCountMsg(numItems);panel.setTitle(PTC.miniNavigator.getMiniTableTitleBar(title,objectsStr));return ret}
function MTmouseOverImg(img,oid,count){if(WVSPopup.showing3D&&!WVSPopup.pviewReady)return;WVSPopup.selectedChild=oid;img.style.border="1px solid #FF0000";_mtTimeOutImg=img;_mtTimeOut=setTimeout(MTmouseOverImgTooltip,500);if(WVSPopup.isNavigateMode()&&PTC.miniNavigator.is3dPluginPresent())for(var i=0;i<count;i++)document.mtpvctl.SelectInstance("/"+oid+":"+i)}
function MTmouseOverImgTooltip(){var pos=WVSFindAbsPos(_mtTimeOutImg);WVSPopup.showStatus(MTFormatTooltip(_mtTimeOutImg.getAttribute("xtitle")),pos[0]+24,pos[1]+16,false);if(WVSPopup.type=="clashreport"&&WVSPopup.use3D&&_mtTimeOutImg.getAttribute("mtp")=="0"){var d=new Date;var thumbnail3d=WVSPopup.baseURL+"servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getPVS?oid="+WVSPopup.selectedChild+"&forreport=1&f="+d.getTime()+".pvs";MTsetViewer(null,thumbnail3d)}}
function MTmouseOutImg(img,oid,count){if(WVSPopup.showing3D&&!WVSPopup.pviewReady)return;WVSPopup.selectedChild=null;if(WVSPopup.isNavigateMode()&&PTC.miniNavigator.is3dPluginPresent())document.mtpvctl.DeSelectAll();if(_mtTimeOut)clearTimeout(_mtTimeOut);WVSPopup.hideStatus();var images=Ext.DomQuery.jsSelect("img[id^=cmt]",WVSPopup.right_col);Ext.each(images,function(image){image.style.border="1px solid #FFFFFF"})}
function MTFormatTooltip(text){text=PTC.util.HTMLEncoder.encodeForHTMLContent(text);if(text){text=text.replace(/\|st\|/g,"<br><img width='24' height='16' style='margin-right:4px; vertical-align:middle;' onerror='this.src=\"wt/clients/images/wvs/blank.gif\";' src='servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getMThumb?oid=");text=text.replace(/\|en\|/g,"'>")}return text}
MTnavigateTo=MTnavigateTo.wrap(function(proceed,oid,nullFHistory){if(WVSPopup.showing3D){if(!WVSPopup.pviewReady)return;if(PTC.miniNavigator.is3dPluginPresent())WVSPopup.pviewOrientation=document.mtpvctl.GetViewLocation()}return proceed.call(this,oid,nullFHistory)});function MTnavigateToAssociated(){if(WVSPopup.assocoid)MTnavigateTo(WVSPopup.assocoid)}
function MTzoomToAllPlugin(){try{if(_mtIsChrome)window.setTimeout("document.mtpvctl.ZoomToAll();",100);else document.mtpvctl.ZoomToAllTime(0)}catch(e){}}function MTzoomToAll(){if(!WVSPopup.showing3D||!WVSPopup.pviewReady)return;MTzoomToAllPlugin()}function MTspinCenter(){if(!WVSPopup.showing3D||!WVSPopup.pviewReady)return;WVSPopup.pviewMode="spincenter";document.mtpvctl.SetMode(WVSPopup.pviewMode)}
function MTcopyToSystemClipboard(){if(!WVSPopup.showing3D||!WVSPopup.pviewReady)return;var retok=false;var ret="";var pvaction=WVSPopup.pvaction;if(pvaction=="2"&&WVSPopup.typenav)pvaction="3";if(pvaction=="1"||pvaction=="3"||pvaction=="4"||pvaction=="5"){ret=MTLaunchPVOption(false,WVSPopup.oid,pvaction);if(ret!=null&&ret!=""){var i=ret.indexOf("('");if(i<0){i=ret.indexOf('("');if(i>0){ret=ret.substring(i+2);i=ret.indexOf('"');if(i>0){ret=ret.substring(0,i);retok=true}}}else{ret=ret.substring(i+2);
i=ret.indexOf("'");if(i>0){ret=ret.substring(0,i);retok=true}}}}if(retok){var s=ret.split("?");if(s[0].indexOf("://")<0){if(ret.substring(0,1)=="/"){ret=ret.substring(1);ret=ret.substring(ret.indexOf("/")+1)}ret=WVSPopup.baseURL+ret}document.mtpvctl.CopyToClipboardWithUrl(ret)}else document.mtpvctl.CopyToClipboard()}
function MTcopyToSuccess(xmlhttp){if(xmlhttp.responseText&&xmlhttp.responseText.length>0){var pos=WVSPopup.win.getPosition(false);WVSPopup.showStatus(PTC.util.HTMLEncoder.encodeForHTMLContent(xmlhttp.responseText),pos[0]+40,pos[1]+274,true)}}
function MTcopyTo(){var copy_oid=WVSPopup.oid;if(WVSPopup.type.indexOf("clash_")===0){if(!WVSPopup.assocoid)return;copy_oid=WVSPopup.assocoid}WVSPopup.pinit();var OR="";if(copy_oid.indexOf("OR:")!==0&&copy_oid.indexOf("VR:")!==0)OR="OR:";var theURL="wtcore/jsp/wvs/clipboard_copy.jsp?copy_object="+OR+copy_oid+"&byProductView=1";WVSPopup.fetchServerData(theURL,{onSuccess:MTcopyToSuccess})}function MTsetViewerNull(){MTsetViewer(null,null)}
function MTsetViewer(thumbnail,thumbnail3d){if(WVSPopup.isNavigateMode()){var d=new Date;thumbnail3d=WVSPopup.baseURL+"servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getPVS?oid="+WVSPopup.oid+"&f="+d.getTime()+".pvs"}if(thumbnail3d==null){WVSPopup.showing3D=false;if(thumbnail!=null)if(WVSPopup.showdyndoc==true){var dynDocPanel=Ext.getCmp("dyn_doc_panel");dynDocPanel.body.update("");new Ajax.Request(thumbnail,{asynchronous:true,method:"post",parameters:{},onSuccess:function(transport){if(_mtIsIE)dynDocPanel.body.update('<img style="display:none"/>'+
transport.responseText);else dynDocPanel.body.update(transport.responseText)},onFailure:function(){PTC.wvs.error("An error occurred when attempting to perform an ajax call to "+url)}})}else WVSPopup.pviewimg.src=thumbnail;else if(_docColorOption==-3618616)WVSPopup.pviewimg.src="wt/clients/images/wvs/gradient_bg.png";else WVSPopup.pviewimg.src="wt/clients/images/wvs/sp.gif";if(WVSPopup.showdyndoc==true){wvs_hide_3D();wvs_hide_2D();wvs_show_dynDoc()}else{wvs_hide_3D();wvs_hide_dynDoc();wvs_show_2D()}}else if(WVSPopup.showdyndoc==
false){WVSPopup.showing3D=true;if(typeof document.mtpvctl=="undefined"){var ret="";if(_mtIsIE){ret+="<script for='mtpvctl' event='OnDoAction()'>MTNSDoAction()<\/script>";ret+="<script for='mtpvctl' event='OnRMB(x,y)'>MTNSDoRMBAction(x,y)<\/script>";ret+="<script for='mtpvctl' event='OnLoadComplete()'>MTNSLoadComplete()<\/script>";ret+="<script for='mtpvctl' event='OnPreSelectedInstance(text)'>MTPreSelect(text)<\/script>";ret+="<script for='mtpvctl' event='OnClearPreSelection()'>MTClearPreSelect()<\/script>"}else _visNavEvents=
"MTInitNSEvents()";var urltemplate=WVSPopup.baseURL+"servlet/WindchillAuthGW/wt.content.ContentHttp/viewContent/FILENAME_KEY?u8&HttpOperationItem=OID1_KEY&ContentHolder=OID2_KEY";var configurl=WVSPopup.baseURL+"wtcore/jsp/wvs/visminithumb.jsp?a=1";if(typeof _docColorOption!="undefined"&&_docColorOption!=null){configurl+="&bc="+(_docColorOption&16777215);if(typeof _docGradColorOption!="undefined"&&_docGradColorOption!=null)configurl+="&gc="+(_docGradColorOption&16777215)}ret+=MTGetPviewHtml(" urltemplate='"+
urltemplate+"' configurl='"+configurl+"' src='"+thumbnail3d+"' renderatstartup='true' thumbnailView='true' getetb='false' userid='"+PTC.navigation.GLOBAL_USER_ID+"' ");WVSPopup.pviewrun.innerHTML=ret;wvs_hide_2D();wvs_hide_dynDoc();wvs_show_3D();try{if(_mtIsIE)document.mtpvctl.IsRunning()}catch(e){WVSPopup.setMode(false,false);WVSPopup.showing3D=false;wvs_hide_3D();wvs_hide_dynDoc();wvs_show_2D()}}else{wvs_hide_dynDoc();wvs_hide_2D();wvs_show_3D();document.mtpvctl.src=thumbnail3d}}}
function wvs_hide_3D(){if(PTC.miniNavigator.is3dPluginPresent())if(_mtIsIE){if(WVSPopup.pviewrun.style.display=="")WVSPopup.pviewrun.style.display="none"}else if(WVSPopup.pviewrun.style.width!="0pt"&&WVSPopup.pviewrun.style.width!="0px"){WVSPopup.pviewrun.style.width="0px";WVSPopup.pviewrun.style.height="0px"}}function wvs_hide_2D(){if(WVSPopup.pviewimg.style.display=="")WVSPopup.pviewimg.style.display="none"}
function wvs_hide_dynDoc(){var dynDocPanel=Ext.getCmp("dyn_doc_panel");if(dynDocPanel&&dynDocPanel.isVisible())dynDocPanel.hide()}
function wvs_show_3D(){if(_mtIsIE){if(WVSPopup.pviewrun.style.display=="none")WVSPopup.pviewrun.style.display=""}else if(WVSPopup.pviewrun.style.width=="0pt"||WVSPopup.pviewrun.style.width=="0px"){WVSPopup.pviewrun.style.width=PTC.miniNavigator.getThumbnailWidth();WVSPopup.pviewrun.style.height=PTC.miniNavigator.getThumbnailHeight()}else if(WVSPopup.pviewrun.style.display=="none")WVSPopup.pviewrun.style.display=""}
function wvs_show_2D(){if(WVSPopup.pviewimg.style.display=="none")WVSPopup.pviewimg.style.display=""}function wvs_show_dynDoc(){var dynDocPanel=Ext.getCmp("dyn_doc_panel");if(dynDocPanel&&!dynDocPanel.isVisible())dynDocPanel.show()}function MTswitchTo3DSuccess(xmlhttp){if(xmlhttp.responseText&&xmlhttp.responseText.length>0)MTsetViewer(null,xmlhttp.responseText)}
function MTswitchTo3D(){if(!WVSPopup.use3D||WVSPopup.showing3D||WVSPopup.show3D)return;WVSPopup.show3D=true;WVSPopup.pviewReady=false;if(WVSPopup.isNavigateMode()){window.setTimeout(MTsetViewerNull,0);return}var theURL="servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getThumb3DURL?oid="+WVSPopup.oid;var options={onSuccess:MTswitchTo3DSuccess,asynchronous:true};WVSPopup.fetchServerData(theURL,options)}
function MTforceLoad2DSuccess(xmlhttp){var old_show3D=WVSPopup.show3D;WVSPopup.show3D=false;MTsetViewer(xmlhttp.responseText&&xmlhttp.responseText.length>0?xmlhttp.responseText:null,null);WVSPopup.show3D=old_show3D}function MTforceLoad2D(){var theURL="servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getThumbURL?oid="+WVSPopup.oid;WVSPopup.fetchServerData(theURL,{onSuccess:MTforceLoad2DSuccess})}function MTInitNSEvents(){var cb=new MTNS6callback;document.mtpvctl.SetNSCallback(cb)}
function MTNS6callback(){this.OnLoadComplete=MTNSLoadComplete;this.OnDoAction=MTNSDoAction;this.OnRMB=MTNSDoRMBAction;this.OnPreSelectedInstance=MTPreSelect;this.OnClearPreSelection=MTClearPreSelect}
function MTNSDoAction(){if(WVSPopup.pviewMode=="spincenter"){WVSPopup.pviewMode="select";document.mtpvctl.SetMode(WVSPopup.pviewMode)}var rm=Ext.getCmp("wvsrightmenu");if(rm.isVisible()){rm.hide();return}if(WVSPopup.selectedChild!=null){var img=document.getElementById("cmt"+WVSPopup.selectedChild);if(img!=null){img.focus();window.setTimeout("MTnavigateTo('"+WVSPopup.selectedChild+"');",20)}}}
function MTNSDoRMBAction(x,y){var rm=Ext.getCmp("wvsrightmenu");var pos=WVSFindAbsPos(WVSPopup.pviewrun);rm.showAt([pos[0]+x,pos[1]+y])}function MTCheckLoaded(){if(document.mtpvctl.IsInstanceVisible("/"))return true;else{var c=WVSPopup.right_col.childNodes;var c=Ext.DomQuery.jsSelect("img[id^=cmt]",WVSPopup.right_col);for(var i=0,l=c.length;i<l;i++){var id=c[i].id;if(id&&c[i].getAttribute("mtp")=="0")if(document.mtpvctl.IsInstanceVisible("/"+id.substring(3)+":0"))return true}}return false}
function MTPVRunTimeout(){wvs_hide_2D();wvs_hide_dynDoc();wvs_show_3D();WVSPopup.pviewReady=true}
function MTNSLoadComplete(){if(WVSPopup.isNavigateMode()&&WVSPopup.type.indexOf("clash_")!==0)if(!MTCheckLoaded()){MTforceLoad2D();return}if(WVSPopup.pviewOrientation){document.mtpvctl.SetViewLocation(WVSPopup.pviewOrientation);WVSPopup.pviewOrientation=null}else if(typeof _docViewOrientationOption!="undefined"&&_docViewOrientationOption!=null){var s=_docViewOrientationOption.split(" ");document.mtpvctl.SetViewLocation(s[0]+" "+s[1]+" "+s[2]+" 0 "+s[3]+" "+s[4]+" "+s[5]+" 0 "+s[6]+" "+s[7]+" "+s[8]+
" 0 0 0 0 1")}MTzoomToAllPlugin();if(WVSPopup.type.indexOf("clash")===0){var val=document.mtpvctl.GetPropertyValue("/","","wvs_tn_bbox_info");if(val!=null&&val.length>0){var a=val.split("|");for(var i=0;i<a.length;i++){var s=a[i].split(" ");if(s.length==6)document.mtpvctl.CreateBoundingBox(parseFloat(s[0]),parseFloat(s[1]),parseFloat(s[2]),parseFloat(s[3]),parseFloat(s[4]),parseFloat(s[5]),"0x00ffff00",0.15,false)}}}if(_mtIsIE)if(WVSPopup.pviewrun.style.display=="none")setTimeout(MTPVRunTimeout,10);
else WVSPopup.pviewReady=true;else{if(WVSPopup.pviewrun.style.width=="0pt"||WVSPopup.pviewrun.style.width=="0px")setTimeout(MTPVRunTimeout,10);else WVSPopup.pviewReady=true;if(_mtIsChrome)WVSPopup.pviewrun.style.visibility=""}}function MTSelect(text){if(text=="/")return;var img=document.getElementById("cmt"+text.substring(1,text.lastIndexOf(":")));if(img!=null)img.style.border="1px solid #FF0000"}
function MTDeselect(text){if(text=="/")return;var img=document.getElementById("cmt"+text.substring(1,text.lastIndexOf(":")));if(img!=null)img.style.border="1px solid #FFFFFF"}function MTDeselectAll(){var c=WVSPopup.right_col.childNodes;var c=Ext.DomQuery.jsSelect("img[id^=cmt]",WVSPopup.right_col);for(var i=0,l=c.length;i<l;i++)c[i].style.border="1px solid #FFFFFF"}
function MTPreSelect(text){if(text=="/"||WVSPopup.pviewMode!="select")return;var oid=text.substring(1,text.lastIndexOf(":"));var img=document.getElementById("cmt"+oid);if(img!=null){WVSPopup.selectedChild=oid;img.style.border="1px solid #FF0000";_mtTimeOutImg=img;_mtTimeOut=setTimeout(MTPreSelectTooltip,500);var count=img.getAttribute("cmt");if(count!=null&&PTC.miniNavigator.is3dPluginPresent())for(var i=0;i<count;i++)document.mtpvctl.SelectInstance("/"+oid+":"+i)}}
function MTPreSelectTooltip(){var pos=WVSFindAbsPos(_mtTimeOutImg);WVSPopup.showStatus(MTFormatTooltip(_mtTimeOutImg.getAttribute("xtitle")),pos[0]+24,pos[1]+16,false)}function MTClearPreSelect(){WVSPopup.selectedChild=null;document.mtpvctl.DeSelectAll();if(_mtTimeOut)clearTimeout(_mtTimeOut);WVSPopup.hideStatus();var c=WVSPopup.right_col.childNodes;var c=Ext.DomQuery.jsSelect("img[id^=cmt]",WVSPopup.right_col);for(var i=0,l=c.length;i<l;i++)c[i].style.border="1px solid #FFFFFF"}
function MTLaunchPV(){MTLaunchPVOption(true,WVSPopup.oid,WVSPopup.pvaction)}
function MTLaunchPVOptionSuccess(xmlhttp){if(xmlhttp.responseText&&xmlhttp.responseText.length>0)if(xmlhttp.request.options.launchPV){if(!WVSPopup.pinned)WVSPopup.hide();eval(xmlhttp.responseText)}else return xmlhttp.responseText;else if(launchPV){var pos=WVSPopup.win.getPosition(false);WVSPopup.showStatus(PTC.util.HTMLEncoder.encodeForHTMLContent(bundleHandler.get("com.ptc.wvs.server.ui.uiResource.TN_NO_PRODUCTVIEW_DATA")),pos[0]+88,pos[1]+274,true)}}
function MTLaunchPVOption(launchPV,oid,pvaction){WVSPopup.hideStatus();var theURL="servlet/WindchillAuthGW/com.ptc.wvs.server.ui.ThumbnailHelper/getPVLaunch?oid="+oid+"&pvaction="+pvaction;var options={onSuccess:MTLaunchPVOptionSuccess,launchPV:launchPV,asynchronous:false};return WVSPopup.fetchServerData(theURL,options).responseText}
function MTsetViewerOptions(){var options=WVSPopup.options;if(options&&options.length>0){var i=options.indexOf(";");var opt=options;if(i>=0){opt=options.substring(0,i);if(i<options.length)options=options.substring(i+1);else options=null}else options=null;i=opt.indexOf(" ");if(i>0){_docColorOption=Math.floor(parseInt(opt.substring(0,i),10));_docGradColorOption=Math.floor(parseInt(opt.substring(i+1),10))}else{_docColorOption=Math.floor(parseInt(opt,10));_docGradColorOption=null}if(options&&options.length>
0){i=options.indexOf(";");opt=options;if(i>=0){opt=options.substring(0,i);if(i<options.length)options=options.substring(i+1);else options=null}else options=null;_docViewOrientationOption=opt;if(options&&options.length>0)_docAdditionalOption=options}}}
function MTGetPviewHtml(pluginParams){var htmlString="";if(_mtIsIE){if(_is64bitIE)htmlString+='<object classid="CLSID:F1BFCEEA-892D-405c-945F-19F87338A17F" id="mtpvctl"';else htmlString+='<object classid="CLSID:F07443A6-02CF-4215-9413-55EE10D509CC" id="mtpvctl"';htmlString+=" width=100% height=100%>"+ConvertNSParamsToIE(pluginParams)+"</object>"}else htmlString+='<embed id="mtpvctl" name="mtpvctl" type="application/x-pvlite9-ed" width="100%" height="100%" '+pluginParams+">";return htmlString};
